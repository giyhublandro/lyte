Imports System.Data.Odbc
Imports System.IO
Imports iTextSharp.text
Imports iTextSharp.text.pdf
Imports MySql.Data.MySqlClient
Imports System.Runtime.InteropServices

'--------------------------------
Imports System
Imports System.Text
Imports System.Web

Imports System.Configuration
Imports System.Windows.Forms.DataVisualization.Charting
Imports System.Net

Imports System.ComponentModel

Public Class Functions

    Structure ResumeParService
        Dim SERVICE As String
    End Structure

    Private Declare Function InternetGetConnectedState Lib "wininet" (ByRef conn As Long, ByVal val As Long) As Boolean

    'PERMET DE SAVOIR SI ON DOIT SELECTIONNER UN MAGASIN AU CAS OU ON EN A PLUSIEURS

    Public Shared Sub choixDeMagasinOuPas()

        '2- MAGASIN DE l'UTILISATEUR SI IL EST ASSOCIE A PLUS D'UN MAGASIN
        Dim lesMagasins As DataTable = Functions.getElementByCode(Trim(GlobalVariable.ConnectedUser(0)("CODE_UTILISATEUR")), "utilisateur_magazin", "CODE_UTILISATEUR")

        If lesMagasins.Rows.Count >= 1 Then

            'SI LA VALEUR ACTUEL D'UN MAGASINEST DEFINI ON NE L'A REDEFEINIE PAS

            If Trim(GlobalVariable.magasinActuel).Equals("") Then

                ChoixDuMagasinForm.Close()
                ChoixDuMagasinForm.Show()
                ChoixDuMagasinForm.TopMost() = True

            End If

        ElseIf lesMagasins.Rows.Count = 1 Then

            GlobalVariable.magasinActuel = Trim(lesMagasins.Rows(0)("CODE_MAGAZIN"))

            'CREATION DU FICHIER CONTENANT LA LISTE DES ARTICLES FAISANT L'OBJET D'UN TRAITEMENT
            'inventaireJournalierTextFile(GlobalVariable.magasinActuel, GlobalVariable.shiftActuel)

        End If

    End Sub

    Public Shared Function determinationDuShift(SHIFT) As String

        If SHIFT = 0 Then
            SHIFT = "MATIN"
        ElseIf SHIFT = 1 Then
            SHIFT = "SOIR"
        ElseIf SHIFT = 2 Then
            SHIFT = "SOIR"
        End If

        Return shift

    End Function

    Public Shared Sub inventaireJournalierTextFile(ByVal CODE_MAGASIN As String, ByVal SHIFT_VALUE As Integer, ByVal DEBUT_FIN As Integer, Optional ByVal NIGHT_AUDIT As Integer = 0, Optional ByVal CODE_UTILISATEUR As String = "", Optional ByVal NOM_UTILISATEUR As String = "")

        If NIGHT_AUDIT = 0 Then

            'SI C'EST PAS LE NIGHT AUDI ALORS ON RECUPRER LES INFORMATIONS DE L'UTILISATEUR ACTUELLEMENT CONNECTE

            CODE_UTILISATEUR = GlobalVariable.ConnectedUser.Rows(0)("CODE_UTILISATEUR")
            NOM_UTILISATEUR = GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR")

        End If

        Dim extension As String = ".txt"
        Dim nomDuDossierRapport As String = "RAPPORTS\INVENTAIRES"
        'Dim nomDuFichier As String = GlobalVariable.ConnectedUser.Rows(0)("CODE_UTILISATEUR") & extension
        Dim nomDuFichier As String = CODE_UTILISATEUR & extension

        'PERMET DE DEFINIR LE TYPE DE SHIFT : MATIN - SOIR - NUIT
        Dim SHIFT As String = determinationDuShift(SHIFT_VALUE)
        Dim DEBUT_FIN_ As String = ""

        If DEBUT_FIN = 0 Then
            DEBUT_FIN_ = "DEBUT"
        Else
            DEBUT_FIN_ = "FIN"
        End If

        Dim filePathAndDirectory As String = GlobalVariable.AgenceActuelle.Rows(0)("CHEMIN_SAUVEGARDE_AUTO") & "\" & nomDuDossierRapport & "\" & GlobalVariable.DateDeTravail.ToString("ddMMyy") & "\" & CODE_MAGASIN & "\" & SHIFT & "\" & DEBUT_FIN_

        Dim filepathPlusFile As String = filePathAndDirectory & "\" & nomDuFichier

        If Not Directory.Exists(filePathAndDirectory) Then

            My.Computer.FileSystem.CreateDirectory(filePathAndDirectory)

            If Not System.IO.File.Exists(filepathPlusFile) Then
                System.IO.File.Create(filepathPlusFile).Dispose()
            End If

        End If

        Dim ligne_facture As New LigneFacture()

        Dim DATE_SHIFT As Date = GlobalVariable.DateDeTravail
        Dim INDEX_SHIFT As Integer = GlobalVariable.shiftActuel

        If NIGHT_AUDIT = 0 Then
            INDEX_SHIFT = GlobalVariable.shiftActuel
        Else
            INDEX_SHIFT = SHIFT_VALUE
        End If

        Dim HEURE_ARRIVEE As String = Now().ToLongTimeString
        Dim HEURE_DEPART As String = ""
        Dim CHEMIN_DEBUT As String = filepathPlusFile
        Dim CHEMIN_FIN As String = filepathPlusFile
        Dim ID_SHIFT As Integer = 0

        If DEBUT_FIN = 0 Then 'ENREGISTREMENT DU FICHIER A LA CONNECTION
            ligne_facture.insertGestionDesShifts(DATE_SHIFT, INDEX_SHIFT, CODE_UTILISATEUR, CODE_MAGASIN, NOM_UTILISATEUR, HEURE_ARRIVEE, HEURE_DEPART, CHEMIN_DEBUT)
        Else

            'ENREGISTREMENT DU FICHIER A LA DECONNECTION

            HEURE_DEPART = Now().ToLongTimeString()
            ligne_facture.updateHeureDepartGestionDesShifts(HEURE_DEPART, CHEMIN_FIN, CODE_UTILISATEUR, CODE_MAGASIN, DATE_SHIFT)

        End If

        'INSERTION DE ALIGNE DE GSTION DU SHIFT

        Dim getUserQuery1 = "SELECT DISTINCT CODE_ARTICLE FROM article WHERE CODE_FAMILLE = @CODE_FAMILLE ORDER BY DESIGNATION_FR ASC"

        Dim command1 As New MySqlCommand(getUserQuery1, GlobalVariable.connect)
        Dim CODE_FAMILLE As String = "BOISSONS"
        command1.Parameters.Add("@CODE_FAMILLE", MySqlDbType.VarChar).Value = CODE_FAMILLE

        Dim adapter1 As New MySqlDataAdapter

        Dim ficheInventaireJournaliere As New DataTable()

        adapter1.SelectCommand = command1

        adapter1.Fill(ficheInventaireJournaliere)

        Dim PRIX_DE_VENTE As Double = 0
        Dim PRIX_UTILISE As Integer = 0
        Dim PRIX_CONSO_UTILISE As Integer = 0

        If ficheInventaireJournaliere.Rows.Count > 0 Then

            Dim swriter As StreamWriter
            swriter = File.AppendText(filepathPlusFile)

            Dim infoSup As DataTable
            Dim infoSupMagasin As DataTable = Functions.getElementByCode(CODE_MAGASIN, "magasin", "CODE_MAGASIN")

            Dim econom As New Economat()

            Dim CODE_ARTICLE As String = ""
            Dim LIBELLE_ARTICLE As String = ""
            Dim QUANTITE_EN_STOCK As Double = 0

            Dim CODE_ARTICLE_ As String = ""

            For i = 0 To ficheInventaireJournaliere.Rows.Count - 1

                infoSup = Functions.getElementByCode(ficheInventaireJournaliere.Rows(i)("CODE_ARTICLE"), "article", "CODE_ARTICLE")

                If infoSup.Rows.Count > 0 Then

                    'DETERMINONS LE PRIX DE VENTE UTILSE DANS LE MAGASIN ACTUEL
                    'PRIX_DE_VENTE
                    If infoSupMagasin.Rows.Count > 0 Then

                        'ON DOIT SAVOIR SI L'ARTICLE SE VEND EN CONSOMMATION

                        CODE_ARTICLE_ = infoSup.Rows(0)("CODE_ARTICLE")
                        Dim conso As DataTable = Functions.getElementByCode(CODE_ARTICLE_, "unite_comptage", "CODE_UNITE_DE_COMPTAGE")

                        If conso.Rows.Count > 0 Then

                            PRIX_DE_VENTE = BarRestaurantForm.prixUtilseConso(CODE_MAGASIN, infoSup)

                        Else

                            If PRIX_UTILISE = 0 Then
                                PRIX_DE_VENTE = infoSup.Rows(0)("PRIX_VENTE_HT")
                            ElseIf PRIX_UTILISE = 1 Then
                                PRIX_DE_VENTE = infoSup.Rows(0)("PRIX_VENTE1_HT")
                            ElseIf PRIX_UTILISE = 2 Then
                                PRIX_DE_VENTE = infoSup.Rows(0)("PRIX_VENTE2_HT")
                            ElseIf PRIX_UTILISE = 3 Then
                                PRIX_DE_VENTE = infoSup.Rows(0)("PRIX_VENTE3_HT")
                            End If

                        End If

                    End If

                    '----------------------------------------------------------------------------------------------------

                    CODE_ARTICLE = infoSup.Rows(0)("CODE_ARTICLE")
                    LIBELLE_ARTICLE = infoSup.Rows(0)("DESIGNATION_FR")
                    QUANTITE_EN_STOCK = econom.QuantiteDunArticleQuelconqueDansUnMagasinQuelconque(CODE_MAGASIN, CODE_ARTICLE)

                    '----------------------------------------------------------------------------------------------------
                    swriter.WriteLine(CODE_ARTICLE & "#" & LIBELLE_ARTICLE & "#" & PRIX_DE_VENTE & "#" & QUANTITE_EN_STOCK)

                End If

            Next

            swriter.Flush()
            swriter.Close()

        End If

    End Sub

    Structure SituationClient

        Dim dateOperation
        Dim libelleOperation
        Dim Debit
        Dim Credit

    End Structure

    Public Shared Sub controlDeChangementDeDateDeTravail(ByVal dateAfficher As String, ByVal DateDeTravail As String, ByVal form As Form)

        If Not dateAfficher = DateDeTravail Then
            AccueilForm.Show()
            form.Close()
        End If

    End Sub

    Public Shared Sub controleDeClotureEncours(ByVal DateDeSituation As Date)

        Dim getUserQuery = "SELECT * FROM cloture WHERE DATE_DE_TRAVAIL >= '" & DateDeSituation.ToString("yyyy-MM-dd") & "' AND DATE_DE_TRAVAIL <= '" & DateDeSituation.ToString("yyyy-MM-dd") & "'"

        Dim command As New MySqlCommand(getUserQuery, GlobalVariable.connect)

        'command.Parameters.Add("@ETAT", MySqlDbType.Int64).Value = 1

        Dim adapter As New MySqlDataAdapter

        Dim cloture As New DataTable()

        adapter.SelectCommand = command

        adapter.Fill(cloture)

        If cloture.Rows(0)("ETAT") = 0 Then
            '1- ON DETERMINE TOUS LES UTILISATEURS CONNECTES PUIS ON ENVOIE UN MESSAGE 
            '2- ON FERME L'APPLICATION PUIS ON RENVOIE UN MESSAGE INDIQUANT QUE LA CLOTURE EST TERMINEE
            '3- 
        End If

    End Sub
    Public Shared Function SituationDeCaisseEspeces(ByVal DateDeSituation As Date, ByVal CODE_CAISSIER As String) As Double

        'GlobalVariable.fenetreDouvervetureDeCaisse = "bar"

        Dim getUserQuery = "SELECT * FROM reglement WHERE CODE_CAISSIER = @CODE_CAISSIER AND DATE_REGLEMENT >= '" & DateDeSituation.ToString("yyyy-MM-dd") & "' AND DATE_REGLEMENT <= '" & DateDeSituation.ToString("yyyy-MM-dd") & "' 
        AND ETAT=@ETAT AND MODE_REGLEMENT IN ('Espèce', 'Cash') ORDER BY DATE_REGLEMENT DESC"

        Dim command As New MySqlCommand(getUserQuery, GlobalVariable.connect)

        command.Parameters.Add("@CODE_CAISSIER", MySqlDbType.VarChar).Value = CODE_CAISSIER
        command.Parameters.Add("@ETAT", MySqlDbType.Int64).Value = 0

        Dim adapter As New MySqlDataAdapter

        Dim situationDeCaisse As New DataTable()

        adapter.SelectCommand = command

        adapter.Fill(situationDeCaisse)

        Dim TotalFacture As Double = 0

        If situationDeCaisse.Rows.Count > 0 Then
            'On selection l'ensemble des reglements d'un jour donné
            For i = 0 To situationDeCaisse.Rows.Count - 1
                TotalFacture += situationDeCaisse.Rows(i)("MONTANT_VERSE")
            Next

            Dim situationDeCaisseCasDeRemboursement As DataTable = Functions.SituationDeCaisseCasDeRemboursement(GlobalVariable.DateDeTravail)

            Dim TotalRembourse As Double = 0
            'On selection l'ensemble des remboursement d'un jour donné
            If situationDeCaisseCasDeRemboursement.Rows.Count > 0 Then

                For j = 0 To situationDeCaisseCasDeRemboursement.Rows.Count - 1
                    TotalRembourse += situationDeCaisseCasDeRemboursement.Rows(j)("MONTANT_HT")
                Next

                'On soustrait les montant remboursé des montants encaissé
                TotalFacture -= TotalRembourse

            End If

        End If

        Return TotalFacture

    End Function
    '----------------------------------------------------------------
    Public Shared Sub BonDeCaisseDeTransfert(ByVal CODE_CAISSIER As String, ByVal REFERENCE_TRANSFERT As String, ByVal LIBELLE_TRANSFERT As String, ByVal DEBIT As Double, ByVal CREDIT As Double, ByVal REFERENCE_TRANSACTION As String, Optional ByVal FORM_NAME As String = "")

        Dim caisse As DataTable = Functions.getElementByCode(CODE_CAISSIER, "caisse", "CODE_UTILISATEUR")
        Dim titre As String = ""
        Dim LIBELLE_CAISSE As String = ""
        If caisse.Rows.Count > 0 Then
            LIBELLE_CAISSE = caisse.Rows(0)("LIBELLE_CAISSE")

            If GlobalVariable.actualLanguageValue = 1 Then
                titre = "JOURNAL DE CAISSE [ " & LIBELLE_CAISSE & " ] / " & GlobalVariable.DateDeTravail & " " & Now().ToLongTimeString
            Else
                titre = "CASH HAND OVER FORM [ " & LIBELLE_CAISSE & " ] / " & GlobalVariable.DateDeTravail & " " & Now().ToLongTimeString
            End If
        End If

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0
        Dim TotalFactureGratuitee As Double = 0

        Dim tireDocument As String = titre
        Dim titreFichier As String = "JOURNAL DE CAISSE [ " & LIBELLE_CAISSE & " ] " & (Date.Now().ToString("ddMMyyHHmmss"))
        If GlobalVariable.actualLanguageValue = 0 Then
            titreFichier = "CASH HAND OVER OF [ " & LIBELLE_CAISSE & " ] " & (Date.Now().ToString("ddMMyyHHmmss"))
        End If
        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = "JOURNAL DE CAISSE [ " & LIBELLE_CAISSE & " ]" & " " & (Date.Now().ToString("ddMMyyHms"))
        If GlobalVariable.actualLanguageValue = 0 Then
            sfd.FileName = "CASH HAND OVER OF [ " & LIBELLE_CAISSE & " ]" & " " & (Date.Now().ToString("ddMMyyHms"))
        End If

        '---------------------------------- BILLETAGE -----------------------------------------

        Dim dtBilletageList As New DataTable()

        Dim getBilletage As String = "SELECT `NB1`, `NB2`, `NB3`, `NB4`, `NB5`, `NP1`, `NP2`, `NP3`, `NP4`, `NP5`, `NP6`, `NP7`, `NB1T1`, `NB2T2`, `NB3T3`, `NB4T4`, `NB5T5`, `NP1T1`, `NP2T2`, `NP3T3`, `NP4T4`, `NP5T5`, `NP6T6`, `NP7T7`, `CODE_CAISSIER`, `REFERENCE_TRANSACTION`, GRAND_TOTAL FROM `transfert_recette_coupures` WHERE REFERENCE_TRANSACTION=@REFERENCE_TRANSACTION"

        Dim commandBilletage As New MySqlCommand(getBilletage, GlobalVariable.connect)

        commandBilletage.Parameters.Add("@REFERENCE_TRANSACTION", MySqlDbType.VarChar).Value = REFERENCE_TRANSACTION
        Dim adapterBilletage As New MySqlDataAdapter

        adapterBilletage.SelectCommand = commandBilletage
        adapterBilletage.Fill(dtBilletageList)

        '--------------------------------------------------------------------------------------

        If sfd.ShowDialog = 1 Then

            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4, 10, 10, 10, 10)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 13, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim pdfTable0 As New PdfPTable(3) 'Number of columns
            pdfTable0.TotalWidth = 560.0F
            pdfTable0.LockedWidth = True
            pdfTable0.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable0.HeaderRows = 1

            Dim widths0 As Single() = New Single() {40.0F, 40.0F, 40.0F}

            pdfTable0.SetWidths(widths0)

            Dim pdfCell As PdfPCell = Nothing

            pdfCell = New PdfPCell(New Paragraph(societe.Rows(0)("RAISON_SOCIALE"), fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.Border = 0
            pdfCell.Colspan = 2
            pdfTable0.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("Date : " & GlobalVariable.DateDeTravail, fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.Border = 0
            pdfCell.Colspan = 2
            pdfTable0.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("BP : " & societe.Rows(0)("BOITE_POSTALE") & " " & societe.Rows(0)("VILLE") & " - " & societe.Rows(0)("PAYS"), fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.Border = 0
            pdfCell.Colspan = 2
            pdfTable0.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("Heure : " & Now().ToLongTimeString, fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.Border = 0
            pdfCell.Colspan = 2
            pdfTable0.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(societe.Rows(0)("TELEPHONE"), fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.Border = 0
            pdfCell.Colspan = 2
            pdfTable0.AddCell(pdfCell)

            pdfDoc.Add(pdfTable0)

            Dim p1 As Paragraph = New Paragraph(Chr(13), pColumn)
            p1.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p1)
            'pdfWrite.PageEvent = New HeaderFooter

            Dim pdfTable As New PdfPTable(5) 'Number of columns
            pdfTable.TotalWidth = 560.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single() = New Single() {12.0F, 15.0F, 70.0F, 10.0F, 10.0F}

            pdfTable.SetWidths(widths)

            'Dim pdfCell As PdfPCell = Nothing

            pdfCell = New PdfPCell(New Paragraph("DATE", fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            'pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F

            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("REFERENCE", fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            'pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F

            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("LIBELLE DU MOUVEMENT", fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            'pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F

            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("DEBIT", fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            'pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F

            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("CREDIT", fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            'pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F

            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(GlobalVariable.DateDeTravail, fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.MinimumHeight = 5
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(REFERENCE_TRANSFERT, fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.MinimumHeight = 5
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(LIBELLE_TRANSFERT, fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.MinimumHeight = 5
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(DEBIT, "#,##0"), fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 5
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(CREDIT, "#,##0"), fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 5
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("", fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 5
            pdfCell.Border = 0
            pdfCell.Colspan = 3
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("", fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 5
            pdfCell.Border = 0
            pdfCell.Colspan = 2
            pdfTable.AddCell(pdfCell)

            pdfDoc.Add(pdfTable)

            'REMPLISSAGE DU BILLETAGE

            If dtBilletageList.Rows.Count > 0 Then

                Dim pdfTable01 As New PdfPTable(6) 'Number of columns
                pdfTable01.TotalWidth = 560.0F
                pdfTable01.LockedWidth = True
                pdfTable01.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.HeaderRows = 1

                Dim widths01 As Single() = New Single() {20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F}

                pdfTable01.SetWidths(widths01)

                If Not Trim(FORM_NAME).Equals("") Then
                    pdfCell = New PdfPCell(New Paragraph(Chr(13) & "A -\ SOLDE EN CAISSE" & Chr(13), fontTotal))
                Else
                    pdfCell = New PdfPCell(New Paragraph(Chr(13) & "A -\ BILLETERIE" & Chr(13), fontTotal))
                End If

                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.Border = 0
                pdfCell.Colspan = 6
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BILLETS", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.Colspan = 3
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PIECES", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.Colspan = 3
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NOMBRE", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("COUPURES", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NOMBRE", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PIECES", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                pdfTable01.AddCell(pdfCell)

                Dim totalBillets As Double = 0
                Dim totalPieces As Double = 0
                '-------------------------------------------------------------------------------------------------

                totalBillets += dtBilletageList.Rows(0)("NB1") * 10000 + dtBilletageList.Rows(0)("NB2") * 5000 + dtBilletageList.Rows(0)("NB3") * 2000 + dtBilletageList.Rows(0)("NB4") * 1000 + dtBilletageList.Rows(0)("NB5") * 500

                totalPieces = dtBilletageList.Rows(0)("GRAND_TOTAL") - totalBillets

                pdfCell = New PdfPCell(New Paragraph(dtBilletageList.Rows(0)("NB1"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("10 000", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(dtBilletageList.Rows(0)("NB1") * 10000, "#,##0"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(dtBilletageList.Rows(0)("NP1"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("500", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(dtBilletageList.Rows(0)("NP1") * 500, "#,##0"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                '---------------------------------------------------------------------------------------------------------------

                pdfCell = New PdfPCell(New Paragraph(dtBilletageList.Rows(0)("NB2"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("5 000", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(dtBilletageList.Rows(0)("NB2") * 5000, "#,##0"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(dtBilletageList.Rows(0)("NP2"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("100", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(dtBilletageList.Rows(0)("NP2") * 100, "#,##0"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                '------------------------------------------------------------------------------------------

                pdfCell = New PdfPCell(New Paragraph(dtBilletageList.Rows(0)("NB3"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("2 000", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(dtBilletageList.Rows(0)("NB3") * 2000, "#,##0"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(dtBilletageList.Rows(0)("NP3"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("50", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(dtBilletageList.Rows(0)("NP3") * 50, "#,##0"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                '------------------------------------------------------------------------------------------

                pdfCell = New PdfPCell(New Paragraph(dtBilletageList.Rows(0)("NB4"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("1 000", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(dtBilletageList.Rows(0)("NB4") * 1000, "#,##0"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(dtBilletageList.Rows(0)("NP4"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("25", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(dtBilletageList.Rows(0)("NP4") * 25, "#,##0"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                '------------------------------------------------------------------------------------------

                pdfCell = New PdfPCell(New Paragraph(dtBilletageList.Rows(0)("NB5"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("500", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(dtBilletageList.Rows(0)("NB5") * 500, "#,##0"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(dtBilletageList.Rows(0)("NP5"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("10", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(dtBilletageList.Rows(0)("NP5") * 10, "#,##0"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                '------------------------------------------------------------------------------------------

                pdfCell = New PdfPCell(New Paragraph("TOTAL : ", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.Border = 0
                pdfCell.Colspan = 2
                pdfTable01.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph(Format(totalBillets, "#,##0"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.Border = 0
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(dtBilletageList.Rows(0)("NP5"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("10", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(dtBilletageList.Rows(0)("NP5") * 10, "#,##0"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                '--------------------------------------------------------------------------------------------
                pdfCell = New PdfPCell(New Paragraph("", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.Border = 0
                pdfCell.Colspan = 2
                pdfTable01.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph("", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.Border = 0
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(dtBilletageList.Rows(0)("NP7"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("1", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(dtBilletageList.Rows(0)("NP7") * 1, "#,##0"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.AddCell(pdfCell)

                '------------------------------------------------------------------------------------------

                'AFFICHAGE DES TOTAUX

                pdfCell = New PdfPCell(New Paragraph("", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.Border = 0
                pdfCell.Colspan = 2
                pdfTable01.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph("", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.Border = 0
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TOTAL : ", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.Colspan = 2
                pdfCell.Border = 0
                pdfTable01.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph(Format(totalPieces, "#,##0"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.Border = 0
                pdfTable01.AddCell(pdfCell)

                '------------------------------------------------------------------------------------------

                pdfCell = New PdfPCell(New Paragraph("", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.Colspan = 6
                pdfCell.Border = 0
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.Colspan = 6
                pdfCell.Border = 0
                pdfTable01.AddCell(pdfCell)

                pdfDoc.Add(pdfTable01)

                '---------------------------------------------- AAFICHAGE PROPRE ALA PETITE CAISSE ------------------------------------

                If Not Trim(FORM_NAME).Equals("") Then

                    'EN PROVENANCE DU

                    Dim dateDebut As Date = GlobalVariable.DateDeTravail.ToShortDateString

                    'Dim getSortie As String = "SELECT `DATE_REGLEMENT` AS DATE, `NUM_REGLEMENT` AS REFERENCE, `REF_REGLEMENT` AS DESCRITION, `MONTANT_SORTIE` AS 'MONTANT RETIRE' FROM petite_caisse_ligne WHERE CODE_AGENCE = @CODE_AGENCE AND CODE_CAISSIER =@CODE_CAISSIER AND DATE_REGLEMENT >= '" & dateDebut.ToString("yyyy-MM-dd") & "' AND DATE_REGLEMENT <='" & dateDebut.ToString("yyyy-MM-dd") & "' AND ETAT=@ETAT AND NATURE_OPERATION=@NATURE_OPERATION ORDER BY DATE_REGLEMENT DESC"

                    Dim getSortie As String = "SELECT `DATE_REGLEMENT` AS DATE, `NUM_REGLEMENT` AS REFERENCE, `REF_REGLEMENT` AS DESCRITION, `MONTANT_SORTIE` AS 'MONTANT RETIRE' FROM petite_caisse_ligne WHERE CODE_AGENCE = @CODE_AGENCE AND ETAT=@ETAT AND NATURE_OPERATION=@NATURE_OPERATION ORDER BY DATE_REGLEMENT DESC"

                    Dim commandSortie As New MySqlCommand(getSortie, GlobalVariable.connect)

                    commandSortie.Parameters.Add("@CODE_CAISSIER", MySqlDbType.VarChar).Value = GlobalVariable.ConnectedUser.Rows(0)("CODE_UTILISATEUR")
                    commandSortie.Parameters.Add("@CODE_AGENCE", MySqlDbType.VarChar).Value = GlobalVariable.codeAgence
                    commandSortie.Parameters.Add("@ETAT", MySqlDbType.Int64).Value = 0
                    commandSortie.Parameters.Add("@NATURE_OPERATION", MySqlDbType.Int64).Value = 1

                    Dim adapterSortie As New MySqlDataAdapter
                    Dim dtSortieList As New DataTable()
                    adapterSortie.SelectCommand = commandSortie
                    adapterSortie.Fill(dtSortieList)


                    Dim totalSortie As Double = 0


                    If dtSortieList.Rows.Count > 0 Then

                        Dim pdfTable02 As New PdfPTable(4) 'Number of columns
                        pdfTable02.TotalWidth = 560.0F
                        pdfTable02.LockedWidth = True
                        pdfTable02.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable02.HeaderRows = 1

                        Dim widths02 As Single() = New Single() {15.0F, 15.0F, 70.0F, 15.0F}

                        pdfTable02.SetWidths(widths02)

                        pdfCell = New PdfPCell(New Paragraph(Chr(13) & "B -\ RECAPITULATIF DES SORTIES", fontTotal))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.Border = 0
                        pdfCell.Colspan = 4
                        pdfTable02.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("DATE", fontTotal))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfTable02.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("REFERENCE", fontTotal))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfTable02.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("DESCRIPTION", fontTotal))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfTable02.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("MONTANT RETIRE", fontTotal))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfTable02.AddCell(pdfCell)

                        For i = 0 To dtSortieList.Rows.Count - 1

                            For j = 0 To dtSortieList.Columns.Count - 1

                                If j = 0 Then
                                    pdfCell = New PdfPCell(New Paragraph(CDate(dtSortieList.Rows(i)(j)).ToShortDateString, fontTotal))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                                ElseIf j = 3 Then
                                    'montant
                                    pdfCell = New PdfPCell(New Paragraph(Format(Double.Parse(dtSortieList.Rows(i)(j)), "#,##0"), fontTotal))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                    totalSortie += Double.Parse(dtSortieList.Rows(i)(j))
                                Else
                                    pdfCell = New PdfPCell(New Paragraph(dtSortieList.Rows(i)(j), fontTotal))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                End If

                                pdfTable02.AddCell(pdfCell)

                            Next
                        Next

                        pdfDoc.Add(pdfTable02)

                    End If

                    Dim pdfTable03 As New PdfPTable(4) 'Number of columns
                    pdfTable03.TotalWidth = 560.0F
                    pdfTable03.LockedWidth = True
                    pdfTable03.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable03.HeaderRows = 1

                    Dim widths03 As Single() = New Single() {20.0F, 20.0F, 20.0F, 20.0F}

                    pdfTable03.SetWidths(widths03)

                    If dtSortieList.Rows.Count > 0 Then

                        pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.Border = 0
                        pdfCell.Colspan = 3
                        pdfTable03.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalSortie, "#,##0"), fontTotal))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.Border = 0
                        pdfTable03.AddCell(pdfCell)

                    End If

                    pdfCell = New PdfPCell(New Paragraph("", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.Border = 0
                    pdfCell.Colspan = 4
                    pdfTable03.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("Signature Caissier(e) Entrant", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable03.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("Signature Caissier(e) Sortant", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable03.AddCell(pdfCell)

                    Dim infoCaissierSortant As DataTable = Functions.getElementByCode(GlobalVariable.TransfertDeElementDeCaisse, "utilisateurs", "CODE_UTILISATEUR")

                    Dim CAISSIER_ENTRANT As String = ""

                    If infoCaissierSortant.Rows.Count > 0 Then
                        CAISSIER_ENTRANT = infoCaissierSortant.Rows(0)("NOM_UTILISATEUR")
                    End If

                    pdfCell = New PdfPCell(New Paragraph(CAISSIER_ENTRANT, fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable03.AddCell(pdfCell)

                    GlobalVariable.TransfertDeElementDeCaisse = ""

                    pdfCell = New PdfPCell(New Paragraph(GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR"), fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable03.AddCell(pdfCell)

                    pdfDoc.Add(pdfTable03)

                Else

                    'SITUATION DE CAISSE DU SHIFT SUR LA FICHE DE TRANSFERT DE FONDS

                    '-------------------------------------------------------

                    Dim grandTotalSituationDeCaisse As Double = 0

                    Dim Libelle = New Paragraph(Chr(13) & "SITUATION DE CAISSE : " & GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR") & Chr(13) & Chr(13), pRow)

                    If GlobalVariable.actualLanguageValue = 0 Then
                        Libelle = New Paragraph(Chr(13) & "CASH HAND OVER FORM : " & GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR") & Chr(13) & Chr(13), pRow)
                    End If
                    pdfDoc.Add(Libelle)

                    Dim dt As New DataTable()

                    Dim dtModeReglement As New DataTable()
                    Dim GrandTotalFacture As Double = 0
                    Dim DateDeSituation As Date = CDate(GlobalVariable.DateDeTravail).ToShortDateString
                    'SELECTION DES MODES DE REGLEMENTS
                    dtModeReglement = ModeDeReglementDeSituationDeCaisse(DateDeSituation)

                    'SELECTION DES REGLEMENTS
                    dt = SituationDeCaisse(DateDeSituation)

                    'For i = 0 To dt.Rows.Count - 1
                    'GrandTotalFacture += dt.Rows(i)("MONTANT_VERSE")
                    'Next

                    For j = 0 To dtModeReglement.Rows.Count - 1

                        Dim pdfTable_ As New PdfPTable(3) 'Number of columns
                        pdfTable_.TotalWidth = 560.0F
                        pdfTable_.LockedWidth = True
                        pdfTable_.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable_.HeaderRows = 1

                        'Dim widths As Single() = New Single() {2.0F, 5.0F, 2.5F, 1.5F}
                        Dim widths_ As Single() = New Single() {2.0F, 10.0F, 2.5F}
                        pdfTable_.SetWidths(widths_)

                        Dim pdfCell_ As PdfPCell = Nothing

                        Dim p1_ = New Paragraph(j + 1 & " /- " & dtModeReglement.Rows(j)("MODE_REGLEMENT") & Chr(13) & Chr(13), fontTotal)

                        pdfDoc.Add(p1_)

                        Dim MODE_REGLEMENT As String = dtModeReglement.Rows(j)("MODE_REGLEMENT")

                        pdfCell_ = New PdfPCell(New Paragraph("DATE", fontTotal))
                        pdfCell_.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell_.MinimumHeight = 15
                        pdfCell_.PaddingLeft = 5.0F
                        'pdfCell_.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable_.AddCell(pdfCell_)

                        pdfCell_ = New PdfPCell(New Paragraph("DESIGNATION", fontTotal))
                        pdfCell_.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell_.MinimumHeight = 15
                        pdfCell_.PaddingLeft = 5.0F
                        'pdfCell_.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable_.AddCell(pdfCell_)

                        pdfCell_ = New PdfPCell(New Paragraph("MODE REGLEMENT", fontTotal))
                        pdfCell_.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell_.MinimumHeight = 15
                        pdfCell_.PaddingLeft = 5.0F
                        'pdfCell_.BackgroundColor = BaseColor.LIGHT_GRAY
                        'pdfTable_.AddCell(pdfCell_)

                        pdfCell_ = New PdfPCell(New Paragraph("MONTANT", fontTotal))
                        pdfCell_.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell_.MinimumHeight = 15
                        pdfCell_.PaddingLeft = 5.0F
                        'pdfCell_.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable_.AddCell(pdfCell_)

                        TotalFacture = 0
                        TotalFactureGratuitee = 0

                        Dim dtSpecific As DataTable = SituationDeCaisseParModeDeReglement(DateDeSituation, MODE_REGLEMENT)

                        If dtSpecific.Rows.Count > 0 Then

                            For i = 0 To dtSpecific.Rows.Count - 1

                                If dtModeReglement.Rows(j)("MODE_REGLEMENT").Equals("Free") Or dtModeReglement.Rows(j)("MODE_REGLEMENT").Equals("Gratuitée") Then

                                    If dtSpecific.Rows(i)("MONTANT_VERSE") > 0 Then

                                        pdfCell_ = New PdfPCell(New Paragraph(dtSpecific.Rows(i)("DATE_REGLEMENT"), fontTotal))
                                        pdfCell_.MinimumHeight = 15
                                        pdfCell_.PaddingLeft = 5.0F
                                        pdfCell_.HorizontalAlignment = Element.ALIGN_LEFT
                                        pdfTable_.AddCell(pdfCell_)

                                        pdfCell_ = New PdfPCell(New Paragraph(dtSpecific.Rows(i)("REF_REGLEMENT"), fontTotal))
                                        pdfCell_.MinimumHeight = 15
                                        pdfCell_.PaddingLeft = 5.0F
                                        pdfCell_.HorizontalAlignment = Element.ALIGN_LEFT
                                        pdfTable_.AddCell(pdfCell_)

                                        pdfCell_ = New PdfPCell(New Paragraph(Format(dtSpecific.Rows(i)("MONTANT_VERSE"), "#,##0"), fontTotal))
                                        pdfCell_.MinimumHeight = 15
                                        pdfCell_.PaddingLeft = 5.0F
                                        pdfCell_.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfTable_.AddCell(pdfCell_)

                                        TotalFactureGratuitee += dtSpecific.Rows(i)("MONTANT_VERSE")

                                    End If

                                Else
                                    pdfCell_ = New PdfPCell(New Paragraph(dtSpecific.Rows(i)("DATE_REGLEMENT"), fontTotal))
                                    pdfCell_.MinimumHeight = 15
                                    pdfCell_.PaddingLeft = 5.0F
                                    pdfCell_.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfTable_.AddCell(pdfCell_)

                                    pdfCell_ = New PdfPCell(New Paragraph(dtSpecific.Rows(i)("REF_REGLEMENT"), fontTotal))
                                    pdfCell_.MinimumHeight = 15
                                    pdfCell_.PaddingLeft = 5.0F
                                    pdfCell_.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfTable_.AddCell(pdfCell_)

                                    pdfCell_ = New PdfPCell(New Paragraph(Format(dtSpecific.Rows(i)("MONTANT_VERSE"), "#,##0"), fontTotal))
                                    pdfCell_.MinimumHeight = 15
                                    pdfCell_.PaddingLeft = 5.0F
                                    pdfCell_.HorizontalAlignment = Element.ALIGN_RIGHT
                                    pdfTable_.AddCell(pdfCell_)
                                End If

                                TotalFacture += dtSpecific.Rows(i)("MONTANT_VERSE")

                                grandTotalSituationDeCaisse += dtSpecific.Rows(i)("MONTANT_VERSE")

                            Next

                            pdfDoc.Add(pdfTable_)

                            '------------------------------------------------------------------------
                            Dim pSpace As New PdfPCell(New Paragraph(Chr(13) & Chr(13) & Chr(13)))
                            'pdfDoc.Add(pdfTable_)

                            Dim pdfTable2 As New PdfPTable(3) 'Number of columns

                            pdfTable2.TotalWidth = 560.0F
                            pdfTable2.LockedWidth = True
                            pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                            'pdfTable2.HeaderRows = 1

                            Dim widths2 As Single() = New Single() {2.0F, 10.0F, 2.5F}
                            pdfTable2.SetWidths(widths2)

                            Dim pdfCell2 As PdfPCell = Nothing

                            pdfCell2 = New PdfPCell(New Paragraph("TOTAL : ", fontTotal))
                            pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell2.MinimumHeight = 18
                            pdfCell2.PaddingLeft = 15.0F
                            pdfCell2.Border = 0
                            pdfCell2.Colspan = 2
                            pdfTable2.AddCell(pdfCell2)

                            If dtModeReglement.Rows(j)("MODE_REGLEMENT").Equals("Free") Or dtModeReglement.Rows(j)("MODE_REGLEMENT").Equals("Gratuitée") Then
                                pdfCell2 = New PdfPCell(New Paragraph(Format(TotalFactureGratuitee, "#,##0"), fontTotal))
                            Else
                                pdfCell2 = New PdfPCell(New Paragraph(Format(TotalFacture, "#,##0"), fontTotal))
                            End If

                            pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell2.MinimumHeight = 18
                            pdfCell2.PaddingLeft = 5.0F
                            'pdfCell2.Border = 0
                            pdfTable2.AddCell(pdfCell2)

                            pdfDoc.Add(pdfTable2)

                        End If

                    Next

                    Dim lettreEnChiffre = New Paragraph(Chr(13) & "Arrêter la présente à la somme de: " & Format(grandTotalSituationDeCaisse, "#,##0") & " (" & NBLT(grandTotalSituationDeCaisse) & ") " & societe.Rows(0)("CODE_MONNAIE") & Chr(13) & Chr(13), pRow)
                    If GlobalVariable.actualLanguageValue = 0 Then
                        lettreEnChiffre = New Paragraph(Chr(13) & "To settle the present amount at: " & Format(grandTotalSituationDeCaisse, "#,##0") & " (" & NBLT(grandTotalSituationDeCaisse) & ") " & societe.Rows(0)("CODE_MONNAIE") & Chr(13) & Chr(13), pRow)
                    End If

                    pdfDoc.Add(lettreEnChiffre)

                    '--------------------------------------------------------

                    Dim pdfTable04 As New PdfPTable(4) 'Number of columns
                    pdfTable04.TotalWidth = 560.0F
                    pdfTable04.LockedWidth = True
                    pdfTable04.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable04.HeaderRows = 1

                    Dim widths04 As Single() = New Single() {15.0F, 15.0F, 15.0F, 15.0F}

                    pdfTable04.SetWidths(widths04)

                    pdfCell = New PdfPCell(New Paragraph("Signature Caissier(e) ", fontTotal))
                    If GlobalVariable.actualLanguageValue = 0 Then
                        pdfCell = New PdfPCell(New Paragraph("Cashier's Signature ", fontTotal))
                    End If
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable04.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("Signature Caissier(e) Principal(e)", fontTotal))
                    If GlobalVariable.actualLanguageValue = 0 Then
                        pdfCell = New PdfPCell(New Paragraph("Main Cashier signature", fontTotal))
                    End If
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable04.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR"), fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable04.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable04.AddCell(pdfCell)

                    pdfDoc.Add(pdfTable04)

                End If

            End If

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13), pColumn)
            p10.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p10)

            pdfDoc.Close()

            'MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

            Process.Start(sfd.FileName)

        End If

    End Sub


    Public Shared Sub ClosingOpenedConnection()

        If GlobalVariable.databaseType = "MYSQL" Then
            GlobalVariable.connect.Close()
        ElseIf GlobalVariable.databaseType = "ACCESS" Then
            'GlobalVariable.sqlConnection.Close()
        End If

    End Sub

    Public Shared Function conversionEnPlusPetiteUnite(ByVal CODE_ARTICLE As String, ByVal QTE As Double, ByVal UNITE_ACTUELLE As String) As Double

        Dim Article As DataTable = Functions.getElementByCode(CODE_ARTICLE, "article", "CODE_ARTICLE")

        Dim QTE_CONVERTI As Double = QTE 'PAR DEFAUT ON CONSIDERE C'EST LA PETITE UNITE

        If Article.Rows.Count > 0 Then

            Dim PETITE_UNITE As String = ""
            Dim GRANDE_UNITE As String = ""
            Dim CONSOMMATION As String = ""
            Dim LIBELLE_UNITE As String = UNITE_ACTUELLE

            Dim VALEUR_DE_CONVERSION As Double = 0

            Dim UNITE_COMPTAGE As String = Article.Rows(0)("UNITE_COMPTAGE")
            Dim BOISSON As Integer = Article.Rows(0)("BOISSON")

            Dim unite As DataTable = Functions.getElementByCode(UNITE_COMPTAGE, "unite_comptage", "CODE_UNITE_DE_COMPTAGE")
            '1- CONVERSION VERS CONSOMMATION
            '2- CONVERSION VERS PETITE UNITE
            If unite.Rows.Count > 0 Then

                PETITE_UNITE = unite.Rows(0)("PETITE_UNITE")
                GRANDE_UNITE = unite.Rows(0)("GRANDE_UNITE")
                VALEUR_DE_CONVERSION = unite.Rows(0)("VALEUR_NUMERIQUE")

                '1.1- ON DOIT CHERCHER A SAVOIR SI L'ARTICLE ACTUELLE EST STOCKE EN CONSO BIEN QUE POUVANT AVOIR D'AUTRES UNITES (GRANDE ET PETITE)
                '- REDUIRE LA VENTE EN CONSOMMATION SI VENDU EN BOUTEILLE PAR EXAMPLE.
                '-------------------------------------------------------------------------------------------------------------------------------------------
                Dim conso As DataTable = Functions.getElementByCode(Trim(Article.Rows(0)("CODE_CONSO")), "unite_comptage", "CODE_UNITE_DE_COMPTAGE")

                If Trim(Article.Rows(0)("CODE_CONSO")).Equals("") Then
                    conso = Nothing
                End If

                If conso IsNot Nothing And BOISSON = 1 Then

                    If conso.Rows.Count > 0 Then

                        Dim valeurConversion As Double = conso.Rows(0)("VALEUR_NUMERIQUE") 'VOLUME DE LA CONSOMMATION

                        Dim contenance As Double = Article.Rows(0)("CONTENANCE")

                        Dim nombreDeConsoDansUneBouteille As Integer = Math.Floor(contenance / valeurConversion)

                        If LIBELLE_UNITE = PETITE_UNITE Then
                            QTE_CONVERTI = QTE * nombreDeConsoDansUneBouteille 'CONVERSION DE LA PETITE UNITE VERS LA CONSOMMATION
                        End If

                    End If

                Else

                    If LIBELLE_UNITE = GRANDE_UNITE Then
                        QTE_CONVERTI *= VALEUR_DE_CONVERSION 'CONVERSION DE LA GRANDE UNITE VERS LA PETITE
                    End If

                End If
                '----------------------------------------------------------------------------------------------
            End If

        End If

        Return QTE_CONVERTI

    End Function

    Public Shared Function affichageQteDansUnFormatCorrect(ByVal CODE_ARTICLE As String, ByVal QTE As Double) As Double

        'IL S'AGIRA DE TRANSFORMER UNE QTE D'UNE UNITE A UNE AUTRE
        'PLUS SPECIFIQUEMENT PERMET DE TRANSFORMER UN ARTICLE POUVANT ETRE VENDU 
        'EN CONSOMMATION EN BOUTEILLE ET CONSO POUR AFFICHAGE

        Dim QTE_CONVERTI As Double = QTE

        Dim Article As DataTable = Functions.getElementByCode(CODE_ARTICLE, "article", "CODE_ARTICLE")

        If Article.Rows.Count > 0 Then

            If Integer.Parse(Article.Rows(0)("BOISSON")) = 1 Then

                Dim nombreDeConsoTotal As Double = QTE
                Dim nombreDeConso As Integer = 0

                'QUANTITE STOCKE PAR APPORT AU CONSO

                'ON RECUPERE LA CONSOMMATION
                Dim conso As DataTable = Functions.getElementByCode(Trim(Article.Rows(0)("CODE_CONSO")), "unite_comptage", "CODE_UNITE_DE_COMPTAGE")

                If Trim(Article.Rows(0)("CODE_CONSO")).Equals("") Then
                    conso = Nothing
                End If

                If conso IsNot Nothing Then

                    If conso.Rows.Count > 0 Then

                        Dim valeurConversion As Double = conso.Rows(0)("VALEUR_NUMERIQUE") 'VOLUME DE LA CONSOMMATION

                        Dim nombreDeBouteille As Double = 0

                        Dim contenance As Double = Article.Rows(0)("CONTENANCE")

                        Dim nombreDeConsoDansUneBouteille As Integer = Math.Floor(contenance / valeurConversion) 'MAGASIN ACTUEL

                        If nombreDeConsoDansUneBouteille > 0 Then

                            nombreDeBouteille = Int(nombreDeConsoTotal / nombreDeConsoDansUneBouteille) 'MAGASIN ACTUEL
                            nombreDeConso = nombreDeConsoTotal Mod nombreDeConsoDansUneBouteille 'MAGASIN ACTUEL

                        End If

                        QTE_CONVERTI = nombreDeBouteille + (nombreDeConso / 100)

                    End If

                End If

            Else

                'L'ARTICLE N'ETANT PAS ASSOCIE AU CONSOMMATION
                'ON DOIT VERIFIER SI L'ARTICLE EST ASSOCIE A UNE GRANDE UNITE &  N'AYANT PAS POUR PETITE UNITE 'UNITE OU BOUTEILLe'

                Dim CODE_UNITE As String = Article.Rows(0)("UNITE_COMPTAGE")
                Dim UNITE As DataTable = Functions.getElementByCode(CODE_UNITE, "unite_comptage", "CODE_UNITE_DE_COMPTAGE")

                If UNITE.Rows.Count > 0 Then

                    Dim PETITE_UNITE = UNITE.Rows(0)("PETITE_UNITE")
                    Dim GRANDE_UNITE = UNITE.Rows(0)("GRANDE_UNITE")

                    Dim VALEUR_NUMERIQUE As Double = 1
                    VALEUR_NUMERIQUE = UNITE.Rows(0)("VALEUR_NUMERIQUE")

                    If VALEUR_NUMERIQUE > 1 Then

                        Dim convert As Boolean = True

                        If Not PETITE_UNITE.ToString.Contains("UNITE") Or Not PETITE_UNITE.ToString.Contains("BOUTEILLE") Then
                            convert = False
                        End If

                        If convert Then
                            QTE_CONVERTI = QTE / VALEUR_NUMERIQUE
                        End If

                    End If

                End If

            End If

        End If

        Return QTE_CONVERTI

    End Function

    Public Shared Function ImpressionArticleMatieres(ByVal dt As DataGridView, ByVal titre As String, ByVal all As Integer)

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = titre
        Dim titreFichier As String = titre

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titre & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then

            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4, 10, 10, 10, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 13, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            pdfDoc.Open()

            Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & "***", pColumn)
            p1.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p1)

            Dim p3 As Paragraph = New Paragraph(titre & Chr(13) & Chr(13), pRow)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            pdfWrite.PageEvent = New HeaderFooter

            Dim pdfTable As New PdfPTable(3) 'Number of columns
            pdfTable.TotalWidth = 560.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single() = New Single() {40.0F, 20.0F, 20.0F}

            pdfTable.SetWidths(widths)

            Dim pdfCell As PdfPCell = Nothing

            pdfCell = New PdfPCell(New Paragraph("DESIGNATION", fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            'pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F

            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("STOCK", fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            'pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F

            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("QTE REELLE", fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            'pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F

            pdfTable.AddCell(pdfCell)

            For i = 0 To dt.Rows.Count - 1

                '---------------------------------------------------------------------------------



                '---------------------------------------------------------------------------------

                If all = 0 Then

                    If dt.Rows(i).Cells("QUANTITE").Value > 0 Then

                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells("DESIGNATION").Value, font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        'pdfCell.MinimumHeight = 8
                        'pdfCell.PaddingLeft = 5.0F
                        pdfCell.MinimumHeight = 5

                        pdfTable.AddCell(pdfCell)

                        Dim QTE As Double = affichageQteDansUnFormatCorrect(dt.Rows(i).Cells("CODE").Value, dt.Rows(i).Cells("QUANTITE").Value)

                        pdfCell = New PdfPCell(New Paragraph(QTE, font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        'pdfCell.MinimumHeight = 8
                        'pdfCell.PaddingLeft = 5.0F
                        pdfCell.MinimumHeight = 5

                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("", font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        'pdfCell.MinimumHeight = 8
                        'pdfCell.PaddingLeft = 5.0F
                        pdfCell.MinimumHeight = 5

                        pdfTable.AddCell(pdfCell)

                    End If

                ElseIf all = 1 Then

                    pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells("DESIGNATION").Value, font1))
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    'pdfCell.MinimumHeight = 8
                    'pdfCell.PaddingLeft = 5.0F
                    pdfCell.MinimumHeight = 5

                    pdfTable.AddCell(pdfCell)

                    'SI L'ARTICLE SE VEND EN CONSOMMATION ON DOIT AFFICHER APPORT AU BOUTEILLE CAR L'ARTICLE ETANT STOCKE EN CONSO
                    Dim QTE As Double = affichageQteDansUnFormatCorrect(dt.Rows(i).Cells("CODE").Value, dt.Rows(i).Cells("QUANTITE").Value)

                    pdfCell = New PdfPCell(New Paragraph(QTE, font1))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    'pdfCell.MinimumHeight = 8
                    'pdfCell.PaddingLeft = 5.0F
                    pdfCell.MinimumHeight = 5

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", font1))
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    'pdfCell.MinimumHeight = 8
                    'pdfCell.PaddingLeft = 5.0F
                    pdfCell.MinimumHeight = 5

                    pdfTable.AddCell(pdfCell)

                End If

            Next

            pdfDoc.Add(pdfTable)

            '------------------------------------------------------------------------

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

            Process.Start(sfd.FileName)

        End If

    End Function

    'Generating Random Code 
    Public Shared Function GeneratingRandomCode(ByVal tableToCountElements As String, ByVal FirstLetters As String) As String

        Dim Rand As New Random
        Dim MaListe As New List(Of Integer)

        Dim existQuery As String = "Select * From " & tableToCountElements

        Dim command As New MySqlCommand(existQuery, GlobalVariable.connect)

        Dim adapter As New MySqlDataAdapter(command)
        Dim table As New DataTable()
        adapter.Fill(table)

        For i = 0 To Rand.Next(100)
            MaListe.Add(Rand.Next(-10, 10))
        Next

        If (table.Rows.Count >= 0) Then

            Dim numerOfElementsInReserveConf As Integer = 0

            If tableToCountElements = "reservation" Then

                Dim existQuery1 As String = "Select * From reserve_conf"

                Dim command1 As New MySqlCommand(existQuery1, GlobalVariable.connect)

                Dim adapter1 As New MySqlDataAdapter(command1)
                Dim table1 As New DataTable()
                adapter.Fill(table1)

                numerOfElementsInReserveConf = table1.Rows.Count

            End If

            Dim numberOfElements As Integer

            numberOfElements = table.Rows.Count + numerOfElementsInReserveConf + 1

            numberOfElements = CType(numberOfElements, String)

            Dim randomNumber As String = Rand.Next(0, MaListe.Count)
            Dim randomNumberSafe As String = Rand.Next(0, MaListe.Count)

            Dim code = FirstLetters & numberOfElements & "" & Date.Now().ToString("ms")

            ''GlobalVariable.connect.closeConnection()

            Return code
        Else
            ''GlobalVariable.connect.closeConnection()

            Return 0

        End If

    End Function

    Public Shared Function GeneratingRandomCodeAccountNumber(ByVal tableToCountElements As String, ByVal FirstLetters As String) As String

        Dim Rand As New Random
        Dim MaListe As New List(Of Integer)

        Dim existQuery As String = "Select * From " & tableToCountElements

        Dim command As New MySqlCommand(existQuery, GlobalVariable.connect)

        Dim adapter As New MySqlDataAdapter(command)
        Dim table As New DataTable()
        adapter.Fill(table)

        For i = 0 To Rand.Next(100)
            MaListe.Add(Rand.Next(-10, 10))
        Next

        If (table.Rows.Count >= 0) Then

            Dim numberOfElements As Integer

            numberOfElements = table.Rows.Count + 1

            If numberOfElements Then

            End If

            numberOfElements = CType(numberOfElements, String)

            Dim code = FirstLetters & "" & Date.Now().ToString("ms") & numberOfElements

            ''GlobalVariable.connect.closeConnection()

            Return code

        Else
            ''GlobalVariable.connect.closeConnection()

            Return 0

        End If

    End Function

    Public Shared Function GeneratingRandomCodeWithSpecifications(ByVal tableToCountElements As String, ByVal FirstLetters As String) As String

        Dim Rand As New Random
        Dim MaListe As New List(Of Integer)

        For i = 0 To Rand.Next(99)
            MaListe.Add(Rand.Next(-10, 10))
        Next

        Dim existQuery As String = "Select * From " & tableToCountElements

        Dim command As New MySqlCommand(existQuery, GlobalVariable.connect)
        Dim code As String = ""
        Dim adapter As New MySqlDataAdapter(command)
        Dim table As New DataTable()
        adapter.Fill(table)

        Dim randomNumber As String = Rand.Next(0, MaListe.Count)

        If table.Rows.Count > 0 Then

            Dim numberOfElements As Integer = table.Rows.Count + 1
            'Dim code = numberOfElements & Date.Now().ToString("ddMMyyHHmmss")
            code = numberOfElements & randomNumber & Date.Now().ToString("HHss")

            Return FirstLetters + code

        Else

            code = 1 & randomNumber & Date.Now().ToString("HHss")

            Return FirstLetters + code

        End If

    End Function

    Public Shared Function GeneratingRandomCodePanne(ByVal tableToCountElements As String, ByVal FirstLetters As String) As String

        Dim Rand As New Random
        Dim MaListe As New List(Of Integer)

        Dim existQuery As String = "Select * From " & tableToCountElements

        Dim command As New MySqlCommand(existQuery, GlobalVariable.connect)

        Dim adapter As New MySqlDataAdapter(command)
        Dim table As New DataTable()
        adapter.Fill(table)


        If (table.Rows.Count >= 0) Then

            Dim numerOfElementsInReserveConf As Integer = 0

            Dim existQuery1 As String = "Select * From " & tableToCountElements

            Dim command1 As New MySqlCommand(existQuery1, GlobalVariable.connect)

            Dim adapter1 As New MySqlDataAdapter(command1)
            Dim table1 As New DataTable()
            adapter.Fill(table1)

            numerOfElementsInReserveConf = table1.Rows.Count

            Dim numberOfElements As Integer

            numberOfElements = table.Rows.Count + 1

            numberOfElements = CType(numberOfElements, String)

            Dim randomNumber As String = Rand.Next(0, MaListe.Count)
            Dim randomNumberSafe As String = Rand.Next(0, MaListe.Count)

            Dim code = numberOfElements & Date.Now().ToString("ms")

            ''GlobalVariable.connect.closeConnection()

            Return FirstLetters + code
        Else
            ''GlobalVariable.connect.closeConnection()

            Return 0

        End If

    End Function
    '----------------------------------------------------------------
    'Check if element Code Exist
    Public Shared Function entryCodeExists(ByVal code As String, ByVal tableName As String, ByVal codeFieldName As String) As Boolean

        Dim existQuery As String = "Select * From " & tableName & "  WHERE " & codeFieldName & "=@code"

        Dim command As New MySqlCommand(existQuery, GlobalVariable.connect)
        command.Parameters.Add("@code", MySqlDbType.VarChar).Value = code

        Dim adapter As New MySqlDataAdapter(command)
        Dim table As New DataTable()
        adapter.Fill(table)

        If (table.Rows.Count > 0) Then
            'GlobalVariable.connect.closeConnection()
            Return True
        Else
            'GlobalVariable.connect.closeConnection()
            Return False
        End If

    End Function

    'SUPRESSION DE TOUS LE CONTENU D'UNE TABLE

    Public Shared Function deleteAll(ByVal tableName As String) As Boolean

        Dim adapter As New MySqlDataAdapter
        Dim table As New DataTable
        Dim getUserQuery = "DELETE FROM " & tableName
        Dim Command As New MySqlCommand(getUserQuery, GlobalVariable.connect)

        adapter.SelectCommand = Command
        adapter.Fill(table)

        Return True

    End Function

    '--------------------------------------------------------------------
    'Deleting an element from database using it code
    Public Shared Function DeleteElementByCode(ByVal code As String, ByVal tableName As String, ByVal fieldName As String) As Boolean

        Dim adapter As New MySqlDataAdapter
        Dim table As New DataTable
        Dim getUserQuery = "DELETE FROM " & tableName & " WHERE " & fieldName & " = @CODE"
        Dim Command As New MySqlCommand(getUserQuery, GlobalVariable.connect)
        Command.Parameters.Add("@CODE", MySqlDbType.VarChar).Value = code
        adapter.SelectCommand = Command
        adapter.Fill(table)

        'GlobalVariable.connect.closeConnection()

        Return True

    End Function

    Public Shared Function DeleteElementOnTwoConditions(ByVal code As String, ByVal tableName As String, ByVal fieldName As String, ByVal fieldName2 As String, ByVal condition2 As String) As Boolean

        Dim adapter As New MySqlDataAdapter
        Dim table As New DataTable
        Dim getUserQuery = "DELETE FROM " & tableName & " WHERE " & fieldName & " = @CODE And " & fieldName2 & " = @CODE2"
        Dim Command As New MySqlCommand(getUserQuery, GlobalVariable.connect)
        Command.Parameters.Add("@CODE", MySqlDbType.VarChar).Value = code
        Command.Parameters.Add("@CODE2", MySqlDbType.VarChar).Value = condition2

        adapter.SelectCommand = Command
        adapter.Fill(table)

        'GlobalVariable.connect.closeConnection()

        Return True

    End Function


    Public Shared Function DeleteElementByCode(ByVal code As String, ByVal tableName As String, ByVal fieldName As String, ByVal fieldName2 As String, ByVal condition2 As String) As Boolean

        Dim adapter As New MySqlDataAdapter
        Dim table As New DataTable
        Dim getUserQuery = "DELETE FROM " & tableName & " WHERE " & fieldName & " = @CODE And " & fieldName2 & " = @CODE2"
        Dim Command As New MySqlCommand(getUserQuery, GlobalVariable.connect)
        Command.Parameters.Add("@CODE", MySqlDbType.VarChar).Value = code
        Command.Parameters.Add("@CODE2", MySqlDbType.VarChar).Value = condition2

        adapter.SelectCommand = Command
        adapter.Fill(table)

        'GlobalVariable.connect.closeConnection()

        Return True

    End Function

    'Deleting an element from database using it code
    Public Shared Function DeleteElementByCodeAndOtherCondition(ByVal code As String, ByVal tableName As String, ByVal fieldName As String, ByVal code2 As String, ByVal fieldName2 As String)
        Dim adapter As New MySqlDataAdapter
        Dim table As New DataTable
        Dim getUserQuery = "DELETE FROM " & tableName & " WHERE " & fieldName & " = @CODE And " & fieldName2 & " = @code2"
        Dim Command As New MySqlCommand(getUserQuery, GlobalVariable.connect)
        Command.Parameters.Add("@CODE", MySqlDbType.VarChar).Value = code
        Command.Parameters.Add("@code2", MySqlDbType.VarChar).Value = code2
        adapter.SelectCommand = Command
        adapter.Fill(table)

        'GlobalVariable.connect.closeConnection()

        Return True

    End Function

    '--------------------------------------------------------------------
    'GET ELEMENT ON CONDITION BY DATE

    Public Shared Function getElementByOnCodeAndDate(ByVal ETAT_MAIN_COURANTE As Integer, ByVal tableName As String, ByVal fieldName As String, ByVal conditionDate As Date, ByVal TYPE_RESA As String, Optional ByVal CODE_RESERVATION As String = "") As DataTable

        Dim table As New DataTable

        Dim DateDebut As Date = conditionDate.ToString("yyyy-MM-dd")
        Dim DateFin As Date = conditionDate.ToString("yyyy-MM-dd")

        'GlobalVariable.connect.openConnection()

        Dim adapter As New MySqlDataAdapter
        Dim getUserQuery As String = ""

        If TYPE_RESA = "main_courante_autres" Then
            getUserQuery = "Select * FROM " & tableName & " WHERE " & fieldName & " = @ETAT_MAIN_COURANTE And DATE_MAIN_COURANTE >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_MAIN_COURANTE <='" & DateFin.ToString("yyyy-MM-dd") & "' AND ETAT_MAIN_COURANTE=@ETAT_MAIN_COURANTE"
        Else
            getUserQuery = "Select * FROM " & tableName & " WHERE " & fieldName & " = @ETAT_MAIN_COURANTE And DATE_MAIN_COURANTE >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_MAIN_COURANTE <='" & DateFin.ToString("yyyy-MM-dd") & "' AND ETAT_MAIN_COURANTE=@ETAT_MAIN_COURANTE AND NUM_RESERVATION=@CODE_RESERVATION"
        End If

        Dim Command As New MySqlCommand(getUserQuery, GlobalVariable.connect)

        'Command.Parameters.Add("@CODE", MySqlDbType.VarChar).Value = code
        Command.Parameters.Add("@ETAT_MAIN_COURANTE", MySqlDbType.Int64).Value = ETAT_MAIN_COURANTE
        Command.Parameters.Add("@CODE_RESERVATION", MySqlDbType.VarChar).Value = CODE_RESERVATION

        adapter.SelectCommand = Command
        adapter.Fill(table)

        Return table

    End Function

    'POUR LES DONNEES STATISTIQUES DU PANNEAU LATERAL DROIT
    Public Shared Function getElementByCodeIncludedDate(ByVal code As String, ByVal tableName As String, ByVal fieldName As String, ByVal TYPE_RESA As String) As DataTable

        Dim table As New DataTable

        Dim DateDebut As Date = GlobalVariable.DateDeTravail.ToString("yyyy-MM-dd")
        Dim DateFin As Date = GlobalVariable.DateDeTravail.ToString("yyyy-MM-dd")

        Dim adapter As New MySqlDataAdapter()
        Dim getUserQuery As String = ""

        If TYPE_RESA = "en chambre" Then
            getUserQuery = "SELECT * FROM " & tableName & " WHERE " & fieldName & " = @CODE AND DATE_ENTTRE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION=@ETAT_RESERVATION_ENCHAMBRE"
        ElseIf TYPE_RESA = "arrivee" Then
            getUserQuery = "SELECT * FROM " & tableName & " WHERE " & fieldName & " = @CODE AND DATE_ENTTRE >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_ENTTRE <='" & DateFin.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION=@ETAT_RESERVATION_ARRIVEE"
        End If

        Dim ETAT_RESERVATION_ENCHAMBRE As Integer = 1
        Dim ETAT_RESERVATION_ARRIVEE As Integer = 0

        Dim Command As New MySqlCommand(getUserQuery, GlobalVariable.connect)

        Command.Parameters.Add("@CODE", MySqlDbType.VarChar).Value = code
        Command.Parameters.Add("@ETAT_RESERVATION_ENCHAMBRE", MySqlDbType.Int64).Value = ETAT_RESERVATION_ENCHAMBRE
        Command.Parameters.Add("@ETAT_RESERVATION_ARRIVEE", MySqlDbType.Int64).Value = ETAT_RESERVATION_ARRIVEE

        adapter.SelectCommand = Command
        adapter.Fill(table)

        Return table

    End Function


    'Returning an element form database using it's code
    Public Shared Function getElementByCode(ByVal code As String, ByVal tableName As String, ByVal fieldName As String) As DataTable

        Dim table As New DataTable

        Dim getUserQuery = "Select * FROM " & tableName & " WHERE " & fieldName & " = @CODE"
        Dim Command As New MySqlCommand(getUserQuery, GlobalVariable.connect)
        Dim adapter_2 As MySqlDataAdapter
        adapter_2 = New MySqlDataAdapter()
        Command.Parameters.Add("@CODE", MySqlDbType.VarChar).Value = code
        adapter_2.SelectCommand = Command
        adapter_2.Fill(table)

        Return table

    End Function


    'Clearing textBox 
    Public Shared Sub ClearTextBox(ByVal root As Control)
        For Each ctrl As Control In root.Controls
            ClearTextBox(ctrl)
            If TypeOf ctrl Is TextBox Then
                CType(ctrl, TextBox).Text = String.Empty
            End If
        Next ctrl

        For Each ctrl As Control In root.Controls
            If TypeOf ctrl Is ComboBox Then
                Dim cbo = DirectCast(ctrl, ComboBox)
                'cbo.SelectedIndex = 1
            End If

        Next ctrl

        For Each ctrl As Control In root.Controls
            If TypeOf ctrl Is MaskedTextBox Then
                Dim cbo = DirectCast(ctrl, MaskedTextBox)
                cbo.Clear()
            End If

        Next ctrl

    End Sub
    'Clearing textBox 
    Public Shared Sub SiplifiedClearTextBox(ByVal root As Control)
        For Each ctrler As Control In root.Controls
            ClearTextBox(ctrler)
            If TypeOf ctrler Is TextBox Then
                CType(ctrler, TextBox).Text = String.Empty
            End If
        Next ctrler

        For Each ctrler As Control In root.Controls
            If TypeOf ctrler Is MaskedTextBox Then
                Dim cbo = DirectCast(ctrler, MaskedTextBox)
                cbo.Clear()
            End If

        Next ctrler

    End Sub

    '--------------------------------------------------------------------
    'Returning all elements form database that correspond to a criteria

    Public Shared Function GetAllElementsOnCondition(ByVal condition As String, ByVal tableName As String, ByVal fieldName As String) As DataTable

        Dim adapter As New MySqlDataAdapter
        Dim table As New DataTable
        Dim getUserQuery = "SELECT * FROM " & tableName & " WHERE " & fieldName & " = @condition"
        Dim Command As New MySqlCommand(getUserQuery, GlobalVariable.connect)
        Command.Parameters.Add("@condition", MySqlDbType.VarChar).Value = condition
        adapter.SelectCommand = Command
        adapter.Fill(table)

        'GlobalVariable.connect.closeConnection()

        Return table

    End Function

    Public Shared Function GetAllElementsOnTwoConditions(ByVal condition1 As String, ByVal tableName As String, ByVal fieldName1 As String, ByVal condition2 As String, ByVal fieldName2 As String) As DataTable

        Dim adapter As New MySqlDataAdapter
        Dim table As New DataTable
        Dim getUserQuery = "SELECT * FROM " & tableName & " WHERE " & fieldName1 & " = @condition1 AND " & fieldName2 & " = @condition2"
        Dim Command As New MySqlCommand(getUserQuery, GlobalVariable.connect)
        Command.Parameters.Add("@condition1", MySqlDbType.VarChar).Value = condition1
        Command.Parameters.Add("@condition2", MySqlDbType.VarChar).Value = condition2
        adapter.SelectCommand = Command
        adapter.Fill(table)

        'GlobalVariable.connect.closeConnection()

        Return table

    End Function

    Public Shared Function GetAllElementsOnTwoConditionsLike(ByVal condition1 As String, ByVal tableName As String, ByVal fieldName1 As String, ByVal condition2 As String, ByVal fieldName2 As String) As DataTable

        Dim adapter As New MySqlDataAdapter
        Dim table As New DataTable
        Dim getUserQuery = "SELECT * FROM " & tableName & " WHERE " & fieldName1 & " LIKE '%" & condition1 & "%' AND " & fieldName2 & " = @condition2"
        Dim Command As New MySqlCommand(getUserQuery, GlobalVariable.connect)
        'Command.Parameters.Add("@condition1", MySqlDbType.VarChar).Value = condition1
        Command.Parameters.Add("@condition2", MySqlDbType.VarChar).Value = condition2
        adapter.SelectCommand = Command
        adapter.Fill(table)

        'GlobalVariable.connect.closeConnection()

        Return table

    End Function


    '---------------------------------------------------------------
    'Returning the Code of the last inserted element
    Public Shared Function latInsertedElementCode(ByVal tableName As String, ByVal codeFieldName As String) As String

        Dim query As String = "SELECT * FROM " & tableName
        Dim adapter As New MySqlDataAdapter

        Dim table As New DataTable()
        Dim command As New MySqlCommand(query, GlobalVariable.connect)

        adapter.SelectCommand = command
        adapter.Fill(table)

        If (table.Rows.Count > 0) Then

            'GlobalVariable.connect.closeConnection()

            'Selecting the last inserted element code
            Return (table.Rows(table.Rows.Count - 1)(codeFieldName).ToString)

        Else

            Return ""

        End If

    End Function

    'Returning the Code of the last inserted element
    Public Shared Function latInsertedElementId(ByVal tableName As String, ByVal codeFieldName As String) As String

        Dim query As String = "SELECT * FROM " & tableName
        Dim adapter As New MySqlDataAdapter

        Dim table As New DataTable()
        Dim command As New MySqlCommand(query, GlobalVariable.connect)

        adapter.SelectCommand = command
        adapter.Fill(table)

        If (table.Rows.Count > 0) Then
            Return (table.Rows(table.Rows.Count - 1)(codeFieldName))
        Else
            Return ""
        End If

    End Function

    '-------------------------------------------------------------
    'Total number of element in table
    Public Shared Function TotalNumberOfElementsInTable(ByVal tableToCountElements As String) As Integer

        Dim existQuery As String = "SELECT * From " & tableToCountElements

        Dim command As New MySqlCommand(existQuery, GlobalVariable.connect)

        Dim adapter As New MySqlDataAdapter(command)
        Dim table As New DataTable()
        adapter.Fill(table)

        If (table.Rows.Count > 0) Then
            'GlobalVariable.connect.closeConnection()
            Return table.Rows.Count
        Else
            'GlobalVariable.connect.closeConnection()
            Return 0
        End If

    End Function

    '----------------------------------------------------------------------------------------------------------

    'Selecting all the elements in a table


    Public Shared Function allTableFields(ByVal tableName As String) As DataTable

        Dim FillingListquery As String = "SELECT * FROM " & tableName
        Dim commandList As New MySqlCommand(FillingListquery, GlobalVariable.connect)

        Dim adapterList As New MySqlDataAdapter(commandList)
        Dim tableList As New DataTable()

        adapterList.Fill(tableList)

        Return tableList

    End Function

    Public Shared Function allTableFieldsOnConditionOrganised(ByVal tableName As String, ByVal field As String, ByVal condition As String, ByVal orderdBy As String) As DataTable

        Dim FillingListquery As String = "SELECT * FROM " & tableName & " WHERE " & field & "=@condition ORDER BY " & orderdBy & " ASC"
        Dim commandList As New MySqlCommand(FillingListquery, GlobalVariable.connect)
        commandList.Parameters.Add("@condition", MySqlDbType.VarChar).Value = condition
        Dim adapterList As New MySqlDataAdapter(commandList)
        Dim tableList As New DataTable()

        adapterList.Fill(tableList)

        Return tableList

    End Function

    Public Shared Function allTableFieldsOnConditionOrganisedInt(ByVal tableName As String, ByVal field As String, ByVal condition As String, ByVal orderdBy As String) As DataTable

        Dim FillingListquery As String = "SELECT * FROM " & tableName & " WHERE " & field & "=@condition ORDER BY " & orderdBy & " ASC"
        Dim commandList As New MySqlCommand(FillingListquery, GlobalVariable.connect)
        commandList.Parameters.Add("@condition", MySqlDbType.Int64).Value = condition
        Dim adapterList As New MySqlDataAdapter(commandList)
        Dim tableList As New DataTable()

        adapterList.Fill(tableList)

        'GlobalVariable.connect.closeConnection()

        Return tableList

    End Function

    Public Shared Function allTableFieldsOnConditionOrganisedString(ByVal tableName As String, ByVal field As String, ByVal condition As String, ByVal orderdBy As String) As DataTable

        Dim FillingListquery As String = "SELECT * FROM " & tableName & " WHERE " & field & "=@condition ORDER BY " & orderdBy & " ASC"
        Dim commandList As New MySqlCommand(FillingListquery, GlobalVariable.connect)
        commandList.Parameters.Add("@condition", MySqlDbType.VarChar).Value = condition
        Dim adapterList As New MySqlDataAdapter(commandList)
        Dim tableList As New DataTable()

        adapterList.Fill(tableList)

        'GlobalVariable.connect.closeConnection()

        Return tableList

    End Function

    Public Shared Function allTableFieldsOrganised(ByVal tableName As String, ByVal orderdBy As String) As DataTable

        Dim FillingListquery As String = "SELECT * FROM " & tableName & " ORDER BY " & orderdBy & " ASC"
        Dim commandList As New MySqlCommand(FillingListquery, GlobalVariable.connect)

        Dim adapterList As New MySqlDataAdapter(commandList)
        Dim tableList As New DataTable()

        adapterList.Fill(tableList)

        'GlobalVariable.connect.closeConnection()

        Return tableList

    End Function

    'Selecting all the elements in a table

    Public Shared Function allTableFieldsInAnAgency(ByVal tableName As String, ByVal agencyCode As String) As DataTable

        Dim FillingListquery As String = "SELECT * FROM " & tableName & "CODE_AGENCE = " & agencyCode
        Dim commandList As New MySqlCommand(FillingListquery, GlobalVariable.connect)

        Dim adapterList As New MySqlDataAdapter(commandList)
        Dim tableList As New DataTable()

        adapterList.Fill(tableList)

        'GlobalVariable.connect.closeConnection()

        Return tableList

    End Function

    'We Set back the global variables to their initial values

    Public Shared Sub emptyConnectionVariable()

        GlobalVariable.ConnectedUser = Nothing
        GlobalVariable.AgenceActuelle = Nothing
        GlobalVariable.DroitAccesDeUtilisateurConnect = Nothing

    End Sub

    Public Shared Sub EmtyGlobalVariablesContainingCodeToUpdate()

        GlobalVariable.codeReservationToUpdate = ""
        GlobalVariable.codeMainCouranteToUpdate = ""
        GlobalVariable.codeMainCouranteGeneraleToUpdate = ""
        GlobalVariable.codeMainCouranteJournaliereToUpdate = ""
        GlobalVariable.codeReglementToUpdate = ""
        GlobalVariable.codeOccupationchambreToUpdate = ""
        GlobalVariable.codeFactureToUpdate = ""
        GlobalVariable.codeCompteToUpdate = ""
        GlobalVariable.codeChambreToUpdate = ""
        GlobalVariable.codeClientToUpdate = ""
        GlobalVariable.reserveConfCheckInState = "NON"
        GlobalVariable.reserveConfCheckOutState = 3
        GlobalVariable.magasinActuel = ""
        GlobalVariable.shiftActuel = -1
        GlobalVariable.MainCouranteJournaliereToUpdate = Nothing
        GlobalVariable.infoReservationPourEncodage = Nothing
        GlobalVariable.ReservationToUpdate = Nothing

        GlobalVariable.ReservationToUpdate = Nothing
        GlobalVariable.ClientToUpdate = Nothing
        GlobalVariable.MainCouranteGeneraleToUpdate = Nothing
        GlobalVariable.MainCouranteJournaliereToUpdate = Nothing
        GlobalVariable.ReglementToUpdate = Nothing

    End Sub

    '------------------------------------ REGLEMENTS ----------------------------------------------


    '----------------------------------- END REGLEMENT --------------------------------------------

    'SituationDuClient

    Public Shared Function SituationDuClient(ByVal CodeCLient As String) As Double

        'On selectionne l'ensemble des reglements du client payés ou pas
        Dim query As String = "SELECT CODE_FACTURE, DATE_FACTURE, LIBELLE_FACTURE, MONTANT_TTC FROM facture WHERE CODE_CLIENT = @CODE_CLIENT AND ETAT_FACTURE = 0 ORDER BY DATE_FACTURE DESC"
        Dim command As New MySqlCommand(query, GlobalVariable.connect)
        command.Parameters.Add("@CODE_CLIENT", MySqlDbType.VarChar).Value = CodeCLient

        Dim adapter As New MySqlDataAdapter(command)
        Dim tableFacture As New DataTable()

        adapter.Fill(tableFacture)

        'On selectionne l'ensemble des reglement du client
        Dim query1 As String = "SELECT REF_REGLEMENT, NUM_REGLEMENT,MONTANT_VERSE, DATE_REGLEMENT FROM reglement WHERE CODE_CLIENT = @CODE_CLIENT AND IMPRIMER = 0 ORDER BY DATE_REGLEMENT DESC"
        Dim command1 As New MySqlCommand(query1, GlobalVariable.connect)
        command1.Parameters.Add("@CODE_CLIENT", MySqlDbType.VarChar).Value = CodeCLient

        Dim adapter1 As New MySqlDataAdapter(command1)
        Dim tableReglement As New DataTable()

        adapter1.Fill(tableReglement)

        Dim tailleDuTableau As Integer = tableReglement.Rows.Count + tableFacture.Rows.Count

        Dim toutesLesFactures(tailleDuTableau) As SituationClient

        Dim niemElementDutableau As Integer = 0

        Dim totalFacture As Double = 0
        Dim totalReglement As Double = 0

        For i = 0 To tableReglement.Rows.Count - 1
            totalReglement = totalReglement + tableReglement.Rows(i)("MONTANT_VERSE")
        Next

        For i = 0 To tableFacture.Rows.Count - 1
            totalFacture = totalFacture + tableFacture.Rows(i)("MONTANT_TTC")
        Next

        Return totalReglement - totalFacture

    End Function

    'SituationDuClient

    Public Shared Function SituationDeReservation(ByVal CodeReservation As String) As Double

        'On selectionne l'ensemble des reglements du client payés ou pas
        Dim query As String = "SELECT CODE_FACTURE, DATE_FACTURE, LIBELLE_FACTURE, MONTANT_TTC FROM ligne_facture WHERE CODE_RESERVATION = @CODE_RESERVATION AND ETAT_FACTURE = 0 ORDER BY DATE_FACTURE DESC"
        Dim command As New MySqlCommand(query, GlobalVariable.connect)
        command.Parameters.Add("@CODE_RESERVATION", MySqlDbType.VarChar).Value = CodeReservation

        Dim adapter As New MySqlDataAdapter(command)
        Dim tableFacture As New DataTable()

        adapter.Fill(tableFacture)

        'On selectionne l'ensemble des reglement du client
        Dim query1 As String = "SELECT REF_REGLEMENT, NUM_REGLEMENT,MONTANT_VERSE, DATE_REGLEMENT FROM reglement WHERE CODE_RESERVATION = @CODE_RESERVATION AND IMPRIMER = 0 ORDER BY DATE_REGLEMENT DESC"
        Dim command1 As New MySqlCommand(query1, GlobalVariable.connect)
        command1.Parameters.Add("@CODE_RESERVATION", MySqlDbType.VarChar).Value = CodeReservation

        Dim adapter1 As New MySqlDataAdapter(command1)
        Dim tableReglement As New DataTable()

        adapter1.Fill(tableReglement)

        Dim tailleDuTableau As Integer = tableReglement.Rows.Count + tableFacture.Rows.Count

        Dim toutesLesFactures(tailleDuTableau) As SituationClient

        Dim niemElementDutableau As Integer = 0

        Dim totalFacture As Double = 0
        Dim totalReglement As Double = 0

        If tableReglement.Rows.Count > 0 Then

            For i = 0 To tableReglement.Rows.Count - 1

                totalReglement = totalReglement + tableReglement.Rows(i)("MONTANT_VERSE")

            Next

        End If

        If tableFacture.Rows.Count > 0 Then

            For i = 0 To tableFacture.Rows.Count - 1

                totalFacture = totalFacture + tableFacture.Rows(i)("MONTANT_TTC")

            Next

        End If

        Return totalReglement - totalFacture

    End Function

    '-------------------------------------------------------------GESTION DE L'IMPRESSION DE LA FACTURE ---------------------------------------------------

    'Code to generate a pdf for printing documents

    Public Shared Sub GenerationDeFicheDePoliceOldWayWorkingPerfectly(ByVal NumConfirmation As String, ByVal client As String, ByVal DateDebut As Date, ByVal DateFin As Date, ByVal NbreNuitee As Integer, ByVal hebergement As String, ByVal Codehebergement As String, ByVal tarif As Double, ByVal HeureEntree As DateTime, ByVal heureDepart As DateTime, ByVal TypeRea As String)

        If Not NumConfirmation = "num" Then

            'Dim dlg As New PrintDialog
            'dlg.ShowDialog()

            Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}
            sfd.FileName = "Fiche de Police de " & client & GlobalVariable.DateDeTravail.ToString("ddMMyyHms")

            Dim societe As DataTable = allTableFields("societe")
            Dim clientInformation As DataTable = getElementByCode(client, "client", "NOM_PRENOM")
            Dim Reservation As DataTable

            Reservation = getElementByCode(NumConfirmation, "reservation", "CODE_RESERVATION")

            If Not Reservation.Rows.Count > 0 Then
                Reservation = getElementByCode(NumConfirmation, "reserve_conf", "CODE_RESERVATION")
            End If

            If sfd.ShowDialog = 1 Then
                'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
                Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
                Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
                Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim font1 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
                Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim font2 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)

                Dim Libelle As String
                Dim LibelleJour As String
                Dim LibelleReservation As String
                Dim TitreDuDocument As String

                If GlobalVariable.typeChambreOuSalle = "salle" Then

                    Libelle = "Location de Salle"
                    LibelleJour = "Jour"
                    LibelleReservation = "CONTRAT DE RESERVATION N° : "
                    TitreDuDocument = "CONTRAT"

                Else

                    Libelle = "Hébergement"
                    LibelleJour = "nuitée"
                    LibelleReservation = "FICHE DE RESERVATION N° : "
                    TitreDuDocument = "FICHE DE POLICE"

                End If

                pdfWrite.PageEvent = New HeaderFooter

                pdfDoc.Open()

                Dim p1 As Paragraph = New Paragraph(Chr(13) & Chr(13) & Chr(13) & TitreDuDocument & Chr(13) & "Date:" & GlobalVariable.DateDeTravail & Chr(13) & Chr(13) & Chr(13), pColumn)
                p1.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p1)

                Dim intro As String = "Cher(e) Mr/Mme:" & client & ", Merci d'avoir choisi de séjourner avec nous a " & societe.Rows(0)("RAISON_SOCIALE") & ". Nous avons le plaisir de confirmer votre réservation comme suit : " & Chr(13) & Chr(13)

                'pdfDoc.Add(New Paragraph(intro, font1))

                Dim pdfTable3 As New PdfPTable(2) 'Number of columns

                pdfTable3.TotalWidth = 520.0F
                pdfTable3.LockedWidth = True
                pdfTable3.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfTable3.HeaderRows = 1

                Dim widths3 As Single() = New Single() {3.0F, 5.0F}
                pdfTable3.SetWidths(widths3)

                Dim pdfCell3 As PdfPCell = Nothing

                pdfCell3 = New PdfPCell(New Paragraph(LibelleReservation & Chr(13) & Chr(13) & "Nom (en gros caractère) : " & Chr(13) & "(Surname in block block capitals)" & Chr(13) & Chr(13) & "Nom de jeune fille : " & Chr(13) & "(Madein name if applicable)" & Chr(13) & Chr(13) & "Prénom : " & Chr(13) & "(Christian name)" & Chr(13) & Chr(13) & "Date de Naissance : " & Chr(13) & "(Date of birth)" & Chr(13) & Chr(13) & "Lieu de Naissance : " & Chr(13) & "(Place of birth)" & Chr(13) & Chr(13) & "Nationalité : " & Chr(13) & "(Nationality)" & Chr(13) & Chr(13) & "CNI/NIU : " & Chr(13) & "(ID Card)" & Chr(13) & Chr(13) & "Pays de résidence : " & Chr(13) & "(Country of permanance residence)" & Chr(13) & Chr(13) & "Téléphone : " & Chr(13) & "(Telephone)" & Chr(13) & Chr(13) & "Adresse : " & Chr(13) & "(Adress)" & Chr(13) & Chr(13) & "Profession : " & Chr(13) & "(Occupation)", font1))

                pdfCell3.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell3.MinimumHeight = 18
                pdfCell3.PaddingLeft = 15.0F
                pdfCell3.Border = 0
                pdfTable3.AddCell(pdfCell3)

                pdfCell3 = New PdfPCell(New Paragraph(NumConfirmation & Chr(13) & Chr(13) & clientInformation.Rows(0)("NOM_CLIENT") & Chr(13) & Chr(13) & Chr(13) & clientInformation.Rows(0)("NOM_JEUNE_FILLE") & Chr(13) & Chr(13) & Chr(13) & clientInformation.Rows(0)("PRENOMS") & Chr(13) & Chr(13) & Chr(13) & clientInformation.Rows(0)("DATE_DE_NAISSANCE") & Chr(13) & Chr(13) & Chr(13) & clientInformation.Rows(0)("LIEU_DE_NAISSANCE") & Chr(13) & Chr(13) & Chr(13) & clientInformation.Rows(0)("NATIONALITE") & Chr(13) & Chr(13) & Chr(13) & clientInformation.Rows(0)("CNI") & Chr(13) & Chr(13) & Chr(13) & clientInformation.Rows(0)("PAYS_RESIDENCE") & Chr(13) & Chr(13) & Chr(13) & clientInformation.Rows(0)("TELEPHONE") & Chr(13) & Chr(13) & Chr(13) & clientInformation.Rows(0)("ADRESSE") & Chr(13) & Chr(13) & Chr(13) & clientInformation.Rows(0)("PROFESSION"), pColumn))

                pdfCell3.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell3.MinimumHeight = 18
                pdfCell3.PaddingLeft = 5.0F
                pdfCell3.Border = 0
                pdfTable3.AddCell(pdfCell3)

                pdfDoc.Add(pdfTable3)

                Dim pdfTable4 As New PdfPTable(4) 'Number of columns

                pdfTable4.TotalWidth = 520.0F
                pdfTable4.LockedWidth = True
                pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfTable4.HeaderRows = 1

                Dim widths4 As Single() = New Single() {3.0F, 5.0F, 3.0F, 5.0F}
                pdfTable4.SetWidths(widths4)

                Dim pdfCell4 As PdfPCell = Nothing

                pdfCell4 = New PdfPCell(New Paragraph(" FAX: ", font1))
                pdfCell4.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell4.MinimumHeight = 18
                pdfCell4.PaddingLeft = 15.0F
                pdfCell4.Border = 0
                pdfTable4.AddCell(pdfCell4)

                pdfCell4 = New PdfPCell(New Paragraph(clientInformation.Rows(0)("FAX"), pColumn))
                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell4.MinimumHeight = 18
                pdfCell4.PaddingLeft = 5.0F
                pdfCell4.Border = 0
                pdfTable4.AddCell(pdfCell4)

                pdfCell4 = New PdfPCell(New Paragraph(" EMAIL: ", font1))
                pdfCell4.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell4.MinimumHeight = 18
                pdfCell4.PaddingLeft = 15.0F
                pdfCell4.Border = 0
                pdfTable4.AddCell(pdfCell4)

                pdfCell4 = New PdfPCell(New Paragraph(clientInformation.Rows(0)("EMAIL"), pColumn))
                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell4.MinimumHeight = 18
                pdfCell4.PaddingLeft = 5.0F
                pdfCell4.Border = 0
                pdfTable4.AddCell(pdfCell4)

                pdfDoc.Add(pdfTable4)


                Dim pdfTable5 As New PdfPTable(6) 'Number of columns

                pdfTable5.TotalWidth = 520.0F
                pdfTable5.LockedWidth = True
                pdfTable5.HorizontalAlignment = Element.ALIGN_RIGHT

                Dim widths5 As Single() = New Single() {6.0F, 5.0F, 4.0F, 4.0F, 3.0F, 1.0F}
                pdfTable5.SetWidths(widths5)

                Dim pdfCell5 As PdfPCell = Nothing

                pdfCell5 = New PdfPCell(New Paragraph(" Nombre de personne(s) : " & Chr(13) & "(Number of person)" & Chr(13) & Chr(13) & "Venant de : " & Chr(13) & "(Coming from)" & Chr(13) & Chr(13) & "Mode de Transport: " & Chr(13) & "(Transport Mode)", font1))
                pdfCell5.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell5.MinimumHeight = 18
                pdfCell5.PaddingLeft = 15.0F
                pdfCell5.Border = 0
                pdfTable5.AddCell(pdfCell5)

                'GENERATION DE LA FICHE DE POLICE APRES RAPPEL DE LA RESERVATION
                If Reservation.Rows.Count > 0 Then

                    pdfCell5 = New PdfPCell(New Paragraph(Reservation.Rows(0)("NB_PERSONNES") & Chr(13) & Chr(13) & Chr(13) & Reservation.Rows(0)("VENANT_DE") & Chr(13) & Chr(13) & Chr(13) & clientInformation.Rows(0)("MODE_TRANSPORT"), pColumn))
                    pdfCell5.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfCell5.MinimumHeight = 18
                    pdfCell5.PaddingLeft = 5.0F
                    pdfCell5.Border = 0
                    pdfTable5.AddCell(pdfCell5)

                    pdfCell5 = New PdfPCell(New Paragraph(" Adultes: " & Chr(13) & Chr(13) & Chr(13) & "Se rendant à : " & Chr(13) & "(Travelling to)" & Chr(13) & Chr(13) & "Véhicule N°: " & Chr(13) & "(Vehicule N°)", font1))
                    pdfCell5.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfCell5.MinimumHeight = 18
                    pdfCell5.PaddingLeft = 15.0F
                    pdfCell5.Border = 0
                    pdfTable5.AddCell(pdfCell5)

                    pdfCell5 = New PdfPCell(New Paragraph(Reservation.Rows(0)("ADULTES") & Chr(13) & Chr(13) & Chr(13) & Reservation.Rows(0)("SE_RENDANT_A") & Chr(13) & Chr(13) & Chr(13) & clientInformation.Rows(0)("NUM_VEHICULE") & Chr(13), pColumn))
                    pdfCell5.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell5.MinimumHeight = 18
                    pdfCell5.PaddingLeft = 5.0F
                    pdfCell5.Border = 0
                    pdfTable5.AddCell(pdfCell5)

                    pdfCell5 = New PdfPCell(New Paragraph(" Enfants: ", font1))
                    pdfCell5.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfCell5.MinimumHeight = 18
                    pdfCell5.PaddingLeft = 15.0F
                    pdfCell5.Border = 0
                    pdfTable5.AddCell(pdfCell5)

                    pdfCell5 = New PdfPCell(New Paragraph(Reservation.Rows(0)("ENFANTS"), pColumn))
                    pdfCell5.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell5.MinimumHeight = 18
                    pdfCell5.PaddingLeft = 5.0F
                    pdfCell5.Border = 0
                    pdfTable5.AddCell(pdfCell5)

                    pdfDoc.Add(pdfTable5)

                    Dim spaceParagraph = New Paragraph(Chr(13) & Chr(13))
                    pdfDoc.Add(spaceParagraph)
                    'To disaply information concerning the room 

                    Dim pdfTable As New PdfPTable(6) 'Number of columns

                    pdfTable.TotalWidth = 520.0F
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.HeaderRows = 1

                    Dim widths As Single() = New Single() {2.4F, 2.4F, 2.2F, 1.8F, 1.8F, 1.8F}
                    pdfTable.SetWidths(widths)

                    Dim pdfCell As PdfPCell = Nothing

                    pdfCell = New PdfPCell(New Paragraph("Date entrée" & Chr(13) & "(Entering Adate)", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 15.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("Date sortie" & Chr(13) & "(Check out date)", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    ''pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("Total nuitées" & Chr(13) & "(Number of nights)", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("Chambre N° " & Chr(13) & "(Room N°)", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("Prix Chambre" & Chr(13) & "(Room Cost)", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("Caution" & Chr(13) & "(Deposit)", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    '---------------------VALUES OF TABLE
                    pdfCell = New PdfPCell(New Paragraph(Reservation.Rows(0)("DATE_ENTTRE").ToString, font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Reservation.Rows(0)("DATE_SORTIE").ToString, font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Integer.Parse((Reservation.Rows(0)("DATE_SORTIE") - Reservation.Rows(0)("DATE_ENTTRE")).Days), font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Reservation.Rows(0)("CHAMBRE_ID").ToString, font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfTable.AddCell(pdfCell)

                    If Reservation.Rows(0)("AFFICHER_PRIX") = 1 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(Reservation.Rows(0)("MONTANT_ACCORDE"), "#,##0").ToString, font1))
                    ElseIf Reservation.Rows(0)("AFFICHER_PRIX") = 0 Then
                        pdfCell = New PdfPCell(New Paragraph("/", font1))
                    End If

                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(Reservation.Rows(0)("MONTANT_TOTAL_CAUTION"), "#,##0").ToString, font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.AddCell(pdfCell)

                    pdfDoc.Add(pdfTable)

                    Dim MONTANT_HT As Double = Integer.Parse((Reservation.Rows(0)("DATE_SORTIE") - Reservation.Rows(0)("DATE_ENTTRE")).Days) * Double.Parse(Reservation.Rows(0)("MONTANT_ACCORDE"))

                    Dim pdfTable2 As New PdfPTable(2) 'Number of columns

                    pdfTable2.TotalWidth = 520.0F
                    pdfTable2.LockedWidth = True
                    pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                    'pdfTable2.HeaderRows = 1

                    Dim widths2 As Single() = New Single() {2.5F, 2.5F}
                    pdfTable2.SetWidths(widths2)

                    Dim pdfCell2 As PdfPCell = Nothing

                    pdfCell2 = New PdfPCell(New Paragraph("Total: ", fontTotal))
                    pdfCell2.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell2.MinimumHeight = 18
                    pdfCell2.PaddingLeft = 15.0F
                    pdfCell2.Border = 0
                    pdfTable2.AddCell(pdfCell2)

                    pdfCell2 = New PdfPCell(New Paragraph(Format(MONTANT_HT, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), fontTotal))
                    pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell2.MinimumHeight = 18
                    pdfCell2.PaddingLeft = 5.0F
                    pdfCell2.Border = 0

                    'ON AFFICHE LE PRIX QUE SI AFFICHER PRIX EST COCHE
                    If CInt(Reservation.Rows(0)("AFFICHER_PRIX")) = 1 Then
                        pdfTable2.AddCell(pdfCell2)
                    End If

                    pdfDoc.Close()

                    MessageBox.Show("PDF has been exported" & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                    Process.Start(sfd.FileName)

                Else

                    MessageBox.Show("Bien vouloir enregistrer la réservation", "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                End If

                'pdfDoc.Add(pdfTable2)
                ' -----------------------------------------------------------------------------------------------------
                'Dim p2 As Paragraph = New Paragraph("SIGNATURE DU CLIENT                                                    SIGNATURE DE L'HOTEL")
                'p2.Alignment = Element.ALIGN_CENTER

                'pdfDoc.Add(p2)



            End If

        End If

    End Sub

    Public Shared Sub GenerationDeFicheDePolice(ByVal NumConfirmation As String, ByVal client As String, ByVal DateDebut As Date, ByVal DateFin As Date, ByVal NbreNuitee As Integer, ByVal hebergement As String, ByVal Codehebergement As String, ByVal tarif As Double, ByVal HeureEntree As DateTime, ByVal heureDepart As DateTime, ByVal TypeRea As String)

        If Not NumConfirmation = "num" Then

            'Dim dlg As New PrintDialog
            'dlg.ShowDialog()

            Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}
            sfd.FileName = "Fiche de Police de " & client & Now().ToString("ddMMyyHms")

            Dim societe As DataTable = allTableFields("societe")
            Dim clientInformation As DataTable = getElementByCode(client, "client", "NOM_PRENOM")
            Dim Reservation As DataTable

            Reservation = getElementByCode(NumConfirmation, "reservation", "CODE_RESERVATION")

            If Not Reservation.Rows.Count > 0 Then
                Reservation = getElementByCode(NumConfirmation, "reserve_conf", "CODE_RESERVATION")
            End If

            If sfd.ShowDialog = 1 Then
                'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
                Dim pdfDoc As New Document(PageSize.A4, 20, 20, 80, 40)
                Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
                Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim pColumnEnlish As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.ITALIC, BaseColor.BLUE)
                Dim font1 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
                Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim font2 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 11, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim fontPolicyFrenchTitle As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim fontPolicyFrenchText As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
                Dim fontPolicyEnglishText As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.ITALIC, BaseColor.BLUE)
                Dim fontPolicyEnglishTextChunk As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.ITALIC, BaseColor.BLUE)

                Dim Libelle As String
                Dim LibelleJour As String
                Dim LibelleReservation As String
                Dim TitreDuDocument As String

                If GlobalVariable.typeChambreOuSalle = "salle" Then

                    Libelle = "Location de Salle"
                    LibelleJour = "Jour"
                    LibelleReservation = "CONTRAT DE RESERVATION N°: "
                    TitreDuDocument = "CONTRAT"

                Else

                    Libelle = "Hébergement"
                    LibelleJour = "nuitée"
                    LibelleReservation = "FICHE DE RESERVATION N°: "
                    TitreDuDocument = "FICHE DE POLICE / HOTEL REGISTRATION FORM"

                End If

                pdfWrite.PageEvent = New HeaderFooter

                pdfDoc.Open()

                Dim p1 As Paragraph = New Paragraph(Chr(13) & TitreDuDocument & Chr(13) & Chr(13), pColumn)
                p1.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p1)

                Dim intro As String = "Cher(e) Mr/Mme:" & client & ", Merci d'avoir choisi de séjourner avec nous a " & societe.Rows(0)("RAISON_SOCIALE") & ". Nous avons le plaisir de confirmer votre réservation comme suit : " & Chr(13) & Chr(13)

                'pdfDoc.Add(New Paragraph(intro, font1))e

                '---------------------------------------------------------------------------------------------------------------------------------------------

                Dim pdfTable3 As New PdfPTable(6) 'Number of columns

                pdfTable3.TotalWidth = 550.0F
                pdfTable3.LockedWidth = True
                pdfTable3.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfTable3.HeaderRows = 1

                '-------------------------------

                Dim frenchPhrase = New Paragraph("RENSEIGNEMENTS PERSONNELS / ", pColumn)
                Dim englishPhrase = New Paragraph("PERSONAL INFORMATION" & Chr(13) & " ", pColumnEnlish)


                Dim pdfTable31 As New PdfPTable(2)
                pdfTable31.LockedWidth = True
                Dim pdfCell31 As PdfPCell = Nothing
                Dim widths31 As Single() = New Single() {20.0F, 20.0F}
                pdfTable31.SetWidths(widths31)

                pdfCell31 = New PdfPCell(frenchPhrase)

                pdfCell31.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell31.Border = 0
                pdfTable31.AddCell(pdfCell31)

                pdfCell31 = New PdfPCell(frenchPhrase)

                pdfCell31.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell31.Border = 0
                pdfTable31.AddCell(pdfCell31)
                '-------------------------------
                Dim widths3 As Single() = New Single() {20.0F, 30.0F, 20.0F, 23.0F, 22.0F, 22.0F}
                pdfTable3.SetWidths(widths3)

                Dim pdfCell3 As PdfPCell = Nothing
                pdfCell3 = New PdfPCell(New Paragraph("RENSEIGNEMENTS PERSONNELS / PERSONAL INFORMATION" & Chr(13) & " ", pColumn))

                'pdfCell3 = New PdfPCell(New Paragraph(LibelleReservation & Chr(13) & Chr(13) & "Nom (en gros caractère) : " & Chr(13) & "(Surname in block block capitals)" & Chr(13) & Chr(13) & "Nom de jeune fille : " & Chr(13) & "(Madein name if applicable)" & Chr(13) & Chr(13) & "Prénom : " & Chr(13) & "(Christian name)" & Chr(13) & Chr(13) & "Date de Naissance : " & Chr(13) & "(Date of birth)" & Chr(13) & Chr(13) & "Lieu de Naissance : " & Chr(13) & "(Place of birth)" & Chr(13) & Chr(13) & "Nationalité : " & Chr(13) & "(Nationality)" & Chr(13) & Chr(13) & "CNI/NIU : " & Chr(13) & "(ID Card)" & Chr(13) & Chr(13) & "Pays de résidence : " & Chr(13) & "(Country of permanance residence)" & Chr(13) & Chr(13) & "Téléphone : " & Chr(13) & "(Telephone)" & Chr(13) & Chr(13) & "Adresse : " & Chr(13) & "(Adress)" & Chr(13) & Chr(13) & "Profession : " & Chr(13) & "(Occupation)", font1))

                pdfCell3.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell3.Colspan = 6
                pdfCell3.Border = 0
                pdfTable3.AddCell(pdfCell3)

                'pdfCell3 = New PdfPCell(New Paragraph(NumConfirmation & Chr(13) & Chr(13) & clientInformation.Rows(0)("NOM_CLIENT") & Chr(13) & Chr(13) & Chr(13) & clientInformation.Rows(0)("NOM_JEUNE_FILLE") & Chr(13) & Chr(13) & Chr(13) & clientInformation.Rows(0)("PRENOMS") & Chr(13) & Chr(13) & Chr(13) & clientInformation.Rows(0)("DATE_DE_NAISSANCE") & Chr(13) & Chr(13) & Chr(13) & clientInformation.Rows(0)("LIEU_DE_NAISSANCE") & Chr(13) & Chr(13) & Chr(13) & clientInformation.Rows(0)("NATIONALITE") & Chr(13) & Chr(13) & Chr(13) & clientInformation.Rows(0)("CNI") & Chr(13) & Chr(13) & Chr(13) & clientInformation.Rows(0)("PAYS_RESIDENCE") & Chr(13) & Chr(13) & Chr(13) & clientInformation.Rows(0)("TELEPHONE") & Chr(13) & Chr(13) & Chr(13) & clientInformation.Rows(0)("ADRESSE") & Chr(13) & Chr(13) & Chr(13) & clientInformation.Rows(0)("PROFESSION"), pColumn))

                pdfCell3 = New PdfPCell(New Paragraph("Nom / " & Chr(13) & "Name : ", font1))
                pdfTable3.AddCell(pdfCell3)
                pdfCell3 = New PdfPCell(New Paragraph(clientInformation.Rows(0)("NOM_CLIENT"), fontTotal))
                pdfCell31.HorizontalAlignment = Element.ALIGN_MIDDLE
                pdfTable3.AddCell(pdfCell3)

                pdfCell3 = New PdfPCell(New Paragraph("Prénom / " & Chr(13) & "First name : ", font1))
                pdfTable3.AddCell(pdfCell3)
                pdfCell3 = New PdfPCell(New Paragraph(clientInformation.Rows(0)("PRENOMS"), fontTotal))
                pdfCell31.HorizontalAlignment = Element.ALIGN_MIDDLE
                pdfTable3.AddCell(pdfCell3)

                pdfCell3 = New PdfPCell(New Paragraph("Nom de jeune fille / " & Chr(13) & "Modern name : ", font1))
                pdfTable3.AddCell(pdfCell3)
                pdfCell3 = New PdfPCell(New Paragraph(clientInformation.Rows(0)("NOM_JEUNE_FILLE"), fontTotal))
                pdfCell31.HorizontalAlignment = Element.ALIGN_MIDDLE
                pdfTable3.AddCell(pdfCell3)

                pdfCell3 = New PdfPCell(New Paragraph("Date de naissance / " & Chr(13) & "Date of birth : ", font1))
                pdfTable3.AddCell(pdfCell3)
                pdfCell3 = New PdfPCell(New Paragraph(clientInformation.Rows(0)("DATE_DE_NAISSANCE"), fontTotal))
                pdfCell31.HorizontalAlignment = Element.ALIGN_MIDDLE
                pdfTable3.AddCell(pdfCell3)

                pdfCell3 = New PdfPCell(New Paragraph("Lieu de naissance / " & Chr(13) & "Place of birth : ", font1))
                pdfTable3.AddCell(pdfCell3)
                pdfCell3 = New PdfPCell(New Paragraph(clientInformation.Rows(0)("LIEU_DE_NAISSANCE"), fontTotal))
                pdfCell31.HorizontalAlignment = Element.ALIGN_MIDDLE
                pdfTable3.AddCell(pdfCell3)

                pdfCell3 = New PdfPCell(New Paragraph("Nationalité / " & Chr(13) & "Nationality : ", font1))
                pdfTable3.AddCell(pdfCell3)
                pdfCell3 = New PdfPCell(New Paragraph(clientInformation.Rows(0)("NATIONALITE"), fontTotal))
                pdfCell31.HorizontalAlignment = Element.ALIGN_MIDDLE
                pdfTable3.AddCell(pdfCell3)

                pdfCell3 = New PdfPCell(New Paragraph("Télephone / " & Chr(13) & "Phone : ", font1))
                pdfTable3.AddCell(pdfCell3)
                pdfCell3 = New PdfPCell(New Paragraph(clientInformation.Rows(0)("TELEPHONE"), fontTotal))
                pdfCell31.HorizontalAlignment = Element.ALIGN_MIDDLE
                pdfTable3.AddCell(pdfCell3)

                pdfCell3 = New PdfPCell(New Paragraph("Whatsapp / " & Chr(13) & "", font1))
                pdfTable3.AddCell(pdfCell3)
                pdfCell3 = New PdfPCell(New Paragraph("", font1))
                pdfTable3.AddCell(pdfCell3)

                pdfCell3 = New PdfPCell(New Paragraph("CNI / Passport / " & Chr(13) & "ID Card / Passport : ", font1))
                pdfCell31.HorizontalAlignment = Element.ALIGN_MIDDLE
                pdfTable3.AddCell(pdfCell3)
                pdfCell3 = New PdfPCell(New Paragraph(clientInformation.Rows(0)("CNI"), fontTotal))
                pdfCell31.HorizontalAlignment = Element.ALIGN_MIDDLE
                pdfTable3.AddCell(pdfCell3)

                pdfCell3 = New PdfPCell(New Paragraph("Adresse mail / " & Chr(13) & "E-mail addresse", font1))
                pdfTable3.AddCell(pdfCell3)
                pdfCell3 = New PdfPCell(New Paragraph(clientInformation.Rows(0)("EMAIL"), fontTotal))
                pdfCell31.HorizontalAlignment = Element.ALIGN_MIDDLE
                pdfTable3.AddCell(pdfCell3)

                'pdfCell3 = New PdfPCell(New Paragraph("Véhicule M / " & Chr(13) & "Car brand :", font1))
                'pdfTable3.AddCell(pdfCell3)
                'pdfCell3 = New PdfPCell(New Paragraph("", fontTotal))
                'pdfCell31.HorizontalAlignment = Element.ALIGN_MIDDLE
                'pdfTable3.AddCell(pdfCell3)

                pdfCell3 = New PdfPCell(New Paragraph("Num Véhicule / " & Chr(13) & "Car reg. : ", font1))
                pdfTable3.AddCell(pdfCell3)
                pdfCell3 = New PdfPCell(New Paragraph(clientInformation.Rows(0)("NUM_VEHICULE"), fontTotal))
                pdfCell31.HorizontalAlignment = Element.ALIGN_MIDDLE
                pdfTable3.AddCell(pdfCell3)

                pdfCell3 = New PdfPCell(New Paragraph("Couleur / " & Chr(13) & "Color", font1))
                pdfTable3.AddCell(pdfCell3)
                pdfCell3 = New PdfPCell(New Paragraph("", fontTotal))
                pdfCell31.HorizontalAlignment = Element.ALIGN_MIDDLE
                pdfTable3.AddCell(pdfCell3)

                pdfCell3 = New PdfPCell(New Paragraph("Venant de / " & Chr(13) & "Coming from :", font1))
                pdfTable3.AddCell(pdfCell3)
                pdfCell3 = New PdfPCell(New Paragraph(Reservation.Rows(0)("VENANT_DE"), fontTotal))
                pdfCell31.HorizontalAlignment = Element.ALIGN_MIDDLE
                pdfTable3.AddCell(pdfCell3)

                pdfCell3 = New PdfPCell(New Paragraph("Se rendant à / " & Chr(13) & "Going to : ", font1))
                pdfTable3.AddCell(pdfCell3)
                pdfCell3 = New PdfPCell(New Paragraph(Reservation.Rows(0)("SE_RENDANT_A"), fontTotal))
                pdfCell31.HorizontalAlignment = Element.ALIGN_MIDDLE
                pdfTable3.AddCell(pdfCell3)

                pdfCell3 = New PdfPCell(New Paragraph("Nbre de Pax / " & Chr(13) & "Number of guest", font1))
                pdfTable3.AddCell(pdfCell3)
                pdfCell3 = New PdfPCell(New Paragraph(Reservation.Rows(0)("NB_PERSONNES").ToString, fontTotal))
                pdfCell31.HorizontalAlignment = Element.ALIGN_MIDDLE
                pdfTable3.AddCell(pdfCell3)

                pdfDoc.Add(pdfTable3)

                Dim pdfTable03 As New PdfPTable(6) 'Number of columns

                pdfTable03.TotalWidth = 550.0F
                pdfTable03.LockedWidth = True
                pdfTable03.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfTable03.HeaderRows = 1

                Dim widths03 As Single() = New Single() {20.0F, 30.0F, 18.0F, 25.0F, 22.0F, 22.0F}
                pdfTable03.SetWidths(widths03)

                Dim pdfCell03 As PdfPCell = Nothing
                pdfCell03 = New PdfPCell(New Paragraph(Chr(13) & "INFORMATIONS DE RESERVATION / BOOKING INFORMATION" & Chr(13) & " ", pColumn))

                pdfCell03.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell03.Colspan = 6
                pdfCell03.Border = 0
                pdfTable03.AddCell(pdfCell03)

                Dim MONTANT_TAXE_DE_SEJOUR As Double = 0

                Dim taxe_sejour As DataTable = Functions.getElementByCode(Reservation.Rows(0)("CODE_RESERVATION"), "taxe_sejour_collectee", "NUM_RESERVATION")

                If taxe_sejour.Rows.Count > 0 Then
                    MONTANT_TAXE_DE_SEJOUR = taxe_sejour.Rows(0)("TAXE_SEJOUR_COLLECTEE")
                End If

                pdfCell03 = New PdfPCell(New Paragraph("N° de réservation / " & Chr(13) & "booking number : ", font1))
                pdfTable03.AddCell(pdfCell03)
                pdfCell03 = New PdfPCell(New Paragraph(Reservation.Rows(0)("CODE_RESERVATION"), fontTotal))
                pdfCell03.Colspan = 5
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("Date d'arrivée / " & Chr(13) & "Arrival date : ", font1))
                pdfTable03.AddCell(pdfCell03)
                pdfCell03 = New PdfPCell(New Paragraph(CDate(Reservation.Rows(0)("DATE_ENTTRE")).ToShortDateString & " " & CDate(Reservation.Rows(0)("HEURE_ENTREE")).ToShortTimeString, fontTotal))
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("Date de départ / " & Chr(13) & "Departure date: : ", font1))
                pdfTable03.AddCell(pdfCell03)
                pdfCell03 = New PdfPCell(New Paragraph(CDate(Reservation.Rows(0)("DATE_SORTIE")).ToShortDateString & " " & CDate(Reservation.Rows(0)("HEURE_SORTIE")).ToShortTimeString, fontTotal))
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("Nb nuit(s) / " & Chr(13) & "Nb of night(s) : ", font1))
                pdfTable03.AddCell(pdfCell03)
                pdfCell03 = New PdfPCell(New Paragraph(Integer.Parse((Reservation.Rows(0)("DATE_SORTIE") - Reservation.Rows(0)("DATE_ENTTRE")).Days), fontTotal))
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("Type de chambre /" & Chr(13) & "Room type : ", font1))
                pdfTable03.AddCell(pdfCell03)

                Dim nomTypeDeChambre As String = ""

                Dim infoRoomType As DataTable = Functions.getElementByCode(Reservation.Rows(0)("TYPE_CHAMBRE"), "type_chambre", "CODE_TYPE_CHAMBRE")

                If infoRoomType.Rows.Count > 0 Then
                    nomTypeDeChambre = infoRoomType.Rows(0)("LIBELLE_TYPE_CHAMBRE")
                Else
                    nomTypeDeChambre = Reservation.Rows(0)("TYPE_CHAMBRE")
                End If

                pdfCell03 = New PdfPCell(New Paragraph(nomTypeDeChambre, fontTotal))
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("N° de chambre / " & Chr(13) & "Room number : ", font1))
                pdfTable03.AddCell(pdfCell03)
                pdfCell03 = New PdfPCell(New Paragraph(Reservation.Rows(0)("CHAMBRE_ID").ToString, fontTotal))
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("Tarif de chambre / " & Chr(13) & "Room rate : ", font1))
                pdfTable03.AddCell(pdfCell03)

                If Reservation.Rows(0)("AFFICHER_PRIX") = 1 Then
                    pdfCell03 = New PdfPCell(New Paragraph(Format(Reservation.Rows(0)("MONTANT_ACCORDE") + MONTANT_TAXE_DE_SEJOUR, "#,##0").ToString & " " & societe.Rows(0)("CODE_MONNAIE"), fontTotal))
                ElseIf Reservation.Rows(0)("AFFICHER_PRIX") = 0 Then
                    pdfCell03 = New PdfPCell(New Paragraph("/", fontTotal))
                End If
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph(Chr(13) & "REGLEMENT INTERIEUR ET CONDITIONS / TERMS AND CONDITIONS" & Chr(13) & " ", pColumn))
                pdfCell03.Border = 0
                pdfCell03.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell03.Colspan = 6
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("Article 1 : Accueil / Check-in", fontPolicyFrenchTitle))
                pdfCell03.HorizontalAlignment = HorizontalAlignment.Left
                pdfCell03.Border = 0
                pdfCell03.Colspan = 6
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("L’Hotel se réserve le droit de ne pas recevoir ou annuler le séjour des clients dont la tenue est indécente et négligée ainsi que, les clients dont le comportement est contraire aux bonnes mœurs et à l’ordre public. Toute personne désireuse de loger à l’hôtel est tenue de faire connaître son identité et celle des personnes qui l’accompagnent.", fontPolicyFrenchText))
                pdfCell03.Border = 0
                pdfCell03.Colspan = 6
                pdfCell03.HorizontalAlignment = Element.ALIGN_JUSTIFIED
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("The Hotel reserves the right not to accept or cancel the stay of customers whose dress is indecent and negligent as well as guests whose behavior is contrary to morality and public order. Anyone wishing to stay at the hotel is required to make known their identity and that of their visitors", fontPolicyEnglishText))
                pdfCell03.Border = 0
                pdfCell03.HorizontalAlignment = Element.ALIGN_JUSTIFIED
                pdfCell03.Colspan = 6
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("Article 2 : Heure de départ / Departure time", fontPolicyFrenchTitle))
                pdfCell03.Border = 0
                pdfCell03.Colspan = 6
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("La chambre doit être libérées avant 12h (midi) le jour de départ. Les départs tardifs, jusqu'à 14h, pourraient être autorisés selon la disponibilité. Les départs tardifs, jusqu'à 16h, pourraient être autorisés, le jour même, selon la disponibilité et moyennant des frais de 50% du tarif de la nuitée, plus taxes applicables. Tout départ tardif (après 16h) entraînera des frais équivalent à une nuit au tarif affiché, plus taxes applicables.", fontPolicyFrenchText))
                pdfCell03.Border = 0
                pdfCell03.Colspan = 6
                pdfCell03.HorizontalAlignment = Element.ALIGN_JUSTIFIED
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("Rooms must be vacated before 12 noon on the day of departure. Late check-outs, up to 2 p.m., may be permitted depending on availability. Late departures, until 4 p.m., may be authorized the same day, depending on availability and for a fee of 50% of the overnight rate, plus applicable taxes. Any late departure (after 4 p.m.) will incur a charge equivalent to one night at the displayed rate, plus applicable taxes.", fontPolicyEnglishText))
                pdfCell03.HorizontalAlignment = Element.ALIGN_JUSTIFIED
                pdfCell03.Border = 0
                pdfCell03.Colspan = 6
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("Article 3 : Gestion des cartes clefs / Keycard management", fontPolicyFrenchTitle))
                pdfCell03.Border = 0
                pdfCell03.Colspan = 6
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("La clef de la chambre doit être restituée le jour du départ. En cas de perte ou de non restitution, l’hôtel se réserve le droit de vous facturer le montant de 5 000 FCFA.", fontPolicyFrenchText))
                pdfCell03.HorizontalAlignment = Element.ALIGN_JUSTIFIED
                pdfCell03.Border = 0
                pdfCell03.Colspan = 6
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("The room keycard must be returned upon departure. In the event of loss or non-return, the hotel reserves the right to charge you the amount of 5,000 FCFA.", fontPolicyEnglishText))
                pdfCell03.HorizontalAlignment = Element.ALIGN_JUSTIFIED
                pdfCell03.Border = 0
                pdfCell03.Colspan = 6
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("Article 4 : Nuisances et respect des autres clients / Nuisances and respect for other customers", fontPolicyFrenchTitle))
                pdfCell03.Border = 0
                pdfCell03.Colspan = 6
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("Pour le respect et le repos des autres clients, veillez à ne pas claquer les portes ni à faire trop de bruit, particulièrement entre 22h00 et 8h00. Tout bruit de voisinage lié au comportement d’une personne sous sa responsabilité, pourra amener l’hôtelier à inviter le client à quitter l’établissement.", fontPolicyFrenchText))
                pdfCell03.HorizontalAlignment = Element.ALIGN_JUSTIFIED
                pdfCell03.Border = 0
                pdfCell03.Colspan = 6
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("For the respect of the peaceful rest of other customers, be careful not to slam the doors or make too much noise, especially between 10:00 p.m. and 8:00 a.m. Any neighborhood noise related to the behavior of the guest or any of his visitor, may lead to eviction.", fontPolicyEnglishText))
                pdfCell03.HorizontalAlignment = Element.ALIGN_JUSTIFIED
                pdfCell03.Border = 0
                pdfCell03.Colspan = 6
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("Article 5 : Parking / Use of car park", fontPolicyFrenchTitle))
                pdfCell03.Border = 0
                pdfCell03.Colspan = 6
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("Un parking privé en extérieur est proposé à nos clients. Nous déclinons toute responsabilité en cas de perte/vol/dégradation dans l'enceinte du parking.", fontPolicyFrenchText))
                pdfCell03.HorizontalAlignment = Element.ALIGN_JUSTIFIED
                pdfCell03.Border = 0
                pdfCell03.Colspan = 6
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("A private outdoor parking is available to our customers. We decline all responsibility in the event of loss/theft/damage within the car park.", fontPolicyEnglishText))
                pdfCell03.HorizontalAlignment = Element.ALIGN_JUSTIFIED
                pdfCell03.Border = 0
                pdfCell03.Colspan = 6
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("Article 6 : Acceptation du règlement et conditions générales de vente / Acceptance of terms and conditions", fontPolicyFrenchTitle))
                pdfCell03.Border = 0
                pdfCell03.Colspan = 6
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("Le règlement intérieur de l’hôtel s’applique à l’ensemble des réservations. Tout séjour entraîne l’acceptation des conditions particulières et du règlement intérieur de l’hôtel. Le non-respect des dispositions ci-dessus entraîne la résiliation immédiate du contrat.", fontPolicyFrenchText))
                pdfCell03.HorizontalAlignment = Element.ALIGN_JUSTIFIED
                pdfCell03.Border = 0
                pdfCell03.Colspan = 6
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("These rules are applicable to all reservations. Any stay entails acceptance of the the above motioned conditions and internal rules of the hotel. Failure to comply with the above provisions will result in the immediate termination of the contract.", fontPolicyEnglishText))
                pdfCell03.HorizontalAlignment = Element.ALIGN_JUSTIFIED
                pdfCell03.Border = 0
                pdfCell03.Colspan = 6
                pdfTable03.AddCell(pdfCell03)

                '---------------------------------------------------------- signature-------------------------+++++++++++--------------------------------------


                pdfCell03 = New PdfPCell(New Paragraph(Chr(13) & "Signature du client /", pColumn))
                pdfCell03.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell03.Border = 0
                pdfCell03.Colspan = 2
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph(Chr(13) & "Date / " & GlobalVariable.DateDeTravail.ToShortDateString, pColumn))
                pdfCell03.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell03.Border = 0
                pdfCell03.Colspan = 2
                pdfTable03.AddCell(pdfCell03)


                Dim CODE_RESERVATION As String = Reservation.Rows(0)("CODE_RESERVATION")
                Dim CHECKIN_PAR As String = ""

                Dim infoSuiviReservation As DataTable = Functions.getElementByCode(CODE_RESERVATION, "suivi_des_reservations", "CODE_RESERVATION")

                If infoSuiviReservation.Rows.Count > 0 Then

                    CHECKIN_PAR = infoSuiviReservation.Rows(0)("CHECKIN_PAR")

                    Dim infoUser As DataTable = Functions.getElementByCode(CHECKIN_PAR, "utilisateurs", "GRIFFE_UTILISATEUR")

                    If infoUser.Rows.Count > 0 Then
                        CHECKIN_PAR = infoUser.Rows(0)("NOM_UTILISATEUR")
                    End If

                Else
                    CHECKIN_PAR = GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR")
                End If

                pdfCell03 = New PdfPCell(New Paragraph(Chr(13) & "Enregistré par / ", pColumn))
                pdfCell03.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell03.Border = 0
                pdfCell03.Colspan = 2
                pdfTable03.AddCell(pdfCell03)


                pdfCell03 = New PdfPCell(New Paragraph("Guest signature : ", fontPolicyEnglishText))
                pdfCell03.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell03.Border = 0
                pdfCell03.Colspan = 2
                pdfTable03.AddCell(pdfCell03)


                pdfCell03 = New PdfPCell(New Paragraph("Date :  ", fontPolicyEnglishText))
                pdfCell03.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell03.Border = 0
                pdfCell03.Colspan = 2
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("Checked in by /", fontPolicyEnglishText))
                pdfCell03.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell03.Border = 0
                pdfCell03.Colspan = 2
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("", pColumn))
                pdfCell03.HorizontalAlignment = Element.ALIGN_JUSTIFIED
                pdfCell03.Border = 0
                pdfCell03.Colspan = 2
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("", pColumn))
                pdfCell03.HorizontalAlignment = Element.ALIGN_JUSTIFIED
                pdfCell03.Border = 0
                pdfCell03.Colspan = 2
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph(CHECKIN_PAR, fontTotal))
                'pdfCell03 = New PdfPCell(New Paragraph("", fontTotal))
                pdfCell03.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell03.Border = 0
                pdfCell03.Colspan = 2
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph(Chr(13) & Chr(13) & "NOUS VOUS SOUHAITONS UN AGRÉABLE SÉJOUR", pColumn))
                pdfCell03.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell03.Border = 0
                pdfCell03.Colspan = 6
                pdfTable03.AddCell(pdfCell03)

                pdfCell03 = New PdfPCell(New Paragraph("WE WISH YOU A PLEASANT STAY", pColumnEnlish))
                pdfCell03.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell03.Border = 0
                pdfCell03.Colspan = 6
                pdfTable03.AddCell(pdfCell03)

                pdfDoc.Add(pdfTable03)

                'GENERATION DE LA FICHE DE POLICE APRES RAPPEL DE LA RESERVATION
                If Reservation.Rows.Count > 0 Then

                    pdfDoc.Close()

                    MessageBox.Show("PDF has been exported" & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                    Process.Start(sfd.FileName)

                Else

                    MessageBox.Show("Bien vouloir enregistrer la réservation", "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                End If
                'pdfDoc.Add(pdfTable2)
                ' -----------------------------------------------------------------------------------------------------
                'Dim p2 As Paragraph = New Paragraph("SIGNATURE DU CLIENT                                                    SIGNATURE DE L'HOTEL")
                'p2.Alignment = Element.ALIGN_CENTER

                'pdfDoc.Add(p2)



            End If

        End If

    End Sub

    Public Shared Sub GenerationDeConfirmationReservationOldPerfect(ByVal NumConfirmation As String, ByVal client As String, ByVal DateDebut As Date, ByVal DateFin As Date, ByVal NbreNuitee As Integer, ByVal hebergement As String, ByVal Codehebergement As String, ByVal tarif As Double, ByVal HeureEntree As DateTime, ByVal heureDepart As DateTime, ByVal TypeRea As String)

        If True Then

            Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}
            sfd.FileName = "CONFIRMATION RESERVATION DE " & client & Now().ToString("ddMMyyHms")

            Dim societe As DataTable = Functions.allTableFields("societe")

            Dim CODE_MONNAIE As String = ""

            If societe.Rows.Count > 0 Then
                CODE_MONNAIE = societe.Rows(0)("CODE_MONNAIE")
            End If

            If sfd.ShowDialog = 1 Then
                'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
                Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
                Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
                Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim font1 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
                Dim font2 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)

                Dim Libelle As String
                Dim LibelleJour As String

                If GlobalVariable.typeChambreOuSalle = "salle" Then
                    Libelle = "Salle"
                    LibelleJour = "Jour"
                Else
                    Libelle = "Hébergement"
                    LibelleJour = "nuitée"
                End If

                pdfWrite.PageEvent = New HeaderFooter
                'pdfWrite.PageEvent = New HeaderFooter

                pdfDoc.Open()

                Dim infoSupResa As DataTable = getElementByCode(NumConfirmation, "reservation", "CODE_RESERVATION")

                If Not infoSupResa.Rows.Count > 0 Then
                    infoSupResa = getElementByCode(NumConfirmation, "reserve_conf", "CODE_RESERVATION")
                End If

                Dim DEPOT_DE_GARANTIE As Double = 0
                Dim CAUTION As Double = 0

                If infoSupResa.Rows.Count > 0 Then
                    DEPOT_DE_GARANTIE = infoSupResa.Rows(0)("DEPOT_DE_GARANTIE")
                    CAUTION = infoSupResa.Rows(0)("MONTANT_TOTAL_CAUTION")
                End If

                Dim p1 As Paragraph = New Paragraph(Chr(13) & Chr(13) & "CONFIRMATION DE RESERVATION" & Chr(13) & "Date:" & Now() & Chr(13) & Chr(13))
                p1.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p1)

                Dim intro As String = ""

                If GlobalVariable.typeChambreOuSalle = "salle" Then
                    intro = "Cher(e) Mr/Mme:" & client & ", Merci d'avoir choisi d'organiser votre évènement chez nous ( " & societe.Rows(0)("RAISON_SOCIALE") & "). Nous avons le plaisir de confirmer votre réservation comme suit : " & Chr(13) & Chr(13)
                Else
                    intro = "Cher(e) Mr/Mme:" & client & ", Merci d'avoir choisi de séjourner au sein de :  " & societe.Rows(0)("RAISON_SOCIALE") & ". Nous avons le plaisir de confirmer votre réservation comme suit : " & Chr(13) & Chr(13)
                End If

                pdfDoc.Add(New Paragraph(intro, font1))

                Dim MONTANT_TAXE_DE_SEJOUR As Double = 0

                Dim taxe_sejour As DataTable = Functions.getElementByCode(NumConfirmation, "taxe_sejour_collectee", "NUM_RESERVATION")

                If taxe_sejour.Rows.Count > 0 Then
                    MONTANT_TAXE_DE_SEJOUR = taxe_sejour.Rows(0)("TAXE_SEJOUR_COLLECTEE")
                End If

                Dim MONTANT_HT As Double = Integer.Parse(NbreNuitee) * (Double.Parse(tarif) + MONTANT_TAXE_DE_SEJOUR)

                Dim termes As String = ""

                If GlobalVariable.typeChambreOuSalle = "salle" Then
                    termes = "• Numéro de confirmation : " & NumConfirmation & Chr(13) & "• Nom du client : " & client & Chr(13) & "• Date d’arrivée : " & DateDebut & Chr(13) & "• Date de départ : " & DateFin & Chr(13) & "• Nombre de " & LibelleJour & " :" & NbreNuitee & Chr(13) & "• " & Libelle & " : " & hebergement & " - " & Codehebergement & Chr(13) & "• Tarif par jour : " & Format(tarif + MONTANT_TAXE_DE_SEJOUR, "#,##0") & " " & CODE_MONNAIE & Chr(13) & "• Heure d'arrivée : " & CDate(HeureEntree).ToLongTimeString & Chr(13) & "• Heure de départ : " & CDate(heureDepart).ToLongTimeString & Chr(13) & "• Total : " & Format(MONTANT_HT, "#,##0") & " " & CODE_MONNAIE & Chr(13) & "• Caution : " & Format(CAUTION, "#,##0") & " " & CODE_MONNAIE & Chr(13) & "• Dépot de garantie : " & Format(DEPOT_DE_GARANTIE, "#,##0") & " " & CODE_MONNAIE & Chr(13)
                Else
                    termes = "• Numéro de confirmation : " & NumConfirmation & Chr(13) & "• Nom du client : " & client & Chr(13) & "• Date d’arrivée : " & DateDebut & Chr(13) & "• Date de départ : " & DateFin & Chr(13) & "• Nombre de " & LibelleJour & " :" & NbreNuitee & Chr(13) & "• " & Libelle & " : " & hebergement & " - " & Codehebergement & Chr(13) & "• Tarif par nuit : " & Format(tarif, "#,##0") & " " & CODE_MONNAIE & Chr(13) & "• Taxe de séjour applicable par nuit : " & Format(MONTANT_TAXE_DE_SEJOUR, "#,##0") & " " & CODE_MONNAIE & Chr(13) & "• Heure d'arrivée : " & CDate(HeureEntree).ToLongTimeString & Chr(13) & "• Heure de départ : " & CDate(heureDepart).ToLongTimeString & Chr(13) & "• Total du séjour : " & Format(MONTANT_HT, "#,##0") & " " & CODE_MONNAIE & Chr(13)
                End If

                pdfDoc.Add(New Paragraph(termes, font1))

                Dim info1Header As String = "INFORMATION PRATIQUE" & Chr(13)
                Dim p2 As Paragraph = New Paragraph(info1Header, font2)
                p2.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p2)

                Dim info1 As String = societe.Rows(0)("RAISON_SOCIALE") & " fera selon ses efforts commerciaux raisonnables pour répondre à tous vos besoins particuliers. Si vous avez des exigences spécifiques que vous souhaitez que nous considérions, veuillez nous contacter dans les plus brefs délais." & Chr(13) & Chr(13)
                pdfDoc.Add(New Paragraph(info1, font1))

                Dim info2Header As String = "CONDITION DE VENTE" & Chr(13)
                Dim p3 As Paragraph = New Paragraph(info2Header, font2)
                p3.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p3)

                Dim info2 As String = "Le tarif par nuit indiqué s’entend par logement (chambre), pour le nombre de personnes et la/les date(s) préalablement sélectionnées, sauf indication contraire (forfaits). Cependant, vous devrez payer la taxe de séjour supplémentaires à votre arrivée à l'hôtel" & Chr(13) & Chr(13)
                pdfDoc.Add(New Paragraph(info2, font1))

                Dim info3Header As String = "POLITIQUE DE RÉSERVATION" & Chr(13)
                Dim p4 As Paragraph = New Paragraph(info3Header, font2)
                p4.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p4)

                Dim info3 As String = "Politique de garantie : Toutes les réservations doivent être garanties par un règlement équivalent au tarif de la première nuit, plus taxes applicables au moment de la réservation. Ceci ne concerne pas les réservations non-remboursables, pour lesquelles la totalité du prépaiement est conservé." & Chr(13) & Chr(13)

                pdfDoc.Add(New Paragraph(info3, font1))

                Dim info4 As String = "Politique d’annulation : Vous pouvez annuler votre réservation sans pénalité jusqu'à 24 heures ou plus avant le jour de votre arrivée (heure locale), sauf si autrement spécifié sur votre réservation. Si vous annulez après cette période, veuillez noter que des frais d'annulation équivalent à la première nuit, plus taxes applicables seront appliqués et possiblement certains frais additionnels." & Chr(13) & Chr(13)

                pdfDoc.Add(New Paragraph(info4, font1))

                Dim info5 As String = "Politique enfants : Hébergement gratuit pour les enfants de moins de 12 ans partageant la chambre de leurs parents, dans la limite du nombre maximum de personnes par type de chambre autorisé. Le nombre d'enfants doit être indiqué lors de la réservation." & Chr(13)

                pdfDoc.Add(New Paragraph(info5, font1))

                Dim info6 As String = "Nous nous réjouissons sincèrement d’avance d'avoir le plaisir de vous accueillir."

                pdfDoc.Add(New Paragraph(info6, font1))

                pdfDoc.Close()

                MessageBox.Show("PDF has been exported" & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                Process.Start(sfd.FileName)

            End If

        End If

    End Sub

    Public Shared Sub GenerationDeConfirmationReservation(ByVal NumConfirmation As String, ByVal client As String, ByVal DateDebut As Date, ByVal DateFin As Date, ByVal NbreNuitee As Integer, ByVal hebergement As String, ByVal Codehebergement As String, ByVal tarif As Double, ByVal HeureEntree As DateTime, ByVal heureDepart As DateTime, ByVal TypeRea As String)

        'DEFINITION DES TROIS TABLES

        ' ----------------------------------------- TWO TABLES INTO A MAIN TABLE --------------------------------------------------
        Dim mtable As PdfPTable = New PdfPTable(2)
        mtable.WidthPercentage = 100
        mtable.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

        Dim tableRight As PdfPTable = New PdfPTable(1)
        tableRight.WidthPercentage = 100
        tableRight.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

        Dim tableLeft As PdfPTable = New PdfPTable(1)
        tableLeft.WidthPercentage = 100
        tableLeft.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

        Dim pdfCell As PdfPCell = Nothing

        '-------------------------------------------------------------------------------------------
        If True Then

            Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

            If GlobalVariable.actualLanguageValue = 1 Then
                sfd.FileName = "CONFIRMATION RESERVATION DE " & client & Now().ToString("ddMMyyHms")
            Else
                sfd.FileName = "RESERVATION CONFIRMATION OF " & client & Now().ToString("ddMMyyHms")
            End If

            Dim societe As DataTable = Functions.allTableFields("societe")

            Dim CODE_MONNAIE As String = ""

            If societe.Rows.Count > 0 Then
                CODE_MONNAIE = societe.Rows(0)("CODE_MONNAIE")
            End If

            If sfd.ShowDialog = 1 Then
                'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
                Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
                Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
                Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim font1 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
                Dim font2 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)

                Dim Libelle As String = ""
                Dim LibelleJour As String = ""
                Dim libelleMontant As String = ""
                Dim nombreDeMois As Integer = 0
                Dim libelleNombreDeMois As String = ""

                pdfWrite.PageEvent = New HeaderFooter

                pdfDoc.Open()

                Dim infoSupResa As DataTable = getElementByCode(NumConfirmation, "reservation", "CODE_RESERVATION")

                If Not infoSupResa.Rows.Count > 0 Then
                    infoSupResa = getElementByCode(NumConfirmation, "reserve_conf", "CODE_RESERVATION")
                End If

                Dim DEPOT_DE_GARANTIE As Double = 0
                Dim CAUTION As Double = 0
                Dim PAX As Integer = 1
                Dim MENSUEL As Integer = 0

                If infoSupResa.Rows.Count > 0 Then
                    DEPOT_DE_GARANTIE = infoSupResa.Rows(0)("DEPOT_DE_GARANTIE")
                    CAUTION = infoSupResa.Rows(0)("MONTANT_TOTAL_CAUTION")
                    PAX = infoSupResa.Rows(0)("NB_PERSONNES")
                    MENSUEL = infoSupResa.Rows(0)("MENSUEL")
                End If

                If GlobalVariable.actualLanguageValue = 1 Then

                    If GlobalVariable.typeChambreOuSalle = "salle" Then

                        Libelle = "Type Salle :"
                        LibelleJour = "Jour(s) :"
                        libelleMontant = "Montant Location :"

                    Else

                        If MENSUEL = 0 Then
                            Libelle = "Type Chambre :"
                            LibelleJour = "Nuitée(s) : "
                            libelleMontant = "Tarif TTC"
                        Else
                            Libelle = "Type Logement :"
                            LibelleJour = "Jour(s) :"
                            libelleMontant = "Loyer Mensuel :"
                        End If

                    End If

                Else


                    If GlobalVariable.typeChambreOuSalle = "salle" Then

                        Libelle = "Hall Type :"
                        LibelleJour = "Day(s) :"
                        libelleMontant = "Renting Amount :"

                    Else

                        If MENSUEL = 0 Then
                            Libelle = "Room Type :"
                            LibelleJour = "Night(s) : "
                            libelleMontant = "Price including Tax"
                        Else
                            Libelle = "Housing type :"
                            LibelleJour = "Day(s) :"
                            libelleMontant = "Monthly rent :"
                        End If

                    End If

                End If

                Dim intro As String = ""

                Dim MONTANT_TAXE_DE_SEJOUR As Double = 0

                Dim taxe_sejour As DataTable = Functions.getElementByCode(NumConfirmation, "taxe_sejour_collectee", "NUM_RESERVATION")

                If taxe_sejour.Rows.Count > 0 Then
                    MONTANT_TAXE_DE_SEJOUR = taxe_sejour.Rows(0)("TAXE_SEJOUR_COLLECTEE")
                End If

                Dim MONTANT_HT As Double = Integer.Parse(NbreNuitee) * (Double.Parse(tarif) + MONTANT_TAXE_DE_SEJOUR)

                If MENSUEL = 1 Then
                    MONTANT_HT = (Double.Parse(tarif) + MONTANT_TAXE_DE_SEJOUR)
                End If

                '0-TOP INFORMATION
                Dim p0 As Paragraph = New Paragraph(Chr(13) & Chr(13) & "CONFIRMATION DE RESERVATION No " & NumConfirmation & Chr(13), pColumn)
                If GlobalVariable.actualLanguageValue = 0 Then
                    p0 = New Paragraph(Chr(13) & Chr(13) & "RESERVATION CONFIRMATION No " & NumConfirmation & Chr(13), pColumn)
                End If
                p0.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p0)

                Dim p1 As Paragraph = New Paragraph(Chr(13) & "Nous avons le plaisir de confirmer votre réservation No " & NumConfirmation & Chr(13) & Chr(13), font1)
                If GlobalVariable.actualLanguageValue = 0 Then
                    p1 = New Paragraph(Chr(13) & "We have the pleasure to confirm your reservation No " & NumConfirmation & Chr(13) & Chr(13), font1)
                End If
                p1.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p1)

                '1-LEFT TABLE ---------------------------------------------------------------
                '1.1- INFORMATION DU CLIENT

                Dim MONTANT_NAVETTE As Double = GlobalVariable.AgenceActuelle.Rows(0)("MONTANT_NAVETTE")
                Dim DIRECTION As String = GlobalVariable.AgenceActuelle.Rows(0)("DIRECTION")

                Dim infoSupClient As DataTable = Functions.getElementByCode(client, "client", "NOM_PRENOM")
                Dim nom As String = ""
                Dim prenom As String = ""
                Dim adresse As String = ""
                Dim tel As String = ""
                Dim email As String = ""
                Dim mode_reglement As String = "-"
                Dim civilite As String = ""
                Dim clientAdditionnel As Integer = 0

                If infoSupClient.Rows.Count > 0 Then
                    nom = infoSupClient.Rows(0)("NOM_CLIENT")
                    prenom = infoSupClient.Rows(0)("PRENOMS")
                    adresse = infoSupClient.Rows(0)("ADRESSE")
                    tel = infoSupClient.Rows(0)("TELEPHONE")
                    email = infoSupClient.Rows(0)("EMAIL")
                    If Not IsDBNull(infoSupClient.Rows(0)("CODE_MODE_PAIEMENT")) Then
                        mode_reglement = infoSupClient.Rows(0)("CODE_MODE_PAIEMENT")
                    End If
                    civilite = infoSupClient.Rows(0)("CIVILITE")
                End If

                Dim tL1 As PdfPTable = New PdfPTable(2)
                tL1.WidthPercentage = 100
                pdfCell = New PdfPCell(New Paragraph("Information du client", pColumn))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph("Client Information", pColumn))
                End If
                pdfCell.Border = 0
                pdfCell.BorderWidthBottom = 1
                pdfCell.Colspan = 2
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tL1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("Nom : ", font1))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph("Name", pColumn))
                End If
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tL1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(civilite & " " & nom, font1))
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tL1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("Prénom : ", font1))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph("Surname", pColumn))
                End If
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tL1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(prenom, font1))
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tL1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("Adresse :", font1))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph("Address", pColumn))
                End If
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tL1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(adresse, font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.Border = 0
                tL1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("Email :", font1))
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tL1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(email, font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.Border = 0
                tL1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("Tel :", font1))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph("Phone", pColumn))
                End If
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tL1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(tel, font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.Border = 0
                tL1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Chr(13) & "Client additionnel", font1))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Chr(12) & "Additional client", pColumn))
                End If
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tL1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Chr(13) & clientAdditionnel, font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.Border = 0
                tL1.AddCell(pdfCell)

                tableLeft.AddCell(tL1)

                Dim tL2 As PdfPTable = New PdfPTable(1)
                tL2.WidthPercentage = 100

                pdfCell = New PdfPCell(New Paragraph(Chr(12) & "Garantie", pColumn))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Chr(12) & "Arrhes", pColumn))
                End If
                pdfCell.Border = 0
                pdfCell.BorderWidthBottom = 1
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tL2.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Chr(13) & "Sans dépôt de garantie, cette réservation est valable jusqu’à 18h00 le jour d’arrivée." & Chr(13), font1))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Chr(13) & "Without an arrhes, this reservation is valid till 6 pm of the arrival date." & Chr(13), font1))
                End If
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tL2.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Chr(13) & "Si la chambre est garantie, votre réservation est maintenue en cas d'arrivée après 18h00 également toute la nuit. Sont considérés comme garanties pour une réservation de chambre : " & Chr(13) & "• Une carte de crédit (Visa ou Master) " & Chr(13) & "•	Le prépaiement d'une nuitée, en espèce ou par virement bancaire." & Chr(13), font1))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Chr(13) & "If the room / Hall is guarantee, your reservation is maintained in case of arrivals after 6 pm and the entire night. Are considered as guarantee, reservations for a Room / Hall : " & Chr(13) & "•	A credit Card (Visa or Master) " & Chr(13) & "•	The payment of one night/day, in cash or through bank transfer." & Chr(13), font1))
                End If
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tL2.AddCell(pdfCell)

                tableLeft.AddCell(tL2)

                Dim tL3 As PdfPTable = New PdfPTable(1)
                tL3.WidthPercentage = 100

                pdfCell = New PdfPCell(New Paragraph(Chr(12) & "Annulation", pColumn))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Chr(12) & "Cancellation", pColumn))
                End If
                pdfCell.Border = 0
                pdfCell.BorderWidthBottom = 1
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tL3.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Chr(13) & "Cette réservation devra être annulée au plus tard à 23h59, la veille de l'arrivée afin d'éviter les pénalités d'annulation ou de non présentation." & Chr(13), font1))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Chr(13) & "This reservation should be canceled latest at 11:59 pm, the day before the arrival date so as to avoid penalities of cancellation  or No Show." & Chr(13), font1))
                End If
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tL3.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Chr(13) & "A l'enregistrement la réception vérifiera les informations relatives à votre séjour. Le tarif offert est fonction de votre date d'arrivée et de la durée de votre séjour. Un départ anticipé ou un séjour prolongé pourra entrainer une modification du tarif." & Chr(13), font1))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Chr(13) & "During the registration the reception will check the informations related to your stay. The Room rate is relative to your arrival date and the length of your stay. An early departure or an extension stay may bring about a change in the room rate." & Chr(13), font1))
                End If
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tL3.AddCell(pdfCell)

                tableLeft.AddCell(tL3)

                Dim tL4 As PdfPTable = New PdfPTable(1)
                tL4.WidthPercentage = 100

                pdfCell = New PdfPCell(New Paragraph(Chr(12) & "Direction", pColumn))
                pdfCell.Border = 0
                pdfCell.BorderWidthBottom = 1
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tL4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Chr(12) & DIRECTION, font1))
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tL4.AddCell(pdfCell)

                tableLeft.AddCell(tL4)

                '-------------------------------------------------------------------------------------

                Dim tL5 As PdfPTable = New PdfPTable(1)
                tL5.WidthPercentage = 100

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.Border = 0
                pdfCell.BorderWidthBottom = 1
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                tL5.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("La Direction", pColumn))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph("The Direction", pColumn))
                End If
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                tL5.AddCell(pdfCell)

                Dim img() As Byte
                img = GlobalVariable.AgenceActuelle.Rows(0)("CACHET")

                Dim mStream As New MemoryStream(img)
                Dim cachet As Image
                cachet = Image.GetInstance(img)
                cachet.ScalePercent(10.0F)

                pdfCell = New PdfPCell(New Paragraph(Chr(13) & Chr(13) & "", pColumn))
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                tL5.AddCell(pdfCell)

                pdfCell = New PdfPCell(cachet)
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                tL5.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Chr(13) & "Date :" & Now() & Chr(13), pColumn))
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                tL5.AddCell(pdfCell)

                tableLeft.AddCell(tL5)

                '2- RIGHT TABLE -------------------------------------------------------------

                Dim tR1 As PdfPTable = New PdfPTable(2)
                tR1.WidthPercentage = 100

                pdfCell = New PdfPCell(New Paragraph("Votre séjour", pColumn))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph("Your Stay", pColumn))
                End If
                pdfCell.Border = 0
                pdfCell.BorderWidthBottom = 1
                pdfCell.Colspan = 2
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("Arrivé : ", font1))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph("Arrival : ", font1))
                End If
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(DateDebut & " à " & CDate(HeureEntree).ToLongTimeString, font1))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph(DateDebut & " at " & CDate(HeureEntree).ToLongTimeString, font1))
                End If
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("Départ : ", font1))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph("Departure : ", font1))
                End If
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(DateFin & " à " & CDate(heureDepart).ToLongTimeString, font1))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph(DateFin & " at " & CDate(heureDepart).ToLongTimeString, font1))
                End If
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("Nombre de pers. : ", font1))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph("Number of Pax : ", font1))
                End If
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(PAX, font1))
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Libelle, font1))
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(hebergement, font1))
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(LibelleJour, font1))
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(NbreNuitee, font1))
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(libelleMontant, font1))
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(tarif, "#,##0") & " " & CODE_MONNAIE, font1))
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("Taxe de séjour ", font1))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph("Tourist Tax ", font1))
                End If
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(MONTANT_TAXE_DE_SEJOUR, "#,##0") & " " & CODE_MONNAIE, font1))
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Chr(13) & "Total du séjour TTC ", pColumn))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Chr(13) & "Total stay included Tax ", pColumn))
                End If
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Chr(13) & Format(MONTANT_HT, "#,##0") & " " & CODE_MONNAIE, pColumn))
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Chr(13) & "Pour vos futurs séjours, les réservations sont possibles sur les sites www.hotelsoft.cm ou nous vous garantissons le meilleur tarif disponible. Aucun frais de réservation ne sera perçu. Le règlement de l'ensemble ou du solde des prestations se fera directement auprès de l'hôtel" & Chr(13) & Chr(13), font1))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Chr(13) & "For your furture stay, the regulations will be donne directly at the Hotel" & Chr(13) & Chr(13), font1))
                End If
                pdfCell.Border = 0
                pdfCell.Colspan = 2
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR1.AddCell(pdfCell)

                tableRight.AddCell(tR1)

                Dim tR2 As PdfPTable = New PdfPTable(1)
                tR2.WidthPercentage = 100

                pdfCell = New PdfPCell(New Paragraph(Chr(13) & "Modalité", pColumn))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Chr(13) & "Modality", pColumn))
                End If
                pdfCell.Border = 0
                pdfCell.BorderWidthBottom = 1
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR2.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Chr(13) & "L'heure de départ est fixée à 12h minimum." & Chr(13) & "L'occupation prolongée de la chambre jusqu'à 16h entrainera la facturation de 50% du tarif appliqué et au-delà de 16h, la nuitée complète." & Chr(13), font1))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Chr(13) & "The departure time is at 12 minimum." & Chr(13) & "The occupation of the room till 4pm will bring about and extra fee at a rate of 50% the room rate beyond 4pm, the entire night. " & Chr(13), font1))
                End If
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR2.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Chr(13) & "Les enregistrements commencent à partir de 14h." & Chr(13) & "Les arrivées matinales ne sont pas garanties." & Chr(13) & "A la demande, elles seront facturées à 100% du tarif confirmé avant 8h30 et à 50% pour une arrivée entre 8h30 et 12h." & Chr(13), font1))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Chr(13) & "The registration start at 2pm." & Chr(13) & "Early arrival are not garantee." & Chr(13) & "on demande, the will be charged at 100% of the room rate confirmed before 8h30 Am and at 50% for an arrival between 8h30 Am and 12h." & Chr(13), font1))
                End If
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR2.AddCell(pdfCell)

                tableRight.AddCell(tR2)

                Dim tR3 As PdfPTable = New PdfPTable(1)
                tR3.WidthPercentage = 100

                pdfCell = New PdfPCell(New Paragraph(Chr(12) & "Transport", pColumn))
                pdfCell.Border = 0
                pdfCell.BorderWidthBottom = 1
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR3.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Chr(13) & GlobalVariable.AgenceActuelle.Rows(0)("NOM_AGENCE") & " " & GlobalVariable.AgenceActuelle.Rows(0)("VILLE") & " offre une navette pour les transferts aéroport. " & Chr(13) & " Les transferts aéroport sont facturés à " & MONTANT_NAVETTE & " " & CODE_MONNAIE & " par personne entre (18h-08h)", font1))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Chr(13) & GlobalVariable.AgenceActuelle.Rows(0)("NOM_AGENCE") & " " & GlobalVariable.AgenceActuelle.Rows(0)("VILLE") & " offers shuttle buses to and from aerports. " & Chr(13) & " Transfer t and from aerports are charged at " & MONTANT_NAVETTE & " " & CODE_MONNAIE & " per personne between (18pm-08am)", font1))
                End If
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR3.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Chr(13) & "L'hôtel a également la possibilité de vous mettre en contact direct avec un service de taxis sécurisés " & Chr(13), font1))
                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Chr(13) & "The hotel also has the possibility to put you into direct contact with secured Taxis drivers." & Chr(13), font1))
                End If
                pdfCell.Border = 0
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                tR3.AddCell(pdfCell)

                tableRight.AddCell(tR3)

                mtable.AddCell(tableLeft)

                mtable.AddCell(tableRight)

                pdfDoc.Add(mtable)

                pdfDoc.Close()

                MessageBox.Show("PDF has been exported" & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                Process.Start(sfd.FileName)

            End If

        End If

    End Sub

    Class HeaderFooter_1

        Inherits PdfPageEventHelper

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim CODE_AGENCE As String = GlobalVariable.codeAgence

        Dim UTILISE As Integer = 1

        Public Overrides Sub OnEndPage(writer As PdfWriter, document As Document)

            Dim papierEnTete As DataTable = Functions.getElementByCode(CODE_AGENCE, "papier_entete", "CODE_AGENCE")

            Dim HeaderFont As New Font(iTextSharp.text.Font.FontFamily.COURIER, 14, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(Font.FontFamily.TIMES_ROMAN, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font2 As New Font(Font.FontFamily.COURIER, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim font4 As New Font(Font.FontFamily.COURIER, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font3 As New Font(Font.FontFamily.TIMES_ROMAN, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pdfCell As PdfPCell = Nothing

            Dim img() As Byte
            img = societe.Rows(0)("LOGO")

            Dim img2() As Byte
            img2 = papierEnTete.Rows(0)("IMAGE_2")

            Dim img1() As Byte
            img1 = papierEnTete.Rows(0)("IMAGE_1")

            Dim mStream As New MemoryStream(img)
            Dim mStream2 As New MemoryStream(img2)
            Dim mStream1 As New MemoryStream(img1)

            Dim logo As Image
            logo = Image.GetInstance(img)
            'logo.ScalePercent(60.0F)
            logo.ScalePercent(45.0F)

            Dim IMAGE_2 As Image
            IMAGE_2 = Image.GetInstance(img2)
            IMAGE_2.ScalePercent(13.0F)

            Dim IMAGE_1 As Image
            IMAGE_1 = Image.GetInstance(img1)
            IMAGE_1.ScalePercent(13.0F)

            '--------------------------------------------------------------------- START HEADER --------------------------------------------------------------

            If papierEnTete.Rows.Count > 0 Then

                Dim EN_TETE_L1 = papierEnTete.Rows(0)("EN_TETE_L1")
                Dim EN_TETE_L2 = papierEnTete.Rows(0)("EN_TETE_L2")
                Dim EN_TETE_L3 = papierEnTete.Rows(0)("EN_TETE_L3")
                Dim EN_TETE_L4 = papierEnTete.Rows(0)("EN_TETE_L4")
                Dim PIEDS_L1 = papierEnTete.Rows(0)("PIEDS_L1")
                Dim PIEDS_L2 = papierEnTete.Rows(0)("PIEDS_L2")
                Dim PIEDS_L3 = papierEnTete.Rows(0)("PIEDS_L3")

                If papierEnTete.Rows(0)("UTILISE") = 1 Then

                    Dim pdfTable As New PdfPTable(3) 'Number of columns

                    pdfTable.TotalWidth = document.PageSize.Width
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                    'pdfTable.HeaderRows = 1

                    Dim widths As Single() = New Single() {2.4F, 10.0F, 2.4F}
                    pdfTable.SetWidths(widths)

                    pdfCell = New PdfPCell(logo)
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.Border = 0
                    pdfCell.PaddingLeft = 15.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    Dim mtable As PdfPTable = New PdfPTable(1)
                    mtable.WidthPercentage = 100
                    mtable.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

                    pdfCell = New PdfPCell(New Paragraph(societe.Rows(0)("RAISON_SOCIALE"), HeaderFont))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0 'used to remove borders on the cells

                    mtable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(EN_TETE_L1 & Chr(13), font1))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0 'used to remove borders on the cells

                    mtable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(EN_TETE_L2, font3))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0 'used to remove borders on the cells

                    mtable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(EN_TETE_L3, font3))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0 'used to remove borders on the cells

                    mtable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(EN_TETE_L4, font3))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0 'used to remove borders on the cells

                    mtable.DefaultCell.BorderWidth = 0
                    pdfTable.DefaultCell.BorderWidth = 0

                    mtable.AddCell(pdfCell)

                    pdfTable.AddCell(mtable)

                    pdfCell = New PdfPCell(IMAGE_2)
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.Border = 0
                    pdfCell.PaddingRight = 15.0F
                    pdfTable.AddCell(pdfCell)

                    'pdfTable.WriteSelectedRows(0, -1, 0, document.GetTop(document.TopMargin) + 155, writer.DirectContent)

                    If True Then
                        pdfTable.AddCell(pdfCell)
                        pdfTable.WriteSelectedRows(0, -1, 0, document.GetTop(document.TopMargin) + 155, writer.DirectContent)
                    Else
                        pdfTable.AddCell(pdfCell)
                    End If

                    '----------------------------------------------------------------------------------------------------------------------------------------------------------------

                    If GlobalVariable.DocumentToGenerate = "situation caisse" Then
                        'pdfCell = New PdfPCell(New Paragraph("               SIGNATURE DU CAISSIER                                               SIGNATURE DU COMPTABLE"))
                    ElseIf GlobalVariable.DocumentToGenerate = "DST" Then
                        'pdfCell = New PdfPCell(New Paragraph(""))
                    ElseIf GlobalVariable.DocumentToGenerate = "reglement" Or GlobalVariable.DocumentToGenerate = "facture" Then
                        'pdfCell = New PdfPCell(New Paragraph("               SIGNATURE DU CLIENT                                                    SIGNATURE DE L'HOTEL"))
                End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfCell.PaddingLeft = 15.0F
                    pdfCell.Border = 0
                    'pFooterSign.AddCell(pdfCell)
                    'pFooterSign.WriteSelectedRows(0, -1, 0, document.GetBottom(document.BottomMargin) + 45, writer.DirectContent)

                    Dim pFooter As New PdfPTable(1)
                    pFooter.TotalWidth = document.PageSize.Width
                    pdfCell.PaddingLeft = 15.0F
                    pFooter.DefaultCell.Border = 0

                    pdfCell = New PdfPCell(New Paragraph(PIEDS_L1, font4))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 15.0F
                    pdfCell.Border = 0
                    pFooter.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(PIEDS_L2 & Chr(13) & PIEDS_L3 & Chr(13) & " TECHFLECTION LYTE " & GlobalVariable.DateDeTravail & "-" & Now().ToLongTimeString, font2))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 15.0F
                    pdfCell.Border = 0
                    pFooter.AddCell(pdfCell)

                    'pFooter.WriteSelectedRows(0, -1, 0, document.GetBottom(document.BottomMargin) - 23, writer.DirectContent)
                    pFooter.WriteSelectedRows(0, -1, 0, 75, writer.DirectContent)

                    Dim pFooterLeft As New PdfPTable(1)
                    pFooterLeft.TotalWidth = document.PageSize.Width
                    pdfCell.PaddingLeft = 15.0F
                    pFooterLeft.DefaultCell.Border = 0

                    pdfCell = New PdfPCell(IMAGE_1) 'BOTTOM 
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfCell.PaddingLeft = 15.0F
                    pdfCell.Border = 0
                    pFooterLeft.AddCell(pdfCell)
                    'pFooterLeft.WriteSelectedRows(0, -1, 0, document.GetBottom(document.BottomMargin) + 15, writer.DirectContent)
                    pFooterLeft.WriteSelectedRows(0, -1, 0, 80, writer.DirectContent)

                ElseIf papierEnTete.Rows(0)("UTILISE") = 0 Then

                    Dim mtable As PdfPTable = New PdfPTable(1)
                    mtable.WidthPercentage = 100
                    mtable.DefaultCell.Border = itextsharp.text.Rectangle.NO_BORDER

                    '--------------------------------------------------------------

                    Dim pdfTable As New PdfPTable(2) 'Number of columns

                    pdfTable.TotalWidth = document.PageSize.Width
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT

                    Dim widths As Single() = New Single() {30.0F, 70.0F}
                    pdfTable.SetWidths(widths)

                    pdfCell = New PdfPCell(logo)
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 15
                    pdfCell.Border = 0
                    pdfCell.PaddingLeft = 15.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(societe.Rows(0)("RAISON_SOCIALE"), HeaderFont))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0 'used to remove borders on the cells
                    mtable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Chr(13) & EN_TETE_L1 & Chr(13) & EN_TETE_L2 & Chr(13) & EN_TETE_L3 & Chr(13) & EN_TETE_L4, font1))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.MinimumHeight = 15
                    pdfCell.Border = 0 'used to remove borders on the cells
                    mtable.AddCell(pdfCell)

                    mtable.DefaultCell.BorderWidth = 0
                    pdfTable.DefaultCell.BorderWidth = 0

                    'document.PageNumber = 1

                    If True Then
                        pdfTable.AddCell(mtable)
                        pdfTable.WriteSelectedRows(0, -1, 0, document.GetTop(document.TopMargin) + 60, writer.DirectContent)
                    End If
                    '----------------------------------------------------------------------------------------------------------------------------------------------------------------

                    Dim pFooter As New PdfPTable(1)
                    pFooter.TotalWidth = document.PageSize.Width
                    pdfCell.PaddingLeft = 15.0F
                    pdfCell.MinimumHeight = 15
                    pFooter.DefaultCell.Border = 0

                    pdfCell = New PdfPCell(New Paragraph(PIEDS_L1, font4))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 15.0F
                    pdfCell.MinimumHeight = 15
                    pdfCell.Border = 0
                    pFooter.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(PIEDS_L2 & Chr(13) & PIEDS_L3 & Chr(13) & " TECHFLECTION LYTE " & GlobalVariable.DateDeTravail & "-" & Now().ToLongTimeString, font2))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 15.0F
                    pdfCell.MinimumHeight = 15
                    pdfCell.Border = 0
                    pFooter.AddCell(pdfCell)

                    pFooter.WriteSelectedRows(0, -1, 0, 80, writer.DirectContent)

                End If

            End If

        End Sub

    End Class

    Class HeaderFooter

        Inherits PdfPageEventHelper

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim CODE_AGENCE As String = GlobalVariable.codeAgence

        Dim UTILISE As Integer = 1

        Public Overrides Sub OnEndPage(writer As PdfWriter, document As Document)

            Dim papierEnTete As DataTable = Functions.getElementByCode(CODE_AGENCE, "papier_entete", "CODE_AGENCE")

            Dim HeaderFont As New Font(itextsharp.text.Font.FontFamily.COURIER, 22, itextsharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(Font.FontFamily.TIMES_ROMAN, 11, itextsharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font2 As New Font(Font.FontFamily.COURIER, 10, itextsharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim font4 As New Font(Font.FontFamily.COURIER, 10, itextsharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font3 As New Font(Font.FontFamily.TIMES_ROMAN, 10, itextsharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pdfCell As PdfPCell = Nothing

            Dim img() As Byte
            img = societe.Rows(0)("LOGO")

            Dim img2() As Byte
            img2 = papierEnTete.Rows(0)("IMAGE_2")

            Dim img1() As Byte
            img1 = papierEnTete.Rows(0)("IMAGE_1")

            Dim mStream As New MemoryStream(img)
            Dim mStream2 As New MemoryStream(img2)
            Dim mStream1 As New MemoryStream(img1)

            Dim logo As Image
            logo = Image.GetInstance(img)
            'logo.ScalePercent(60.0F)
            logo.ScalePercent(65.0F)

            Dim IMAGE_2 As Image
            IMAGE_2 = Image.GetInstance(img2)
            IMAGE_2.ScalePercent(18.0F)

            Dim IMAGE_1 As Image
            IMAGE_1 = Image.GetInstance(img1)
            IMAGE_1.ScalePercent(18.0F)

            '--------------------------------------------------------------------- START HEADER --------------------------------------------------------------

            If papierEnTete.Rows.Count > 0 Then

                Dim EN_TETE_L1 = papierEnTete.Rows(0)("EN_TETE_L1")
                Dim EN_TETE_L2 = papierEnTete.Rows(0)("EN_TETE_L2")
                Dim EN_TETE_L3 = papierEnTete.Rows(0)("EN_TETE_L3")
                Dim EN_TETE_L4 = papierEnTete.Rows(0)("EN_TETE_L4")
                Dim PIEDS_L1 = papierEnTete.Rows(0)("PIEDS_L1")
                Dim PIEDS_L2 = papierEnTete.Rows(0)("PIEDS_L2")
                Dim PIEDS_L3 = papierEnTete.Rows(0)("PIEDS_L3")

                If papierEnTete.Rows(0)("UTILISE") = 1 Then

                    Dim pdfTable As New PdfPTable(3) 'Number of columns

                    pdfTable.TotalWidth = document.PageSize.Width
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                    'pdfTable.HeaderRows = 1

                    Dim widths As Single() = New Single() {2.4F, 10.0F, 2.4F}
                    pdfTable.SetWidths(widths)

                    pdfCell = New PdfPCell(logo)
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.Border = 0
                    pdfCell.PaddingLeft = 15.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    Dim mtable As PdfPTable = New PdfPTable(1)
                    mtable.WidthPercentage = 100
                    mtable.DefaultCell.Border = itextsharp.text.Rectangle.NO_BORDER

                    pdfCell = New PdfPCell(New Paragraph(societe.Rows(0)("RAISON_SOCIALE"), HeaderFont))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0 'used to remove borders on the cells

                    mtable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(EN_TETE_L1 & Chr(13), font1))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0 'used to remove borders on the cells

                    mtable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(EN_TETE_L2, font3))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0 'used to remove borders on the cells

                    mtable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(EN_TETE_L3, font3))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0 'used to remove borders on the cells

                    mtable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(EN_TETE_L4, font3))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0 'used to remove borders on the cells

                    mtable.DefaultCell.BorderWidth = 0
                    pdfTable.DefaultCell.BorderWidth = 0

                    mtable.AddCell(pdfCell)

                    pdfTable.AddCell(mtable)

                    pdfCell = New PdfPCell(IMAGE_2)
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.Border = 0
                    pdfCell.PaddingRight = 15.0F
                    pdfTable.AddCell(pdfCell)

                    'pdfTable.WriteSelectedRows(0, -1, 0, document.GetTop(document.TopMargin) + 155, writer.DirectContent)

                    If document.PageNumber = 1 Then
                        pdfTable.AddCell(pdfCell)
                        pdfTable.WriteSelectedRows(0, -1, 0, document.GetTop(document.TopMargin) + 155, writer.DirectContent)
                    Else
                        pdfTable.AddCell(pdfCell)
                    End If

                    '----------------------------------------------------------------------------------------------------------------------------------------------------------------

                    Dim pFooter As New PdfPTable(1)
                    pFooter.TotalWidth = document.PageSize.Width
                    pdfCell.PaddingLeft = 15.0F
                    pFooter.DefaultCell.Border = 0

                    pdfCell = New PdfPCell(New Paragraph(PIEDS_L1, font4))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 15.0F
                    pdfCell.Border = 0
                    pFooter.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(PIEDS_L2 & Chr(13) & PIEDS_L3 & Chr(13) & " TECHFLECTION LYTE " & GlobalVariable.DateDeTravail & "-" & Now().ToLongTimeString, font2))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 15.0F
                    pdfCell.Border = 0
                    pFooter.AddCell(pdfCell)

                    'pFooter.WriteSelectedRows(0, -1, 0, document.GetBottom(document.BottomMargin) - 23, writer.DirectContent)
                    pFooter.WriteSelectedRows(0, -1, 0, 40, writer.DirectContent)

                    Dim pFooterLeft As New PdfPTable(1)
                    pFooterLeft.TotalWidth = document.PageSize.Width
                    pdfCell.PaddingLeft = 15.0F
                    pFooterLeft.DefaultCell.Border = 0

                    pdfCell = New PdfPCell(IMAGE_1) 'BOTTOM 
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfCell.PaddingLeft = 15.0F
                    pdfCell.Border = 0
                    pFooterLeft.AddCell(pdfCell)
                    'pFooterLeft.WriteSelectedRows(0, -1, 0, document.GetBottom(document.BottomMargin) + 15, writer.DirectContent)
                    pFooterLeft.WriteSelectedRows(0, -1, 0, 95, writer.DirectContent)

                ElseIf papierEnTete.Rows(0)("UTILISE") = 0 Then

                    Dim mtable As PdfPTable = New PdfPTable(1)
                    mtable.WidthPercentage = 100
                    mtable.DefaultCell.Border = itextsharp.text.Rectangle.NO_BORDER

                    '--------------------------------------------------------------

                    Dim pdfTable As New PdfPTable(2) 'Number of columns

                    pdfTable.TotalWidth = document.PageSize.Width
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT

                    Dim widths As Single() = New Single() {30.0F, 70.0F}
                    pdfTable.SetWidths(widths)

                    pdfCell = New PdfPCell(logo)
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 15
                    pdfCell.Border = 0
                    pdfCell.PaddingLeft = 15.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(societe.Rows(0)("RAISON_SOCIALE"), HeaderFont))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0 'used to remove borders on the cells
                    mtable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Chr(13) & EN_TETE_L1 & Chr(13) & EN_TETE_L2 & Chr(13) & EN_TETE_L3 & Chr(13) & EN_TETE_L4, font1))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.MinimumHeight = 15
                    pdfCell.Border = 0 'used to remove borders on the cells
                    mtable.AddCell(pdfCell)

                    mtable.DefaultCell.BorderWidth = 0
                    pdfTable.DefaultCell.BorderWidth = 0

                    If document.PageNumber = 1 Then
                        pdfTable.AddCell(mtable)
                        pdfTable.WriteSelectedRows(0, -1, 0, document.GetTop(document.TopMargin) + 155, writer.DirectContent)
                    End If
                    '----------------------------------------------------------------------------------------------------------------------------------------------------------------

                    Dim pFooter As New PdfPTable(1)
                    pFooter.TotalWidth = document.PageSize.Width
                    pdfCell.PaddingLeft = 15.0F
                    pdfCell.MinimumHeight = 15
                    pFooter.DefaultCell.Border = 0

                    pdfCell = New PdfPCell(New Paragraph(PIEDS_L1, font4))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 15.0F
                    pdfCell.MinimumHeight = 15
                    pdfCell.Border = 0
                    pFooter.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(PIEDS_L2 & Chr(13) & PIEDS_L3 & Chr(13) & " TECHFLECTION LYTE " & GlobalVariable.DateDeTravail & "-" & Now().ToLongTimeString, font2))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 15.0F
                    pdfCell.MinimumHeight = 15
                    pdfCell.Border = 0
                    pFooter.AddCell(pdfCell)

                    pFooter.WriteSelectedRows(0, -1, 0, 40, writer.DirectContent)

                End If

            End If

        End Sub

    End Class


    '----------------------------------------------------------------------------------------------------------------

    'TARIF APPLIQUE A UN CLIENT 
    'On détermine l'ensemble des prix appliqués a un client

    Public Shared Function TarifAppliqueAuClient(ByVal CODE_CLIENT As String, ByVal CODE_TYPE As String) As DataTable

        Dim CODE_ENTREPRISE As String = ""
        Dim FillingListquery As String = ""

        If getElementByCode(CODE_CLIENT, "client", "CODE_CLIENT").Rows.Count > 0 Then

            CODE_ENTREPRISE = getElementByCode(CODE_CLIENT, "client", "CODE_CLIENT").Rows(0)("CODE_ENTREPRISE")

        End If

        'We find tarif based on the code of the company associated to the client
        If Not CODE_ENTREPRISE = "" Then

            'GlobalVariable.connect.openConnection()

            'L'entreprise existe et est associée a un tarif
            FillingListquery = "SELECT PRIX_TARIF1,LIBELLE_TARIF, PRIX_TARIF_ENCOURS, CODE_CLIENT,CODE_TARIF FROM tarif_client INNER JOIN tarif_prix WHERE tarif_client.ID_TARIF_PRIX = tarif_prix.ID_TARIF AND CODE_CLIENT=@CODE_CLIENT AND CODE_TYPE=@CODE_TYPE"

            Dim commandList As New MySqlCommand(FillingListquery, GlobalVariable.connect)
            commandList.Parameters.Add("@CODE_TYPE", MySqlDbType.VarChar).Value = CODE_TYPE
            commandList.Parameters.Add("@CODE_CLIENT", MySqlDbType.VarChar).Value = Trim(CODE_ENTREPRISE)

            Dim adapterList As New MySqlDataAdapter(commandList)
            Dim tableList As New DataTable()

            adapterList.Fill(tableList)

            If tableList.Rows.Count > 0 Then

                Return tableList

            Else
                'L'entreprise existe mais n'est pas associée a un tarif

                'We find tarif based on the code of the client
                Dim FillingListquery1 As String = "SELECT PRIX_TARIF1,LIBELLE_TARIF, PRIX_TARIF_ENCOURS, CODE_CLIENT,CODE_TARIF FROM tarif_client INNER JOIN tarif_prix WHERE tarif_client.ID_TARIF_PRIX = tarif_prix.ID_TARIF AND CODE_CLIENT=@CODE_CLIENT AND CODE_TYPE=@CODE_TYPE"

                Dim commandList1 As New MySqlCommand(FillingListquery1, GlobalVariable.connect)
                commandList1.Parameters.Add("@CODE_TYPE", MySqlDbType.VarChar).Value = CODE_TYPE
                commandList1.Parameters.Add("@CODE_CLIENT", MySqlDbType.VarChar).Value = Trim(CODE_CLIENT)

                Dim adapterList1 As New MySqlDataAdapter(commandList1)
                Dim tableList1 As New DataTable()

                adapterList1.Fill(tableList1)

                Return tableList1

            End If

        Else
            'L'entreprise n'existe pas donc un recherche si le client est associé a un tarif

            'We find tarif based on the code of the client
            FillingListquery = "SELECT PRIX_TARIF1,LIBELLE_TARIF, PRIX_TARIF_ENCOURS, CODE_CLIENT,CODE_TARIF FROM tarif_client INNER JOIN tarif_prix WHERE tarif_client.ID_TARIF_PRIX = tarif_prix.ID_TARIF AND CODE_CLIENT=@CODE_CLIENT AND CODE_TYPE=@CODE_TYPE"

            Dim commandList As New MySqlCommand(FillingListquery, GlobalVariable.connect)
            commandList.Parameters.Add("@CODE_TYPE", MySqlDbType.VarChar).Value = CODE_TYPE
            commandList.Parameters.Add("@CODE_CLIENT", MySqlDbType.VarChar).Value = Trim(CODE_CLIENT)

            Dim adapterList As New MySqlDataAdapter(commandList)
            Dim tableList As New DataTable()

            adapterList.Fill(tableList)

            Return tableList

        End If

        'GlobalVariable.connect.closeConnection()

    End Function

    '------------------------TITLES---------------------------

    Public Shared Sub AffectingTitleToAForm(ByVal title As String, ByVal label As Label)

        label.Visible = True
        label.Text = title

    End Sub

    Public Shared Sub CleanTitleOfForms(ByVal label As Label)

        label.Visible = False

        label.Text = ""

        label.Refresh()

    End Sub

    '------------------------------------------------------------------------

    Public Shared Sub cloturer(ByVal nouvelDateDeTravail As Date)

        Dim insertQuery As String = "INSERT INTO `cloture`(`CODE_CLOTURE`, `DATE_DE_TRAVAIL`) VALUES (@value1,@value2)"

        Dim command0 As New MySqlCommand(insertQuery, GlobalVariable.connect)

        command0.Parameters.Add("@value1", MySqlDbType.VarChar).Value = GeneratingRandomCode("cloture", "")
        command0.Parameters.Add("@value2", MySqlDbType.Date).Value = nouvelDateDeTravail

        'Opening the connection
        'GlobalVariable.connect.openConnection()

        'Excuting the command and testing if everything went on well
        If (command0.ExecuteNonQuery() = 1) Then

        End If

    End Sub

    'OBTENTION DE LA DATE DE TRAVAIL
    Public Shared Function ObtenirDateDeTravail() As DateTime

        Dim clotureExistantes As DataTable = allTableFields("cloture")

        'si il y'a pas de travail la date de travail devient celle du jour
        If Not clotureExistantes.Rows.Count > 0 Then

            'Insertion d'une nouvelle date de clôture
            cloturer(Now())

        End If

        Dim DerniereCloture As DataTable = Functions.allTableFields("cloture")

        'On retourne la derniere date insérée
        Return DerniereCloture.Rows(DerniereCloture.Rows.Count - 1)("DATE_DE_TRAVAIL")

    End Function

    Public Shared Sub DuplicateRowFromDataGrid(ByVal Grid As DataGridView, ByVal ElementToDuplicate As String, ByVal Table As String, ByVal ColumnTitle As String)

        Dim updateRoomStatus As Boolean = False

        Dim table_1 As String = "reserve_conf"

        If Table = "reserve_conf" Then

            Table = "reservation"

            updateRoomStatus = True

        End If

        'Deleting elements from data grid of room categories
        For Each row As DataGridViewRow In Grid.SelectedRows

            Dim duplicate As String = ""

            If updateRoomStatus Then
                'DUPLICATION D'UN EN CHAMBRE POUR CREER UNE RESERVATION
                'duplicate = "INSERT INTO " & Table & " (`CODE_RESERVATION`, `CLIENT_ID`, `UTILISATEUR_ID`, `CHAMBRE_ID`, `AGENCE_ID`, `NOM_CLIENT`, `DATE_ENTTRE`, `HEURE_ENTREE`, `DATE_SORTIE`, `HEURE_SORTIE`, `ADULTES`, `NB_PERSONNES`, `ENFANTS`, `RECEVOIR_EMAIL`, `RECEVOIR_SMS`, `ETAT_RESERVATION`, `DATE_CREATION`, `HEURE_CREATION`, `MONTANT_TOTAL_CAUTION`, `MOTIF_ETAT`, `DATE_ETAT`, `MONTANT_ACCORDE`, `GROUPE`, `CHECKIN`, `TYPE`, `PETIT_DEJEUNER`, `SOLDE_RESERVATION`, `SOURCE_RESERVATION`, `PETIT_DEJEUNER_ROUTAGE`, `CHAMBRE_ROUTAGE`, `VENANT_DE`, `SE_RENDANT_A`, `RAISON`, `ROUTAGE`, `ETAT_NOTE_RESERVATION`, `CODE_ENTREPRISE`, `NOM_ENTREPRISE`, `AFFICHER_PRIX`, `DEPOT_DE_GARANTIE`, `DAY_USE`, `BC_ENTREPRISE`, `DATE_DE_CONTROLE`, `TYPE_CHAMBRE`,`FSC`) 
                duplicate = "INSERT INTO " & Table & " (`CODE_RESERVATION`, `CLIENT_ID`, `UTILISATEUR_ID`, `CHAMBRE_ID`, `AGENCE_ID`, `NOM_CLIENT`, `DATE_ENTTRE`, `HEURE_ENTREE`, `DATE_SORTIE`, `HEURE_SORTIE`, `ADULTES`, `NB_PERSONNES`, `ENFANTS`, `RECEVOIR_EMAIL`, `RECEVOIR_SMS`, `ETAT_RESERVATION`, `DATE_CREATION`, `HEURE_CREATION`, `MONTANT_TOTAL_CAUTION`, `MOTIF_ETAT`, `DATE_ETAT`, `MONTANT_ACCORDE`, `GROUPE`, `CHECKIN`, `TYPE`, `PETIT_DEJEUNER`,  `SOURCE_RESERVATION`, `PETIT_DEJEUNER_ROUTAGE`, `CHAMBRE_ROUTAGE`, `VENANT_DE`, `SE_RENDANT_A`, `RAISON`, `ROUTAGE`, `ETAT_NOTE_RESERVATION`, `CODE_ENTREPRISE`, `NOM_ENTREPRISE`, `AFFICHER_PRIX`, `DEPOT_DE_GARANTIE`, `DAY_USE`, `MENSUEL`,`BC_ENTREPRISE`, `DATE_DE_CONTROLE`, `TYPE_CHAMBRE`,`FSC`, BFK_COST) 
            SELECT `CODE_RESERVATION`, `CLIENT_ID`, `UTILISATEUR_ID`, `CHAMBRE_ID`, `AGENCE_ID`, `NOM_CLIENT`, `DATE_ENTTRE`, `HEURE_ENTREE`, `DATE_SORTIE`, `HEURE_SORTIE`, `ADULTES`, `NB_PERSONNES`, `ENFANTS`, `RECEVOIR_EMAIL`, `RECEVOIR_SMS`, `ETAT_RESERVATION`, `DATE_CREATION`, `HEURE_CREATION`, `MONTANT_TOTAL_CAUTION`, `MOTIF_ETAT`, `DATE_ETAT`, `MONTANT_ACCORDE`, `GROUPE`, `CHECKIN`, `TYPE`, `PETIT_DEJEUNER`,`SOURCE_RESERVATION`,`PETIT_DEJEUNER_ROUTAGE`, `CHAMBRE_ROUTAGE`,`VENANT_DE`,`SE_RENDANT_A`,`RAISON`, `ROUTAGE`,`ETAT_NOTE_RESERVATION`, `CODE_ENTREPRISE`, `NOM_ENTREPRISE`, `AFFICHER_PRIX`, `DEPOT_DE_GARANTIE`, `DAY_USE`, `MENSUEL`, `BC_ENTREPRISE`, `DATE_DE_CONTROLE`, `TYPE_CHAMBRE`, `FSC`, `BFK_COST` FROM " & table_1 & " WHERE CODE_RESERVATION = @CODE_RESERVATION"
                'Select Case`CODE_RESERVATION`, `CLIENT_ID`, `UTILISATEUR_ID`, `CHAMBRE_ID`, `AGENCE_ID`, `NOM_CLIENT`, `DATE_ENTTRE`, `HEURE_ENTREE`, `DATE_SORTIE`, `HEURE_SORTIE`, `ADULTES`, `NB_PERSONNES`, `ENFANTS`, `RECEVOIR_EMAIL`, `RECEVOIR_SMS`, `ETAT_RESERVATION`, `DATE_CREATION`, `HEURE_CREATION`, `MONTANT_TOTAL_CAUTION`, `MOTIF_ETAT`, `DATE_ETAT`, `MONTANT_ACCORDE`, `GROUPE`, `CHECKIN`, `TYPE`, `PETIT_DEJEUNER`, `SOLDE_RESERVATION`,`SOURCE_RESERVATION`,`PETIT_DEJEUNER_ROUTAGE`, `CHAMBRE_ROUTAGE`,`VENANT_DE`,`SE_RENDANT_A`,`RAISON`, `ROUTAGE`,`ETAT_NOTE_RESERVATION`, `CODE_ENTREPRISE`, `NOM_ENTREPRISE`, `AFFICHER_PRIX`, `DEPOT_DE_GARANTIE`, `DAY_USE`, `BC_ENTREPRISE`, `DATE_DE_CONTROLE`, `TYPE_CHAMBRE`, `FSC` FROM " & table_1 & " WHERE CODE_RESERVATION = @CODE_RESERVATION"
            Else
                'DUPLICATION DES RESERVATIONS SIMPELEMENT
                duplicate = "INSERT INTO " & Table & " (`CODE_RESERVATION`, `CLIENT_ID`, `UTILISATEUR_ID`, `CHAMBRE_ID`, `AGENCE_ID`, `NOM_CLIENT`, `DATE_ENTTRE`, `HEURE_ENTREE`, `DATE_SORTIE`, `HEURE_SORTIE`, `ADULTES`, `NB_PERSONNES`, `ENFANTS`, `RECEVOIR_EMAIL`, `RECEVOIR_SMS`, `ETAT_RESERVATION`, `DATE_CREATION`, `HEURE_CREATION`, `MONTANT_TOTAL_CAUTION`, `MOTIF_ETAT`, `DATE_ETAT`, `MONTANT_ACCORDE`, `GROUPE`, `CHECKIN`, `TYPE`, `PETIT_DEJEUNER`, `SOURCE_RESERVATION`, `PETIT_DEJEUNER_ROUTAGE`, `CHAMBRE_ROUTAGE`, `VENANT_DE`, `SE_RENDANT_A`, `RAISON`, `ROUTAGE`, `ETAT_NOTE_RESERVATION`, `CODE_ENTREPRISE`, `NOM_ENTREPRISE`, `AFFICHER_PRIX`, `DEPOT_DE_GARANTIE`, `DAY_USE`, `MENSUEL`, `BC_ENTREPRISE`, `DATE_DE_CONTROLE`, `TYPE_CHAMBRE`, `FSC`, `BFK_COST`) 
            SELECT `CODE_RESERVATION`, `CLIENT_ID`, `UTILISATEUR_ID`, `CHAMBRE_ID`, `AGENCE_ID`, `NOM_CLIENT`, `DATE_ENTTRE`, `HEURE_ENTREE`, `DATE_SORTIE`, `HEURE_SORTIE`, `ADULTES`, `NB_PERSONNES`, `ENFANTS`, `RECEVOIR_EMAIL`, `RECEVOIR_SMS`, `ETAT_RESERVATION`, `DATE_CREATION`, `HEURE_CREATION`, `MONTANT_TOTAL_CAUTION`, `MOTIF_ETAT`, `DATE_ETAT`, `MONTANT_ACCORDE`, `GROUPE`, `CHECKIN`, `TYPE`, `PETIT_DEJEUNER`,`SOURCE_RESERVATION`,`PETIT_DEJEUNER_ROUTAGE`, `CHAMBRE_ROUTAGE`,`VENANT_DE`,`SE_RENDANT_A`,`RAISON`, `ROUTAGE`,`ETAT_NOTE_RESERVATION`, `CODE_ENTREPRISE`, `NOM_ENTREPRISE`, `AFFICHER_PRIX`, `DEPOT_DE_GARANTIE`, `DAY_USE`, `MENSUEL`, `BC_ENTREPRISE`, `DATE_DE_CONTROLE`, `TYPE_CHAMBRE`, `FSC`, `BFK_COST` FROM " & Table & " WHERE CODE_RESERVATION = @CODE_RESERVATION"

                'duplicate = "INSERT INTO " & Table & " (`CODE_RESERVATION`, `CLIENT_ID`, `UTILISATEUR_ID`, `CHAMBRE_ID`, `AGENCE_ID`, `NOM_CLIENT`, `DATE_ENTTRE`, `HEURE_ENTREE`, `DATE_SORTIE`, `HEURE_SORTIE`, `ADULTES`, `NB_PERSONNES`, `ENFANTS`, `RECEVOIR_EMAIL`, `RECEVOIR_SMS`, `ETAT_RESERVATION`, `DATE_CREATION`, `HEURE_CREATION`, `MONTANT_TOTAL_CAUTION`, `MOTIF_ETAT`, `DATE_ETAT`, `MONTANT_ACCORDE`, `GROUPE`, `CHECKIN`, `TYPE`, `PETIT_DEJEUNER`, `SOLDE_RESERVATION`, `SOURCE_RESERVATION`, `PETIT_DEJEUNER_ROUTAGE`, `CHAMBRE_ROUTAGE`, `VENANT_DE`, `SE_RENDANT_A`, `RAISON`, `ROUTAGE`, `ETAT_NOTE_RESERVATION`, `CODE_ENTREPRISE`, `NOM_ENTREPRISE`, `AFFICHER_PRIX`, `DEPOT_DE_GARANTIE`, `DAY_USE`, `BC_ENTREPRISE`, `DATE_DE_CONTROLE`, `TYPE_CHAMBRE`, `FSC`) 
                '    Select Case`CODE_RESERVATION`, `CLIENT_ID`, `UTILISATEUR_ID`, `CHAMBRE_ID`, `AGENCE_ID`, `NOM_CLIENT`, `DATE_ENTTRE`, `HEURE_ENTREE`, `DATE_SORTIE`, `HEURE_SORTIE`, `ADULTES`, `NB_PERSONNES`, `ENFANTS`, `RECEVOIR_EMAIL`, `RECEVOIR_SMS`, `ETAT_RESERVATION`, `DATE_CREATION`, `HEURE_CREATION`, `MONTANT_TOTAL_CAUTION`, `MOTIF_ETAT`, `DATE_ETAT`, `MONTANT_ACCORDE`, `GROUPE`, `CHECKIN`, `TYPE`, `PETIT_DEJEUNER`, `SOLDE_RESERVATION`,`SOURCE_RESERVATION`,`PETIT_DEJEUNER_ROUTAGE`, `CHAMBRE_ROUTAGE`,`VENANT_DE`,`SE_RENDANT_A`,`RAISON`, `ROUTAGE`,`ETAT_NOTE_RESERVATION`, `CODE_ENTREPRISE`, `NOM_ENTREPRISE`, `AFFICHER_PRIX`, `DEPOT_DE_GARANTIE`, `DAY_USE`, `BC_ENTREPRISE`, `DATE_DE_CONTROLE`, `TYPE_CHAMBRE`, `FSC` FROM " & Table & " WHERE CODE_RESERVATION = @CODE_RESERVATION"

            End If

            Dim command As New MySqlCommand(duplicate, GlobalVariable.connect)

            command.Parameters.Add("@CODE_RESERVATION", MySqlDbType.VarChar).Value = ElementToDuplicate

            'Opening the connection
            'GlobalVariable.connect.openConnection()

            'Excuting the command and testing if everything went on well

            Dim NEW_CODE_RESERVATION As String = ""

            If (command.ExecuteNonQuery() = 1) Then

                '----------------------DEBUT MAIN COURANTE JOURNALIERE-------------------------------------------------
                'We duplicate the mainCourante journaliere related to the reservation after the duplication of the reservation itself
                Dim reservation As New Reservation()

                'UPDATING THE CODE OF THE NEW RESERVATION

                Dim ACTUAL_RESERVATION_ID As Integer = latInsertedElementId(Table, ColumnTitle)

                'MISE DE JOURS DU CODE DE LA RESERVATION INSCRITE PLUS HAUT
                NEW_CODE_RESERVATION = GeneratingRandomCodeWithSpecifications(Table, "RESA")

                reservation.DuplicateReservation(NEW_CODE_RESERVATION, ACTUAL_RESERVATION_ID, Table)

                'ON DOIT EGALEMENT PRENDRE EN COMPTE D'AUTRES PARAMETRES OU SPECIFICITE DE LA RESERVATION 
                '1- LA TAXE DE SEJOURS


            End If

            Dim CODE_RESERVATION As String = ElementToDuplicate
            Dim infoTaxe As DataTable = Functions.getElementByCode(CODE_RESERVATION, "taxe_sejour_collectee", "NUM_RESERVATION")

            If infoTaxe.Rows.Count > 0 Then

                Dim insertQueryTaxe As String = "INSERT INTO `taxe_sejour_collectee` (`CODE_CATEGORIE_HOTEL`, `CODE_CLIENT`, `NUM_RESERVATION`, `NUM_FACTURE`, `CODE_CHAMBRE`, `TAXE_SEJOUR_COLLECTEE`, `DATE_FACTURATION_TAXE`, `DATE_CREATION`, `CODE_UTILISATEUR_CREA`, `CODE_AGENCE`) VALUES (@valu1,@valu2,@valu3,@valu4,@valu5,@valu6,@valu7,@valu8,@valu9,@valu10)"

                Dim commandTaxe As New MySqlCommand(insertQueryTaxe, GlobalVariable.connect)

                commandTaxe.Parameters.Add("@valu1", MySqlDbType.VarChar).Value = GlobalVariable.AgenceActuelle.Rows(0)("CATEGORIE_HOTEL")
                commandTaxe.Parameters.Add("@valu2", MySqlDbType.VarChar).Value = infoTaxe.Rows(0)("CODE_CLIENT")
                commandTaxe.Parameters.Add("@valu3", MySqlDbType.VarChar).Value = NEW_CODE_RESERVATION
                commandTaxe.Parameters.Add("@valu4", MySqlDbType.VarChar).Value = ""
                commandTaxe.Parameters.Add("@valu5", MySqlDbType.VarChar).Value = infoTaxe.Rows(0)("CODE_CHAMBRE")

                commandTaxe.Parameters.Add("@valu6", MySqlDbType.Double).Value = infoTaxe.Rows(0)("TAXE_SEJOUR_COLLECTEE")

                commandTaxe.Parameters.Add("@valu7", MySqlDbType.Date).Value = GlobalVariable.DateDeTravail
                commandTaxe.Parameters.Add("@valu8", MySqlDbType.Date).Value = GlobalVariable.DateDeTravail
                commandTaxe.Parameters.Add("@valu9", MySqlDbType.VarChar).Value = GlobalVariable.codeUser
                commandTaxe.Parameters.Add("@valu10", MySqlDbType.VarChar).Value = GlobalVariable.AgenceActuelle.Rows(0)("CODE_AGENCE")

                commandTaxe.ExecuteNonQuery()

            End If

            If updateRoomStatus Then

                Dim nomDelaTable As String = "reservation"

                Dim nomDuChamp As String = "ETAT_NOTE_RESERVATION"
                Dim ValeurDuChamp As String = "ATTENDUE"
                Dim nomDuChampDuCode As String = "CODE_RESERVATION"
                Dim valeurDuChampDuCode As String = NEW_CODE_RESERVATION
                Dim variableType As Integer = 2

                updateOfFields(nomDelaTable, nomDuChamp, ValeurDuChamp, nomDuChampDuCode, valeurDuChampDuCode, variableType)

                nomDuChamp = "SOLDE_RESERVATION"
                ValeurDuChamp = 0
                variableType = 1
                updateOfFields(nomDelaTable, nomDuChamp, ValeurDuChamp, nomDuChampDuCode, valeurDuChampDuCode, variableType)

                nomDuChamp = "ETAT_RESERVATION"
                ValeurDuChamp = 0
                variableType = 0
                updateOfFields(nomDelaTable, nomDuChamp, ValeurDuChamp, nomDuChampDuCode, valeurDuChampDuCode, variableType)

                nomDuChamp = "CHECKIN"
                ValeurDuChamp = "NON"
                variableType = 2
                updateOfFields(nomDelaTable, nomDuChamp, ValeurDuChamp, nomDuChampDuCode, valeurDuChampDuCode, variableType)

                nomDuChamp = "DATE_ENTTRE"
                ValeurDuChamp = CDate(GlobalVariable.DateDeTravail).ToString("yyyy-MM-dd")

                Dim updateQuery As String = "UPDATE `reservation` SET `DATE_ENTTRE` = @DATE_ENTTRE WHERE CODE_RESERVATION = @CODE_RESERVATION"

                Dim commandupdateQuery As New MySqlCommand(updateQuery, GlobalVariable.connect)

                commandupdateQuery.Parameters.Add("@DATE_ENTTRE", MySqlDbType.Date).Value = ValeurDuChamp
                commandupdateQuery.Parameters.Add("@CODE_RESERVATION", MySqlDbType.VarChar).Value = valeurDuChampDuCode

                commandupdateQuery.ExecuteNonQuery()

            End If

        Next

        'Opening the connection

        'GlobalVariable.connect.closeConnection()

    End Sub

    Public Shared Sub DeleteRowFromDataGrid(ByVal Grid As DataGridView, ByVal ElementToDelete As String, ByVal Table As String, ByVal ColumnTitle As String)

        'Deleting elements from data grid of room categories

        If DeleteElementByCode(Trim(ElementToDelete), Table, ColumnTitle) Then
            DeleteElementByCode(ElementToDelete, "main_courante_journaliere", "NUM_RESERVATION")
            DeleteElementByCode(ElementToDelete, "main_courante", "CODE_RESERVATION")
            DeleteElementByCode(ElementToDelete, "main_courante_generale", "NUM_RESERVATION")
        End If

    End Sub

    Public Shared Sub DeleteRowFromDataGridGeneral(ByVal Grid As DataGridView, ByVal ElementToDelete As String, ByVal Table As String, ByVal ColumnTitle As String)

        'Deleting elements from data grid of room categories
        For Each row As DataGridViewRow In Grid.SelectedRows

            If DeleteElementByCode(ElementToDelete, Table, ColumnTitle) Then

            End If

        Next

    End Sub

    Public Shared Sub DeleteRowFromDataGridGeneral(ByVal Grid As DataGridView, ByVal ElementToDelete As String, ByVal Table As String, ByVal ColumnTitle As String, ByVal ColumnTitle2 As String, ByVal Condition As String)

        'Deleting elements from data grid of room categories
        For Each row As DataGridViewRow In Grid.SelectedRows

            If DeleteElementByCode(ElementToDelete, Table, ColumnTitle, ColumnTitle2, Condition) Then

            End If

        Next

    End Sub

    Public Shared Sub DeleteRowFromDataGridGeneralFacturationLine(ByVal Grid As DataGridView, ByVal ElementToDelete As String, ByVal Table As String, ByVal ColumnTitle As String, ByVal ElementToDeleteSecondValue As String, ByVal ColumnTitle2 As String)

        'Deleting elements from data grid of ligne_facture_temp
        For Each row As DataGridViewRow In Grid.SelectedRows

            If DeleteElementByCodeAndOtherCondition(ElementToDelete, Table, ColumnTitle, ElementToDeleteSecondValue, ColumnTitle2) Then

            End If

        Next

    End Sub

    'Montant sans taxe
    Public Shared Function prelevementDeTaxeSurUnMontant(ByVal montantAprelever As Double) As Double
        'retourne la valeur du montant avec la tva prélévée
        'Return montantAprelever - (GlobalVariable.societe.Rows(0)("TAUX_TVA") / 100 * montantAprelever)

        Return (montantAprelever / (GlobalVariable.societe.Rows(0)("TAUX_TVA") / 100 + 1))

    End Function

    'Montant sans taxe
    Public Shared Function NonprelevementDeTaxeSurUnMontant(ByVal montantAprelever As Double) As Double
        'retourne la valeur du montant avec la tva prélévée
        Return montantAprelever

    End Function

    'taxe sur le montant
    Public Shared Function prelevementDeTaxeSurUnMontantPOurCalcul(ByVal montantAprelever As Double) As Double
        'retourne la valeur de la tva

        Dim montantHt As Double = 0

        montantHt = (montantAprelever / (GlobalVariable.societe.Rows(0)("TAUX_TVA") / 100 + 1))

        Return (montantAprelever - montantHt)

    End Function

    'IMPRESSION DES DOCUMENTS REGLEMENT ET FACTURE

    Public Shared Function NumberToTextEnglish(ByVal n As Integer) As String

        Select Case n
            Case 0
                Return ""

            Case 1 To 19
                Dim arr() As String = {"One", "Two", "Three", "Four", "Five", "Six", "Seven", "Eight", "Nine", "Ten", "Eleven", "Twelve", "Thirteen", "Fourteen", "Fifteen", "Sixteen", "Seventeen", "Eighteen", "Nineteen"}
                Return arr(n - 1) & " "

            Case 20 To 99
                Dim arr() As String = {"Twenty", "Thirty", "Forty", "Fifty", "Sixty", "Seventy", "Eighty", "Ninety"}
                Return arr(n \ 10 - 2) & " " & NumberToTextEnglish(n Mod 10)

            Case 100 To 199
                Return "One Hundred " & NumberToTextEnglish(n Mod 100)

            Case 200 To 999
                Return NumberToTextEnglish(n \ 100) & "Hundreds " & NumberToTextEnglish(n Mod 100)

            Case 1000 To 1999
                Return "One Thousand " & NumberToTextEnglish(n Mod 1000)

            Case 2000 To 999999
                Return NumberToTextEnglish(n \ 1000) & "Thousands " & NumberToTextEnglish(n Mod 1000)

            Case 1000000 To 1999999
                Return "One Million " & NumberToTextEnglish(n Mod 1000000)

            Case 1000000 To 999999999
                Return NumberToTextEnglish(n \ 1000000) & "Millions " & NumberToTextEnglish(n Mod 1000000)

            Case 1000000000 To 1999999999
                Return "One Billion " & NumberToTextEnglish(n Mod 1000000000)

            Case Else
                Return NumberToTextEnglish(n \ 1000000000) & "Billion " _
    & NumberToTextEnglish(n Mod 1000000000)
        End Select

    End Function

    Public Shared Sub DocumentToPrintSynthese(ByVal ElementToDuplicate As String, ByVal Table As String, ByVal ColumnTitle As String, ByVal client As String, Optional ByVal reservationNum As String = "")

        Dim CODE_FACTURE As String = ElementToDuplicate
        Dim CODE_RESERVATION As String = ""

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0
        'Dim totalNormal As Double = 0
        Dim totalTVA As Double = 0
        Dim TAxeSejour As Double = 0
        Dim SoldeNet As Double = 0
        Dim TotalVersement As Double = 0

        Dim dt As DataTable
        Dim elements As DataTable
        Dim dtReg As DataTable

        Dim tousLesElemetsDeFacture As New DataTable()

        tousLesElemetsDeFacture.Columns.Add("DATE_ELEMENT", GetType(Date))
        tousLesElemetsDeFacture.Columns.Add("LIBELLE")
        tousLesElemetsDeFacture.Columns.Add("QUANTITE")
        tousLesElemetsDeFacture.Columns.Add("MONTANT")

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        Dim exonere As Boolean = False

        If Not Trim(GlobalVariable.codeReservationToUpdate).Equals("") Then
            'SI LE CODE DE RESERVATION EXISTE
            exonere = Functions.exonereDelaTVAComplet(GlobalVariable.codeReservationToUpdate)
        Else

            'SI LE CODE DE RESERVATION N'EXISTE PAS ON DOIT LE TROUVER DANS LA RESERVATIONS
            'Dim CODE_FACTURE As String = ElementToDuplicate

            Dim infoSupFacture As DataTable = Functions.getElementByCode(CODE_FACTURE, "facture", "CODE_FACTURE")

            If infoSupFacture.Rows.Count > 0 Then
                CODE_RESERVATION = infoSupFacture.Rows(0)("CODE_RESERVATION")
                exonere = Functions.exonereDelaTVAComplet(CODE_RESERVATION)
            End If

        End If

        If GlobalVariable.DocumentToGenerate = "facture" Then


            tireDocument = "FACTURE N° : "
            titreFichier = "FACTURE DE "

            'dt = GetAllElementsOnCondition(ElementToDuplicate, "ligne_facture", "CODE_FACTURE")

            dtReg = GetAllElementsOnCondition(ElementToDuplicate, "reglement", "NUM_FACTURE")

            Dim getUserQuery = "SELECT DISTINCT TYPE_LIGNE_FACTURE FROM ligne_facture WHERE CODE_FACTURE=@CODE_FACTURE AND TYPE_LIGNE_FACTURE IN ('ACCOMMODATION','HEBERGEMENT','TAXE DE SEJOURS', 'LOCATION SALLE') ORDER BY TYPE_LIGNE_FACTURE ASC"
            Dim command As New MySqlCommand(getUserQuery, GlobalVariable.connect)

            command.Parameters.Add("@CODE_FACTURE", MySqlDbType.VarChar).Value = ElementToDuplicate

            Dim adapter As New MySqlDataAdapter

            Dim famille As New DataTable()

            adapter.SelectCommand = command
            adapter.Fill(famille)

            For k = 0 To famille.Rows.Count - 1

                Dim totalMontantFamille As Double = 0
                Dim totalQteFamille As Double = 0

                Dim LIBELLE As String = famille.Rows(k)("TYPE_LIGNE_FACTURE").ToString.ToUpper()

                dt = Functions.GetAllElementsOnTwoConditions(LIBELLE, "ligne_facture", "TYPE_LIGNE_FACTURE", ElementToDuplicate, "CODE_FACTURE")

                If dt.Rows.Count > 0 Then

                    For i = 0 To dt.Rows.Count - 1

                        totalQteFamille += dt.Rows(i)("QUANTITE")
                        totalMontantFamille += dt.Rows(i)("MONTANT_TTC")

                        If Not LIBELLE.Contains("TAXE DE SEJOUR") Then
                            TotalFacture += NonprelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT_TTC")) 'calcul de la somme apres prelevement de la taxe
                            totalTVA += Functions.prelevementDeTaxeSurUnMontantPOurCalcul(dt.Rows(i)("MONTANT_TTC")) 'calcul de la somme des taxes prelevees
                        Else

                            If LIBELLE.Contains("TAXE DE SEJOUR") Then
                                TAxeSejour += Functions.NonprelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT_TTC"))
                            End If

                        End If

                    Next

                    tousLesElemetsDeFacture.Rows.Add(GlobalVariable.DateDeTravail.ToShortDateString, LIBELLE, totalQteFamille, totalMontantFamille)

                End If

            Next

            '------------------------------------------------------------------------------

            Dim getUserQuery_ = "SELECT DISTINCT CODE_ARTICLE FROM ligne_facture WHERE CODE_FACTURE=@CODE_FACTURE AND TYPE_LIGNE_FACTURE NOT IN ('ACCOMMODATION','HEBERGEMENT','TAXE DE SEJOURS', 'LOCATION SALLE') ORDER BY TYPE_LIGNE_FACTURE ASC"
            Dim command_ As New MySqlCommand(getUserQuery_, GlobalVariable.connect)

            command_.Parameters.Add("@CODE_FACTURE", MySqlDbType.VarChar).Value = ElementToDuplicate

            Dim adapter_ As New MySqlDataAdapter

            Dim famille_ As New DataTable()

            adapter_.SelectCommand = command_
            adapter_.Fill(famille_)

            For k = 0 To famille_.Rows.Count - 1

                Dim totalMontantFamille As Double = 0
                Dim totalQteFamille As Double = 0

                Dim CODE_ARTICLE As String = famille_.Rows(k)("CODE_ARTICLE").ToString.ToUpper()

                dt = Functions.GetAllElementsOnTwoConditions(CODE_ARTICLE, "ligne_facture", "CODE_ARTICLE", ElementToDuplicate, "CODE_FACTURE")

                Dim infoSupArticle As DataTable = Functions.getElementByCode(CODE_ARTICLE, "article", "CODE_ARTICLE")

                Dim LIBELLE As String = ""

                If infoSupArticle.Rows.Count > 0 Then
                    LIBELLE = infoSupArticle.Rows(0)("DESIGNATION_FR")
                End If

                If dt.Rows.Count > 0 Then

                    For i = 0 To dt.Rows.Count - 1

                        totalQteFamille += dt.Rows(i)("QUANTITE")
                        totalMontantFamille += dt.Rows(i)("MONTANT_TTC")

                        If Not LIBELLE.Contains("TAXE DE SEJOUR") Then
                            TotalFacture += NonprelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT_TTC")) 'calcul de la somme apres prelevement de la taxe
                            totalTVA += Functions.prelevementDeTaxeSurUnMontantPOurCalcul(dt.Rows(i)("MONTANT_TTC")) 'calcul de la somme des taxes prelevees
                        Else

                            If LIBELLE.Contains("TAXE DE SEJOUR") Then
                                TAxeSejour += Functions.NonprelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT_TTC"))
                            End If

                        End If

                    Next

                    tousLesElemetsDeFacture.Rows.Add(GlobalVariable.DateDeTravail.ToShortDateString, LIBELLE, totalQteFamille, totalMontantFamille)

                End If

            Next

            '-------------------------------------------------------------------------------

            If exonere Then
                totalTVA = 0
            End If

            If dtReg.Rows.Count > 0 Then

                Dim n As Integer = 0

                Dim qteReglement As Integer = dtReg.Rows.Count

                For i = 0 To dtReg.Rows.Count - 1

                    TotalVersement += Functions.NonprelevementDeTaxeSurUnMontant(dtReg.Rows(i)("MONTANT_VERSE"))

                    n = i + 1

                Next

                tousLesElemetsDeFacture.Rows.Add(GlobalVariable.DateDeTravail.ToShortDateString, "ENCAISSEMENT", qteReglement, TotalVersement * -1)

            End If

        ElseIf GlobalVariable.DocumentToGenerate = "reglement" Then

            tireDocument = "RECU N° : "
            titreFichier = "RECU DE "

            dtReg = GetAllElementsOnCondition(ElementToDuplicate, "reglement", "NUM_REGLEMENT")

            If dtReg.Rows.Count > 0 Then

                Dim n As Integer = 0

                For i = 0 To dtReg.Rows.Count - 1

                    TotalFacture += dtReg.Rows(i)("MONTANT_VERSE")

                    tousLesElemetsDeFacture.Rows.Add(CDate(dtReg.Rows(i)("DATE_REGLEMENT").ToShortDateString), dtReg.Rows(i)("REF_REGLEMENT").ToString, dtReg.Rows(i)("QUANTITE"), dtReg.Rows(i)("MONTANT_VERSE"))

                Next

            End If

        End If

        If tousLesElemetsDeFacture.Rows.Count > 0 Then
            'REORGANISATION PAR ORDRE DE DATE DECROISSANTE
            elements = chargementTemporaireDesElementsDeFacturePourImpression(tousLesElemetsDeFacture)
        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        Dim nomClient As String = ""

        Dim reservationToPrint As DataTable = Functions.getElementByCode(reservationNum, "reserve_conf", "CODE_RESERVATION")

        If reservationToPrint.Rows.Count > 0 Then

            If Not Trim(GlobalVariable.ReservationToUpdate(0)("CODE_ENTREPRISE")) = "" Then
                nomClient = GlobalVariable.ReservationToUpdate(0)("NOM_ENTREPRISE") & " ( " & GlobalVariable.ReservationToUpdate(0)("NOM_CLIENT") & " )"
            ElseIf getElementByCode(client, "client", "CODE_CLIENT").Rows.Count > 0 Then
                nomClient = getElementByCode(client, "client", "CODE_CLIENT").Rows(0)("NOM_PRENOM")
            End If

        Else

            If getElementByCode(client, "client", "CODE_CLIENT").Rows.Count > 0 Then
                nomClient = getElementByCode(client, "client", "CODE_CLIENT").Rows(0)("NOM_PRENOM")
            End If

        End If

        sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 60)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))

            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim pdfTable As New PdfPTable(4) 'Number of columns
            pdfTable.TotalWidth = 530.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single() = New Single() {1.0F, 6.5F, 0.6F, 1.5F}

            pdfTable.SetWidths(widths)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim Date_facture_reglement As Date = GlobalVariable.DateDeTravail

            If GlobalVariable.DocumentToGenerate = "reglement" Then

                Dim infoSup As DataTable = Functions.getElementByCode(ElementToDuplicate, "reglement", "NUM_REGLEMENT")

                If infoSup.Rows.Count > 0 Then
                    Date_facture_reglement = CDate(infoSup.Rows(0)("DATE_REGLEMENT")).ToShortDateString
                End If

            ElseIf GlobalVariable.DocumentToGenerate = "facture" Then

                Dim infoSup As DataTable = Functions.getElementByCode(ElementToDuplicate, "facture", "CODE_FACTURE")

                If infoSup.Rows.Count > 0 Then
                    Date_facture_reglement = CDate(infoSup.Rows(0)("DATE_FACTURE")).ToShortDateString
                End If

            End If

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & Chr(13) & tireDocument & ElementToDuplicate & Chr(13) & "DATE : " & Date_facture_reglement & Chr(13), pColumn)
            p10.Alignment = Element.ALIGN_LEFT

            pdfDoc.Add(p10)

            Dim termes As String = ""

            Dim clientInformation As DataTable

            'If GlobalVariable.typeDeClientAFacturer = "en chambre" Then

            'SI ON TRAITE UNE RESERVATION

            If Not Trim(reservationNum).Equals("") Then

                If Not Trim(GlobalVariable.ReservationToUpdate(0)("CODE_ENTREPRISE")) = "" Then
                    clientInformation = Functions.getElementByCode(GlobalVariable.ReservationToUpdate(0)("CODE_ENTREPRISE"), "client", "CODE_CLIENT")
                Else
                    clientInformation = Functions.getElementByCode(client, "client", "CODE_CLIENT")
                End If

                If Not Trim(GlobalVariable.ReservationToUpdate(0)("CODE_ENTREPRISE")) = "" Then

                    If clientInformation.Rows.Count > 0 Then

                        termes = Chr(13) & "NOM DU CLIENT : " & clientInformation.Rows(0)("NOM_PRENOM") & "(" & GlobalVariable.ReservationToUpdate(0)("NOM_CLIENT") & ")" & Chr(13) & clientInformation.Rows(0)("NOM_JEUNE_FILLE") & Chr(13) & clientInformation.Rows(0)("PRENOMS") & Chr(13) & "CHAMBRE N° : " & GlobalVariable.ReservationToUpdate(0)("CHAMBRE_ID") & Chr(13) & "RESERVATION N° : " & GlobalVariable.codeReservationToUpdate & Chr(13) & Chr(13)

                    End If

                Else

                    If clientInformation.Rows.Count > 0 Then
                        termes = Chr(13) & "NOM DU CLIENT : " & nomClient & Chr(13) & "CHAMBRE N° : " & GlobalVariable.ReservationToUpdate(0)("CHAMBRE_ID") & Chr(13) & "RESERVATION N° : " & GlobalVariable.codeReservationToUpdate & Chr(13) & Chr(13)
                    End If

                End If

            Else
                termes = Chr(13) & "NOM DU CLIENT : " & nomClient & Chr(13) & Chr(13)
            End If

            pdfDoc.Add(New Paragraph(termes, pRow))

            pdfCell = New PdfPCell(New Paragraph("DATE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            If tousLesElemetsDeFacture.Rows.Count > 0 Then

                For i = 0 To tousLesElemetsDeFacture.Rows.Count - 1

                    If GlobalVariable.DocumentToGenerate = "facture" Then

                        pdfCell = New PdfPCell(New Paragraph("-", font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(elements.Rows(i)("LIBELLE_ELEMENT"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(elements.Rows(i)("QUANTITE"), "#,##0"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfTable.AddCell(pdfCell)

                        'On ne preleve pas de taxe sur les taxes de sejours

                        Dim LIBELLE_TAXE As String = "TAXE DE SEJOUR"
                        Dim LIBELLE_FACTURE As String = elements.Rows(i)("LIBELLE_ELEMENT").ToString.ToUpper()

                        If Not LIBELLE_FACTURE.Contains(LIBELLE_TAXE) Then
                            'pdfCell = New PdfPCell(New Paragraph(Format(prelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT_TTC") * -1), "#,##0"), font1))
                            pdfCell = New PdfPCell(New Paragraph(Format(NonprelevementDeTaxeSurUnMontant(elements.Rows(i)("MONTANT") * -1), "#,##0"), font1))
                        Else
                            pdfCell = New PdfPCell(New Paragraph(Format(NonprelevementDeTaxeSurUnMontant(elements.Rows(i)("MONTANT") * -1), "#,##0"), font1))
                        End If

                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.AddCell(pdfCell)

                    ElseIf GlobalVariable.DocumentToGenerate = "reglement" Then

                        pdfCell = New PdfPCell(New Paragraph(CDate(elements.Rows(i)("DATE_ELEMT")).ToShortDateString, font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(elements.Rows(i)("LIBELLE_ELEMENT"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(elements.Rows(i)("QUANTITE"), "#,##0"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(elements.Rows(i)("MONTANT"), "#,##0"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.AddCell(pdfCell)

                    End If

                Next

                pdfDoc.Add(pdfTable)

                '------------------------------------------------------------------------

                If GlobalVariable.DocumentToGenerate = "reglement" Then

                    Dim pdfTable2 As New PdfPTable(4) 'Number of columns

                    pdfTable2.TotalWidth = 530.0F
                    pdfTable2.LockedWidth = True
                    pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                    'pdfTable2.HeaderRows = 1

                    'Dim widths2 As Single() = New Single() {5.8F, 1.8F}
                    Dim widths2 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                    pdfTable2.SetWidths(widths2)

                    Dim pdfCell2 As PdfPCell = Nothing

                    If GlobalVariable.DocumentToGenerate = "reglement" Then
                        pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & "TOTAL : ", fontTotal))
                    Else
                        pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & "TOTAL HT : ", fontTotal))
                    End If

                    pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell2.MinimumHeight = 18
                    pdfCell2.PaddingLeft = 15.0F
                    pdfCell2.Border = 0
                    pdfCell2.Colspan = 3

                    pdfTable2.AddCell(pdfCell2)

                    pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & Format(TotalFacture, "#,##0"), fontTotal))
                    pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell2.MinimumHeight = 18
                    pdfCell2.PaddingLeft = 5.0F
                    pdfCell2.Border = 0
                    pdfTable2.AddCell(pdfCell2)

                    pdfDoc.Add(pdfTable2)

                    '-----------------------------------
                End If


                If Not GlobalVariable.DocumentToGenerate = "reglement" Then

                    Dim TVA As Double = 0

                    If Not exonere Then

                        If societe.Rows(0)("TAUX_TVA") > 0 Then
                            TVA = totalTVA
                        Else
                            TVA = 0
                        End If

                    End If

                    '----------------------------- TOTAL HT -----------------------------------
                    Dim pdfTable06 As New PdfPTable(4)

                    pdfTable06.TotalWidth = 530.0F
                    pdfTable06.LockedWidth = True
                    pdfTable06.HorizontalAlignment = Element.ALIGN_RIGHT

                    Dim widths06 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                    pdfTable06.SetWidths(widths06)

                    Dim pdfCell06 As PdfPCell = Nothing

                    '------------------------------ DEBUT RECAPITULATIF OU BILAN ------------------------------------

                    pdfCell06 = New PdfPCell(New Paragraph("", fontTotal))
                    pdfCell06.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell06.MinimumHeight = 18
                    pdfCell06.PaddingLeft = 15.0F
                    pdfCell06.Colspan = 4
                    pdfCell06.Border = 0
                    pdfTable06.AddCell(pdfCell06)

                    pdfCell06 = New PdfPCell(New Paragraph("TOTAL HT : ", fontTotal))
                    pdfCell06.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell06.MinimumHeight = 18
                    pdfCell06.PaddingLeft = 15.0F
                    pdfCell06.Colspan = 3
                    pdfCell06.Border = 0
                    pdfTable06.AddCell(pdfCell06)

                    Dim TAXE_SEJOUR As Double = 0

                    pdfCell06 = New PdfPCell(New Paragraph(Format(TotalFacture - TVA, "#,##0"), fontTotal))
                    pdfCell06.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell06.MinimumHeight = 18
                    pdfCell06.PaddingLeft = 5.0F
                    pdfCell06.Border = 0
                    pdfTable06.AddCell(pdfCell06)

                    pdfDoc.Add(pdfTable06)

                    '--------------------------------------------------------------------------

                    If TAxeSejour >= 0 Then

                        Dim pdfTable6 As New PdfPTable(4) 'Number of columns

                        pdfTable6.TotalWidth = 530.0F
                        pdfTable6.LockedWidth = True
                        pdfTable6.HorizontalAlignment = Element.ALIGN_RIGHT
                        'pdfTable4.HeaderRows = 1

                        Dim widths6 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                        pdfTable6.SetWidths(widths6)

                        Dim pdfCell6 As PdfPCell = Nothing

                        pdfCell6 = New PdfPCell(New Paragraph("TAXE DE SEJOURS : ", fontTotal))
                        pdfCell6.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell6.MinimumHeight = 18
                        pdfCell6.PaddingLeft = 15.0F
                        pdfCell6.Colspan = 3
                        pdfCell6.Border = 0
                        pdfTable6.AddCell(pdfCell6)

                        'Dim TAXE_SEJOUR As Double = 0

                        pdfCell6 = New PdfPCell(New Paragraph(Format(TAxeSejour, "#,##0"), fontTotal))
                        pdfCell6.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell6.MinimumHeight = 18
                        pdfCell6.PaddingLeft = 5.0F
                        pdfCell6.Border = 0
                        pdfTable6.AddCell(pdfCell6)

                        pdfDoc.Add(pdfTable6)

                    End If

                    If TVA > 0 Then

                        Dim pdfTable4 As New PdfPTable(4) 'Number of columns

                        pdfTable4.TotalWidth = 530.0F
                        pdfTable4.LockedWidth = True
                        pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
                        'pdfTable4.HeaderRows = 1

                        Dim widths4 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                        pdfTable4.SetWidths(widths4)

                        Dim pdfCell4 As PdfPCell = Nothing

                        pdfCell4 = New PdfPCell(New Paragraph("TVA : ", fontTotal))
                        pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell4.MinimumHeight = 18
                        pdfCell4.PaddingLeft = 15.0F
                        pdfCell4.Border = 0
                        pdfCell4.Colspan = 3
                        pdfTable4.AddCell(pdfCell4)

                        pdfCell4 = New PdfPCell(New Paragraph(Format(TVA, "#,##0"), fontTotal))
                        pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell4.MinimumHeight = 18
                        pdfCell4.PaddingLeft = 5.0F
                        pdfCell4.Border = 0
                        pdfTable4.AddCell(pdfCell4)

                        pdfDoc.Add(pdfTable4)

                        '-----------------------------------
                        Dim pdfTable3 As New PdfPTable(4) 'Number of columns

                        pdfTable3.TotalWidth = 530.0F
                        pdfTable3.LockedWidth = True
                        pdfTable3.HorizontalAlignment = Element.ALIGN_RIGHT
                        'pdfTable3.HeaderRows = 1

                        Dim widths3 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                        pdfTable3.SetWidths(widths3)

                        Dim pdfCell3 As PdfPCell = Nothing

                        pdfCell3 = New PdfPCell(New Paragraph("", fontTotal))
                        pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell3.MinimumHeight = 18
                        pdfCell3.PaddingLeft = 15.0F
                        pdfCell3.Border = 0
                        pdfCell3.Colspan = 3
                        pdfTable3.AddCell(pdfCell3)

                        pdfCell3 = New PdfPCell(New Paragraph("----------------", fontTotal))
                        pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell3.MinimumHeight = 18
                        pdfCell3.PaddingLeft = 15.0F
                        pdfCell3.Border = 0
                        'pdfCell3.Colspan = 3
                        pdfTable3.AddCell(pdfCell3)

                        pdfCell3 = New PdfPCell(New Paragraph("TOTAL TTC : ", fontTotal))
                        pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell3.MinimumHeight = 18
                        pdfCell3.PaddingLeft = 15.0F
                        pdfCell3.Border = 0
                        pdfCell3.Colspan = 3
                        pdfTable3.AddCell(pdfCell3)

                        'Dim TotalTTC As Double = (TotalFacture * 0.1925) + TotalFacture

                        'pdfCell3 = New PdfPCell(New Paragraph(Format(TotalTTC, "#,##0"), fontTotal))
                        pdfCell3 = New PdfPCell(New Paragraph(Format(TotalFacture + TAxeSejour, "#,##0"), fontTotal))
                        pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell3.MinimumHeight = 18
                        pdfCell3.PaddingLeft = 5.0F
                        pdfCell3.Border = 0
                        pdfTable3.AddCell(pdfCell3)

                        pdfDoc.Add(pdfTable3)

                        '---------------------------------------END INFO TVA --------------------------

                    Else

                        '-----------------------------------
                        Dim pdfTable3 As New PdfPTable(4) 'Number of columns

                        pdfTable3.TotalWidth = 530.0F
                        pdfTable3.LockedWidth = True
                        pdfTable3.HorizontalAlignment = Element.ALIGN_RIGHT
                        'pdfTable3.HeaderRows = 1

                        Dim widths3 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                        pdfTable3.SetWidths(widths3)

                        Dim pdfCell3 As PdfPCell = Nothing

                        pdfCell3 = New PdfPCell(New Paragraph("", fontTotal))
                        pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell3.MinimumHeight = 18
                        pdfCell3.PaddingLeft = 15.0F
                        pdfCell3.Border = 0
                        pdfCell3.Colspan = 3
                        pdfTable3.AddCell(pdfCell3)

                        pdfCell3 = New PdfPCell(New Paragraph("----------------", fontTotal))
                        pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell3.MinimumHeight = 18
                        pdfCell3.PaddingLeft = 15.0F
                        pdfCell3.Border = 0
                        'pdfCell3.Colspan = 3
                        pdfTable3.AddCell(pdfCell3)

                        pdfCell3 = New PdfPCell(New Paragraph("TOTAL : ", fontTotal))
                        pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell3.MinimumHeight = 18
                        pdfCell3.PaddingLeft = 15.0F
                        pdfCell3.Border = 0
                        pdfCell3.Colspan = 3
                        pdfTable3.AddCell(pdfCell3)

                        pdfCell3 = New PdfPCell(New Paragraph(Format(TotalFacture + TAxeSejour, "#,##0"), fontTotal))
                        pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell3.MinimumHeight = 18
                        pdfCell3.PaddingLeft = 5.0F
                        pdfCell3.Border = 0
                        pdfTable3.AddCell(pdfCell3)

                        pdfDoc.Add(pdfTable3)

                        '---------------------------------------END INFO TVA --------------------------

                    End If

                    Dim pdfTable7 As New PdfPTable(4) 'Number of columns

                    pdfTable7.TotalWidth = 530.0F
                    pdfTable7.LockedWidth = True
                    pdfTable7.HorizontalAlignment = Element.ALIGN_RIGHT
                    'pdfTable7.HeaderRows = 1

                    Dim widths7 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                    pdfTable7.SetWidths(widths7)

                    Dim pdfCell7 As PdfPCell = Nothing

                    SoldeNet = TotalVersement - (TotalFacture + TAxeSejour)

                    Dim terme As String = ""

                    If SoldeNet > 0 Then
                        terme = "FAVEUR CLIENT : "
                    ElseIf SoldeNet = 0 Then
                        terme = "SOLDE NUL : "
                    ElseIf 0 > SoldeNet Then
                        terme = "A REGLER : "
                    End If

                    pdfCell7 = New PdfPCell(New Paragraph(terme, fontTotal))
                    pdfCell7.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell7.MinimumHeight = 18
                    pdfCell7.PaddingLeft = 15.0F
                    pdfCell7.Colspan = 3
                    pdfCell7.Border = 0
                    pdfTable7.AddCell(pdfCell7)

                    If SoldeNet < 0 Then
                        'SoldeNet *= -1
                    End If

                    pdfCell7 = New PdfPCell(New Paragraph(Format(SoldeNet, "#,##0"), fontTotal))
                    pdfCell7.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell7.MinimumHeight = 18
                    pdfCell7.PaddingLeft = 5.0F
                    pdfCell7.Border = 0
                    pdfTable7.AddCell(pdfCell7)

                    pdfDoc.Add(pdfTable7)

                    '----------------------------------------

                    Dim chiffreEnLettre = New Paragraph(Chr(13) & Chr(13) & "Arrêter la présente à la somme de: " & NBLT(TotalFacture + TAxeSejour) & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE"), pRow)

                    pdfDoc.Add(chiffreEnLettre)

                    '----------------------------------------------- DETAILS DU GROUPE -------------------------------------------------------------------------------

                    Dim totalSejour As Double = 0

                    Dim dateEntree As Date
                    Dim dateSortie As Date

                    Dim nbreNuitee As Integer = 0
                    Dim nbreNuiteeTotal As Integer = 0

                    'Recherchons toutes les lignes associées a un groupe

                    'ON RECHERCHE SI LA RESERVATION ASSOCIE A LA FACTURE N'EST PAS ASSOCIE A UN NUMERO DE GROUPE
                    Dim signature_ = New Paragraph(Chr(13) & Chr(13) & "             SIGNATURE DU CLIENT                                                            SIGNATURE DE L'HOTEL", pRow)

                    pdfDoc.Add(signature_)

                    pdfDoc.NewPage()

                    pdfWrite.PageEvent = New HeaderFooter

                    Dim infoSupResa As DataTable = Functions.getElementByCode(CODE_RESERVATION, "reserve_conf", "CODE_RESERVATION")
                    Dim GROUPE As String = ""

                    If infoSupResa.Rows.Count > 0 Then
                        GROUPE = infoSupResa.Rows(0)("GROUPE")
                    End If

                    If Not Trim(GROUPE).Equals("") Then

                        Dim dt_ As DataTable = reservationDunGroupe(GROUPE, "reserve_conf")

                        If dt_.Rows.Count > 0 Then

                            Dim termes_ As String = Chr(13) & " ROOM LIST DE LA FACTURE N° : " & ElementToDuplicate & Chr(13) & Chr(13)
                            pdfDoc.Add(New Paragraph(termes_, pRow))

                            'Dim pdfTable_ As New PdfPTable(6) 'Number of columns
                            Dim pdfTable_ As New PdfPTable(5) 'Number of columns
                            pdfTable_.TotalWidth = 530.0F
                            pdfTable_.LockedWidth = True
                            pdfTable_.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable_.HeaderRows = 1

                            ' Dim widths_ As Single() = New Single() {5.0F, 1.7F, 1.7F, 1.2F, 1.5F, 1.5F}
                            Dim widths_ As Single() = New Single() {5.0F, 20.0F, 8.0F, 8.0F, 5.0F}

                            pdfTable_.SetWidths(widths_)

                            pdfCell = New PdfPCell(New Paragraph("CH.", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable_.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("NOM", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable_.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable_.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable_.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("NUITEES", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable_.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("TARIF", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            'pdfTable_.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            'pdfTable_.AddCell(pdfCell)

                            Dim montantAccorde As Double = 0
                            Dim TotalFactureGroupe As Double = 0
                            Dim totalNuitee As Integer = 0

                            For i = 0 To dt_.Rows.Count - 1

                                dateEntree = CDate(dt_.Rows(i)("DATE ENTREE")).ToShortDateString
                                dateSortie = CDate(dt_.Rows(i)("DATE SORTIE")).ToShortDateString

                                pdfCell = New PdfPCell(New Paragraph(dt_.Rows(i)("CHAMBRE"), font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfTable_.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(dt_.Rows(i)("NOM CLIENT"), font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfTable_.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(dateEntree, font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfTable_.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(dateSortie, font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfTable_.AddCell(pdfCell)

                                montantAccorde = dt_.Rows(i)("PRIX/NUITEE")
                                nbreNuitee = CType((dateSortie - dateEntree).TotalDays, Int32)

                                totalNuitee += nbreNuitee

                                totalSejour = nbreNuitee * montantAccorde

                                pdfCell = New PdfPCell(New Paragraph(nbreNuitee, font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfTable_.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(montantAccorde, "#,##0"), font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                'pdfTable_.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(totalSejour, "#,##0"), font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                'pdfTable_.AddCell(pdfCell)

                                TotalFactureGroupe += totalSejour

                            Next

                            pdfCell = New PdfPCell(New Paragraph(dt_.Rows.Count, pColumn))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            'pdfCell.Border = 0
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable_.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("", font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.Colspan = 3
                            pdfCell.Border = 0
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable_.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(totalNuitee, "#,##0"), pColumn))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            'pdfCell.Border = 0
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable_.AddCell(pdfCell)

                            pdfDoc.Add(pdfTable_)

                        End If

                    End If

                    '-------------------------------------------------------------------------------------------------------------------------------------------------

                Else

                    Dim chiffreEnLettre = New Paragraph(Chr(13) & Chr(13) & "Reçu la somme de : " & NBLT(TotalFacture + TAxeSejour) & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE"), pRow)

                    pdfDoc.Add(chiffreEnLettre)

                End If

                Dim signature = New Paragraph(Chr(13) & Chr(13) & "             SIGNATURE DU CLIENT                                                            SIGNATURE DE L'HOTEL", pRow)

                pdfDoc.Add(signature)

            Else

                MessageBox.Show("Aucune Ligne de Fatcure à imprimer!")

            End If


            ' ------------------------------------------------------------------------------------------------

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Function reservationDunGroupe(ByVal GROUPE As String, ByVal tableName As String) As DataTable

        Dim query As String = ""

        query = "SELECT NOM_CLIENT As 'NOM CLIENT', CHAMBRE_ID AS 'CHAMBRE',DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',ETAT_NOTE_RESERVATION AS 'STATUT',NB_PERSONNES As 'PERSONNE(S)', GROUPE, CODE_ENTREPRISE, NOM_ENTREPRISE FROM " & tableName & " WHERE GROUPE =@GROUPE ORDER BY CHAMBRE_ID ASC"

        'On Affiche toute reservation dont la date d'entree figure entre les deux dates saisies

        Dim command As New MySqlCommand(query, GlobalVariable.connect)
        command.Parameters.Add("@GROUPE", MySqlDbType.VarChar).Value = GROUPE

        Dim adapter As New MySqlDataAdapter(command)
        Dim table As New DataTable()
        adapter.Fill(table)

        Return table

    End Function

    Public Shared Function infoChambres(ByVal CHAMBRE As String)

        Dim query As String = ""

        query = "SELECT LIBELLE_TYPE_CHAMBRE, type_chambre.PRIX, CODE_CHAMBRE
        FROM chambre, type_chambre WHERE chambre.CODE_TYPE_CHAMBRE = type_chambre.CODE_TYPE_CHAMBRE AND chambre.CODE_CHAMBRE =@CHAMBRE"

        'On Affiche toute reservation dont la date d'entree figure entre les deux dates saisies

        Dim command As New MySqlCommand(query, GlobalVariable.connect)
        command.Parameters.Add("@CHAMBRE", MySqlDbType.VarChar).Value = CHAMBRE

        Dim adapter As New MySqlDataAdapter(command)
        Dim table As New DataTable()
        adapter.Fill(table)

        Return table

    End Function

    Public Shared Sub DocumentToPrintComptoire(ByVal ElementToDuplicate As String, ByVal Table As String, ByVal ColumnTitle As String, ByVal client As String, ByVal dtligneFacture As DataGridView, Optional ByVal reservationNum As String = "", Optional ByVal reference_garantie As String = "", Optional ByVal DEPOT_DE_GARANTIE As Double = 0)

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0
        'Dim totalNormal As Double = 0
        Dim totalTVA As Double = 0
        Dim TAxeSejour As Double = 0
        Dim SoldeNet As Double = 0
        Dim TotalVersement As Double = 0

        Dim dt As DataTable
        Dim dtReg As DataTable

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        If GlobalVariable.DocumentToGenerate = "facture" Then

            tireDocument = "FACTURE N°: "
            titreFichier = "FACTURE DE "
            dt = GetAllElementsOnCondition(ElementToDuplicate, "ligne_facture", "CODE_FACTURE")

            dtReg = GetAllElementsOnCondition(ElementToDuplicate, "reglement", "NUM_FACTURE")

            For i = 0 To dt.Rows.Count - 1

                If (Not dt.Rows(i)("LIBELLE_FACTURE") = "Taxe de sejour") Or (Not dt.Rows(i)("LIBELLE_FACTURE") = "Tourist tax") Then
                    TotalFacture += Functions.prelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT_TTC")) 'calcul de la somme apres prelevement de la taxe
                    totalTVA += Functions.prelevementDeTaxeSurUnMontantPOurCalcul(dt.Rows(i)("MONTANT_TTC")) 'calcul de la somme des taxes prelevees
                Else
                    TAxeSejour += Functions.NonprelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT_TTC"))
                End If

            Next

            If dtReg.Rows.Count > 0 Then

                For i = 0 To dtReg.Rows.Count - 1
                    TotalVersement += Functions.NonprelevementDeTaxeSurUnMontant(dtReg.Rows(i)("MONTANT_VERSE"))
                Next

            End If

        ElseIf GlobalVariable.DocumentToGenerate = "reglement" Then

            If GlobalVariable.actualLanguageValue = 1 Then
                tireDocument = "RECU N° : "
                titreFichier = "RECU DE "
            Else
                tireDocument = "RECEIPT N° : "
                titreFichier = "RECEIPT OF "
            End If

            dt = GetAllElementsOnCondition(ElementToDuplicate, "reglement", "NUM_REGLEMENT")

            For i = 0 To dt.Rows.Count - 1

                TotalFacture += dt.Rows(i)("MONTANT_VERSE")

            Next

        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        Dim nomClient As String = ""

        Dim reservationToPrint As DataTable = Functions.getElementByCode(reservationNum, "reserve_conf", "CODE_RESERVATION")

        If reservationToPrint.Rows.Count > 0 Then

            If Not Trim(reservationToPrint.Rows(0)("CODE_ENTREPRISE")) = "" Then
                nomClient = reservationToPrint.Rows(0)("NOM_ENTREPRISE") & "(" & reservationToPrint.Rows(0)("NOM_CLIENT") & ")"
            ElseIf getElementByCode(client, "client", "CODE_CLIENT").Rows.Count > 0 Then
                nomClient = getElementByCode(client, "client", "CODE_CLIENT").Rows(0)("NOM_PRENOM")
            End If

        Else

            Dim client_Compte As DataTable = getElementByCode(client, "client", "CODE_CLIENT")

            If client_Compte.Rows.Count > 0 Then
                nomClient = client_Compte.Rows(0)("NOM_PRENOM")
            Else
                client_Compte = getElementByCode(client, "compte", "NUMERO_COMPTE")
                If client_Compte.Rows.Count > 0 Then
                    nomClient = client_Compte.Rows(0)("INTITULE")
                End If
            End If

        End If

        sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As Document

            Dim pdfWrite As PdfWriter

            If GlobalVariable.AgenceActuelle.Rows(0)("PRINT_B7") = 1 Then
                pdfDoc = New Document(PageSize.B7, 5, 5, 5, 5)
                pdfWrite = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Else
                pdfDoc = New Document(PageSize.A4, 40, 40, 80, 40)
                pdfWrite = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            End If

            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.TIMES_ROMAN, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pColumn2 As New Font(iTextSharp.text.Font.FontFamily.TIMES_ROMAN, 13, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.TIMES_ROMAN, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.TIMES_ROMAN, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.TIMES_ROMAN, 12, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim title As New Font(iTextSharp.text.Font.FontFamily.TIMES_ROMAN, 16, iTextSharp.text.Font.BOLD, BaseColor.BLACK)

            Dim pdfTable As New PdfPTable(3) 'Number of columns

            If GlobalVariable.AgenceActuelle.Rows(0)("PRINT_B7") = 1 Then

                pColumn = New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                pColumn2 = New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                pRow = New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                fontTotal = New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                font1 = New Font(iTextSharp.text.Font.FontFamily.COURIER, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
                title = New Font(iTextSharp.text.Font.FontFamily.TIMES_ROMAN, 13, iTextSharp.text.Font.BOLD, BaseColor.BLACK)

            End If


            If GlobalVariable.AgenceActuelle.Rows(0)("PRINT_B7") = 1 Then
                pdfTable.TotalWidth = 240.0F
            Else
                pdfTable.TotalWidth = 540.0F
            End If

            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single() = New Single() {47.0F, 8.0F, 15.0F}

            pdfTable.SetWidths(widths)

            Dim pdfCell As PdfPCell = Nothing

            pdfDoc.Open()

            '------------------------------- LOGO SUR LE BON DE COMMANDE --------------------------------------

            Dim img() As Byte
            img = societe.Rows(0)("LOGO")

            Dim mStream As New MemoryStream(img)

            Dim logo As Image
            logo = Image.GetInstance(img)


            'Dim pHeaderLogo As New PdfPTable(1)
            Dim pHeaderLogo As PdfPTable

            If GlobalVariable.AgenceActuelle.Rows(0)("PRINT_B7") = 1 Then

                logo.ScalePercent(40.0F)

                pHeaderLogo = New PdfPTable(1)

                pHeaderLogo.TotalWidth = pdfDoc.PageSize.Width
                pHeaderLogo.DefaultCell.Border = 0

                pdfCell = New PdfPCell(logo)
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0 'used to remove borders on the cells
                pHeaderLogo.AddCell(pdfCell)
                pHeaderLogo.WriteSelectedRows(0, -1, 0, pdfDoc.GetTop(pdfDoc.TopMargin) + 125, pdfWrite.DirectContent)

                pdfDoc.Add(pHeaderLogo)

                Dim pHeader As New PdfPTable(1)
                pHeader.TotalWidth = pdfDoc.PageSize.Width
                pHeader.DefaultCell.Border = 0

                Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE"), title)
                p1.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p1)

                Dim p001_ As Paragraph = New Paragraph("NUM REG. : " & societe.Rows(0)("NUM_REGISTRE") & " / NIU : " & societe.Rows(0)("NUM_CONTRIBUABLE") & Chr(13) & societe.Rows(0)("TELEPHONE") & " - " & societe.Rows(0)("RUE") & Chr(13), pColumn2)
                p001_.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p001_)

            Else

                '-------------------------------------
                logo.ScalePercent(50.0F)

                pHeaderLogo = New PdfPTable(2)
                Dim widths_ As Single() = New Single() {20.0F, 70.0F}

                pHeaderLogo.SetWidths(widths_)
                pHeaderLogo.TotalWidth = pdfDoc.PageSize.Width
                pHeaderLogo.DefaultCell.Border = 0

                pdfCell = New PdfPCell(logo)
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0 'used to remove borders on the cells
                pHeaderLogo.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(societe.Rows(0)("RAISON_SOCIALE"), title))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0 'used to remove borders on the cells
                pHeaderLogo.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", title))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0 'used to remove borders on the cells

                pHeaderLogo.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NUM REG. : " & societe.Rows(0)("NUM_REGISTRE") & " / NIU : " & societe.Rows(0)("NUM_CONTRIBUABLE") & Chr(13) & " " & societe.Rows(0)("TELEPHONE") & " - " & societe.Rows(0)("RUE"), pColumn2))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0 'used to remove borders on the cells

                pHeaderLogo.AddCell(pdfCell)

                pHeaderLogo.WriteSelectedRows(0, -1, 0, pdfDoc.GetTop(pdfDoc.TopMargin) + 150, pdfWrite.DirectContent)

            End If

            Dim p3 As Paragraph = New Paragraph(Chr(13) & Date.Now() & Chr(13), pColumn2)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            Dim termes As String = ""
            Dim termes_ As String = ""

            Dim clientInformation As DataTable
            Dim LIBELLE_TYPE_CHAMBRE As String = ""

            Dim infoResa As DataTable = Functions.getElementByCode(reservationNum, "reserve_conf", "CODE_RESERVATION")
            If Not infoResa.Rows.Count > 0 Then
                infoResa = Functions.getElementByCode(reservationNum, "reservation", "CODE_RESERVATION")
            End If

            If infoResa.Rows.Count > 0 Then
                LIBELLE_TYPE_CHAMBRE = infoChambres(infoResa.Rows(0)("CHAMBRE_ID")).Rows(0)("LIBELLE_TYPE_CHAMBRE")
            End If

            If Not Trim(reference_garantie).Equals("") Then

                termes_ = Chr(13) & "RECU No : " & (Date.Now().ToString("ddMMyyHHmm")) & Chr(13) & "REFERENCE DEPOT GARANTIE : " & reference_garantie & Chr(13) & Chr(13)

                Dim infoSupDepot As DataTable = Functions.getElementByCode(reference_garantie, "caution", "CODE_CAUTION")

                If infoSupDepot.Rows.Count > 0 Then

                    Dim CODE_RESERVATION As String = infoSupDepot.Rows(0)("CODE_RESERVATION")
                    Dim infoSupReservation As DataTable = Functions.getElementByCode(CODE_RESERVATION, "reserve_conf", "CODE_RESERVATION")

                    If Not infoSupReservation.Rows.Count > 0 Then
                        infoSupReservation = Functions.getElementByCode(CODE_RESERVATION, "reservation", "CODE_RESERVATION")
                        If infoSupReservation.Rows.Count > 0 Then
                            termes = Chr(13) & "CLIENT : " & infoSupReservation.Rows(0)("NOM_CLIENT") & Chr(13) & "TYPE DE CHAMBRE : " & LIBELLE_TYPE_CHAMBRE & Chr(13) & "CHAMBRE : " & infoSupReservation.Rows(0)("CHAMBRE_ID") & Chr(13) & Chr(13)
                        Else
                            termes = "CLIENT : " & client & Chr(13) & Chr(13)
                        End If
                    Else
                        termes = Chr(13) & "CLIENT : " & infoSupReservation.Rows(0)("NOM_CLIENT") & Chr(13) & "TYPE DE CHAMBRE : " & LIBELLE_TYPE_CHAMBRE & Chr(13) & "CHAMBRE : " & infoSupReservation.Rows(0)("CHAMBRE_ID") & Chr(13) & Chr(13)
                    End If
                End If

            Else

                termes_ = Chr(13) & "RECU DE CAISSE No : " & (Date.Now().ToString("ddMMyyHHmm")) & Chr(13)

                clientInformation = Functions.getElementByCode(GlobalVariable.codeClientDevantRegler, "client", "CODE_CLIENT")

                If clientInformation.Rows.Count > 0 Then
                    termes = "CLIENT : " & clientInformation.Rows(0)("NOM_PRENOM") & Chr(13) & Chr(13)
                Else

                    Dim infoSupReservation As DataTable = Functions.getElementByCode(reservationNum, "reserve_conf", "CODE_RESERVATION")

                    If GlobalVariable.actualLanguageValue = 1 Then

                        If infoSupReservation.Rows.Count > 0 Then
                            termes = Chr(13) & "CLIENT : " & infoSupReservation.Rows(0)("NOM_CLIENT") & Chr(13) & "TYPE DE CHAMBRE : " & LIBELLE_TYPE_CHAMBRE & Chr(13) & "CHAMBRE : " & infoSupReservation.Rows(0)("CHAMBRE_ID") & Chr(13) & Chr(13)
                        Else
                            infoSupReservation = Functions.getElementByCode(reservationNum, "reservation", "CODE_RESERVATION")

                            If infoSupReservation.Rows.Count > 0 Then
                                termes = Chr(13) & "CLIENT : " & infoSupReservation.Rows(0)("NOM_CLIENT") & Chr(13) & "TYPE DE CHAMBRE : " & LIBELLE_TYPE_CHAMBRE & Chr(13) & "CHAMBRE : " & infoSupReservation.Rows(0)("CHAMBRE_ID") & Chr(13) & Chr(13)
                            End If

                        End If

                    Else

                        If infoSupReservation.Rows.Count > 0 Then
                            termes = Chr(13) & "CLIENT : " & infoSupReservation.Rows(0)("NOM_CLIENT") & Chr(13) & "ROOM TYPE : " & LIBELLE_TYPE_CHAMBRE & Chr(13) & "ROOM : " & infoSupReservation.Rows(0)("CHAMBRE_ID") & Chr(13) & Chr(13)
                        Else
                            infoSupReservation = Functions.getElementByCode(reservationNum, "reservation", "CODE_RESERVATION")

                            If infoSupReservation.Rows.Count > 0 Then
                                termes = Chr(13) & "CLIENT : " & infoSupReservation.Rows(0)("NOM_CLIENT") & Chr(13) & "ROOM TYPE : " & LIBELLE_TYPE_CHAMBRE & Chr(13) & "ROOM : " & infoSupReservation.Rows(0)("CHAMBRE_ID") & Chr(13) & Chr(13)
                            End If

                        End If

                    End If

                End If

            End If

            pdfDoc.Add(New Paragraph(termes_, pColumn2))

            pdfDoc.Add(New Paragraph(termes, pColumn2))

            '-----------------------------------

            If True Then

                pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                If Trim(reference_garantie).Equals("") Then

                    If dt.Rows.Count > 0 Then

                        For i = 0 To dt.Rows.Count - 1

                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(i)("REF_REGLEMENT"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i)("QUANTITE"), "#,##0"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i)("MONTANT_VERSE"), "#,##0"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.AddCell(pdfCell)

                        Next

                        pdfDoc.Add(pdfTable)

                        '------------------------------------------------------------------------

                        Dim pdfTable2 As New PdfPTable(3) 'Number of columns

                        pdfTable2.TotalWidth = 240.0F
                        pdfTable2.LockedWidth = True
                        pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                        'pdfTable2.HeaderRows = 1

                        Dim widths2 As Single() = New Single() {47.0F, 8.0F, 15.0F}
                        pdfTable2.SetWidths(widths2)

                        Dim pdfCell2 As PdfPCell = Nothing

                        If GlobalVariable.DocumentToGenerate = "reglement" Then
                            pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & "TOTAL : ", fontTotal))
                        Else
                            pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & "TOTAL HT : ", fontTotal))
                        End If

                        pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell2.MinimumHeight = 18
                        pdfCell2.PaddingLeft = 15.0F
                        pdfCell2.Border = 0
                        pdfCell2.Colspan = 2
                        pdfTable2.AddCell(pdfCell2)

                        pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & Format(TotalFacture, "#,##0"), fontTotal))
                        pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell2.MinimumHeight = 18
                        pdfCell2.PaddingLeft = 5.0F
                        'pdfCell2.Border = 0
                        pdfTable2.AddCell(pdfCell2)

                        pdfDoc.Add(pdfTable2)

                        'Dim chiffreEnLettre = New Paragraph(Chr(13) & Chr(13) & "Reçu la somme de: " & NBLT(TotalFacture) & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE"), pRow)
                        Dim chiffreEnLettre
                        If GlobalVariable.actualLanguageValue = 1 Then
                            chiffreEnLettre = New Paragraph(Chr(13) & Chr(13) & "Reçu la somme de : " & NBLT(TotalFacture) & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE"), pRow)
                        Else
                            chiffreEnLettre = New Paragraph(Chr(13) & Chr(13) & "Received an amount of xx : " & NBLT(TotalFacture) & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE"), pRow)
                        End If
                        pdfDoc.Add(chiffreEnLettre)

                        ' Then
                        Dim signature As String = Chr(13) & "           CLIENT                                                             HOTEL "
                        If GlobalVariable.actualLanguageValue = 0 Then
                            signature = Chr(13) & "               CLEINT                                                                 HOTEL "
                        End If
                        pdfDoc.Add(New Paragraph(signature, pRow))


                    End If


                Else

                    pdfCell = New PdfPCell(New Paragraph("ENCAISSEMENT DE DEPOT DE GARANTIE", font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(1, "#,##0"), font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(DEPOT_DE_GARANTIE, "#,##0"), font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.AddCell(pdfCell)

                    pdfDoc.Add(pdfTable)

                    '------------------------------------------------------------------------

                    Dim pdfTable2 As New PdfPTable(3) 'Number of columns

                    pdfTable2.TotalWidth = 240.0F
                    pdfTable2.LockedWidth = True
                    pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                    'pdfTable2.HeaderRows = 1

                    Dim widths2 As Single() = New Single() {47.0F, 8.0F, 15.0F}
                    pdfTable2.SetWidths(widths2)

                    Dim pdfCell2 As PdfPCell = Nothing

                    If GlobalVariable.DocumentToGenerate = "reglement" Then
                        pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & "TOTAL : ", fontTotal))
                    Else
                        pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & "TOTAL HT : ", fontTotal))
                    End If

                    pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell2.MinimumHeight = 18
                    pdfCell2.PaddingLeft = 15.0F
                    pdfCell2.Border = 0
                    pdfCell2.Colspan = 2
                    pdfTable2.AddCell(pdfCell2)

                    pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & Format(DEPOT_DE_GARANTIE, "#,##0"), fontTotal))
                    pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell2.MinimumHeight = 18
                    pdfCell2.PaddingLeft = 5.0F
                    'pdfCell2.Border = 0
                    pdfTable2.AddCell(pdfCell2)

                    pdfDoc.Add(pdfTable2)

                    'Dim chiffreEnLettre = New Paragraph(Chr(13) & Chr(13) & "Reçu la somme de: " & NBLT(TotalFacture) & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE"), pRow)
                    Dim chiffreEnLettre
                    If GlobalVariable.actualLanguageValue = 1 Then
                        chiffreEnLettre = New Paragraph(Chr(13) & Chr(13) & "Reçu la somme de : " & NBLT(DEPOT_DE_GARANTIE) & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE"), pRow)
                    Else
                        chiffreEnLettre = New Paragraph(Chr(13) & Chr(13) & "Received an amount of : " & NBLT(DEPOT_DE_GARANTIE) & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE"), pRow)
                    End If
                    pdfDoc.Add(chiffreEnLettre)

                    Dim signature As String = "                                                          Signature client"
                    If GlobalVariable.actualLanguageValue = 0 Then
                        signature = "                                                               Signature Client"
                    Else
                        signature = "                                                               Client's Signature"
                    End If
                    pdfDoc.Add(New Paragraph(signature, pRow))

                End If

                '------------------------------------



            End If

            Dim salutation

            If GlobalVariable.actualLanguageValue = 1 Then
                salutation = New Paragraph(Chr(13) & Chr(13) & "Merci et à bientôt ", pRow)
            Else
                salutation = New Paragraph(Chr(13) & Chr(13) & "Thanks For your Stay ", pRow)
            End If

            pdfDoc.Add(salutation)

            pdfDoc.Close()

            'MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub

    'UTILISE POUR INSERER LES ELEMENTS DE FACTURE DANS UNE TABLE TEMPORAIRE ET DE LES RETOURNER DE FACON ORGANISEE

    Public Shared Function chargementTemporaireDesElementsDeFacturePourImpression(ByVal dt As DataTable) As DataTable

        If dt.Rows.Count > 0 Then

            deleteAll("print_facture_reglement_temp")

            Dim insertQuery As String = ""

            For i = 0 To dt.Rows.Count - 1

                insertQuery = "INSERT INTO `print_facture_reglement_temp`(`DATE_ELEMT`, `LIBELLE_ELEMENT`, `QUANTITE`, `MONTANT`) VALUES (@value1, @value2, @value3, @value4)"

                Dim command As New MySqlCommand(insertQuery, GlobalVariable.connect)

                command.Parameters.Add("@value1", MySqlDbType.Date).Value = CDate(dt.Rows(i)(0))
                command.Parameters.Add("@value2", MySqlDbType.VarChar).Value = dt.Rows(i)(1)
                command.Parameters.Add("@value3", MySqlDbType.Double).Value = dt.Rows(i)(2)
                command.Parameters.Add("@value4", MySqlDbType.Double).Value = dt.Rows(i)(3)

                command.ExecuteNonQuery()

            Next

            Dim query As String = "SELECT `DATE_ELEMT`, `LIBELLE_ELEMENT`, `QUANTITE`, `MONTANT` FROM `print_facture_reglement_temp` ORDER BY DATE_ELEMT DESC"
            Dim command1 As New MySqlCommand(query, GlobalVariable.connect)

            Dim adapter As New MySqlDataAdapter(command1)
            Dim elements As New DataTable()

            adapter.Fill(elements)

            'Enfin on insere le tout dans notre datagrid
            If (elements.Rows.Count > 0) Then

                deleteAll("print_facture_reglement_temp")

                Return elements

            End If

        End If

    End Function

    Public Shared Sub DocumentToPrintDeuxExemplaiare(ByVal ElementToDuplicate As String, ByVal Table As String, ByVal ColumnTitle As String, ByVal client As String, Optional ByVal reservationNum As String = "")

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0
        'Dim totalNormal As Double = 0
        Dim totalTVA As Double = 0
        Dim TAxeSejour As Double = 0
        Dim SoldeNet As Double = 0
        Dim TotalVersement As Double = 0

        Dim dt As DataTable
        Dim elements As DataTable
        Dim dtReg As DataTable

        Dim tousLesElemetsDeFacture As New DataTable()

        tousLesElemetsDeFacture.Columns.Add("DATE_ELEMENT", GetType(Date))
        tousLesElemetsDeFacture.Columns.Add("LIBELLE")
        tousLesElemetsDeFacture.Columns.Add("QUANTITE")
        tousLesElemetsDeFacture.Columns.Add("MONTANT")

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        If GlobalVariable.DocumentToGenerate = "facture" Then

            If GlobalVariable.actualLanguageValue = 1 Then
                tireDocument = "FACTURE N° : "
                titreFichier = "FACTURE DE "
            Else
                tireDocument = "INVOICE N° : "
                titreFichier = "INVOICE OF "
            End If

            dt = GetAllElementsOnCondition(ElementToDuplicate, "ligne_facture", "CODE_FACTURE")

            dtReg = GetAllElementsOnCondition(ElementToDuplicate, "reglement", "NUM_FACTURE")

            For i = 0 To dt.Rows.Count - 1

                Dim LIBELLE As String = dt.Rows(i)("LIBELLE_FACTURE").ToString.ToUpper()

                If (Not LIBELLE.Contains("TAXE DE SEJOUR")) Or (Not LIBELLE.Contains("TOURIST TAX")) Then
                    'TotalFacture += Functions.prelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT_TTC")) 'calcul de la somme apres prelevement de la taxe
                    TotalFacture += NonprelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT_TTC")) 'calcul de la somme apres prelevement de la taxe
                    totalTVA += Functions.prelevementDeTaxeSurUnMontantPOurCalcul(dt.Rows(i)("MONTANT_TTC")) 'calcul de la somme des taxes prelevees
                Else

                    If LIBELLE.Contains("TAXE DE SEJOUR") Or LIBELLE.Contains("TOURIST TAX") Then
                        TAxeSejour += Functions.NonprelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT_TTC"))
                    End If

                End If

                tousLesElemetsDeFacture.Rows.Add(CDate(dt.Rows(i)("DATE_FACTURE")).ToShortDateString, dt.Rows(i)("LIBELLE_FACTURE").ToString, dt.Rows(i)("QUANTITE"), dt.Rows(i)("MONTANT_TTC"))

                'TotalFacture += prelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT_TTC"))
                'totalTVA += prelevementDeTaxeSurUnMontantPOurCalcul(dt.Rows(i)("MONTANT_TTC"))
                'totalNormal += totalNormal + dt.Rows(i)("MONTANT_TTC")

            Next

            If dtReg.Rows.Count > 0 Then

                Dim n As Integer = 0

                For i = 0 To dtReg.Rows.Count - 1

                    TotalVersement += Functions.NonprelevementDeTaxeSurUnMontant(dtReg.Rows(i)("MONTANT_VERSE"))

                    n = i + 1

                    tousLesElemetsDeFacture.Rows.Add(CDate(dtReg.Rows(i)("DATE_REGLEMENT").ToShortDateString), dtReg.Rows(i)("REF_REGLEMENT").ToString, dtReg.Rows(i)("QUANTITE"), dtReg.Rows(i)("MONTANT_VERSE") * -1)

                Next

            End If

        ElseIf GlobalVariable.DocumentToGenerate = "reglement" Then

            tireDocument = "RECU N° : "
            titreFichier = "RECU DE "

            If GlobalVariable.actualLanguageValue = 0 Then
                tireDocument = "RECEIPT N° : "
                titreFichier = "RECEIPT OF "
            End If

            dtReg = GetAllElementsOnCondition(ElementToDuplicate, "reglement", "NUM_REGLEMENT")

            If dtReg.Rows.Count > 0 Then

                Dim n As Integer = 0

                For i = 0 To dtReg.Rows.Count - 1

                    TotalFacture += dtReg.Rows(i)("MONTANT_VERSE")

                    tousLesElemetsDeFacture.Rows.Add(CDate(dtReg.Rows(i)("DATE_REGLEMENT").ToShortDateString), dtReg.Rows(i)("REF_REGLEMENT").ToString, dtReg.Rows(i)("QUANTITE"), dtReg.Rows(i)("MONTANT_VERSE"))

                Next

            End If

        End If

        If tousLesElemetsDeFacture.Rows.Count > 0 Then
            'REORGANISATION PAR ORDRE DE DATE DECROISSANTE
            elements = chargementTemporaireDesElementsDeFacturePourImpression(tousLesElemetsDeFacture)
        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        Dim nomClient As String = ""

        Dim reservationToPrint As DataTable = Functions.getElementByCode(reservationNum, "reserve_conf", "CODE_RESERVATION")

        If reservationToPrint.Rows.Count > 0 Then

            If Not Trim(GlobalVariable.ReservationToUpdate(0)("CODE_ENTREPRISE")) = "" Then
                nomClient = GlobalVariable.ReservationToUpdate(0)("NOM_ENTREPRISE") & " ( " & GlobalVariable.ReservationToUpdate(0)("NOM_CLIENT") & " )"
            ElseIf getElementByCode(client, "client", "CODE_CLIENT").Rows.Count > 0 Then
                nomClient = getElementByCode(client, "client", "CODE_CLIENT").Rows(0)("NOM_PRENOM")
            End If

        Else

            If getElementByCode(client, "client", "CODE_CLIENT").Rows.Count > 0 Then
                nomClient = getElementByCode(client, "client", "CODE_CLIENT").Rows(0)("NOM_PRENOM")
            End If

        End If

        sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A5, 40, 10, 80, 40)
            Dim r As Integer = 1
            If GlobalVariable.AgenceActuelle.Rows(0)("PRINT_B7") = 1 Then
                r = 0
                pdfDoc = New Document(PageSize.B7, 5, 5, 5, 5)
            End If
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn2 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 7, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim title As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 13, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            If GlobalVariable.AgenceActuelle.Rows(0)("PRINT_B7") = 1 Then

                 pColumn = New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                'pColumn1 = New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                pColumn2 = New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                 title = New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 13, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                 pRow = New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 11, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                'pRow1 = New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                fontTotal = New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 11, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                 font1 = New Font(iTextSharp.text.Font.FontFamily.COURIER, 11, iTextSharp.text.Font.BOLD, BaseColor.BLACK)

            End If

            pdfDoc.Open()

            For j = 0 To r

                If j = 1 Then
                    pdfDoc.NewPage()
                End If

                Dim pdfTable As New PdfPTable(4) 'Number of columns

                pdfTable.TotalWidth = 395.0F

                If GlobalVariable.AgenceActuelle.Rows(0)("PRINT_B7") = 1 Then
                    pdfTable = New PdfPTable(3) 'Number of columns
                    pdfTable.TotalWidth = 240.0F
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.HeaderRows = 1

                    Dim widths As Single() = New Single() {47.0F, 8.0F, 15.0F}

                    pdfTable.SetWidths(widths)

                Else

                    pdfTable = New PdfPTable(4) 'Number of columns
                    pdfTable.TotalWidth = 395.0F
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.HeaderRows = 1

                    Dim widths As Single() = New Single() {1.5F, 6.5F, 1.0F, 1.5F}

                    pdfTable.SetWidths(widths)

                End If

                Dim pdfCell As PdfPCell = Nothing

                If GlobalVariable.AgenceActuelle.Rows(0)("PRINT_B7") = 1 Then
                    '------------------------------- LOGO SUR LE BON DE COMMANDE --------------------------------------
                    'klg
                    Dim img() As Byte
                    img = societe.Rows(0)("LOGO")

                    Dim mStream As New MemoryStream(img)

                    Dim logo As Image
                    logo = Image.GetInstance(img)
                    logo.ScalePercent(40.0F)

                    Dim pHeaderLogo As New PdfPTable(1)
                    pHeaderLogo.TotalWidth = pdfDoc.PageSize.Width
                    pHeaderLogo.DefaultCell.Border = 0

                    pdfCell = New PdfPCell(logo)
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0 'used to remove borders on the cells
                    pHeaderLogo.AddCell(pdfCell)
                    pHeaderLogo.WriteSelectedRows(0, -1, 0, pdfDoc.GetTop(pdfDoc.TopMargin) + 125, pdfWrite.DirectContent)

                    pdfDoc.Add(pHeaderLogo)

                    Dim pHeader As New PdfPTable(1)
                    pHeader.TotalWidth = pdfDoc.PageSize.Width
                    pHeader.DefaultCell.Border = 0

                    Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE"), title)
                    p1.Alignment = Element.ALIGN_CENTER

                    pdfDoc.Add(p1)

                    Dim p001_ As Paragraph = New Paragraph("Num Reg. : " & societe.Rows(0)("NUM_REGISTRE") & " / Num Cont. : " & societe.Rows(0)("NUM_CONTRIBUABLE") & Chr(13) & societe.Rows(0)("TELEPHONE") & " - " & societe.Rows(0)("RUE") & Chr(13), pColumn2)
                    p001_.Alignment = Element.ALIGN_CENTER

                    pdfDoc.Add(p001_)

                    Dim p3 As Paragraph = New Paragraph(Date.Now() & Chr(13), pColumn2)
                    p3.Alignment = Element.ALIGN_CENTER

                    pdfDoc.Add(p3)

                Else
                    pdfWrite.PageEvent = New HeaderFooter_1
                End If

                Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & ElementToDuplicate & Chr(13) & "DATE : " & GlobalVariable.DateDeTravail & Chr(13), pColumn)

                p10.Alignment = Element.ALIGN_LEFT

                pdfDoc.Add(p10)

                Dim termes As String = ""

                Dim clientInformation As DataTable

                'If GlobalVariable.typeDeClientAFacturer = "en chambre" Then

                'SI ON TRAITE UNE RESERVATION

                If Not Trim(reservationNum).Equals("") Then

                    If Not Trim(GlobalVariable.ReservationToUpdate(0)("CODE_ENTREPRISE")) = "" Then
                        clientInformation = Functions.getElementByCode(GlobalVariable.ReservationToUpdate(0)("CODE_ENTREPRISE"), "client", "CODE_CLIENT")
                    Else
                        clientInformation = Functions.getElementByCode(client, "client", "CODE_CLIENT")
                    End If

                    If Not Trim(GlobalVariable.ReservationToUpdate(0)("CODE_ENTREPRISE")) = "" Then

                        If clientInformation.Rows.Count > 0 Then
                            termes = Chr(13) & "NOM DU CLIENT : " & clientInformation.Rows(0)("NOM_PRENOM") & "(" & GlobalVariable.ReservationToUpdate(0)("NOM_CLIENT") & ")" & Chr(13) & clientInformation.Rows(0)("NOM_JEUNE_FILLE") & Chr(13) & clientInformation.Rows(0)("PRENOMS") & Chr(13) & "CHAMBRE N° : " & GlobalVariable.ReservationToUpdate(0)("CHAMBRE_ID") & Chr(13) & "RESERVATION N° : " & GlobalVariable.codeReservationToUpdate & Chr(13) & Chr(13)
                            If GlobalVariable.actualLanguageValue = 0 Then
                                termes = Chr(13) & "CLIENT : " & clientInformation.Rows(0)("NOM_PRENOM") & "(" & GlobalVariable.ReservationToUpdate(0)("NOM_CLIENT") & ")" & Chr(13) & clientInformation.Rows(0)("NOM_JEUNE_FILLE") & Chr(13) & clientInformation.Rows(0)("PRENOMS") & Chr(13) & "ROOM N° : " & GlobalVariable.ReservationToUpdate(0)("CHAMBRE_ID") & Chr(13) & "RESERVATION N° : " & GlobalVariable.codeReservationToUpdate & Chr(13) & Chr(13)

                            End If
                        End If

                    Else

                        If clientInformation.Rows.Count > 0 Then
                            termes = Chr(13) & "NOM DU CLIENT : " & nomClient & Chr(13) & "CHAMBRE N° : " & GlobalVariable.ReservationToUpdate(0)("CHAMBRE_ID") & Chr(13) & "RESERVATION N° : " & GlobalVariable.codeReservationToUpdate & Chr(13) & Chr(13)
                            If GlobalVariable.actualLanguageValue = 0 Then
                                termes = Chr(13) & "CLIENT : " & nomClient & Chr(13) & "ROOM N° : " & GlobalVariable.ReservationToUpdate(0)("CHAMBRE_ID") & Chr(13) & "RESERVATION N° : " & GlobalVariable.codeReservationToUpdate & Chr(13) & Chr(13)

                            End If
                        End If

                    End If

                Else

                    termes = Chr(13) & "NOM DU CLIENT : " & nomClient & Chr(13) & Chr(13)
                    If GlobalVariable.actualLanguageValue = 0 Then
                        termes = Chr(13) & "CLIENT : " & nomClient & Chr(13) & Chr(13)
                    End If

                End If

                pdfDoc.Add(New Paragraph(termes, pRow))

                pdfCell = New PdfPCell(New Paragraph("DATE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                If Not GlobalVariable.AgenceActuelle.Rows(0)("PRINT_B7") = 1 Then
                    pdfTable.AddCell(pdfCell)
                End If

                pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                If tousLesElemetsDeFacture.Rows.Count > 0 Then

                    For i = 0 To tousLesElemetsDeFacture.Rows.Count - 1

                        If GlobalVariable.DocumentToGenerate = "facture" Then

                            pdfCell = New PdfPCell(New Paragraph(CDate(elements.Rows(i)("DATE_ELEMT")).ToShortDateString, font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                            If Not GlobalVariable.AgenceActuelle.Rows(0)("PRINT_B7") = 1 Then
                                pdfTable.AddCell(pdfCell)
                            End If

                            pdfCell = New PdfPCell(New Paragraph(elements.Rows(i)("LIBELLE_ELEMENT"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(elements.Rows(i)("QUANTITE"), "#,##0"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            'On ne preleve pas de taxe sur les taxes de sejours

                            Dim LIBELLE_TAXE As String = "TAXE DE SEJOUR"
                            Dim LIBELLE_FACTURE As String = elements.Rows(i)("LIBELLE_ELEMENT").ToString.ToUpper()

                            If Not LIBELLE_FACTURE.Contains(LIBELLE_TAXE) Or Not LIBELLE_FACTURE.Contains("TOURIST TAX") Then
                                'pdfCell = New PdfPCell(New Paragraph(Format(prelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT_TTC") * -1), "#,##0"), font1))
                                pdfCell = New PdfPCell(New Paragraph(Format(NonprelevementDeTaxeSurUnMontant(elements.Rows(i)("MONTANT") * -1), "#,##0"), font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph(Format(NonprelevementDeTaxeSurUnMontant(elements.Rows(i)("MONTANT") * -1), "#,##0"), font1))
                            End If

                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.AddCell(pdfCell)

                        ElseIf GlobalVariable.DocumentToGenerate = "reglement" Then

                            pdfCell = New PdfPCell(New Paragraph(CDate(elements.Rows(i)("DATE_ELEMT")).ToShortDateString, font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            If Not GlobalVariable.AgenceActuelle.Rows(0)("PRINT_B7") = 1 Then
                                pdfTable.AddCell(pdfCell)
                            End If

                            pdfCell = New PdfPCell(New Paragraph(elements.Rows(i)("LIBELLE_ELEMENT"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(elements.Rows(i)("QUANTITE"), "#,##0"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(elements.Rows(i)("MONTANT"), "#,##0"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.AddCell(pdfCell)

                        End If

                    Next

                    pdfDoc.Add(pdfTable)

                    '------------------------------------------------------------------------

                    Dim pdfCell2 As PdfPCell = Nothing

                    Dim pdfTable2 As New PdfPTable(4) 'Number of columns

                    If GlobalVariable.AgenceActuelle.Rows(0)("PRINT_B7") = 1 Then
                        pdfTable2 = New PdfPTable(3) 'Number of columns

                        pdfTable2.TotalWidth = 240.0F
                        pdfTable2.LockedWidth = True
                        pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                        'pdfTable2.HeaderRows = 1

                        Dim widths2 As Single() = New Single() {47.0F, 8.0F, 15.0F}
                        pdfTable2.SetWidths(widths2)

                        If GlobalVariable.DocumentToGenerate = "reglement" Then
                            pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & "TOTAL : ", fontTotal))
                        Else
                            pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & "TOTAL HT : ", fontTotal))
                        End If

                        pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell2.MinimumHeight = 18
                        pdfCell2.PaddingLeft = 15.0F
                        pdfCell2.Border = 0
                        pdfCell2.Colspan = 2
                        pdfTable2.AddCell(pdfCell2)

                        pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & Format(TotalFacture, "#,##0"), fontTotal))
                        pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell2.MinimumHeight = 18
                        pdfCell2.PaddingLeft = 5.0F
                        'pdfCell2.Border = 0
                        pdfTable2.AddCell(pdfCell2)
                    Else

                        pdfTable2.TotalWidth = 530.0F
                        pdfTable2.LockedWidth = True
                        pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                        'pdfTable2.HeaderRows = 1

                        'Dim widths2 As Single() = New Single() {5.8F, 1.8F}
                        Dim widths2 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                        pdfTable2.SetWidths(widths2)

                        If GlobalVariable.DocumentToGenerate = "reglement" Then
                            pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & "TOTAL : ", fontTotal))
                        Else
                            pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & "TOTAL HT : ", fontTotal))
                        End If

                        pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell2.MinimumHeight = 18
                        pdfCell2.PaddingLeft = 15.0F
                        pdfCell2.Border = 0
                        pdfCell2.Colspan = 3

                        pdfTable2.AddCell(pdfCell2)

                        pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & Format(TotalFacture, "#,##0"), fontTotal))
                        pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell2.MinimumHeight = 18
                        pdfCell2.PaddingLeft = 5.0F
                        pdfCell2.Border = 0
                        pdfTable2.AddCell(pdfCell2)

                    End If

                    pdfDoc.Add(pdfTable2)

                    '-----------------------------------

                    If Not GlobalVariable.DocumentToGenerate = "reglement" Then

                        Dim TVA As Double = 0

                        If societe.Rows(0)("TAUX_TVA") > 0 Then
                            TVA = totalTVA
                        Else
                            TVA = 0
                        End If

                        '----------------------------- TOTAL HT -----------------------------------
                        Dim pdfTable06 As New PdfPTable(4)

                        pdfTable06.TotalWidth = 530.0F
                        pdfTable06.LockedWidth = True
                        pdfTable06.HorizontalAlignment = Element.ALIGN_RIGHT

                        Dim widths06 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                        pdfTable06.SetWidths(widths06)

                        Dim pdfCell06 As PdfPCell = Nothing

                        '------------------------------ DEBUT RECAPITULATIF OU BILAN ------------------------------------

                        pdfCell06 = New PdfPCell(New Paragraph("", fontTotal))
                        pdfCell06.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell06.MinimumHeight = 18
                        pdfCell06.PaddingLeft = 15.0F
                        pdfCell06.Colspan = 4
                        pdfCell06.Border = 0
                        pdfTable06.AddCell(pdfCell06)

                        pdfCell06 = New PdfPCell(New Paragraph("TOTAL HT : ", fontTotal))
                        pdfCell06.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell06.MinimumHeight = 18
                        pdfCell06.PaddingLeft = 15.0F
                        pdfCell06.Colspan = 3
                        pdfCell06.Border = 0
                        pdfTable06.AddCell(pdfCell06)

                        Dim TAXE_SEJOUR As Double = 0

                        pdfCell06 = New PdfPCell(New Paragraph(Format(TotalFacture - TVA, "#,##0"), fontTotal))
                        pdfCell06.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell06.MinimumHeight = 18
                        pdfCell06.PaddingLeft = 5.0F
                        pdfCell06.Border = 0
                        pdfTable06.AddCell(pdfCell06)

                        pdfDoc.Add(pdfTable06)

                        '--------------------------------------------------------------------------


                        If TVA > 0 Then

                            Dim pdfTable4 As New PdfPTable(4) 'Number of columns

                            pdfTable4.TotalWidth = 530.0F
                            pdfTable4.LockedWidth = True
                            pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
                            'pdfTable4.HeaderRows = 1

                            Dim widths4 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                            pdfTable4.SetWidths(widths4)

                            Dim pdfCell4 As PdfPCell = Nothing

                            pdfCell4 = New PdfPCell(New Paragraph("TVA : ", fontTotal))
                            pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell4.MinimumHeight = 18
                            pdfCell4.PaddingLeft = 15.0F
                            pdfCell4.Border = 0
                            pdfCell4.Colspan = 3
                            pdfTable4.AddCell(pdfCell4)

                            pdfCell4 = New PdfPCell(New Paragraph(Format(TVA, "#,##0"), fontTotal))
                            pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell4.MinimumHeight = 18
                            pdfCell4.PaddingLeft = 5.0F
                            pdfCell4.Border = 0
                            pdfTable4.AddCell(pdfCell4)

                            pdfDoc.Add(pdfTable4)

                            '-----------------------------------

                            Dim pdfTable6 As New PdfPTable(4) 'Number of columns

                            pdfTable6.TotalWidth = 530.0F
                            pdfTable6.LockedWidth = True
                            pdfTable6.HorizontalAlignment = Element.ALIGN_RIGHT
                            'pdfTable4.HeaderRows = 1

                            Dim widths6 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                            pdfTable6.SetWidths(widths6)

                            Dim pdfCell6 As PdfPCell = Nothing

                            pdfCell6 = New PdfPCell(New Paragraph("TAXE DE SEJOURS : ", fontTotal))
                            pdfCell6.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell6.MinimumHeight = 18
                            pdfCell6.PaddingLeft = 15.0F
                            pdfCell6.Colspan = 3
                            pdfCell6.Border = 0
                            pdfTable6.AddCell(pdfCell6)

                            'Dim TAXE_SEJOUR As Double = 0

                            pdfCell6 = New PdfPCell(New Paragraph(Format(TAxeSejour, "#,##0"), fontTotal))
                            pdfCell6.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell6.MinimumHeight = 18
                            pdfCell6.PaddingLeft = 5.0F
                            pdfCell6.Border = 0
                            pdfTable6.AddCell(pdfCell6)

                            pdfDoc.Add(pdfTable6)

                            '-----------------------------------
                            Dim pdfTable3 As New PdfPTable(4) 'Number of columns

                            pdfTable3.TotalWidth = 530.0F
                            pdfTable3.LockedWidth = True
                            pdfTable3.HorizontalAlignment = Element.ALIGN_RIGHT
                            'pdfTable3.HeaderRows = 1

                            Dim widths3 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                            pdfTable3.SetWidths(widths3)

                            Dim pdfCell3 As PdfPCell = Nothing

                            pdfCell3 = New PdfPCell(New Paragraph("", fontTotal))
                            pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell3.MinimumHeight = 18
                            pdfCell3.PaddingLeft = 15.0F
                            pdfCell3.Border = 0
                            pdfCell3.Colspan = 3
                            pdfTable3.AddCell(pdfCell3)

                            pdfCell3 = New PdfPCell(New Paragraph("----------------", fontTotal))
                            pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell3.MinimumHeight = 18
                            pdfCell3.PaddingLeft = 15.0F
                            pdfCell3.Border = 0
                            'pdfCell3.Colspan = 3
                            pdfTable3.AddCell(pdfCell3)

                            pdfCell3 = New PdfPCell(New Paragraph("TOTAL TTC : ", fontTotal))
                            pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell3.MinimumHeight = 18
                            pdfCell3.PaddingLeft = 15.0F
                            pdfCell3.Border = 0
                            pdfCell3.Colspan = 3
                            pdfTable3.AddCell(pdfCell3)

                            'Dim TotalTTC As Double = (TotalFacture * 0.1925) + TotalFacture

                            'pdfCell3 = New PdfPCell(New Paragraph(Format(TotalTTC, "#,##0"), fontTotal))
                            pdfCell3 = New PdfPCell(New Paragraph(Format(TotalFacture + TAxeSejour, "#,##0"), fontTotal))
                            pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell3.MinimumHeight = 18
                            pdfCell3.PaddingLeft = 5.0F
                            pdfCell3.Border = 0
                            pdfTable3.AddCell(pdfCell3)

                            pdfDoc.Add(pdfTable3)

                            '---------------------------------------END INFO TVA --------------------------

                        End If

                        Dim pdfTable7 As New PdfPTable(4) 'Number of columns

                        pdfTable7.TotalWidth = 530.0F
                        pdfTable7.LockedWidth = True
                        pdfTable7.HorizontalAlignment = Element.ALIGN_RIGHT
                        'pdfTable7.HeaderRows = 1

                        Dim widths7 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                        pdfTable7.SetWidths(widths7)

                        Dim pdfCell7 As PdfPCell = Nothing

                        SoldeNet = TotalVersement - (TotalFacture + TAxeSejour)

                        Dim terme As String = ""

                        If SoldeNet > 0 Then
                            terme = "FAVEUR CLIENT : "
                        ElseIf SoldeNet = 0 Then
                            terme = "SOLDE NUL : "
                        ElseIf 0 > SoldeNet Then
                            terme = "A REGLER : "
                        End If

                        pdfCell7 = New PdfPCell(New Paragraph(terme, fontTotal))
                        pdfCell7.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell7.MinimumHeight = 18
                        pdfCell7.PaddingLeft = 15.0F
                        pdfCell7.Colspan = 3
                        pdfCell7.Border = 0
                        pdfTable7.AddCell(pdfCell7)

                        If SoldeNet < 0 Then
                            'SoldeNet *= -1
                        End If

                        pdfCell7 = New PdfPCell(New Paragraph(Format(SoldeNet, "#,##0"), fontTotal))
                        pdfCell7.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell7.MinimumHeight = 18
                        pdfCell7.PaddingLeft = 5.0F
                        pdfCell7.Border = 0
                        pdfTable7.AddCell(pdfCell7)

                        pdfDoc.Add(pdfTable7)

                        '----------------------------------------

                        Dim chiffreEnLettre = New Paragraph(Chr(13) & Chr(13) & "Arrêter la présente à la somme de: " & NBLT(TotalFacture + TAxeSejour) & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE"), pRow)

                        pdfDoc.Add(chiffreEnLettre)

                    Else

                        Dim chiffreEnLettre = New Paragraph(Chr(13) & Chr(13) & "Reçu la somme de : " & NBLT(TotalFacture + TAxeSejour) & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE"), pRow)
                        If GlobalVariable.actualLanguageValue = 0 Then
                            chiffreEnLettre = New Paragraph(Chr(13) & Chr(13) & "Received an amount of : " & NBLT(TotalFacture + TAxeSejour) & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE"), pRow)

                        End If
                        pdfDoc.Add(chiffreEnLettre)

                    End If

                    Dim signature = New Paragraph(Chr(13) & Chr(13) & "                 SIGNATURE DU CLIENT                                                            SIGNATURE DE L'HOTEL", pRow)
                    If GlobalVariable.AgenceActuelle.Rows(0)("PRINT_B7") = 1 Then
                        signature = New Paragraph(Chr(13) & Chr(13) & "    SIGNATURE DU CLIENT             SIGNATURE DE L'HOTEL", pRow)
                    End If

                    If GlobalVariable.actualLanguageValue = 0 Then
                        signature = New Paragraph(Chr(13) & Chr(13) & "           CLIENT'S SIGNATURE                                                             HOTEL SIGNATURE", pRow)
                        If GlobalVariable.AgenceActuelle.Rows(0)("PRINT_B7") = 1 Then
                            signature = New Paragraph(Chr(13) & Chr(13) & "     CLIENT'S SIGNATURE         HOTEL SIGNATURE", pRow)
                        End If
                    End If

                    pdfDoc.Add(signature)

                Else
                    MessageBox.Show("Aucune Ligne de Fatcure à imprimer!")
                End If

            Next

            ' ------------------------------------------------------------------------------------------------

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub DocumentToPrint(ByVal ElementToDuplicate As String, ByVal Table As String, ByVal ColumnTitle As String, ByVal client As String, Optional ByVal reservationNum As String = "")

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0
        'Dim totalNormal As Double = 0
        Dim totalTVA As Double = 0
        Dim TAxeSejour As Double = 0
        Dim SoldeNet As Double = 0
        Dim TotalVersement As Double = 0

        Dim dt As DataTable
        Dim elements As DataTable
        Dim dtReg As DataTable

        Dim tousLesElemetsDeFacture As New DataTable()

        tousLesElemetsDeFacture.Columns.Add("DATE_ELEMENT", GetType(Date))
        tousLesElemetsDeFacture.Columns.Add("LIBELLE")
        tousLesElemetsDeFacture.Columns.Add("QUANTITE")
        tousLesElemetsDeFacture.Columns.Add("MONTANT")

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        Dim exonere As Boolean = False

        If Not Trim(GlobalVariable.codeReservationToUpdate).Equals("") Then
            'SI LE CODE DE RESERVATION EXISTE
            exonere = Functions.exonereDelaTVAComplet(GlobalVariable.codeReservationToUpdate)
        Else

            'SI LE CODE DE RESERVATION N'EXISTE PAS ON DOIT LE TROUVER DANS LA RESERVATIONS
            Dim CODE_FACTURE As String = ElementToDuplicate

            Dim infoSupFacture As DataTable = Functions.getElementByCode(CODE_FACTURE, "facture", "CODE_FACTURE")

            If infoSupFacture.Rows.Count > 0 Then
                Dim CODE_RESERVATION As String = infoSupFacture.Rows(0)("CODE_RESERVATION")
                exonere = Functions.exonereDelaTVAComplet(CODE_RESERVATION)
            End If

        End If

        If GlobalVariable.DocumentToGenerate = "facture" Then

            tireDocument = "FACTURE N° : "
            titreFichier = "FACTURE DE "

            dt = GetAllElementsOnCondition(ElementToDuplicate, "ligne_facture", "CODE_FACTURE")

            dtReg = GetAllElementsOnCondition(ElementToDuplicate, "reglement", "NUM_FACTURE")

            For i = 0 To dt.Rows.Count - 1

                Dim LIBELLE As String = dt.Rows(i)("LIBELLE_FACTURE").ToString.ToUpper()

                If Not LIBELLE.Contains("TAXE DE SEJOUR") Then
                    'TotalFacture += Functions.prelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT_TTC")) 'calcul de la somme apres prelevement de la taxe
                    TotalFacture += NonprelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT_TTC")) 'calcul de la somme apres prelevement de la taxe
                    totalTVA += Functions.prelevementDeTaxeSurUnMontantPOurCalcul(dt.Rows(i)("MONTANT_TTC")) 'calcul de la somme des taxes prelevees
                Else

                    If LIBELLE.Contains("TAXE DE SEJOUR") Then
                        TAxeSejour += Functions.NonprelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT_TTC"))
                    End If

                End If

                tousLesElemetsDeFacture.Rows.Add(CDate(dt.Rows(i)("DATE_FACTURE")).ToShortDateString, dt.Rows(i)("LIBELLE_FACTURE").ToString, dt.Rows(i)("QUANTITE"), dt.Rows(i)("MONTANT_TTC"))

                'TotalFacture += prelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT_TTC"))
                'totalTVA += prelevementDeTaxeSurUnMontantPOurCalcul(dt.Rows(i)("MONTANT_TTC"))
                'totalNormal += totalNormal + dt.Rows(i)("MONTANT_TTC")

            Next

            If exonere Then
                totalTVA = 0
            End If

            If dtReg.Rows.Count > 0 Then

                Dim n As Integer = 0

                For i = 0 To dtReg.Rows.Count - 1

                    TotalVersement += Functions.NonprelevementDeTaxeSurUnMontant(dtReg.Rows(i)("MONTANT_VERSE"))

                    n = i + 1

                    tousLesElemetsDeFacture.Rows.Add(CDate(dtReg.Rows(i)("DATE_REGLEMENT").ToShortDateString), dtReg.Rows(i)("REF_REGLEMENT").ToString, dtReg.Rows(i)("QUANTITE"), dtReg.Rows(i)("MONTANT_VERSE") * -1)

                Next

            End If

        ElseIf GlobalVariable.DocumentToGenerate = "reglement" Then

            tireDocument = "RECU N° : "
            titreFichier = "RECU DE "

            dtReg = GetAllElementsOnCondition(ElementToDuplicate, "reglement", "NUM_REGLEMENT")

            If dtReg.Rows.Count > 0 Then

                Dim n As Integer = 0

                For i = 0 To dtReg.Rows.Count - 1

                    TotalFacture += dtReg.Rows(i)("MONTANT_VERSE")

                    tousLesElemetsDeFacture.Rows.Add(CDate(dtReg.Rows(i)("DATE_REGLEMENT").ToShortDateString), dtReg.Rows(i)("REF_REGLEMENT").ToString, dtReg.Rows(i)("QUANTITE"), dtReg.Rows(i)("MONTANT_VERSE"))

                Next

            End If

        End If

        If tousLesElemetsDeFacture.Rows.Count > 0 Then
            'REORGANISATION PAR ORDRE DE DATE DECROISSANTE
            elements = chargementTemporaireDesElementsDeFacturePourImpression(tousLesElemetsDeFacture)
        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        Dim nomClient As String = ""

        Dim reservationToPrint As DataTable = Functions.getElementByCode(reservationNum, "reserve_conf", "CODE_RESERVATION")

        If reservationToPrint.Rows.Count > 0 Then

            If Not Trim(GlobalVariable.ReservationToUpdate(0)("CODE_ENTREPRISE")) = "" Then
                nomClient = GlobalVariable.ReservationToUpdate(0)("NOM_ENTREPRISE") & " ( " & GlobalVariable.ReservationToUpdate(0)("NOM_CLIENT") & " )"
            ElseIf getElementByCode(client, "client", "CODE_CLIENT").Rows.Count > 0 Then
                nomClient = getElementByCode(client, "client", "CODE_CLIENT").Rows(0)("NOM_PRENOM")
            End If

        Else

            If getElementByCode(client, "client", "CODE_CLIENT").Rows.Count > 0 Then
                nomClient = getElementByCode(client, "client", "CODE_CLIENT").Rows(0)("NOM_PRENOM")
            End If

        End If

        sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))

            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim pdfTable As New PdfPTable(4) 'Number of columns
            pdfTable.TotalWidth = 530.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}

            pdfTable.SetWidths(widths)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim Date_facture_reglement As Date = GlobalVariable.DateDeTravail
            Dim dateArrivee As Date
            Dim dateDepart As Date
            Dim CODE_RESERVATION As String = ""

            If GlobalVariable.DocumentToGenerate = "reglement" Then

                Dim infoSup As DataTable = Functions.getElementByCode(ElementToDuplicate, "reglement", "NUM_REGLEMENT")

                If infoSup.Rows.Count > 0 Then
                    Date_facture_reglement = CDate(infoSup.Rows(0)("DATE_REGLEMENT")).ToShortDateString
                    CODE_RESERVATION = infoSup.Rows(0)("DATE_REGLEMENT")
                End If

            ElseIf GlobalVariable.DocumentToGenerate = "facture" Then

                Dim infoSup As DataTable = Functions.getElementByCode(ElementToDuplicate, "facture", "CODE_FACTURE")

                If infoSup.Rows.Count > 0 Then
                    Date_facture_reglement = CDate(infoSup.Rows(0)("DATE_FACTURE")).ToShortDateString
                    CODE_RESERVATION = infoSup.Rows(0)("CODE_RESERVATION")
                End If

            End If

            Dim p10 As Paragraph
            Dim infoSupResa As DataTable = Functions.getElementByCode(CODE_RESERVATION, "reserve_conf", "CODE_RESERVATION")
            If infoSupResa.Rows.Count > 0 Then
                dateArrivee = infoSupResa.Rows(0)("DATE_ENTTRE")
                dateDepart = infoSupResa.Rows(0)("DATE_SORTIE")
                p10 = New Paragraph(Chr(13) & Chr(13) & Chr(13) & tireDocument & ElementToDuplicate & Chr(13) & "DATE : " & Date_facture_reglement & Chr(13) & "Date arrivée : " & dateArrivee.ToShortDateString & Chr(13) & "Date départ : " & dateDepart.ToShortDateString & Chr(13), pColumn)
            Else
                p10 = New Paragraph(Chr(13) & Chr(13) & Chr(13) & tireDocument & ElementToDuplicate & Chr(13) & "DATE : " & Date_facture_reglement & Chr(13), pColumn)
            End If

            p10.Alignment = Element.ALIGN_LEFT

            pdfDoc.Add(p10)

            Dim termes As String = ""

            Dim clientInformation As DataTable

            'If GlobalVariable.typeDeClientAFacturer = "en chambre" Then

            'SI ON TRAITE UNE RESERVATION

            If Not Trim(reservationNum).Equals("") Then

                If Not Trim(GlobalVariable.ReservationToUpdate(0)("CODE_ENTREPRISE")) = "" Then
                    clientInformation = Functions.getElementByCode(GlobalVariable.ReservationToUpdate(0)("CODE_ENTREPRISE"), "client", "CODE_CLIENT")
                Else
                    clientInformation = Functions.getElementByCode(client, "client", "CODE_CLIENT")
                End If

                If Not Trim(GlobalVariable.ReservationToUpdate(0)("CODE_ENTREPRISE")) = "" Then

                    If clientInformation.Rows.Count > 0 Then

                        termes = Chr(13) & "NOM DU CLIENT : " & clientInformation.Rows(0)("NOM_PRENOM") & "(" & GlobalVariable.ReservationToUpdate(0)("NOM_CLIENT") & ")" & Chr(13) & clientInformation.Rows(0)("NOM_JEUNE_FILLE") & Chr(13) & clientInformation.Rows(0)("PRENOMS") & Chr(13) & "CHAMBRE N° : " & GlobalVariable.ReservationToUpdate(0)("CHAMBRE_ID") & Chr(13) & "RESERVATION N° : " & GlobalVariable.codeReservationToUpdate & Chr(13) & Chr(13)

                    End If

                Else

                    If clientInformation.Rows.Count > 0 Then
                        termes = Chr(13) & "NOM DU CLIENT : " & nomClient & Chr(13) & "CHAMBRE N° : " & GlobalVariable.ReservationToUpdate(0)("CHAMBRE_ID") & Chr(13) & "RESERVATION N° : " & GlobalVariable.codeReservationToUpdate & Chr(13) & Chr(13)
                    End If

                End If

            Else
                termes = Chr(13) & "NOM DU CLIENT : " & nomClient & Chr(13) & Chr(13)
            End If

            pdfDoc.Add(New Paragraph(termes, pRow))

            pdfCell = New PdfPCell(New Paragraph("DATE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            If tousLesElemetsDeFacture.Rows.Count > 0 Then

                For i = 0 To tousLesElemetsDeFacture.Rows.Count - 1

                    If GlobalVariable.DocumentToGenerate = "facture" Then

                        pdfCell = New PdfPCell(New Paragraph(CDate(elements.Rows(i)("DATE_ELEMT")).ToShortDateString, font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(elements.Rows(i)("LIBELLE_ELEMENT"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(elements.Rows(i)("QUANTITE"), "#,##0"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfTable.AddCell(pdfCell)

                        'On ne preleve pas de taxe sur les taxes de sejours

                        Dim LIBELLE_TAXE As String = "TAXE DE SEJOUR"
                        Dim LIBELLE_FACTURE As String = elements.Rows(i)("LIBELLE_ELEMENT").ToString.ToUpper()

                        If Not LIBELLE_FACTURE.Contains(LIBELLE_TAXE) Then
                            'pdfCell = New PdfPCell(New Paragraph(Format(prelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT_TTC") * -1), "#,##0"), font1))
                            pdfCell = New PdfPCell(New Paragraph(Format(NonprelevementDeTaxeSurUnMontant(elements.Rows(i)("MONTANT") * -1), "#,##0"), font1))
                        Else
                            pdfCell = New PdfPCell(New Paragraph(Format(NonprelevementDeTaxeSurUnMontant(elements.Rows(i)("MONTANT") * -1), "#,##0"), font1))
                        End If

                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.AddCell(pdfCell)

                    ElseIf GlobalVariable.DocumentToGenerate = "reglement" Then

                        pdfCell = New PdfPCell(New Paragraph(CDate(elements.Rows(i)("DATE_ELEMT")).ToShortDateString, font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(elements.Rows(i)("LIBELLE_ELEMENT"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(elements.Rows(i)("QUANTITE"), "#,##0"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(elements.Rows(i)("MONTANT"), "#,##0"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.AddCell(pdfCell)

                    End If

                Next

                pdfDoc.Add(pdfTable)

                '------------------------------------------------------------------------

                If GlobalVariable.DocumentToGenerate = "reglement" Then

                    Dim pdfTable2 As New PdfPTable(4) 'Number of columns

                    pdfTable2.TotalWidth = 530.0F
                    pdfTable2.LockedWidth = True
                    pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                    'pdfTable2.HeaderRows = 1

                    'Dim widths2 As Single() = New Single() {5.8F, 1.8F}
                    Dim widths2 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                    pdfTable2.SetWidths(widths2)

                    Dim pdfCell2 As PdfPCell = Nothing

                    If GlobalVariable.DocumentToGenerate = "reglement" Then
                        pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & "TOTAL : ", fontTotal))
                    Else
                        pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & "TOTAL HT : ", fontTotal))
                    End If

                    pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell2.MinimumHeight = 18
                    pdfCell2.PaddingLeft = 15.0F
                    pdfCell2.Border = 0
                    pdfCell2.Colspan = 3

                    pdfTable2.AddCell(pdfCell2)

                    pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & Format(TotalFacture, "#,##0"), fontTotal))
                    pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell2.MinimumHeight = 18
                    pdfCell2.PaddingLeft = 5.0F
                    pdfCell2.Border = 0
                    pdfTable2.AddCell(pdfCell2)

                    pdfDoc.Add(pdfTable2)

                    '-----------------------------------
                End If


                If Not GlobalVariable.DocumentToGenerate = "reglement" Then

                    Dim TVA As Double = 0

                    If Not exonere Then

                        If societe.Rows(0)("TAUX_TVA") > 0 Then
                            TVA = totalTVA
                        Else
                            TVA = 0
                        End If

                    End If

                    '----------------------------- TOTAL HT -----------------------------------
                    Dim pdfTable06 As New PdfPTable(4)

                    pdfTable06.TotalWidth = 530.0F
                    pdfTable06.LockedWidth = True
                    pdfTable06.HorizontalAlignment = Element.ALIGN_RIGHT

                    Dim widths06 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                    pdfTable06.SetWidths(widths06)

                    Dim pdfCell06 As PdfPCell = Nothing

                    '------------------------------ DEBUT RECAPITULATIF OU BILAN ------------------------------------

                    pdfCell06 = New PdfPCell(New Paragraph("", fontTotal))
                    pdfCell06.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell06.MinimumHeight = 18
                    pdfCell06.PaddingLeft = 15.0F
                    pdfCell06.Colspan = 4
                    pdfCell06.Border = 0
                    pdfTable06.AddCell(pdfCell06)

                    pdfCell06 = New PdfPCell(New Paragraph("TOTAL HT : ", fontTotal))
                    pdfCell06.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell06.MinimumHeight = 18
                    pdfCell06.PaddingLeft = 15.0F
                    pdfCell06.Colspan = 3
                    pdfCell06.Border = 0
                    pdfTable06.AddCell(pdfCell06)

                    Dim TAXE_SEJOUR As Double = 0

                    pdfCell06 = New PdfPCell(New Paragraph(Format(TotalFacture - TVA, "#,##0"), fontTotal))
                    pdfCell06.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell06.MinimumHeight = 18
                    pdfCell06.PaddingLeft = 5.0F
                    pdfCell06.Border = 0
                    pdfTable06.AddCell(pdfCell06)

                    pdfDoc.Add(pdfTable06)

                    '--------------------------------------------------------------------------

                    If TAxeSejour >= 0 Then

                        Dim pdfTable6 As New PdfPTable(4) 'Number of columns

                        pdfTable6.TotalWidth = 530.0F
                        pdfTable6.LockedWidth = True
                        pdfTable6.HorizontalAlignment = Element.ALIGN_RIGHT
                        'pdfTable4.HeaderRows = 1

                        Dim widths6 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                        pdfTable6.SetWidths(widths6)

                        Dim pdfCell6 As PdfPCell = Nothing

                        pdfCell6 = New PdfPCell(New Paragraph("TAXE DE SEJOURS : ", fontTotal))
                        pdfCell6.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell6.MinimumHeight = 18
                        pdfCell6.PaddingLeft = 15.0F
                        pdfCell6.Colspan = 3
                        pdfCell6.Border = 0
                        pdfTable6.AddCell(pdfCell6)

                        'Dim TAXE_SEJOUR As Double = 0

                        pdfCell6 = New PdfPCell(New Paragraph(Format(TAxeSejour, "#,##0"), fontTotal))
                        pdfCell6.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell6.MinimumHeight = 18
                        pdfCell6.PaddingLeft = 5.0F
                        pdfCell6.Border = 0
                        pdfTable6.AddCell(pdfCell6)

                        pdfDoc.Add(pdfTable6)

                    End If

                    If TVA > 0 Then

                        Dim pdfTable4 As New PdfPTable(4) 'Number of columns

                        pdfTable4.TotalWidth = 530.0F
                        pdfTable4.LockedWidth = True
                        pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
                        'pdfTable4.HeaderRows = 1

                        Dim widths4 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                        pdfTable4.SetWidths(widths4)

                        Dim pdfCell4 As PdfPCell = Nothing

                        pdfCell4 = New PdfPCell(New Paragraph("TVA : ", fontTotal))
                        pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell4.MinimumHeight = 18
                        pdfCell4.PaddingLeft = 15.0F
                        pdfCell4.Border = 0
                        pdfCell4.Colspan = 3
                        pdfTable4.AddCell(pdfCell4)

                        pdfCell4 = New PdfPCell(New Paragraph(Format(TVA, "#,##0"), fontTotal))
                        pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell4.MinimumHeight = 18
                        pdfCell4.PaddingLeft = 5.0F
                        pdfCell4.Border = 0
                        pdfTable4.AddCell(pdfCell4)

                        pdfDoc.Add(pdfTable4)

                        '-----------------------------------
                        Dim pdfTable3 As New PdfPTable(4) 'Number of columns

                        pdfTable3.TotalWidth = 530.0F
                        pdfTable3.LockedWidth = True
                        pdfTable3.HorizontalAlignment = Element.ALIGN_RIGHT
                        'pdfTable3.HeaderRows = 1

                        Dim widths3 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                        pdfTable3.SetWidths(widths3)

                        Dim pdfCell3 As PdfPCell = Nothing

                        pdfCell3 = New PdfPCell(New Paragraph("", fontTotal))
                        pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell3.MinimumHeight = 18
                        pdfCell3.PaddingLeft = 15.0F
                        pdfCell3.Border = 0
                        pdfCell3.Colspan = 3
                        pdfTable3.AddCell(pdfCell3)

                        pdfCell3 = New PdfPCell(New Paragraph("----------------", fontTotal))
                        pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell3.MinimumHeight = 18
                        pdfCell3.PaddingLeft = 15.0F
                        pdfCell3.Border = 0
                        'pdfCell3.Colspan = 3
                        pdfTable3.AddCell(pdfCell3)

                        pdfCell3 = New PdfPCell(New Paragraph("TOTAL TTC : ", fontTotal))
                        pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell3.MinimumHeight = 18
                        pdfCell3.PaddingLeft = 15.0F
                        pdfCell3.Border = 0
                        pdfCell3.Colspan = 3
                        pdfTable3.AddCell(pdfCell3)

                        'Dim TotalTTC As Double = (TotalFacture * 0.1925) + TotalFacture

                        'pdfCell3 = New PdfPCell(New Paragraph(Format(TotalTTC, "#,##0"), fontTotal))
                        pdfCell3 = New PdfPCell(New Paragraph(Format(TotalFacture + TAxeSejour, "#,##0"), fontTotal))
                        pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell3.MinimumHeight = 18
                        pdfCell3.PaddingLeft = 5.0F
                        pdfCell3.Border = 0
                        pdfTable3.AddCell(pdfCell3)

                        pdfDoc.Add(pdfTable3)

                        '---------------------------------------END INFO TVA --------------------------

                    Else

                        '-----------------------------------
                        Dim pdfTable3 As New PdfPTable(4) 'Number of columns

                        pdfTable3.TotalWidth = 530.0F
                        pdfTable3.LockedWidth = True
                        pdfTable3.HorizontalAlignment = Element.ALIGN_RIGHT
                        'pdfTable3.HeaderRows = 1

                        Dim widths3 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                        pdfTable3.SetWidths(widths3)

                        Dim pdfCell3 As PdfPCell = Nothing

                        pdfCell3 = New PdfPCell(New Paragraph("", fontTotal))
                        pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell3.MinimumHeight = 18
                        pdfCell3.PaddingLeft = 15.0F
                        pdfCell3.Border = 0
                        pdfCell3.Colspan = 3
                        pdfTable3.AddCell(pdfCell3)

                        pdfCell3 = New PdfPCell(New Paragraph("----------------", fontTotal))
                        pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell3.MinimumHeight = 18
                        pdfCell3.PaddingLeft = 15.0F
                        pdfCell3.Border = 0
                        'pdfCell3.Colspan = 3
                        pdfTable3.AddCell(pdfCell3)

                        pdfCell3 = New PdfPCell(New Paragraph("TOTAL : ", fontTotal))
                        pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell3.MinimumHeight = 18
                        pdfCell3.PaddingLeft = 15.0F
                        pdfCell3.Border = 0
                        pdfCell3.Colspan = 3
                        pdfTable3.AddCell(pdfCell3)

                        pdfCell3 = New PdfPCell(New Paragraph(Format(TotalFacture + TAxeSejour, "#,##0"), fontTotal))
                        pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell3.MinimumHeight = 18
                        pdfCell3.PaddingLeft = 5.0F
                        pdfCell3.Border = 0
                        pdfTable3.AddCell(pdfCell3)

                        pdfDoc.Add(pdfTable3)

                        '---------------------------------------END INFO TVA --------------------------

                    End If

                    Dim pdfTable7 As New PdfPTable(4) 'Number of columns

                    pdfTable7.TotalWidth = 530.0F
                    pdfTable7.LockedWidth = True
                    pdfTable7.HorizontalAlignment = Element.ALIGN_RIGHT
                    'pdfTable7.HeaderRows = 1

                    Dim widths7 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                    pdfTable7.SetWidths(widths7)

                    Dim pdfCell7 As PdfPCell = Nothing

                    SoldeNet = TotalVersement - (TotalFacture + TAxeSejour)

                    Dim terme As String = ""

                    If SoldeNet > 0 Then
                        terme = "FAVEUR CLIENT : "
                    ElseIf SoldeNet = 0 Then
                        terme = "SOLDE NUL : "
                    ElseIf 0 > SoldeNet Then
                        terme = "A REGLER : "
                    End If

                    pdfCell7 = New PdfPCell(New Paragraph(terme, fontTotal))
                    pdfCell7.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell7.MinimumHeight = 18
                    pdfCell7.PaddingLeft = 15.0F
                    pdfCell7.Colspan = 3
                    pdfCell7.Border = 0
                    pdfTable7.AddCell(pdfCell7)

                    If SoldeNet < 0 Then
                        'SoldeNet *= -1
                    End If

                    pdfCell7 = New PdfPCell(New Paragraph(Format(SoldeNet, "#,##0"), fontTotal))
                    pdfCell7.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell7.MinimumHeight = 18
                    pdfCell7.PaddingLeft = 5.0F
                    pdfCell7.Border = 0
                    pdfTable7.AddCell(pdfCell7)

                    pdfDoc.Add(pdfTable7)

                    '----------------------------------------

                    Dim chiffreEnLettre = New Paragraph(Chr(13) & Chr(13) & "Arrêter la présente à la somme de: " & NBLT(TotalFacture + TAxeSejour) & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE"), pRow)

                    pdfDoc.Add(chiffreEnLettre)

                Else

                    Dim chiffreEnLettre = New Paragraph(Chr(13) & Chr(13) & "Reçu la somme de : " & NBLT(TotalFacture + TAxeSejour) & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE"), pRow)

                    pdfDoc.Add(chiffreEnLettre)

                End If

                Dim signature = New Paragraph(Chr(13) & Chr(13) & "             SIGNATURE DU CLIENT                                                            SIGNATURE DE L'HOTEL", pRow)

                pdfDoc.Add(signature)

            Else

                MessageBox.Show("Aucune Ligne de Fatcure à imprimer!")

            End If


            ' ------------------------------------------------------------------------------------------------

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub


    Public Shared Sub DocumentFactureToSend(ByVal ElementToDuplicate As String, ByVal Table As String, ByVal ColumnTitle As String, ByVal client As String, Optional ByVal reservationNum As String = "", Optional ByVal WHATSAPP_OU_EMAIL As Integer = 2)

        Dim titreFichier As String = ""

        Dim nomDuDossierRapport As String = ""

        If GlobalVariable.DocumentToGenerate = "facture" Then
            nomDuDossierRapport = "ENVOI\FACTURES"
            titreFichier = "Facture de " & GlobalVariable.ClientToUpdate.Rows(0)("NOM_PRENOM") & " " & (Date.Now().ToString("ddMMyyHHmmss"))

        Else
            nomDuDossierRapport = "ENVOI\RECUS"
            titreFichier = "Recu de " & GlobalVariable.ClientToUpdate.Rows(0)("NOM_PRENOM") & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        End If

        Dim filePathAndDirectory As String = GlobalVariable.AgenceActuelle.Rows(0)("CHEMIN_SAUVEGARDE_AUTO") & "\" & nomDuDossierRapport & "\" & GlobalVariable.DateDeTravail.ToString("ddMMyy")
        My.Computer.FileSystem.CreateDirectory(filePathAndDirectory)

        Dim TELEPHONE As String = GlobalVariable.ClientToUpdate.Rows(0)("TELEPHONE")
        Dim EMAIL As String = GlobalVariable.ClientToUpdate.Rows(0)("EMAIL")

        Dim fichier As String = filePathAndDirectory & "\" & titreFichier & ".pdf"

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0
        'Dim totalNormal As Double = 0
        Dim totalTVA As Double = 0
        Dim TAxeSejour As Double = 0
        Dim SoldeNet As Double = 0
        Dim TotalVersement As Double = 0

        Dim dt As DataTable
        Dim elements As DataTable
        Dim dtReg As DataTable

        Dim tousLesElemetsDeFacture As New DataTable()

        tousLesElemetsDeFacture.Columns.Add("DATE_ELEMENT", GetType(Date))
        tousLesElemetsDeFacture.Columns.Add("LIBELLE")
        tousLesElemetsDeFacture.Columns.Add("QUANTITE")
        tousLesElemetsDeFacture.Columns.Add("MONTANT")

        Dim tireDocument As String = ""

        Dim exonere As Boolean = False

        Dim CODE_RESERVATION As String = ""
        Dim Date_facture_reglement As Date
        Dim infoSupFacture As DataTable

        Dim CODE_FACTURE_REGLEMENT As String = ElementToDuplicate

        If Not Trim(GlobalVariable.codeReservationToUpdate).Equals("") Then
            'SI LE CODE DE RESERVATION EXISTE
            exonere = Functions.exonereDelaTVAComplet(GlobalVariable.codeReservationToUpdate)
        Else

            'SI LE CODE DE RESERVATION N'EXISTE PAS ON DOIT LE TROUVER DANS LA RESERVATIONS


            infoSupFacture = Functions.getElementByCode(CODE_FACTURE_REGLEMENT, "facture", "CODE_FACTURE")

            If infoSupFacture.Rows.Count > 0 Then
                CODE_RESERVATION = infoSupFacture.Rows(0)("CODE_RESERVATION")
                exonere = Functions.exonereDelaTVAComplet(CODE_RESERVATION)
                Date_facture_reglement = infoSupFacture.Rows(0)("DATE_FACTURE")
            End If

        End If



        If GlobalVariable.DocumentToGenerate = "facture" Then
            infoSupFacture = Functions.getElementByCode(CODE_FACTURE_REGLEMENT, "facture", "CODE_FACTURE")
            If infoSupFacture.Rows.Count > 0 Then
                Date_facture_reglement = infoSupFacture.Rows(0)("DATE_FACTURE")
                CODE_RESERVATION = infoSupFacture.Rows(0)("CODE_RESERVATION")
            End If
        Else
            infoSupFacture = Functions.getElementByCode(CODE_FACTURE_REGLEMENT, "reglement", "NUM_REGLEMENT")
            If infoSupFacture.Rows.Count > 0 Then
                Date_facture_reglement = infoSupFacture.Rows(0)("DATE_REGLEMENT")
                CODE_RESERVATION = infoSupFacture.Rows(0)("CODE_RESERVATION")
            End If
        End If

        If GlobalVariable.DocumentToGenerate = "facture" Then

            tireDocument = "FACTURE N° : "
            'titreFichier = "FACTURE DE "

            dt = GetAllElementsOnCondition(ElementToDuplicate, "ligne_facture", "CODE_FACTURE")

            dtReg = GetAllElementsOnCondition(ElementToDuplicate, "reglement", "NUM_FACTURE")

            For i = 0 To dt.Rows.Count - 1

                Dim LIBELLE As String = dt.Rows(i)("LIBELLE_FACTURE").ToString.ToUpper()

                If Not LIBELLE.Contains("TAXE DE SEJOUR") Then
                    'TotalFacture += Functions.prelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT_TTC")) 'calcul de la somme apres prelevement de la taxe
                    TotalFacture += NonprelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT_TTC")) 'calcul de la somme apres prelevement de la taxe
                    totalTVA += Functions.prelevementDeTaxeSurUnMontantPOurCalcul(dt.Rows(i)("MONTANT_TTC")) 'calcul de la somme des taxes prelevees
                Else

                    If LIBELLE.Contains("TAXE DE SEJOUR") Then
                        TAxeSejour += Functions.NonprelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT_TTC"))
                    End If

                End If

                tousLesElemetsDeFacture.Rows.Add(CDate(dt.Rows(i)("DATE_FACTURE")).ToShortDateString, dt.Rows(i)("LIBELLE_FACTURE").ToString, dt.Rows(i)("QUANTITE"), dt.Rows(i)("MONTANT_TTC"))

                'TotalFacture += prelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT_TTC"))
                'totalTVA += prelevementDeTaxeSurUnMontantPOurCalcul(dt.Rows(i)("MONTANT_TTC"))
                'totalNormal += totalNormal + dt.Rows(i)("MONTANT_TTC")

            Next

            If exonere Then 
                totalTVA = 0
            End If

            If dtReg.Rows.Count > 0 Then

                Dim n As Integer = 0

                For i = 0 To dtReg.Rows.Count - 1

                    TotalVersement += Functions.NonprelevementDeTaxeSurUnMontant(dtReg.Rows(i)("MONTANT_VERSE"))

                    n = i + 1

                    tousLesElemetsDeFacture.Rows.Add(CDate(dtReg.Rows(i)("DATE_REGLEMENT").ToShortDateString), dtReg.Rows(i)("REF_REGLEMENT").ToString, dtReg.Rows(i)("QUANTITE"), dtReg.Rows(i)("MONTANT_VERSE") * -1)

                Next

            End If

        ElseIf GlobalVariable.DocumentToGenerate = "reglement" Then

            tireDocument = "RECU N° : "

            dtReg = GetAllElementsOnCondition(ElementToDuplicate, "reglement", "NUM_REGLEMENT")

            If dtReg.Rows.Count > 0 Then

                Dim n As Integer = 0

                For i = 0 To dtReg.Rows.Count - 1

                    TotalFacture += dtReg.Rows(i)("MONTANT_VERSE")

                    tousLesElemetsDeFacture.Rows.Add(CDate(dtReg.Rows(i)("DATE_REGLEMENT").ToShortDateString), dtReg.Rows(i)("REF_REGLEMENT").ToString, dtReg.Rows(i)("QUANTITE"), dtReg.Rows(i)("MONTANT_VERSE"))

                Next

            End If

        End If

        If tousLesElemetsDeFacture.Rows.Count > 0 Then
            'REORGANISATION PAR ORDRE DE DATE DECROISSANTE
            elements = chargementTemporaireDesElementsDeFacturePourImpression(tousLesElemetsDeFacture)
        End If

        Dim nomClient As String = ""

        Dim reservationToPrint As DataTable = Functions.getElementByCode(reservationNum, "reserve_conf", "CODE_RESERVATION")

        If reservationToPrint.Rows.Count > 0 Then

            If Not Trim(GlobalVariable.ReservationToUpdate(0)("CODE_ENTREPRISE")) = "" Then
                nomClient = GlobalVariable.ReservationToUpdate(0)("NOM_ENTREPRISE") & " ( " & GlobalVariable.ReservationToUpdate(0)("NOM_CLIENT") & " )"
            ElseIf getElementByCode(client, "client", "CODE_CLIENT").Rows.Count > 0 Then
                nomClient = getElementByCode(client, "client", "CODE_CLIENT").Rows(0)("NOM_PRENOM")
            End If

        Else

            If getElementByCode(client, "client", "CODE_CLIENT").Rows.Count > 0 Then
                nomClient = getElementByCode(client, "client", "CODE_CLIENT").Rows(0)("NOM_PRENOM")
            End If

        End If

        Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
        Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(fichier, FileMode.Create))

        Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
        Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
        Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
        Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

        Dim pdfTable As New PdfPTable(4) 'Number of columns
        pdfTable.TotalWidth = 530.0F
        pdfTable.LockedWidth = True
        pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
        pdfTable.HeaderRows = 1

        Dim widths As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}

        pdfTable.SetWidths(widths)

        Dim pdfCell As PdfPCell = Nothing

        pdfWrite.PageEvent = New HeaderFooter

        pdfDoc.Open()

        Dim dateArrivee As Date
        Dim dateDepart As Date

        Dim p10 As Paragraph
        Dim infoSupResa As DataTable = Functions.getElementByCode(CODE_RESERVATION, "reserve_conf", "CODE_RESERVATION")
        If infoSupResa.Rows.Count > 0 Then
            dateArrivee = infoSupResa.Rows(0)("DATE_ENTTRE")
            dateDepart = infoSupResa.Rows(0)("DATE_SORTIE")
            p10 = New Paragraph(Chr(13) & Chr(13) & Chr(13) & tireDocument & ElementToDuplicate & Chr(13) & "DATE : " & Date_facture_reglement & Chr(13) & "Date arrivée : " & dateArrivee.ToShortDateString & Chr(13) & "Date départ : " & dateDepart.ToShortDateString & Chr(13), pColumn)
        Else
            p10 = New Paragraph(Chr(13) & Chr(13) & Chr(13) & tireDocument & ElementToDuplicate & Chr(13) & "DATE : " & Date_facture_reglement & Chr(13), pColumn)
        End If

        p10.Alignment = Element.ALIGN_LEFT

        pdfDoc.Add(p10)

        Dim termes As String = ""

        Dim clientInformation As DataTable

        'If GlobalVariable.typeDeClientAFacturer = "en chambre" Then

        'SI ON TRAITE UNE RESERVATION

        If Not Trim(reservationNum).Equals("") Then

            If Not Trim(GlobalVariable.ReservationToUpdate(0)("CODE_ENTREPRISE")) = "" Then
                clientInformation = Functions.getElementByCode(GlobalVariable.ReservationToUpdate(0)("CODE_ENTREPRISE"), "client", "CODE_CLIENT")
            Else
                clientInformation = Functions.getElementByCode(client, "client", "CODE_CLIENT")
            End If

            If Not Trim(GlobalVariable.ReservationToUpdate(0)("CODE_ENTREPRISE")) = "" Then

                If clientInformation.Rows.Count > 0 Then

                    termes = Chr(13) & "NOM DU CLIENT : " & clientInformation.Rows(0)("NOM_PRENOM") & "(" & GlobalVariable.ReservationToUpdate(0)("NOM_CLIENT") & ")" & Chr(13) & clientInformation.Rows(0)("NOM_JEUNE_FILLE") & Chr(13) & clientInformation.Rows(0)("PRENOMS") & Chr(13) & "CHAMBRE N° : " & GlobalVariable.ReservationToUpdate(0)("CHAMBRE_ID") & Chr(13) & "RESERVATION N° : " & GlobalVariable.codeReservationToUpdate & Chr(13) & Chr(13)

                End If

            Else

                If clientInformation.Rows.Count > 0 Then

                    termes = Chr(13) & "NOM DU CLIENT : " & nomClient & Chr(13) & "CHAMBRE N° : " & GlobalVariable.ReservationToUpdate(0)("CHAMBRE_ID") & Chr(13) & "RESERVATION N° : " & GlobalVariable.codeReservationToUpdate & Chr(13) & Chr(13)

                End If

            End If

        Else
            termes = Chr(13) & "NOM DU CLIENT : " & nomClient & Chr(13) & Chr(13)
        End If

        pdfDoc.Add(New Paragraph(termes, pRow))

        pdfCell = New PdfPCell(New Paragraph("DATE", pColumn))
        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
        pdfCell.MinimumHeight = 15
        pdfCell.PaddingLeft = 5.0F
        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
        pdfTable.AddCell(pdfCell)

        pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
        pdfCell.MinimumHeight = 15
        pdfCell.PaddingLeft = 5.0F
        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
        pdfTable.AddCell(pdfCell)

        pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
        pdfCell.MinimumHeight = 15
        pdfCell.PaddingLeft = 5.0F
        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
        pdfTable.AddCell(pdfCell)

        pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
        pdfCell.MinimumHeight = 15
        pdfCell.PaddingLeft = 5.0F
        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
        pdfTable.AddCell(pdfCell)

        If tousLesElemetsDeFacture.Rows.Count > 0 Then

            For i = 0 To tousLesElemetsDeFacture.Rows.Count - 1

                If GlobalVariable.DocumentToGenerate = "facture" Then

                    pdfCell = New PdfPCell(New Paragraph(CDate(elements.Rows(i)("DATE_ELEMT")).ToShortDateString, font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(elements.Rows(i)("LIBELLE_ELEMENT"), font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(elements.Rows(i)("QUANTITE"), "#,##0"), font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfTable.AddCell(pdfCell)

                    'On ne preleve pas de taxe sur les taxes de sejours

                    Dim LIBELLE_TAXE As String = "TAXE DE SEJOUR"
                    Dim LIBELLE_FACTURE As String = elements.Rows(i)("LIBELLE_ELEMENT").ToString.ToUpper()

                    If Not LIBELLE_FACTURE.Contains(LIBELLE_TAXE) Then
                        'pdfCell = New PdfPCell(New Paragraph(Format(prelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT_TTC") * -1), "#,##0"), font1))
                        pdfCell = New PdfPCell(New Paragraph(Format(NonprelevementDeTaxeSurUnMontant(elements.Rows(i)("MONTANT") * -1), "#,##0"), font1))
                    Else
                        pdfCell = New PdfPCell(New Paragraph(Format(NonprelevementDeTaxeSurUnMontant(elements.Rows(i)("MONTANT") * -1), "#,##0"), font1))
                    End If

                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.AddCell(pdfCell)

                ElseIf GlobalVariable.DocumentToGenerate = "reglement" Then

                    pdfCell = New PdfPCell(New Paragraph(CDate(elements.Rows(i)("DATE_ELEMT")).ToShortDateString, font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(elements.Rows(i)("LIBELLE_ELEMENT"), font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(elements.Rows(i)("QUANTITE"), "#,##0"), font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(elements.Rows(i)("MONTANT"), "#,##0"), font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.AddCell(pdfCell)

                End If

            Next

            pdfDoc.Add(pdfTable)

            If GlobalVariable.DocumentToGenerate = "reglement" Then 
                
                '------------------------------------------------------------------------

                Dim pdfTable2 As New PdfPTable(4) 'Number of columns

                pdfTable2.TotalWidth = 530.0F
                pdfTable2.LockedWidth = True
                pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfTable2.HeaderRows = 1

                'Dim widths2 As Single() = New Single() {5.8F, 1.8F}
                Dim widths2 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                pdfTable2.SetWidths(widths2)

                Dim pdfCell2 As PdfPCell = Nothing

                If GlobalVariable.DocumentToGenerate = "reglement" Then
                    pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & "TOTAL : ", fontTotal))
                Else
                    pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & "TOTAL HT : ", fontTotal))
                End If

                pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell2.MinimumHeight = 18
                pdfCell2.PaddingLeft = 15.0F
                pdfCell2.Border = 0
                pdfCell2.Colspan = 3

                pdfTable2.AddCell(pdfCell2)

                pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & Format(TotalFacture, "#,##0"), fontTotal))
                pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell2.MinimumHeight = 18
                pdfCell2.PaddingLeft = 5.0F
                pdfCell2.Border = 0
                pdfTable2.AddCell(pdfCell2)

                pdfDoc.Add(pdfTable2)

            '-----------------------------------

            End If

            If Not GlobalVariable.DocumentToGenerate = "reglement" Then
                
                Dim TVA As Double = 0

                If Not exonere Then 
                    
                    If societe.Rows(0)("TAUX_TVA") > 0 Then
                        TVA = totalTVA
                    Else
                        TVA = 0
                    End If

                End If


                '----------------------------- TOTAL HT -----------------------------------
                Dim pdfTable06 As New PdfPTable(4)

                pdfTable06.TotalWidth = 530.0F
                pdfTable06.LockedWidth = True
                pdfTable06.HorizontalAlignment = Element.ALIGN_RIGHT

                Dim widths06 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                pdfTable06.SetWidths(widths06)

                Dim pdfCell06 As PdfPCell = Nothing

                '------------------------------ DEBUT RECAPITULATIF OU BILAN ------------------------------------

                pdfCell06 = New PdfPCell(New Paragraph("", fontTotal))
                pdfCell06.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell06.MinimumHeight = 18
                pdfCell06.PaddingLeft = 15.0F
                pdfCell06.Colspan = 4
                pdfCell06.Border = 0
                pdfTable06.AddCell(pdfCell06)

                pdfCell06 = New PdfPCell(New Paragraph("TOTAL HT : ", fontTotal))
                pdfCell06.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell06.MinimumHeight = 18
                pdfCell06.PaddingLeft = 15.0F
                pdfCell06.Colspan = 3
                pdfCell06.Border = 0
                pdfTable06.AddCell(pdfCell06)

                Dim TAXE_SEJOUR As Double = 0

                pdfCell06 = New PdfPCell(New Paragraph(Format(TotalFacture - TVA, "#,##0"), fontTotal))
                pdfCell06.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell06.MinimumHeight = 18
                pdfCell06.PaddingLeft = 5.0F
                pdfCell06.Border = 0
                pdfTable06.AddCell(pdfCell06)

                pdfDoc.Add(pdfTable06)

                '--------------------------------------------------------------------------

                If TAxeSejour >= 0 Then

                    '-----------------------------------

                    Dim pdfTable6 As New PdfPTable(4) 'Number of columns

                    pdfTable6.TotalWidth = 530.0F
                    pdfTable6.LockedWidth = True
                    pdfTable6.HorizontalAlignment = Element.ALIGN_RIGHT
                    'pdfTable4.HeaderRows = 1

                    Dim widths6 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                    pdfTable6.SetWidths(widths6)

                    Dim pdfCell6 As PdfPCell = Nothing

                    pdfCell6 = New PdfPCell(New Paragraph("TAXE DE SEJOURS : ", fontTotal))
                    pdfCell6.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell6.MinimumHeight = 18
                    pdfCell6.PaddingLeft = 15.0F
                    pdfCell6.Colspan = 3
                    pdfCell6.Border = 0
                    pdfTable6.AddCell(pdfCell6)

                    'Dim TAXE_SEJOUR As Double = 0

                    pdfCell6 = New PdfPCell(New Paragraph(Format(TAxeSejour, "#,##0"), fontTotal))
                    pdfCell6.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell6.MinimumHeight = 18
                    pdfCell6.PaddingLeft = 5.0F
                    pdfCell6.Border = 0
                    pdfTable6.AddCell(pdfCell6)

                    pdfDoc.Add(pdfTable6)

                    '-----------------------------------
                End If

                If TVA > 0 Then

                    Dim pdfTable4 As New PdfPTable(4) 'Number of columns

                    pdfTable4.TotalWidth = 530.0F
                    pdfTable4.LockedWidth = True
                    pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
                    'pdfTable4.HeaderRows = 1

                    Dim widths4 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                    pdfTable4.SetWidths(widths4)

                    Dim pdfCell4 As PdfPCell = Nothing

                    pdfCell4 = New PdfPCell(New Paragraph("TVA : ", fontTotal))
                    pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell4.MinimumHeight = 18
                    pdfCell4.PaddingLeft = 15.0F
                    pdfCell4.Border = 0
                    pdfCell4.Colspan = 3
                    pdfTable4.AddCell(pdfCell4)

                    pdfCell4 = New PdfPCell(New Paragraph(Format(TVA, "#,##0"), fontTotal))
                    pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell4.MinimumHeight = 18
                    pdfCell4.PaddingLeft = 5.0F
                    pdfCell4.Border = 0
                    pdfTable4.AddCell(pdfCell4)

                    pdfDoc.Add(pdfTable4)


                    Dim pdfTable3 As New PdfPTable(4) 'Number of columns

                    pdfTable3.TotalWidth = 530.0F
                    pdfTable3.LockedWidth = True
                    pdfTable3.HorizontalAlignment = Element.ALIGN_RIGHT
                    'pdfTable3.HeaderRows = 1

                    Dim widths3 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                    pdfTable3.SetWidths(widths3)

                    Dim pdfCell3 As PdfPCell = Nothing

                    pdfCell3 = New PdfPCell(New Paragraph("", fontTotal))
                    pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell3.MinimumHeight = 18
                    pdfCell3.PaddingLeft = 15.0F
                    pdfCell3.Border = 0
                    pdfCell3.Colspan = 3
                    pdfTable3.AddCell(pdfCell3)

                    pdfCell3 = New PdfPCell(New Paragraph("----------------", fontTotal))
                    pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell3.MinimumHeight = 18
                    pdfCell3.PaddingLeft = 15.0F
                    pdfCell3.Border = 0
                    'pdfCell3.Colspan = 3
                    pdfTable3.AddCell(pdfCell3)

                    pdfCell3 = New PdfPCell(New Paragraph("TOTAL TTC : ", fontTotal))
                    pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell3.MinimumHeight = 18
                    pdfCell3.PaddingLeft = 15.0F
                    pdfCell3.Border = 0
                    pdfCell3.Colspan = 3
                    pdfTable3.AddCell(pdfCell3)

                    pdfCell3 = New PdfPCell(New Paragraph(Format(TotalFacture + TAxeSejour, "#,##0"), fontTotal))
                    pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell3.MinimumHeight = 18
                    pdfCell3.PaddingLeft = 5.0F
                    pdfCell3.Border = 0
                    pdfTable3.AddCell(pdfCell3)

                    pdfDoc.Add(pdfTable3)

                    '---------------------------------------END INFO TVA --------------------------

                Else

                    '-----------------------------------
                    Dim pdfTable3 As New PdfPTable(4) 'Number of columns

                    pdfTable3.TotalWidth = 530.0F
                    pdfTable3.LockedWidth = True
                    pdfTable3.HorizontalAlignment = Element.ALIGN_RIGHT
                    'pdfTable3.HeaderRows = 1

                    Dim widths3 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                    pdfTable3.SetWidths(widths3)

                    Dim pdfCell3 As PdfPCell = Nothing

                    pdfCell3 = New PdfPCell(New Paragraph("", fontTotal))
                    pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell3.MinimumHeight = 18
                    pdfCell3.PaddingLeft = 15.0F
                    pdfCell3.Border = 0
                    pdfCell3.Colspan = 3
                    pdfTable3.AddCell(pdfCell3)

                    pdfCell3 = New PdfPCell(New Paragraph("----------------", fontTotal))
                    pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell3.MinimumHeight = 18
                    pdfCell3.PaddingLeft = 15.0F
                    pdfCell3.Border = 0
                    'pdfCell3.Colspan = 3
                    pdfTable3.AddCell(pdfCell3)

                    pdfCell3 = New PdfPCell(New Paragraph("TOTAL : ", fontTotal))
                    pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell3.MinimumHeight = 18
                    pdfCell3.PaddingLeft = 15.0F
                    pdfCell3.Border = 0
                    pdfCell3.Colspan = 3
                    pdfTable3.AddCell(pdfCell3)

                    pdfCell3 = New PdfPCell(New Paragraph(Format(TotalFacture + TAxeSejour, "#,##0"), fontTotal))
                    pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell3.MinimumHeight = 18
                    pdfCell3.PaddingLeft = 5.0F
                    pdfCell3.Border = 0
                    pdfTable3.AddCell(pdfCell3)

                    pdfDoc.Add(pdfTable3)

                End If

                Dim pdfTable7 As New PdfPTable(4) 'Number of columns

                pdfTable7.TotalWidth = 530.0F
                pdfTable7.LockedWidth = True
                pdfTable7.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfTable7.HeaderRows = 1

                Dim widths7 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                pdfTable7.SetWidths(widths7)

                Dim pdfCell7 As PdfPCell = Nothing

                SoldeNet = TotalVersement - (TotalFacture + TAxeSejour)

                Dim terme As String = ""

                If SoldeNet > 0 Then
                    terme = "FAVEUR CLIENT : "
                ElseIf SoldeNet = 0 Then
                    terme = "SOLDE NUL : "
                ElseIf 0 > SoldeNet Then
                    terme = "A REGLER : "
                End If

                pdfCell7 = New PdfPCell(New Paragraph(terme, fontTotal))
                pdfCell7.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell7.MinimumHeight = 18
                pdfCell7.PaddingLeft = 15.0F
                pdfCell7.Colspan = 3
                pdfCell7.Border = 0
                pdfTable7.AddCell(pdfCell7)

                If SoldeNet < 0 Then
                    'SoldeNet *= -1
                End If

                pdfCell7 = New PdfPCell(New Paragraph(Format(SoldeNet, "#,##0"), fontTotal))
                pdfCell7.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell7.MinimumHeight = 18
                pdfCell7.PaddingLeft = 5.0F
                pdfCell7.Border = 0
                pdfTable7.AddCell(pdfCell7)

                pdfDoc.Add(pdfTable7)

                '----------------------------------------

                Dim chiffreEnLettre = New Paragraph(Chr(13) & Chr(13) & "Arrêter la présente à la somme de : " & NBLT(TotalFacture + TAxeSejour) & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE"), pRow)

                pdfDoc.Add(chiffreEnLettre)

                ' -----------------------------------------------------------------------------------------------------
                Dim p2 As Paragraph = New Paragraph(Chr(13) & Chr(13) & "SIGNATURE DU CLIENT                                                    SIGNATURE DE L'HOTEL")
                p2.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p2)

            Else

                Dim chiffreEnLettre = New Paragraph(Chr(13) & Chr(13) & "Reçu la somme de : " & NBLT(TotalFacture + TAxeSejour) & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE"), pRow)

                pdfDoc.Add(chiffreEnLettre)

                Dim p2 As Paragraph = New Paragraph(Chr(13) & Chr(13) & "                                                                        SIGNATURE DU CLIENT")
                p2.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p2)

            End If

        Else

            MessageBox.Show("Aucune Ligne de Fatcure à imprimer!")

        End If


        ' ------------------------------------------------------------------------------------------------

        pdfDoc.Close()

        Dim Titre As String = "FACTURE DE " & client

        If GlobalVariable.DocumentToGenerate = "reglement" Then
            Titre = "RECU DE " & client
        Else
            Titre = "FACTURE DE " & client
        End If

        Dim bodyText As String = "Ci jointe votre facture"

        If WHATSAPP_OU_EMAIL = 1 Then

            RapportApresCloture.envoieDocumentMailClient(fichier, Titre, bodyText, EMAIL)

        ElseIf WHATSAPP_OU_EMAIL = 0 Then

            Dim nmessageOuDocument As Integer = 1
            Dim typeDeDocument As Integer = 2

            Functions.ultrMessage(fichier, nmessageOuDocument, Titre, bodyText, typeDeDocument, TELEPHONE)

        End If

    End Sub

    Public Shared Function ModeDeReglementDeSituationDeCaisse(ByVal DateDeSituation As Date) As DataTable

        'LA SITUATION DE CAISSE EST FONCTION DE LA DATE ET DU MODE DE REGLEMENT ESE

        Dim getUserQuery = "SELECT DISTINCT MODE_REGLEMENT FROM reglement WHERE CODE_CAISSIER = @CODE_CAISSIER AND DATE_REGLEMENT >= '" & DateDeSituation.ToString("yyyy-MM-dd") & "' AND DATE_REGLEMENT <= '" & GlobalVariable.DateDeTravail.ToString("yyyy-MM-dd") & "' ORDER BY DATE_REGLEMENT DESC"

        Dim command As New MySqlCommand(getUserQuery, GlobalVariable.connect)

        command.Parameters.Add("@CODE_CAISSIER", MySqlDbType.VarChar).Value = GlobalVariable.ConnectedUser.Rows(0)("CODE_UTILISATEUR")

        Dim adapter As New MySqlDataAdapter

        Dim dt As New DataTable()
        'Dim command As New MySqlCommand(query, GlobalVariable.connect)

        adapter.SelectCommand = command
        adapter.Fill(dt)

        'MessageBox.Show(dt.Rows.Count)

        Return dt

    End Function

    Public Shared Function SituationDeCaisse(ByVal DateDeSituation As Date) As DataTable

        Dim getUserQuery = "SELECT * FROM reglement WHERE CODE_CAISSIER = @CODE_CAISSIER AND DATE_REGLEMENT >= '" & DateDeSituation.ToString("yyyy-MM-dd") & "' AND DATE_REGLEMENT <= '" & DateDeSituation.ToString("yyyy-MM-dd") & "' AND ETAT=@ETAT ORDER BY DATE_REGLEMENT DESC"

        Dim command As New MySqlCommand(getUserQuery, GlobalVariable.connect)

        command.Parameters.Add("@CODE_CAISSIER", MySqlDbType.VarChar).Value = GlobalVariable.ConnectedUser.Rows(0)("CODE_UTILISATEUR")
        'command.Parameters.Add("@MODE_REGLEMENT", MySqlDbType.VarChar).Value = "Espèce"
        command.Parameters.Add("@ETAT", MySqlDbType.Int64).Value = 0

        Dim adapter As New MySqlDataAdapter

        Dim dt As New DataTable()
        'Dim command As New MySqlCommand(query, GlobalVariable.connect)

        adapter.SelectCommand = command
        adapter.Fill(dt)

        Return dt

    End Function

    Public Shared Function SituationDeCaisseParModeDeReglement(ByVal DateDeSituation As Date, ByVal MODE_REGLEMENT As String) As DataTable

        Dim getUserQuery = "SELECT * FROM reglement WHERE CODE_CAISSIER = @CODE_CAISSIER AND DATE_REGLEMENT >= '" & DateDeSituation.ToString("yyyy-MM-dd") & "' AND DATE_REGLEMENT <= '" & DateDeSituation.ToString("yyyy-MM-dd") & "' AND MODE_REGLEMENT=@MODE_REGLEMENT ORDER BY DATE_REGLEMENT DESC"

        Dim command As New MySqlCommand(getUserQuery, GlobalVariable.connect)

        command.Parameters.Add("@CODE_CAISSIER", MySqlDbType.VarChar).Value = GlobalVariable.ConnectedUser.Rows(0)("CODE_UTILISATEUR")
        command.Parameters.Add("@MODE_REGLEMENT", MySqlDbType.VarChar).Value = MODE_REGLEMENT
        Dim adapter As New MySqlDataAdapter

        Dim dt As New DataTable()
        'Dim command As New MySqlCommand(query, GlobalVariable.connect)

        adapter.SelectCommand = command
        adapter.Fill(dt)

        Return dt

    End Function

    Public Shared Function SituationDeCaisseCasDeRemboursement(ByVal DateDeSituation As Date) As DataTable

        Dim getUserQuery = "SELECT * FROM ligne_facture WHERE CODE_UTILISATEUR_CREA = @CODE_CAISSIER AND DATE_FACTURE >= '" & DateDeSituation.ToString("yyyy-MM-dd") & "' AND DATE_FACTURE <= '" & DateDeSituation.ToString("yyyy-MM-dd") & "' AND TYPE_LIGNE_FACTURE=@TYPE_LIGNE_FACTURE ORDER BY DATE_FACTURE DESC"

        Dim command As New MySqlCommand(getUserQuery, GlobalVariable.connect)

        command.Parameters.Add("@CODE_CAISSIER", MySqlDbType.VarChar).Value = GlobalVariable.ConnectedUser.Rows(0)("CODE_UTILISATEUR")
        command.Parameters.Add("@TYPE_LIGNE_FACTURE", MySqlDbType.VarChar).Value = "Remboursement"
        Dim adapter As New MySqlDataAdapter

        Dim dt As New DataTable()
        'Dim command As New MySqlCommand(query, GlobalVariable.connect)

        adapter.SelectCommand = command
        adapter.Fill(dt)

        Return dt

    End Function

    Public Shared Sub DocumentToPrintSituation(ByVal CODE_CAISSIER As String, ByVal Table As String, ByVal ColumnTitle As String, ByVal DateDeSituation As Date)

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0
        Dim GrandTotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        If GlobalVariable.actualLanguageValue = 1 Then
            tireDocument = "SITUATION DE CAISSE "
            titreFichier = "SITUATION DE CAISSE DE "
        Else
            tireDocument = "CASHIER SITUATION OF THE SHIFT "
            titreFichier = "CASHIER SITUATION OF THE SHIFT "
        End If

        Dim dt As New DataTable()

        Dim dtModeReglement As New DataTable()

        'SELECTION DES MODES DE REGLEMENTS
        dtModeReglement = ModeDeReglementDeSituationDeCaisse(DateDeSituation)

        'SELECTION DES REGLEMENTS
        dt = SituationDeCaisse(DateDeSituation)

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & getElementByCode(CODE_CAISSIER, "utilisateurs", "CODE_UTILISATEUR").Rows(0)("NOM_UTILISATEUR") & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then

            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            Dim Caissier

            If GlobalVariable.actualLanguageValue = 1 Then
                Caissier = New Paragraph("Caissier : " & getElementByCode(CODE_CAISSIER, "utilisateurs", "CODE_UTILISATEUR").Rows(0)("NOM_UTILISATEUR") & Chr(13) & "Date:" & GlobalVariable.DateDeTravail & Chr(13) & Chr(13), pColumn)
            Else
                Caissier = New Paragraph("Cashier : " & getElementByCode(CODE_CAISSIER, "utilisateurs", "CODE_UTILISATEUR").Rows(0)("NOM_UTILISATEUR") & Chr(13) & "Date:" & GlobalVariable.DateDeTravail & Chr(13) & Chr(13), pColumn)
            End If

            pdfDoc.Add(Caissier)

            'If dt.Rows.Count > 0 Then

            Dim TotalFactureGratuite As Double = 0
            Dim pdfCell As PdfPCell = Nothing

            For j = 0 To dtModeReglement.Rows.Count - 1

                Dim pdfTable As New PdfPTable(3) 'Number of columns
                pdfTable.TotalWidth = 520.0F
                pdfTable.LockedWidth = True
                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable.HeaderRows = 1

                'Dim widths As Single() = New Single() {2.0F, 5.0F, 2.5F, 1.5F}
                Dim widths As Single() = New Single() {2.0F, 10.0F, 2.5F}
                pdfTable.SetWidths(widths)

                Dim p1 = New Paragraph(dtModeReglement.Rows(j)("MODE_REGLEMENT") & Chr(13) & Chr(13), pColumn)

                pdfDoc.Add(p1)

                Dim MODE_REGLEMENT As String = dtModeReglement.Rows(j)("MODE_REGLEMENT")

                pdfCell = New PdfPCell(New Paragraph("DATE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("MODE REGLEMENT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                'pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("MONTANT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                TotalFacture = 0
                TotalFactureGratuite = 0
                Dim dtSpecific As DataTable = SituationDeCaisseParModeDeReglement(DateDeSituation, MODE_REGLEMENT)

                If dtSpecific.Rows.Count > 0 Then

                    For i = 0 To dtSpecific.Rows.Count - 1

                        If dtModeReglement.Rows(j)("MODE_REGLEMENT").Equals("Free") Or dtModeReglement.Rows(j)("MODE_REGLEMENT").Equals("Gratuitée") Then

                            If dtSpecific.Rows(i)("MONTANT_VERSE") > 0 Then

                                pdfCell = New PdfPCell(New Paragraph(dtSpecific.Rows(i)("DATE_REGLEMENT"), font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfTable.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(dtSpecific.Rows(i)("REF_REGLEMENT"), font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfTable.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(dtSpecific.Rows(i)("MONTANT_VERSE"), "#,##0"), font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfTable.AddCell(pdfCell)

                                TotalFactureGratuite += dtSpecific.Rows(i)("MONTANT_VERSE")

                            End If

                        Else

                            pdfCell = New PdfPCell(New Paragraph(dtSpecific.Rows(i)("DATE_REGLEMENT"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(dtSpecific.Rows(i)("REF_REGLEMENT"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(dtSpecific.Rows(i)("MONTANT_VERSE"), "#,##0"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.AddCell(pdfCell)

                        End If

                        TotalFacture += dtSpecific.Rows(i)("MONTANT_VERSE")

                        GrandTotalFacture += dtSpecific.Rows(i)("MONTANT_VERSE")

                    Next

                    pdfDoc.Add(pdfTable)

                    '------------------------------------------------------------------------
                    Dim pSpace As New PdfPCell(New Paragraph(Chr(13) & Chr(13) & Chr(13)))
                    'pdfDoc.Add(pdfTable)

                    Dim pdfTable2 As New PdfPTable(3) 'Number of columns

                    pdfTable2.TotalWidth = 520.0F
                    pdfTable2.LockedWidth = True
                    pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                    'pdfTable2.HeaderRows = 1

                    Dim widths2 As Single() = New Single() {2.0F, 10.0F, 2.5F}
                    pdfTable2.SetWidths(widths2)

                    Dim pdfCell2 As PdfPCell = Nothing

                    pdfCell2 = New PdfPCell(New Paragraph("TOTAL : ", fontTotal))
                    pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell2.MinimumHeight = 18
                    pdfCell2.PaddingLeft = 15.0F
                    pdfCell2.Border = 0
                    pdfCell2.Colspan = 2
                    pdfTable2.AddCell(pdfCell2)

                    If dtModeReglement.Rows(j)("MODE_REGLEMENT").Equals("Free") Or dtModeReglement.Rows(j)("MODE_REGLEMENT").Equals("Gratuitée") Then
                        pdfCell2 = New PdfPCell(New Paragraph(Format(TotalFactureGratuite, "#,##0"), fontTotal))
                    Else
                        pdfCell2 = New PdfPCell(New Paragraph(Format(TotalFacture, "#,##0"), fontTotal))
                    End If

                    pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell2.MinimumHeight = 18
                    pdfCell2.PaddingLeft = 5.0F
                    'pdfCell2.Border = 0
                    pdfTable2.AddCell(pdfCell2)

                    pdfDoc.Add(pdfTable2)

                End If

            Next

            Dim totalDepot As Double = 0

            Dim p1_ = New Paragraph("DEPOT DE GARANTIE" & Chr(13) & Chr(13), pColumn)
            pdfDoc.Add(p1_)

            Dim pdfTable2_ As New PdfPTable(3) 'Number of columns

            pdfTable2_.TotalWidth = 520.0F
            pdfTable2_.LockedWidth = True
            pdfTable2_.HorizontalAlignment = Element.ALIGN_RIGHT
            'pdfTable2_.HeaderRows = 1

            Dim pdfCell_1 As New PdfPCell

            Dim widths2_ As Single() = New Single() {2.0F, 10.0F, 2.5F}
            pdfTable2_.SetWidths(widths2_)

            Dim depotDeGarantie As DataTable = Functions.ensembleDesDepotsDeGaranties(DateDeSituation, DateDeSituation, CODE_CAISSIER)

            If depotDeGarantie.Rows.Count > 0 Then

                For i = 0 To depotDeGarantie.Rows.Count - 1

                    pdfCell_1 = New PdfPCell(New Paragraph(depotDeGarantie.Rows(i)("DATE_CREATION"), font1))
                    pdfCell_1.MinimumHeight = 15
                    pdfCell_1.PaddingLeft = 5.0F
                    pdfCell_1.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfTable2_.AddCell(pdfCell_1)

                    pdfCell_1 = New PdfPCell(New Paragraph(depotDeGarantie.Rows(i)("NOM_CLIENT"), font1))
                    pdfCell_1.MinimumHeight = 15
                    pdfCell_1.PaddingLeft = 5.0F
                    pdfCell_1.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfTable2_.AddCell(pdfCell_1)

                    totalDepot += depotDeGarantie.Rows(i)("CREDIT")
                    pdfCell_1 = New PdfPCell(New Paragraph(Format(depotDeGarantie.Rows(i)("CREDIT"), "#,##0"), font1))
                    pdfCell_1.MinimumHeight = 15
                    pdfCell_1.PaddingLeft = 5.0F
                    pdfCell_1.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable2_.AddCell(pdfCell_1)

                Next

                pdfCell_1 = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                pdfCell_1.MinimumHeight = 15
                pdfCell_1.PaddingLeft = 5.0F
                pdfCell_1.Colspan = 2
                pdfCell_1.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable2_.AddCell(pdfCell_1)

                pdfCell_1 = New PdfPCell(New Paragraph(Format(totalDepot, "#,##0"), fontTotal))
                pdfCell_1.MinimumHeight = 15
                pdfCell_1.PaddingLeft = 5.0F
                pdfCell_1.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable2_.AddCell(pdfCell_1)

                pdfDoc.Add(pdfTable2_)

            End If

            'Dim lettreEnChiffre = New Paragraph("Arrêter la présente à la somme de : " & Format(GrandTotalFacture, "#,##0") & " (" & NBLT(GrandTotalFacture) & ") " & societe.Rows(0)("CODE_MONNAIE"), pRow)
            Dim lettreEnChiffre

            If GlobalVariable.actualLanguageValue = 1 Then
                lettreEnChiffre = New Paragraph("Arrêter la présente à la somme de : " & Format(GrandTotalFacture + totalDepot, "#,##0") & " (" & NBLT(GrandTotalFacture + totalDepot) & ") " & societe.Rows(0)("CODE_MONNAIE"), pRow)
            Else
                lettreEnChiffre = New Paragraph("To settle the present amount at : " & Format(GrandTotalFacture + totalDepot, "#,##0") & " (" & NBLT(GrandTotalFacture + totalDepot) & ") " & societe.Rows(0)("CODE_MONNAIE"), pRow)
            End If

            pdfDoc.Add(lettreEnChiffre)

            ' ------------------------------------------------------------------------------------------------

            pdfDoc.Close()

            'MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub listeDesDayuSe(ByVal DateDebut As Date, ByVal DateFin As Date)

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        Dim DateDST As String
        If DateDebut = DateFin Then
            DateDST = DateDebut.ToShortDateString
        Else
            DateDST = DateDebut.ToShortDateString & " AU " & DateFin.ToShortDateString
        End If

        If GlobalVariable.DocumentToGenerate = "day use" Then
            tireDocument = "LISTE DES SIESTES " & Chr(13) & " DU " & DateDST & " " & Now().ToLongTimeString
            titreFichier = "SIESTES "
        ElseIf GlobalVariable.DocumentToGenerate = "non day use" Then
            tireDocument = "LISTE DES SEJOURS " & Chr(13) & " DU " & DateDST & " " & Now().ToLongTimeString
            titreFichier = "LISTE DES SEJOURS "
        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then
            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 13, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            If GlobalVariable.DocumentToGenerate = "day use" Or GlobalVariable.DocumentToGenerate = "non day use" Then

                Dim pdfCell As PdfPCell = Nothing

                pdfWrite.PageEvent = New HeaderFooter

                pdfDoc.Open()

                Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13))
                p10.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p10)

                Dim pdfTable4 As New PdfPTable(9) 'Number of columns
                pdfTable4.TotalWidth = 760.0F
                pdfTable4.LockedWidth = True
                pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable4.HeaderRows = 1

                Dim widths4 As Single() = New Single() {5.0F, 15.0F, 25.0F, 6.0F, 6.0F, 5.0F, 8.0F, 9.0F, 6.0F}
                pdfTable4.SetWidths(widths4)

                pdfCell = New PdfPCell(New Paragraph("CHA.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TYPE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TEMPS", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("MONTANT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("EFFACEMENT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ECARTS", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                Dim typeChambreOuSalle As String = "chambre"

                'On Affiche toute reservation dont la date d'entree figure entre les deux dates saisies
                Dim query As String = ""

                If GlobalVariable.AgenceActuelle.Rows(0)("SERRURES") = 1 Then
                    query = "SELECT CHAMBRE_ID AS 'CHAMBRE', TYPE_CHAMBRE,  NOM_CLIENT As 'NOM & PRENOM', HEURE_ENTREE As 'HEURE ARRIVEE', HEURE_SORTIE As 'HEURE DEPART', MONTANT_ACCORDE AS 'SOLDE' , HEURE_EFFACEMENT AS 'HEURE EFFACEMENT' FROM reserve_conf, suivi_des_encodages WHERE DATE_ENTTRE >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_ENTTRE <='" & DateFin.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND DAY_USE = @DAY_USE AND reserve_conf.CODE_RESERVATION = suivi_des_encodages.CODE_RESERVATION ORDER BY ID_RESERVATION DESC"
                Else
                    query = "SELECT CHAMBRE_ID AS 'CHAMBRE', TYPE_CHAMBRE,  NOM_CLIENT As 'NOM & PRENOM', HEURE_ENTREE As 'HEURE ARRIVEE', HEURE_SORTIE As 'HEURE DEPART', MONTANT_ACCORDE AS 'SOLDE' FROM reserve_conf WHERE DATE_ENTTRE >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_ENTTRE <='" & DateFin.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND DAY_USE = @DAY_USE ORDER BY ID_RESERVATION DESC"
                End If

                Dim command As New MySqlCommand(query, GlobalVariable.connect)
                command.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = typeChambreOuSalle

                If GlobalVariable.DocumentToGenerate = "day use" Then
                    command.Parameters.Add("@DAY_USE", MySqlDbType.Int32).Value = 1
                ElseIf GlobalVariable.DocumentToGenerate = "non day use" Then
                    command.Parameters.Add("@DAY_USE", MySqlDbType.Int32).Value = 0
                End If

                Dim adapter As New MySqlDataAdapter(command)

                Dim tableArrivee As New DataTable()

                adapter.Fill(tableArrivee)

                Dim tempsFait As Integer = 0
                Dim ecart As Integer = 0

                Dim DateTimeArrivee As DateTime
                Dim DateTimeDepart As DateTime
                Dim DateTimeeffacement As DateTime

                Dim montantTotal As Double = 0

                If tableArrivee.Rows.Count > 0 Then

                    For i = 0 To tableArrivee.Rows.Count - 1

                        ecart = -1

                        If GlobalVariable.AgenceActuelle.Rows(0)("SERRURES") = 1 Then

                            For j = 0 To tableArrivee.Columns.Count - 1

                                If j = 5 Then

                                    tempsFait = CType((DateTimeDepart - DateTimeArrivee).TotalHours, Int32)

                                    pdfCell = New PdfPCell(New Paragraph(tempsFait, pRow))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfTable4.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(tableArrivee.Rows(i)(j) * tempsFait, "#,##0"), pRow))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                    montantTotal += tableArrivee.Rows(i)(j) * tempsFait

                                ElseIf j = 6 Then

                                    If Not Trim(tableArrivee.Rows(i)(j)).Equals("") Then

                                        DateTimeeffacement = CDate(tableArrivee.Rows(i)(j)).ToLongTimeString

                                        ecart = CType((DateTimeeffacement - DateTimeDepart).TotalMinutes, Int32)

                                        pdfCell = New PdfPCell(New Paragraph(CDate(tableArrivee.Rows(i)(j)).ToLongTimeString, pRow))

                                    Else
                                        pdfCell = New PdfPCell(New Paragraph("", pRow))
                                    End If

                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                ElseIf j = 3 Or j = 4 Then

                                    If j = 3 Then
                                        DateTimeArrivee = CDate(tableArrivee.Rows(i)(j)).ToLongTimeString
                                    ElseIf j = 4 Then
                                        DateTimeDepart = CDate(tableArrivee.Rows(i)(j)).ToLongTimeString
                                    End If

                                    pdfCell = New PdfPCell(New Paragraph(CDate(tableArrivee.Rows(i)(j)).ToLongTimeString, pRow))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                                Else

                                    If j = 1 Then

                                        Dim TYPE_DE_CHAMBRE As String = ""

                                        Dim infoSupTypeDeChambre As DataTable = Functions.getElementByCode(tableArrivee.Rows(i)(j).ToString, "type_chambre", "CODE_TYPE_CHAMBRE")

                                        If infoSupTypeDeChambre.Rows.Count > 0 Then
                                            TYPE_DE_CHAMBRE = infoSupTypeDeChambre.Rows(0)("LIBELLE_TYPE_CHAMBRE")
                                        End If

                                        pdfCell = New PdfPCell(New Paragraph(TYPE_DE_CHAMBRE, pRow))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                                    Else
                                        pdfCell = New PdfPCell(New Paragraph(tableArrivee.Rows(i)(j).ToString, pRow))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                                    End If

                                End If

                                If j = 0 Then
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                End If

                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F

                                pdfTable4.AddCell(pdfCell)

                                If j = 6 Then

                                    If Not ecart = -1 Then

                                        If GlobalVariable.DocumentToGenerate = "day use" Then
                                            pdfCell = New PdfPCell(New Paragraph(ecart & " min(s)", pRow))
                                        ElseIf GlobalVariable.DocumentToGenerate = "non day use" Then
                                            ecart /= 60
                                            pdfCell = New PdfPCell(New Paragraph(ecart & " heure(s)", pRow))
                                        End If

                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfTable4.AddCell(pdfCell)

                                    Else

                                        pdfCell = New PdfPCell(New Paragraph("", pRow))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfTable4.AddCell(pdfCell)

                                    End If

                                End If

                            Next

                        Else

                            For j = 0 To tableArrivee.Columns.Count - 1

                                If j = 5 Then

                                    tempsFait = CType((DateTimeDepart - DateTimeArrivee).TotalHours, Int32)

                                    pdfCell = New PdfPCell(New Paragraph(tempsFait, pRow))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfTable4.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(tableArrivee.Rows(i)(j) * tempsFait, "#,##0"), pRow))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                    montantTotal += tableArrivee.Rows(i)(j) * tempsFait

                                ElseIf j = 3 Or j = 4 Then

                                    If j = 3 Then
                                        DateTimeArrivee = CDate(tableArrivee.Rows(i)(j)).ToLongTimeString
                                    ElseIf j = 4 Then
                                        DateTimeDepart = CDate(tableArrivee.Rows(i)(j)).ToLongTimeString
                                    End If

                                    pdfCell = New PdfPCell(New Paragraph(CDate(tableArrivee.Rows(i)(j)).ToLongTimeString, pRow))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                                Else

                                    If j = 1 Then

                                        Dim TYPE_DE_CHAMBRE As String = ""

                                        Dim infoSupTypeDeChambre As DataTable = Functions.getElementByCode(tableArrivee.Rows(i)(j).ToString, "type_chambre", "CODE_TYPE_CHAMBRE")

                                        If infoSupTypeDeChambre.Rows.Count > 0 Then
                                            TYPE_DE_CHAMBRE = infoSupTypeDeChambre.Rows(0)("LIBELLE_TYPE_CHAMBRE")
                                        End If

                                        pdfCell = New PdfPCell(New Paragraph(TYPE_DE_CHAMBRE, pRow))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                                    Else
                                        pdfCell = New PdfPCell(New Paragraph(tableArrivee.Rows(i)(j).ToString, pRow))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                                    End If

                                End If

                                If j = 0 Then
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                End If

                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F

                                pdfTable4.AddCell(pdfCell)

                                If j = 5 Then

                                    pdfCell = New PdfPCell(New Paragraph("", pRow))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfTable4.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph("", pRow))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfTable4.AddCell(pdfCell)

                                End If

                            Next

                        End If

                    Next

                    pdfCell = New PdfPCell(New Paragraph(" TOTAL ", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.Colspan = 6
                    pdfTable4.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(montantTotal, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable4.AddCell(pdfCell)

                    pdfDoc.Add(pdfTable4)

                End If

                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Process.Start(sfd.FileName)

            End If


        End If

    End Sub

    Public Shared Function firstDayOfMonth(ByVal sourceDate As DateTime)
        Return New DateTime(sourceDate.Year, sourceDate.Month, 1)
    End Function

    Public Shared Function lastDayOfMonth(ByVal sourceDate As DateTime)
        Dim lastDay As DateTime = New DateTime(sourceDate.Year, sourceDate.Month, 1)
        Return lastDay.AddMonths(1).AddDays(-1)
    End Function

    Public Shared Sub DocumentToPrintDST(ByVal dt As DataGridView, ByVal DateDebut As Date, ByVal DateFin As Date)

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        Dim DateDST As Date
        If DateDebut = DateFin Then
            DateDST = DateDebut
        Else
            DateDST = DateDebut.ToShortDateString() & " AU " & DateFin.ToShortDateString()
        End If

        If GlobalVariable.DocumentToGenerate = "evenements" Then
            tireDocument = "LISTE DES EVENEMENTS " & Chr(13) & " DU " & DateDST & " " & Now().ToLongTimeString
            titreFichier = "EVENEMENTS "

        ElseIf GlobalVariable.DocumentToGenerate = "DST" Then
            tireDocument = "RAPPORT DST " & Chr(13) & " DU " & DateDST & " " & Now().ToLongTimeString
            titreFichier = "RESERVATIONS "
        Else
            tireDocument = "LISTE DES RESERVATIONS " & Chr(13) & " DU " & DateDST & " " & Now().ToLongTimeString
            titreFichier = "RESERVATIONS "
        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then
            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 13, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            If GlobalVariable.DocumentToGenerate = "evenements" Then

                Dim pdfCell As PdfPCell = Nothing

                pdfWrite.PageEvent = New HeaderFooter

                pdfDoc.Open()

                Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13))
                p10.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p10)

                Dim pdfTable4 As New PdfPTable(8) 'Number of columns
                pdfTable4.TotalWidth = 750.0F
                pdfTable4.LockedWidth = True
                pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable4.HeaderRows = 1

                Dim widths4 As Single() = New Single() {7.0F, 9.0F, 20.0F, 9.0F, 9.0F, 9.0F, 5.0F, 13.0F}
                pdfTable4.SetWidths(widths4)

                pdfCell = New PdfPCell(New Paragraph("N° RESA", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("N° CHAMBRE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("SOLDE ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAX", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("EVENEMENT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                Dim query4 As String = "SELECT reserve_conf.CODE_RESERVATION AS 'RESERVATION', CHAMBRE_ID AS 'CHAMBRE', NOM_CLIENT As 'NOM & PRENOM', SOLDE_RESERVATION AS 'SOLDE', DATE_ENTTRE As 'DATE ARRIVEE', DATE_SORTIE As 'DATE DEPART', NB_PERSONNES AS PAX, LIBELLE As EVENEMENT FROM reserve_conf, forfait_salle, evenement WHERE DATE_ENTTRE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND reserve_conf.CODE_RESERVATION =forfait_salle.CODE_RESERVATION AND forfait_salle.CODE_EVENEMENT=evenement.CODE_EVENEMENT ORDER BY ID_RESERVATION DESC"

                'Dim query4 As String = "SELECT reserve_conf.CODE_RESERVATION AS 'RESERVATION', CHAMBRE_ID AS 'CHAMBRE', NOM_CLIENT As 'NOM & PRENOM', SOLDE_RESERVATION AS 'SOLDE', HEURE_ENTREE As 'HEURE ARRIVEE', HEURE_SORTIE As 'HEURE DEPART', NB_PERSONNES AS PAX, LIBELLE As EVENEMENT FROM reserve_conf, forfait_salle, evenement WHERE DATE_ENTTRE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND reserve_conf.CODE_RESERVATION =forfait_salle.CODE_RESERVATION AND forfait_salle.CODE_EVENEMENT=evenement.CODE_EVENEMENT ORDER BY ID_RESERVATION DESC"

                Dim command4 As New MySqlCommand(query4, GlobalVariable.connect)
                command4.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = "salle"

                Dim adapter4 As New MySqlDataAdapter(command4)
                Dim tableArrivee As New DataTable()
                adapter4.Fill(tableArrivee)

                If tableArrivee.Rows.Count > 0 Then

                    For i = 0 To tableArrivee.Rows.Count - 1

                        For j = 0 To tableArrivee.Columns.Count - 1

                            'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            If j = 3 Then
                                pdfCell = New PdfPCell(New Paragraph(Format(tableArrivee.Rows(i)(j), "#,##0"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            ElseIf j = 4 Or j = 5 Then
                                'pdfCell = New PdfPCell(New Paragraph(CDate(tableArrivee.Rows(i)(j)).ToLongTimeString, pRow))
                                pdfCell = New PdfPCell(New Paragraph(CDate(tableArrivee.Rows(i)(j)).ToShortDateString, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            ElseIf j = 6 Or j = 7 Then
                                pdfCell = New PdfPCell(New Paragraph(tableArrivee.Rows(i)(j).ToString, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            Else
                                pdfCell = New PdfPCell(New Paragraph(tableArrivee.Rows(i)(j).ToString, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            End If

                            If j = 1 Then
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            End If

                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F

                            pdfTable4.AddCell(pdfCell)
                        Next

                    Next

                    pdfDoc.Add(pdfTable4)

                End If

                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Process.Start(sfd.FileName)

            Else

                Dim pdfTable As New PdfPTable(6) 'Number of columns
                pdfTable.TotalWidth = 750.0F
                pdfTable.LockedWidth = True
                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable.HeaderRows = 1

                Dim widths As Single() = New Single() {18.0F, 12.0F, 9.0F, 9.0F, 9.0F, 9.0F}
                pdfTable.SetWidths(widths)

                Dim pdfCell As PdfPCell = Nothing

                pdfWrite.PageEvent = New HeaderFooter

                pdfDoc.Open()

                Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13) & Chr(13))
                p10.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p10)

                pdfCell = New PdfPCell(New Paragraph("NOM ET PRENOM", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CNI", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DATE D'ARRIVEE ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DATE DE SORTIE ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("VENANT DE ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("SE RENDANT A ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                If dt.Rows.Count > 0 Then

                    For i = 0 To dt.Rows.Count - 1

                        For j = 0 To dt.Columns.Count - 1
                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value.ToString, pRow))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfTable.AddCell(pdfCell)
                        Next

                    Next

                    pdfDoc.Add(pdfTable)

                    '------------------------------------------------------------------------
                    Dim pSpace As New PdfPCell(New Paragraph(Chr(13) & Chr(13) & Chr(13)))
                    'pdfDoc.Add(pdfTable)

                    Dim pdfTable2 As New PdfPTable(2) 'Number of columns

                    pdfTable2.TotalWidth = 520.0F
                    pdfTable2.LockedWidth = True
                    pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                    'pdfTable2.HeaderRows = 1

                    Dim widths2 As Single() = New Single() {5.8F, 1.1F}
                    pdfTable2.SetWidths(widths2)

                    Dim pdfCell2 As PdfPCell = Nothing

                    pdfCell2 = New PdfPCell(New Paragraph("TOTAL: ", fontTotal))
                    pdfCell2.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell2.MinimumHeight = 18
                    pdfCell2.PaddingLeft = 15.0F
                    pdfCell2.Border = 0
                    pdfTable2.AddCell(pdfCell2)

                    pdfCell2 = New PdfPCell(New Paragraph(Format(TotalFacture, "#,##0"), fontTotal))
                    pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell2.MinimumHeight = 18
                    pdfCell2.PaddingLeft = 5.0F
                    'pdfCell2.Border = 0
                    pdfTable2.AddCell(pdfCell2)

                    'pdfDoc.Add(pdfTable2)

                Else

                    MessageBox.Show("Aucune Ligne de Fatcure à imprimer!")

                End If

                ' ------------------------------------------------------------------------------------------------

                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Process.Start(sfd.FileName)

            End If


        End If

    End Sub

    Public Shared Sub RapportDuPromoteur()

        Dim DateDebutStat As Date = Functions.firstDayOfMonth(GlobalVariable.DateDeTravail)
        Dim DateFinStat As Date = Functions.lastDayOfMonth(GlobalVariable.DateDeTravail)

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        tireDocument = "RAPPORT DU PROMOTEUR " & Chr(13) & " du " & GlobalVariable.DateDeTravail.AddDays(-1) & " " & Now().ToLongTimeString
        titreFichier = "RAPPORT DU PROMOTEUR "

        '-------------------------------------- EN CHAMBRE ----------------------------------

        'On affiche toutes les reserv_conf dont la date saisie est entre la d'entrée et la date de sortie (inclusif)

        Dim DateState As Date = GlobalVariable.DateDeTravail.ToString("yyyy-MM-dd")
        Dim DateDebut As Date = GlobalVariable.DateDeTravail.AddDays(-1).ToString("yyyy-MM-dd")
        Dim DateFin As Date = GlobalVariable.DateDeTravail.ToString("yyyy-MM-dd")

        'Dim query As String = "SELECT CHAMBRE_ID AS 'CHAMBRE', ADULTES, NOM_CLIENT As 'NOM & PRENOM', NB_PERSONNES As PAX, DATE_ENTTRE As 'DATE ARRIVEE', DATE_SORTIE As 'DATE DEPART', ETAT_RESERVATION, MONTANT_ACCORDE AS MONTANT,  SOLDE_RESERVATION AS 'SOLDE' FROM reserve_conf WHERE DATE_ENTTRE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 1 ORDER BY CHAMBRE_ID ASC"
        Dim query As String = "SELECT CHAMBRE_ID AS 'CHAMBRE', ADULTES, NOM_CLIENT As 'NOM & PRENOM', NB_PERSONNES As PAX, DATE_ENTTRE As 'DATE ARRIVEE', DATE_SORTIE As 'DATE DEPART', ETAT_RESERVATION, MONTANT_ACCORDE AS MONTANT,  SOLDE_RESERVATION AS 'SOLDE' FROM reserve_conf WHERE DATE_ENTTRE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & DateDebut.ToString("yyyy-MM-dd") & "' ORDER BY CHAMBRE_ID ASC"

        Dim command As New MySqlCommand(query, GlobalVariable.connect)
        command.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle

        Dim adapter As New MySqlDataAdapter(command)
        Dim tableEnChambre As New DataTable()
        adapter.Fill(tableEnChambre)

        '----------------------------------------------------------------------------------
        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then

            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 12, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim pdfTable As New PdfPTable(9) 'Number of columns
            pdfTable.TotalWidth = 750.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single() = New Single() {9.0F, 7.0F, 25.0F, 5.0F, 9.0F, 9.0F, 7.0F, 8.0F, 8.0F}
            pdfTable.SetWidths(widths)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            Dim ordre As Integer = 0

            If tableEnChambre.Rows.Count > 0 Then

                '1---------------------------------- ETAT D'OCCUPATION DES CHAMBRES -------------------------------------------

                Dim p11 As Paragraph = New Paragraph(Chr(13) & ordre + 1 & " - ETAT D'OCCUPATION DES CHAMBRES DU [ " & GlobalVariable.DateDeTravail.AddDays(-1) & " ]" & Chr(10) & Chr(10))
                p11.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p11)

                Dim p011 As Paragraph = New Paragraph("  Total des Chambres vendus : " & tableEnChambre.Rows.Count & Chr(10) & Chr(10))
                p011.Alignment = Element.ALIGN_LEFT
                'pdfDoc.Add(p011)

                pdfCell = New PdfPCell(New Paragraph("CHAMBRE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TYPE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAX", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NUITEES", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TARIF", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph("SOLDE ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

            End If

            Dim nuits As Integer = 0
            Dim SoldeTotal As Double = 0
            Dim nuitsTotal As Double = 0
            Dim paxTotal As Double = 0
            Dim tarif As Double = 0

            If tableEnChambre.Rows.Count > 0 Then

                For i = 0 To tableEnChambre.Rows.Count - 1

                    For j = 0 To tableEnChambre.Columns.Count - 1

                        If j = 1 Then

                            Dim CHAMBRE As String = tableEnChambre.Rows(i)("CHAMBRE").ToString

                            Dim infoRoomType As DataTable = getElementByCode(CHAMBRE, "chambre", "CODE_CHAMBRE")

                            If infoRoomType.Rows.Count > 0 Then
                                Dim CODE_TYPE_CHAMBRE As String = infoRoomType.Rows(0)("CODE_TYPE_CHAMBRE")
                                pdfCell = New PdfPCell(New Paragraph(CODE_TYPE_CHAMBRE, pRow))
                            End If

                        ElseIf j = 4 Or j = 5 Then
                            pdfCell = New PdfPCell(New Paragraph(CDate(tableEnChambre.Rows(i)(j).ToString).ToShortDateString, pRow))
                        ElseIf j = 6 Then

                            Dim arrivee As Date = CDate(tableEnChambre.Rows(i)("DATE ARRIVEE")).ToShortDateString
                            Dim depart As Date = CDate(tableEnChambre.Rows(i)("DATE DEPART")).ToShortDateString
                            nuits = CType((depart - arrivee).TotalDays, Int64)

                            nuitsTotal += nuits

                            pdfCell = New PdfPCell(New Paragraph(nuits, pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            'pdfTable.AddCell(pdfCell)

                        ElseIf j = 7 Or j = 8 Then
                            pdfCell = New PdfPCell(New Paragraph(Format(tableEnChambre.Rows(i)(j), "#,##0"), pRow))
                        Else
                            If j = 3 Then

                                Dim PAX As Integer = 1

                                If Integer.Parse(tableEnChambre.Rows(i)(j).ToString) <= 0 Then
                                    pdfCell = New PdfPCell(New Paragraph(PAX, pRow))
                                Else
                                    pdfCell = New PdfPCell(New Paragraph(tableEnChambre.Rows(i)(j).ToString, pRow))
                                End If
                            Else
                                pdfCell = New PdfPCell(New Paragraph(tableEnChambre.Rows(i)(j).ToString, pRow))
                            End If

                        End If

                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                        If j = 1 Or j = 3 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j = 4 Or j = 5 Or j = 6 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j = 7 Or j = 8 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        Else
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        End If

                        pdfTable.AddCell(pdfCell)

                    Next

                    SoldeTotal += tableEnChambre.Rows(i)("SOLDE")
                    tarif += tableEnChambre.Rows(i)("MONTANT")

                    Dim PAX_VALUE As Integer = 0

                    If tableEnChambre.Rows(i)("PAX") <= 0 Then
                        PAX_VALUE += 1
                    End If

                    paxTotal += tableEnChambre.Rows(i)("PAX") + PAX_VALUE

                Next

                '---------------------------------------------------

                pdfCell = New PdfPCell(New Paragraph(tableEnChambre.Rows.Count, pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                'pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = 2
                pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(paxTotal, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfTable.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = 2
                pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph(nuitsTotal, pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(tarif, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(SoldeTotal, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

            End If

            '2-------------------------------- RAPPORT DE CAISSE ----------------------------------------

            'On selectionne l'ensemble des caissier ayant effectue un encaissement un jour defini

            Dim query1 As String = "SELECT DISTINCT CODE_CAISSIER FROM reglement WHERE DATE_REGLEMENT <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_REGLEMENT >='" & DateDebut.ToString("yyyy-MM-dd") & "' ORDER BY CODE_CAISSIER ASC"

            Dim command1 As New MySqlCommand(query1, GlobalVariable.connect)
            'command1.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = 

            Dim adapter1 As New MySqlDataAdapter(command1)

            Dim ensembleDesCaissiers As New DataTable()

            adapter1.Fill(ensembleDesCaissiers)

            Dim pdfTable1 As New PdfPTable(4) 'Number of columns
            pdfTable1.TotalWidth = 750.0F
            pdfTable1.LockedWidth = True
            pdfTable1.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable1.HeaderRows = 1

            If ensembleDesCaissiers.Rows.Count > 0 Then

                ordre += 1

                Dim widths1 As Single() = New Single() {22.0F, 12.0F, 12.0F, 12.0F}
                pdfTable1.SetWidths(widths1)

                Dim p12 As Paragraph = New Paragraph(Chr(13) & ordre + 1 & "- RAPPORT DE CAISSE DU [ " & GlobalVariable.DateDeTravail.AddDays(-1) & " ]" & Chr(13) & Chr(13))
                p12.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p12)

                pdfCell = New PdfPCell(New Paragraph("CAISSIER", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("MOTIF", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ENTREES DU JOUR ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ENTREES CUMUL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable1.AddCell(pdfCell)

            End If

            If ensembleDesCaissiers.Rows.Count > 0 Then

                'comme des encaissements ont etes effectues on calcul la somme des versement effectue par chaque caissier

                Dim grandTotal As Double = 0
                Dim grandTotalCumul As Double = 0

                Dim infoSupCaissier As DataTable
                Dim NOM_UTILISATEUR As String = ""

                Dim MONTANT_TOTAL As Double = 0
                Dim MONTANT_TOTAL_CUMUL As Double = 0

                For k = 0 To ensembleDesCaissiers.Rows.Count - 1

                    infoSupCaissier = Functions.getElementByCode(ensembleDesCaissiers.Rows(k)("CODE_CAISSIER"), "utilisateurs", "CODE_UTILISATEUR")

                    If infoSupCaissier.Rows.Count > 0 Then
                        NOM_UTILISATEUR = infoSupCaissier.Rows(0)("NOM_UTILISATEUR")
                    End If

                    Dim getUserQuery = "SELECT MONTANT_VERSE, DATE_REGLEMENT FROM reglement WHERE CODE_CAISSIER = @CODE_CAISSIER AND DATE_REGLEMENT >= '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND DATE_REGLEMENT <= '" & DateDebut.ToString("yyyy-MM-dd") & "' ORDER BY DATE_REGLEMENT DESC"

                    Dim command2 As New MySqlCommand(getUserQuery, GlobalVariable.connect)

                    command2.Parameters.Add("@CODE_CAISSIER", MySqlDbType.VarChar).Value = ensembleDesCaissiers.Rows(k)("CODE_CAISSIER")

                    Dim adapter2 As New MySqlDataAdapter

                    Dim encaissement As New DataTable()

                    adapter2.SelectCommand = command2

                    adapter2.Fill(encaissement)

                    If encaissement.Rows.Count > 0 Then

                        MONTANT_TOTAL = 0
                        MONTANT_TOTAL_CUMUL = 0

                        For j = 0 To encaissement.Rows.Count - 1

                            If CDate(encaissement.Rows(j)("DATE_REGLEMENT")).ToString("yyyy-MM-dd") = CDate(GlobalVariable.DateDeTravail.AddDays(-1)).ToString("yyyy-MM-dd") Then
                                MONTANT_TOTAL += encaissement.Rows(j)("MONTANT_VERSE")
                            End If

                            MONTANT_TOTAL_CUMUL += encaissement.Rows(j)("MONTANT_VERSE")

                        Next

                        grandTotal += MONTANT_TOTAL
                        grandTotalCumul += MONTANT_TOTAL_CUMUL

                        pdfCell = New PdfPCell(New Paragraph(NOM_UTILISATEUR, pRow))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable1.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("ENCAISSEMENTS ", pRow))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable1.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(MONTANT_TOTAL, "#,##0"), pRow))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable1.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(MONTANT_TOTAL_CUMUL, "#,##0"), pRow))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable1.AddCell(pdfCell)

                    End If

                Next

                pdfCell = New PdfPCell(New Paragraph("TOTAL DES ENCAISSEMENTS", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = 2
                pdfCell.Border = 0
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(grandTotal, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable1.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(grandTotalCumul, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable1.AddCell(pdfCell)

                pdfDoc.Add(pdfTable1)

            End If

            '3-----------------------------ETAT DES CLIENTS N'AYANT PAS ENCORE EFFECTUE DES REGLEMENTS---------------------------------------------

            Dim pdfTable3 As New PdfPTable(8) 'Number of columns
            pdfTable3.TotalWidth = 750.0F
            pdfTable3.LockedWidth = True
            pdfTable3.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable3.HeaderRows = 1

            Dim widths3 As Single() = New Single() {9.0F, 7.0F, 25.0F, 9.0F, 9.0F, 7.0F, 8.0F, 8.0F}
            pdfTable3.SetWidths(widths3)

            Dim query3 As String = "SELECT CHAMBRE_ID AS 'CHAMBRE', ADULTES, NOM_CLIENT As 'NOM & PRENOM', DATE_ENTTRE As 'DATE ARRIVEE', DATE_SORTIE As 'DATE DEPART', ETAT_RESERVATION, MONTANT_ACCORDE AS MONTANT,  SOLDE_RESERVATION AS 'SOLDE' FROM reserve_conf WHERE DATE_ENTTRE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 1 AND SOLDE_RESERVATION < 0 AND TYPE=@TYPE ORDER BY CODE_RESERVATION DESC"

            Dim command3 As New MySqlCommand(query3, GlobalVariable.connect)
            command3.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = "chambre"

            Dim adapter3 As New MySqlDataAdapter(command3)
            Dim tableEnChambreDebiteur As New DataTable()
            adapter3.Fill(tableEnChambreDebiteur)

            If tableEnChambreDebiteur.Rows.Count > 0 Then

                ordre += 1

                'Etats des client ayant un solde debiteur
                Dim p13 As Paragraph = New Paragraph(Chr(13) & ordre + 1 & "- ETAT DES CLIENTS INDIVIDUELS AYANT UN SOLDE DEBITEUR [ " & GlobalVariable.DateDeTravail.AddDays(-1) & " ]" & Chr(13) & Chr(13))
                p13.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p13)

                pdfCell = New PdfPCell(New Paragraph("CHAMBRE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable3.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TYPE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable3.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable3.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAX", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                'pdfTable3.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable3.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable3.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NUITEES", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable3.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TARIF", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable3.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph("SOLDE ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable3.AddCell(pdfCell)

            End If

            nuitsTotal = 0
            SoldeTotal = 0
            paxTotal = 0
            tarif = 0

            If tableEnChambreDebiteur.Rows.Count > 0 Then

                For i = 0 To tableEnChambreDebiteur.Rows.Count - 1

                    For j = 0 To tableEnChambreDebiteur.Columns.Count - 1

                        If j = 1 Then

                            Dim CHAMBRE As String = tableEnChambreDebiteur.Rows(i)("CHAMBRE").ToString

                            Dim infoRoomType As DataTable = getElementByCode(CHAMBRE, "chambre", "CODE_CHAMBRE")

                            If infoRoomType.Rows.Count > 0 Then
                                Dim CODE_TYPE_CHAMBRE As String = infoRoomType.Rows(0)("CODE_TYPE_CHAMBRE")
                                pdfCell = New PdfPCell(New Paragraph(CODE_TYPE_CHAMBRE, pRow))
                            End If

                        ElseIf j = 3 Or j = 4 Then
                            pdfCell = New PdfPCell(New Paragraph(CDate(tableEnChambreDebiteur.Rows(i)(j).ToString).ToShortDateString, pRow))
                        ElseIf j = 5 Then

                            Dim arrivee As Date = CDate(tableEnChambreDebiteur.Rows(i)("DATE ARRIVEE")).ToShortDateString
                            Dim depart As Date = CDate(tableEnChambreDebiteur.Rows(i)("DATE DEPART")).ToShortDateString
                            nuits = CType((depart - arrivee).TotalDays, Int64)

                            nuitsTotal += nuits

                            pdfCell = New PdfPCell(New Paragraph(nuits, pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            'pdfTable3.AddCell(pdfCell)

                        ElseIf j = 6 Or j = 8 Then
                            pdfCell = New PdfPCell(New Paragraph(Format(tableEnChambreDebiteur.Rows(i)(j), "#,##0"), pRow))
                        Else
                            pdfCell = New PdfPCell(New Paragraph(tableEnChambreDebiteur.Rows(i)(j).ToString, pRow))
                        End If

                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                        If j = 1 Or j = 3 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j = 4 Or j = 5 Or j = 6 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j = 7 Or j = 8 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        Else
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        End If

                        pdfTable3.AddCell(pdfCell)

                    Next

                    SoldeTotal += tableEnChambreDebiteur.Rows(i)("SOLDE")
                    tarif += tableEnChambreDebiteur.Rows(i)("MONTANT")

                    'paxTotal += tableEnChambreDebiteur.Rows(i)("PAX")

                Next

                '---------------------------------------------------

                pdfCell = New PdfPCell(New Paragraph(tableEnChambreDebiteur.Rows.Count, pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable3.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = 2
                pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable3.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(paxTotal, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfTable3.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = 2
                pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable3.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph(nuitsTotal, pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable3.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(tarif, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfTable3.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(SoldeTotal, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfTable3.AddCell(pdfCell)

                pdfDoc.Add(pdfTable3)

            End If

            '4--------------------------------- LES ARRIVEE DU JOUR ------------------------------------------

            'pdfDoc.NewPage()

            Dim pdfTable4 As New PdfPTable(9) 'Number of columns
            pdfTable4.TotalWidth = 750.0F
            pdfTable4.LockedWidth = True
            pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable4.HeaderRows = 1

            Dim widths4 As Single() = New Single() {9.0F, 7.0F, 25.0F, 5.0F, 9.0F, 9.0F, 7.0F, 8.0F, 8.0F}
            pdfTable4.SetWidths(widths4)

            Dim query4 As String = "SELECT CHAMBRE_ID AS 'CHAMBRE', ADULTES, NOM_CLIENT As 'NOM & PRENOM', NB_PERSONNES As PAX, DATE_ENTTRE As 'DATE ARRIVEE', DATE_SORTIE As 'DATE DEPART', ETAT_RESERVATION, MONTANT_ACCORDE AS MONTANT,  SOLDE_RESERVATION AS 'SOLDE' FROM reserve_conf WHERE DATE_ENTTRE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_ENTTRE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 1 AND TYPE=@TYPE ORDER BY CODE_RESERVATION DESC"

            Dim command4 As New MySqlCommand(query4, GlobalVariable.connect)
            command4.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = "chambre"

            Dim adapter4 As New MySqlDataAdapter(command4)
            Dim tableArrivee As New DataTable()
            adapter4.Fill(tableArrivee)

            If tableArrivee.Rows.Count > 0 Then

                ordre += 1

                'Etats des client ayant un solde debiteur
                Dim p14 As Paragraph = New Paragraph(Chr(13) & ordre + 1 & "- ARRIVEES DU [ " & GlobalVariable.DateDeTravail.AddDays(-1) & " ]" & Chr(10))
                p14.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p14)

                Dim p0011 As Paragraph = New Paragraph("Total des arrivées : " & tableArrivee.Rows.Count & Chr(10) & Chr(10))
                p0011.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p0011)

                pdfCell = New PdfPCell(New Paragraph("CHAMBRE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TYPE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAX", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NUITEES", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TARIF", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph("SOLDE ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

            End If

            nuitsTotal = 0
            SoldeTotal = 0
            paxTotal = 0
            tarif = 0

            If tableArrivee.Rows.Count > 0 Then

                For i = 0 To tableArrivee.Rows.Count - 1

                    For j = 0 To tableArrivee.Columns.Count - 1

                        If j = 1 Then

                            Dim CHAMBRE As String = tableArrivee.Rows(i)("CHAMBRE").ToString

                            Dim infoRoomType As DataTable = getElementByCode(CHAMBRE, "chambre", "CODE_CHAMBRE")

                            If infoRoomType.Rows.Count > 0 Then
                                Dim CODE_TYPE_CHAMBRE As String = infoRoomType.Rows(0)("CODE_TYPE_CHAMBRE")
                                pdfCell = New PdfPCell(New Paragraph(CODE_TYPE_CHAMBRE, pRow))
                            End If

                        ElseIf j = 4 Or j = 5 Then
                            pdfCell = New PdfPCell(New Paragraph(CDate(tableArrivee.Rows(i)(j).ToString).ToShortDateString, pRow))
                        ElseIf j = 6 Then

                            Dim arrivee As Date = CDate(tableArrivee.Rows(i)("DATE ARRIVEE")).ToShortDateString
                            Dim depart As Date = CDate(tableArrivee.Rows(i)("DATE DEPART")).ToShortDateString
                            nuits = CType((depart - arrivee).TotalDays, Int64)

                            nuitsTotal += nuits

                            pdfCell = New PdfPCell(New Paragraph(nuits, pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            'pdfTable4.AddCell(pdfCell)

                        ElseIf j = 7 Or j = 8 Then
                            pdfCell = New PdfPCell(New Paragraph(Format(tableArrivee.Rows(i)(j), "#,##0"), pRow))
                        Else
                            pdfCell = New PdfPCell(New Paragraph(tableArrivee.Rows(i)(j).ToString, pRow))
                        End If

                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                        If j = 1 Or j = 3 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j = 4 Or j = 5 Or j = 6 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j = 7 Or j = 8 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        Else
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        End If

                        pdfTable4.AddCell(pdfCell)

                    Next

                    SoldeTotal += tableArrivee.Rows(i)("SOLDE")
                    tarif += tableArrivee.Rows(i)("MONTANT")

                    paxTotal += tableArrivee.Rows(i)("PAX")

                Next

                '---------------------------------------------------

                pdfCell = New PdfPCell(New Paragraph(tableArrivee.Rows.Count, pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = 2
                pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(paxTotal, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfTable4.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = 2
                pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph(nuitsTotal, pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(tarif, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(SoldeTotal, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfTable4.AddCell(pdfCell)

                pdfDoc.Add(pdfTable4)

            End If

            '----------------------------LISTE DES ATTENDUES----------------------------------------------
            ' pdfDoc.NewPage()

            pdfTable = New PdfPTable(9) 'Number of columns
            pdfTable.TotalWidth = 750.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths5 As Single() = New Single() {9.0F, 7.0F, 25.0F, 5.0F, 9.0F, 9.0F, 7.0F, 8.0F, 8.0F}
            pdfTable.SetWidths(widths5)

            Dim query5 As String = "SELECT CHAMBRE_ID AS 'CHAMBRE', ADULTES, NOM_CLIENT As 'NOM & PRENOM', NB_PERSONNES As PAX, DATE_ENTTRE As 'DATE ARRIVEE', DATE_SORTIE As 'DATE DEPART', ETAT_RESERVATION, MONTANT_ACCORDE AS MONTANT,  SOLDE_RESERVATION AS 'SOLDE' FROM reservation WHERE DATE_ENTTRE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_ENTTRE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 0 AND TYPE=@TYPE ORDER BY CODE_RESERVATION DESC"

            Dim command5 As New MySqlCommand(query5, GlobalVariable.connect)
            command5.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle

            Dim adapter5 As New MySqlDataAdapter(command5)
            Dim tableAttendus As New DataTable()
            adapter5.Fill(tableAttendus)

            If tableAttendus.Rows.Count > 0 Then

                ordre += 1

                'Etats des client ayant un solde debiteur
                Dim p15 As Paragraph = New Paragraph(Chr(13) & ordre + 1 & "- ATTENDUES [ " & GlobalVariable.DateDeTravail & " ]" & Chr(10))
                p15.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p15)

                Dim p1011 As Paragraph = New Paragraph("Total des attendus : " & tableAttendus.Rows.Count & Chr(10) & Chr(10))
                p1011.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p1011)

                pdfCell = New PdfPCell(New Paragraph("CHAMBRE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TYPE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAX", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NUITEES", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TARIF", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph("SOLDE ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

            End If

            nuitsTotal = 0
            SoldeTotal = 0
            paxTotal = 0
            tarif = 0

            If tableAttendus.Rows.Count > 0 Then

                For i = 0 To tableAttendus.Rows.Count - 1

                    For j = 0 To tableAttendus.Columns.Count - 1

                        If j = 1 Then

                            Dim CHAMBRE As String = tableAttendus.Rows(i)("CHAMBRE").ToString

                            Dim infoRoomType As DataTable = getElementByCode(CHAMBRE, "chambre", "CODE_CHAMBRE")

                            If infoRoomType.Rows.Count > 0 Then
                                Dim CODE_TYPE_CHAMBRE As String = infoRoomType.Rows(0)("CODE_TYPE_CHAMBRE")
                                pdfCell = New PdfPCell(New Paragraph(CODE_TYPE_CHAMBRE, pRow))
                            End If

                        ElseIf j = 4 Or j = 5 Then
                            pdfCell = New PdfPCell(New Paragraph(CDate(tableAttendus.Rows(i)(j).ToString).ToShortDateString, pRow))
                        ElseIf j = 6 Then

                            Dim arrivee As Date = CDate(tableAttendus.Rows(i)("DATE ARRIVEE")).ToShortDateString
                            Dim depart As Date = CDate(tableAttendus.Rows(i)("DATE DEPART")).ToShortDateString
                            nuits = CType((depart - arrivee).TotalDays, Int64)

                            nuitsTotal += nuits

                            pdfCell = New PdfPCell(New Paragraph(nuits, pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            'pdfTable.AddCell(pdfCell)

                        ElseIf j = 7 Or j = 8 Then
                            pdfCell = New PdfPCell(New Paragraph(Format(tableAttendus.Rows(i)(j), "#,##0"), pRow))
                        Else
                            pdfCell = New PdfPCell(New Paragraph(tableAttendus.Rows(i)(j).ToString, pRow))
                        End If

                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                        If j = 1 Or j = 3 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j = 4 Or j = 5 Or j = 6 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j = 7 Or j = 8 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        Else
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        End If

                        pdfTable.AddCell(pdfCell)

                    Next

                    SoldeTotal += tableAttendus.Rows(i)("SOLDE")
                    tarif += tableAttendus.Rows(i)("MONTANT")

                    paxTotal += tableAttendus.Rows(i)("PAX")

                Next

                '---------------------------------------------------


                pdfCell = New PdfPCell(New Paragraph(tableAttendus.Rows.Count, pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = 2
                pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(paxTotal, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfTable.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = 2
                pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph(nuitsTotal, pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(tarif, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(SoldeTotal, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

            End If

            '------------------------------------SEJOUR CLOTURES---------------------------------------------------------

            ' pdfDoc.NewPage()

            pdfTable = New PdfPTable(9) 'Number of columns
            pdfTable.TotalWidth = 750.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths6 As Single() = New Single() {9.0F, 7.0F, 25.0F, 5.0F, 9.0F, 9.0F, 7.0F, 8.0F, 8.0F}
            pdfTable.SetWidths(widths6)

            Dim query6 As String = "SELECT CHAMBRE_ID AS 'CHAMBRE', ADULTES, NOM_CLIENT As 'NOM & PRENOM', NB_PERSONNES As PAX, DATE_ENTTRE As 'DATE ARRIVEE', DATE_SORTIE As 'DATE DEPART', ETAT_RESERVATION, MONTANT_ACCORDE AS MONTANT,  SOLDE_RESERVATION AS 'SOLDE' FROM reserve_conf WHERE DATE_SORTIE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 0 AND TYPE=@TYPE ORDER BY CODE_RESERVATION DESC"

            Dim command6 As New MySqlCommand(query6, GlobalVariable.connect)
            command6.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle

            Dim adapter6 As New MySqlDataAdapter(command6)
            Dim tableSejourCloture As New DataTable()
            adapter6.Fill(tableSejourCloture)

            If tableSejourCloture.Rows.Count > 0 Then

                ordre += 1

                'Etats des client ayant un solde debiteur
                Dim p16 As Paragraph = New Paragraph(Chr(13) & ordre + 1 & "- DEPARTS DU  [ " & GlobalVariable.DateDeTravail & " ]" & Chr(10))
                p16.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p16)

                Dim p016 As Paragraph = New Paragraph("Total des departs : " & tableSejourCloture.Rows.Count & Chr(10) & Chr(10))
                p016.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p016)

                pdfCell = New PdfPCell(New Paragraph("CHAMBRE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TYPE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAX", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NUITEES", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TARIF", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph("SOLDE ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

            End If

            nuitsTotal = 0
            SoldeTotal = 0
            paxTotal = 0
            tarif = 0

            If tableSejourCloture.Rows.Count > 0 Then

                For i = 0 To tableSejourCloture.Rows.Count - 1

                    For j = 0 To tableSejourCloture.Columns.Count - 1

                        If j = 1 Then

                            Dim CHAMBRE As String = tableSejourCloture.Rows(i)("CHAMBRE").ToString

                            Dim infoRoomType As DataTable = getElementByCode(CHAMBRE, "chambre", "CODE_CHAMBRE")

                            If infoRoomType.Rows.Count > 0 Then
                                Dim CODE_TYPE_CHAMBRE As String = infoRoomType.Rows(0)("CODE_TYPE_CHAMBRE")
                                pdfCell = New PdfPCell(New Paragraph(CODE_TYPE_CHAMBRE, pRow))
                            End If

                        ElseIf j = 4 Or j = 5 Then
                            pdfCell = New PdfPCell(New Paragraph(CDate(tableSejourCloture.Rows(i)(j).ToString).ToShortDateString, pRow))
                        ElseIf j = 6 Then

                            Dim arrivee As Date = CDate(tableSejourCloture.Rows(i)("DATE ARRIVEE")).ToShortDateString
                            Dim depart As Date = CDate(tableSejourCloture.Rows(i)("DATE DEPART")).ToShortDateString
                            nuits = CType((depart - arrivee).TotalDays, Int64)

                            nuitsTotal += nuits

                            pdfCell = New PdfPCell(New Paragraph(nuits, pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            'pdfTable.AddCell(pdfCell)

                        ElseIf j = 7 Or j = 8 Then
                            pdfCell = New PdfPCell(New Paragraph(Format(tableSejourCloture.Rows(i)(j), "#,##0"), pRow))
                        Else
                            pdfCell = New PdfPCell(New Paragraph(tableSejourCloture.Rows(i)(j).ToString, pRow))
                        End If

                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                        If j = 1 Or j = 3 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j = 4 Or j = 5 Or j = 6 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j = 7 Or j = 8 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        Else
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        End If

                        pdfTable.AddCell(pdfCell)

                    Next

                    SoldeTotal += tableSejourCloture.Rows(i)("SOLDE")
                    tarif += tableSejourCloture.Rows(i)("MONTANT")

                    paxTotal += tableSejourCloture.Rows(i)("PAX")

                Next

                '---------------------------------------------------

                pdfCell = New PdfPCell(New Paragraph(tableSejourCloture.Rows.Count, pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = 2
                pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(paxTotal, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfTable.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = 2
                pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph(nuitsTotal, pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(tarif, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(SoldeTotal, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

            End If

            '------------------------------- RESERVATION ANNULEES ---------------------------------------

            ' pdfDoc.NewPage()

            Dim pdfTable7 As New PdfPTable(8) 'Number of columns
            pdfTable7.TotalWidth = 750.0F
            pdfTable7.LockedWidth = True
            pdfTable7.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable7.HeaderRows = 1

            Dim widths7 As Single() = New Single() {9.0F, 8.0F, 25.0F, 5.0F, 9.0F, 9.0F, 9.0F, 7.0F}
            pdfTable7.SetWidths(widths7)

            Dim query7 As String = "SELECT CODE_RESERVATION AS 'RESERVATION', CHAMBRE_ID AS 'CHAMBRE', NOM_CLIENT As 'NOM & PRENOM', NB_PERSONNES As PAX, SOLDE_RESERVATION AS 'SOLDE', DATE_ENTTRE As 'DATE ARRIVEE', DATE_SORTIE As 'DATE DEPART' FROM reservation WHERE DATE_ENTTRE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 2 AND TYPE=@TYPE ORDER BY CODE_RESERVATION DESC"

            Dim command7 As New MySqlCommand(query7, GlobalVariable.connect)
            command7.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle

            Dim adapter7 As New MySqlDataAdapter(command7)
            Dim tableReservationAnnulee As New DataTable()
            adapter7.Fill(tableReservationAnnulee)

            If tableReservationAnnulee.Rows.Count > 0 Then

                ordre += 1

                'Etats des client ayant un solde debiteur
                Dim p17 As Paragraph = New Paragraph(Chr(13) & ordre + 1 & "- RESERVATIONS ANNULEES [ " & GlobalVariable.DateDeTravail & " ]" & Chr(10))
                p17.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p17)

                Dim p017 As Paragraph = New Paragraph("Total des Réservations annulées : " & tableReservationAnnulee.Rows.Count & Chr(10) & Chr(10))
                p017.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p017)

                pdfCell = New PdfPCell(New Paragraph("RESERVATION", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable7.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("N° CHAMBRE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable7.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable7.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAX ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable7.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("SOLDE ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable7.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable7.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable7.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NUITEES", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable7.AddCell(pdfCell)

            End If

            nuitsTotal = 0
            SoldeTotal = 0
            paxTotal = 0
            tarif = 0

            If tableReservationAnnulee.Rows.Count > 0 Then

                For i = 0 To tableReservationAnnulee.Rows.Count - 1

                    Dim k = 0

                    For j = 0 To tableReservationAnnulee.Columns.Count - 1

                        'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        If j = 5 Or j = 6 Then
                            pdfCell = New PdfPCell(New Paragraph(CDate(tableReservationAnnulee.Rows(i)(j).ToString).ToShortDateString, pRow))
                        Else
                            pdfCell = New PdfPCell(New Paragraph(tableReservationAnnulee.Rows(i)(j).ToString, pRow))
                        End If

                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                        If j = 1 Or j = 3 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j = 4 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        Else
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        End If

                        pdfTable7.AddCell(pdfCell)

                        k += 1

                    Next

                    If k = 7 Then

                        Dim arrivee As Date = CDate(tableReservationAnnulee.Rows(i)("DATE ARRIVEE")).ToShortDateString
                        Dim depart As Date = CDate(tableReservationAnnulee.Rows(i)("DATE DEPART")).ToShortDateString
                        nuits = CType((depart - arrivee).TotalDays, Int64)

                        pdfCell = New PdfPCell(New Paragraph(nuits, pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable7.AddCell(pdfCell)

                        nuitsTotal += nuits

                    End If

                    SoldeTotal += tableReservationAnnulee.Rows(i)("SOLDE")
                    paxTotal += tableReservationAnnulee.Rows(i)("PAX")

                Next


                pdfCell = New PdfPCell(New Paragraph(tableReservationAnnulee.Rows.Count, pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15

                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable7.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = 2
                pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable7.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = 2
                pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable7.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(paxTotal, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfTable7.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(SoldeTotal, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfTable7.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = 2
                pdfCell.Border = 0
                pdfTable7.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(nuitsTotal, pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable7.AddCell(pdfCell)

                pdfDoc.Add(pdfTable7)

            End If

            '---------------------------------------------------------------------------------------------

            '------------------- CLIENT PRESENT ET N'AYANT PAS ENCORE FAIT DE REGLEMENT --------------------------

            'SELECT CHAMBRE_ID AS 'CHAMBRE', ADULTES, NOM_CLIENT As 'NOM & PRENOM', NB_PERSONNES As PAX, DATE_ENTTRE As 'DATE ARRIVEE', DATE_SORTIE As 'DATE DEPART', ETAT_RESERVATION, MONTANT_ACCORDE AS MONTANT,  SOLDE_RESERVATION AS 'SOLDE'

            pdfTable = New PdfPTable(7) 'Number of columns
            pdfTable.TotalWidth = 750.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            widths6 = New Single() {9.0F, 7.0F, 25.0F, 11.0F, 8.0F, 8.0F, 10.0F}
            pdfTable.SetWidths(widths6)

            Dim getUserQuery9 = "SELECT * FROM reserve_conf WHERE DATE_ENTTRE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = @ETAT_RESERVATION AND SOLDE_RESERVATION < 0 ORDER BY CHAMBRE_ID ASC"

            Dim command10 As New MySqlCommand(getUserQuery9, GlobalVariable.connect)

            'command10.Parameters.Add("@DATE_DU_JOUR", MySqlDbType.Date).Value = GlobalVariable.DateDeTravail
            command10.Parameters.Add("@ETAT_RESERVATION", MySqlDbType.Int32).Value = 1
            command10.Parameters.Add("@SOLDE_RESERVATION", MySqlDbType.Int32).Value = 0
            command10.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = "chambre"

            Dim adapter10 As New MySqlDataAdapter(command10)

            Dim clientAyantPasEcnoreRegle As New DataTable()

            adapter10.Fill(clientAyantPasEcnoreRegle)

            If clientAyantPasEcnoreRegle.Rows.Count > 0 Then

                ordre += 1

                'Etats des client ayant un solde debiteur
                Dim p17 As Paragraph = New Paragraph(Chr(13) & ordre + 1 & "- CLIENT PRESENT ET N'AYANT PAS ENCORE EFFECTUE DES REGLEMENTS [ " & GlobalVariable.DateDeTravail.AddDays(-1) & " ]" & Chr(13) & Chr(13))
                p17.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p17)

                pdfCell = New PdfPCell(New Paragraph("CHAMBRE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TYPE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NUITEES", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PRESTATION", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

            End If

            nuitsTotal = 0
            SoldeTotal = 0
            paxTotal = 0
            tarif = 0

            Dim TOTAL_RECETTE As Double = 0
            Dim GRAND_TOTAL_RECETTE As Double = 0
            Dim TOTAL_ENCAISSEMENT As Double = 0
            Dim GRAND_TOTAL_ENCAISSEMENT As Double = 0

            If clientAyantPasEcnoreRegle.Rows.Count > 0 Then

                Dim nombreDeReglement As Integer = 0

                For i = 0 To clientAyantPasEcnoreRegle.Rows.Count - 1

                    Dim CODE_RESERVATION As String = clientAyantPasEcnoreRegle.Rows(i)("CODE_RESERVATION")

                    Dim infoSupReglement As DataTable = Functions.getElementByCode(CODE_RESERVATION, "reglement", "NUM_REGLEMENT")

                    If Not infoSupReglement.Rows.Count > 0 Then

                        nombreDeReglement += 1

                        pdfCell = New PdfPCell(New Paragraph(clientAyantPasEcnoreRegle.Rows(i)("CHAMBRE_ID"), pRow))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(clientAyantPasEcnoreRegle.Rows(i)("TYPE_CHAMBRE"), pRow))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(clientAyantPasEcnoreRegle.Rows(i)("NOM_CLIENT"), pRow))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(CDate(clientAyantPasEcnoreRegle.Rows(i)("DATE_ENTTRE")).ToShortDateString, pRow))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(CDate(clientAyantPasEcnoreRegle.Rows(i)("DATE_SORTIE")).ToShortDateString, pRow))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable.AddCell(pdfCell)

                        Dim arrivee As Date = CDate(clientAyantPasEcnoreRegle.Rows(i)("DATE_ENTTRE")).ToShortDateString
                        Dim depart As Date = CDate(GlobalVariable.DateDeTravail).ToShortDateString

                        nuits = 0

                        nuits = CType((depart - arrivee).TotalDays, Int64)

                        nuitsTotal += nuits

                        pdfCell = New PdfPCell(New Paragraph(nuits, pRow))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable.AddCell(pdfCell)

                        TOTAL_RECETTE = 0

                        Dim infoSupArticleLigne As DataTable = Functions.getElementByCode(CODE_RESERVATION, "ligne_facture", "CODE_RESERVATION")

                        If infoSupArticleLigne.Rows.Count > 0 Then

                            For t = 0 To infoSupArticleLigne.Rows.Count - 1

                                TOTAL_RECETTE += infoSupArticleLigne.Rows(t)("MONTANT_TTC")
                                GRAND_TOTAL_RECETTE += infoSupArticleLigne.Rows(t)("MONTANT_TTC")

                            Next

                        End If

                        pdfCell = New PdfPCell(New Paragraph(Format(TOTAL_RECETTE, "#,##0"), pRow))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable.AddCell(pdfCell)


                    End If

                Next

                '---------------------------------------------------

                If nombreDeReglement > 0 Then

                    pdfCell = New PdfPCell(New Paragraph("", pRow))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.Colspan = 3
                    pdfCell.Border = 0
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(paxTotal, "#,##0"), pRow))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pRow))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)


                    pdfCell = New PdfPCell(New Paragraph(nuitsTotal, pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.Border = 0
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(GRAND_TOTAL_RECETTE, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 15
                    pdfTable.AddCell(pdfCell)

                    pdfDoc.Add(pdfTable)

                End If


            End If

            '------------------------------------- SITUATION GENERALE DES FACTURES DE CLIENTS PRESENTS ----------------------------------------

            pdfTable = New PdfPTable(9) 'Number of columns
            pdfTable.TotalWidth = 750.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            widths6 = New Single() {9.0F, 7.0F, 25.0F, 11.0F, 8.0F, 8.0F, 10.0F, 10.0F, 10.0F}
            pdfTable.SetWidths(widths6)

            Dim getUserQuery12 = "SELECT CODE_CHAMBRE As 'CHAMBRE', main_Courante_journaliere.NUM_RESERVATION As 'RESERVATION', main_courante_journaliere.NOM_CLIENT As 'NOM & PRENOM', DATE_ENTTRE As 'DATE ARRIVEE', DATE_SORTIE As 'DATE DEPART', ENCAISSEMENT_CHEQUE AS 'CHEQUE', PDJ, DEJEUNER, DINER, ENCAISSEMENT_ESPECE AS 'ESPECES', ENCAISSEMENT_CARTE_CREDIT As 'CARTE CREDIT', TELE AS 'MOBILE MONEY',  main_courante_journaliere.MONTANT_ACCORDE AS 'HEBERGEMENT', main_courante_journaliere.BAR_RESTAURANT AS 'BAR/RESTAURANT', BAR, main_courante_journaliere.SERVICES AS 'SERVICES', main_courante_journaliere.SALON_DE_BEAUTE AS 'SALON DE BEAUTE', main_courante_journaliere.BOUTIQE AS 'BOUTIQUE', main_courante_journaliere.CYBERCAFE As 'BUSINESS CENTER', main_courante_journaliere.SPORTS As 'SPORTS' , main_courante_journaliere.LOISIRS As 'LOISIRS', TOTAL_JOUR, main_courante_journaliere.KIOSQUE_A_JOURNAUX as 'JOURNAUX', main_courante_journaliere.BLANCHISSERIE As BLANCHISSERIE, main_courante_journaliere.AUTRES As 'AUTRES', TOTAL_JOUR As 'RECETTE DU JOUR', REPORT_VEILLE As 'REPORT VEILLE', TOTAL_GENERAL As 'TOTAL GENERAL', A_REPORTER As 'A REPORTER' FROM main_Courante_journaliere, reserve_conf WHERE main_Courante_journaliere.NUM_RESERVATION = reserve_conf.CODE_RESERVATION AND reserve_conf.TYPE=@TYPE AND DATE_MAIN_COURANTE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_MAIN_COURANTE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND SOLDE_RESERVATION < 0 ORDER BY CODE_CHAMBRE ASC "

            Dim command12 As New MySqlCommand(getUserQuery12, GlobalVariable.connect)

            'command10.Parameters.Add("@DATE_DU_JOUR", MySqlDbType.Date).Value = GlobalVariable.DateDeTravail
            command12.Parameters.Add("@ETAT_MAIN_COURANTE", MySqlDbType.Int32).Value = 0
            command12.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = "chambre"

            Dim adapter12 As New MySqlDataAdapter(command12)

            Dim situationgeneraleDesClients As New DataTable()

            adapter12.Fill(situationgeneraleDesClients)

            If situationgeneraleDesClients.Rows.Count > 0 Then

                ordre += 1

                'Etats des client ayant un solde debiteur
                Dim p17 As Paragraph = New Paragraph(Chr(13) & ordre + 1 & "- SITUATION GENERALE DES FACTURES DE CLIENTS PRESENTS [ " & GlobalVariable.DateDeTravail.AddDays(-1) & " ]" & Chr(13) & Chr(13))
                p17.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p17)

                pdfCell = New PdfPCell(New Paragraph("CHAMBRE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TYPE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAX", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                'pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NUITEES", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("MONTANT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph("REGLEMENT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("SOLDE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY

                pdfTable.AddCell(pdfCell)

            End If

            nuitsTotal = 0
            SoldeTotal = 0
            paxTotal = 0
            tarif = 0

            TOTAL_RECETTE = 0
            GRAND_TOTAL_RECETTE = 0
            TOTAL_ENCAISSEMENT = 0
            GRAND_TOTAL_ENCAISSEMENT = 0

            If situationgeneraleDesClients.Rows.Count > 0 Then

                For i = 0 To situationgeneraleDesClients.Rows.Count - 1

                    For j = 0 To 5

                        If j = 1 Then

                            Dim CHAMBRE As String = situationgeneraleDesClients.Rows(i)("CHAMBRE").ToString

                            Dim infoRoomType As DataTable = getElementByCode(CHAMBRE, "chambre", "CODE_CHAMBRE")

                            If infoRoomType.Rows.Count > 0 Then
                                Dim CODE_TYPE_CHAMBRE As String = infoRoomType.Rows(0)("CODE_TYPE_CHAMBRE")
                                pdfCell = New PdfPCell(New Paragraph(CODE_TYPE_CHAMBRE, pRow))
                            End If

                        ElseIf j = 3 Or j = 4 Then
                            pdfCell = New PdfPCell(New Paragraph(CDate(situationgeneraleDesClients.Rows(i)(j).ToString).ToShortDateString, pRow))
                        ElseIf j = 5 Then

                            Dim arrivee As Date = CDate(situationgeneraleDesClients.Rows(i)("DATE ARRIVEE")).ToShortDateString
                            Dim depart As Date = CDate(situationgeneraleDesClients.Rows(i)("DATE DEPART")).ToShortDateString
                            nuits = CType((depart - arrivee).TotalDays, Int64)

                            'nuits += 1

                            nuitsTotal += nuits

                            pdfCell = New PdfPCell(New Paragraph(nuits, pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            'pdfTable.AddCell(pdfCell)

                        ElseIf j = 6 Or j = 7 Then
                            pdfCell = New PdfPCell(New Paragraph(Format(situationgeneraleDesClients.Rows(i)(j), "#,##0"), pRow))
                        Else
                            pdfCell = New PdfPCell(New Paragraph(situationgeneraleDesClients.Rows(i)(j).ToString, pRow))
                        End If

                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                        If j = 1 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j = 3 Or j = 4 Or j = 5 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j = 6 Or j = 7 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        Else
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        End If

                        pdfTable.AddCell(pdfCell)

                    Next

                    TOTAL_ENCAISSEMENT = 0
                    TOTAL_RECETTE = 0

                    TOTAL_RECETTE = situationgeneraleDesClients.Rows(i)("HEBERGEMENT") * nuits

                    GRAND_TOTAL_RECETTE += TOTAL_RECETTE

                    pdfCell = New PdfPCell(New Paragraph(Format(TOTAL_RECETTE, "#,##0"), pRow))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F

                    pdfTable.AddCell(pdfCell)

                    Dim CODE_RESERVATION As String = situationgeneraleDesClients.Rows(i)("RESERVATION")
                    Dim reg As DataTable = Functions.getElementByCode(CODE_RESERVATION, "reglement", "CODE_RESERVATION")

                    For k = 0 To reg.Rows.Count - 1
                        TOTAL_ENCAISSEMENT += reg.Rows(k)("MONTANT_VERSE")
                        GRAND_TOTAL_ENCAISSEMENT += reg.Rows(k)("MONTANT_VERSE")
                    Next

                    pdfCell = New PdfPCell(New Paragraph(Format(TOTAL_ENCAISSEMENT, "#,##0"), pRow))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(TOTAL_ENCAISSEMENT - TOTAL_RECETTE, "#,##0"), pRow))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F

                    pdfTable.AddCell(pdfCell)

                Next

                '---------------------------------------------------

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = 3
                pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(paxTotal, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfTable.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = 2
                pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph(nuitsTotal, pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(GRAND_TOTAL_RECETTE, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(GRAND_TOTAL_ENCAISSEMENT, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(GRAND_TOTAL_ENCAISSEMENT - GRAND_TOTAL_RECETTE, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

            End If
            '----------------------------------------------------------------------------------------------------------------------------------

            ' -------------------------------------- SITUATION GENERALE DES PRESTATIONS -------------------------------------------------------


            '1- HEBERGEMENT
            'On Affiche toute reservation dont la date d'entree figure entre les deux dates saisies
            'Dim query As String = "SELECT * FROM main_courante_journaliere WHERE DATE_MAIN_COURANTE >= '" & GlobalVariable.DateDeTravail.ToString("yyyy-MM-dd") & "' AND DATE_MAIN_COURANTE <='" & GlobalVariable.DateDeTravail.ToString("yyyy-MM-dd") & "' AND ETAT_MAIN_COURANTE =@ETAT_MAIN_COURANTE"
            'Dim query13 As String = "SELECT * FROM main_courante_journaliere WHERE ETAT_MAIN_COURANTE =@ETAT_MAIN_COURANTE ORDER BY CODE_MAIN_COURANTE_JOURNALIERE ASC"
            Dim query13 As String = "SELECT * FROM main_courante_journaliere WHERE DATE_MAIN_COURANTE BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & DateFinStat.ToString("yyyy-MM-dd") & "' ORDER BY CODE_MAIN_COURANTE_JOURNALIERE ASC"

            Dim command13 As New MySqlCommand(query13, GlobalVariable.connect)
            command13.Parameters.Add("@ETAT_MAIN_COURANTE", MySqlDbType.VarChar).Value = 0
            'command.Parameters.Add("@ETAT_RESERVATION", MySqlDbType.Int32).Value = 0

            Dim adapter13 As New MySqlDataAdapter(command13)
            Dim dt As New DataTable()
            adapter13.Fill(dt)

            'Dim query2 As String = "SELECT * FROM main_courante_autres WHERE DATE_MAIN_COURANTE >= '" & GlobalVariable.DateDeTravail.ToString("yyyy-MM-dd") & "' AND DATE_MAIN_COURANTE <='" & GlobalVariable.DateDeTravail.ToString("yyyy-MM-dd") & "' AND ETAT_MAIN_COURANTE =@ETAT_MAIN_COURANTE"
            Dim query14 As String = "SELECT * FROM main_courante_autres WHERE DATE_MAIN_COURANTE BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & DateFinStat.ToString("yyyy-MM-dd") & "' ORDER BY CODE_MAIN_COURANTE_JOURNALIERE ASC"

            Dim command14 As New MySqlCommand(query14, GlobalVariable.connect)
            command14.Parameters.Add("@ETAT_MAIN_COURANTE", MySqlDbType.VarChar).Value = 0
            'command.Parameters.Add("@ETAT_RESERVATION", MySqlDbType.Int32).Value = 0

            Dim adapter14 As New MySqlDataAdapter(command14)
            Dim dt2 As New DataTable()
            adapter14.Fill(dt2)

            dt.Merge(dt2)

            Dim hebergementDujours As Double = 0
            Dim barRestaurantDuJour As Double = 0
            Dim autres As Double = 0
            Dim blanchisserrieDujours As Double = 0
            Dim EvenementJour As Double = 0
            Dim taxeDeSejour As Double = 0
            Dim pdjJour As Double = 0
            Dim peujour As Double = 0
            Dim cavejour As Double = 0
            Dim Consojour As Double = 0
            Dim Eaujour As Double = 0
            Dim jourDej As Double = 0
            Dim jourDinner As Double = 0
            Dim bar As Double = 0

            Dim caveCumule As Double = 0
            Dim ConsoCumule As Double = 0
            Dim EauCumule As Double = 0
            Dim cumulepdjJour As Double = 0
            Dim CumuleDej As Double = 0
            Dim CumuleDinner As Double = 0
            Dim hebergementDuCumule As Double = 0
            Dim barRestaurantDuCumule As Double = 0
            Dim blanchisserrieDuCumule As Double = 0
            Dim autresCumule As Double = 0
            Dim taxeDeSejourCumule As Double = 0
            Dim evenementCumule As Double = 0
            Dim evenementJournalier As Double = 0
            Dim barCumule As Double = 0

            Dim restau As Double = 0
            Dim restauCumule As Double = 0

            Dim numeroDuMoiDuMoment As Integer = 0
            Dim numeroAnneeDuMoment As Integer = 0

            Dim numeroDuMoiDateDeTravail As Integer = 0
            Dim numeroAnneeDateDeTravail As Integer = 0

            Integer.TryParse(Month(CDate(GlobalVariable.DateDeTravail).ToShortDateString), numeroDuMoiDateDeTravail)

            If dt.Rows.Count > 0 Then

                ordre += 1

                Dim p19 As Paragraph = New Paragraph(Chr(13) & ordre + 1 & "- SITUATION GENERALE DES PRESTATIONS DU [ " & GlobalVariable.DateDeTravail.AddDays(-1) & " ]" & Chr(13) & Chr(13))
                p19.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p19)

                pdfTable = New PdfPTable(3) 'Number of columns
                pdfTable.TotalWidth = 750.0F
                pdfTable.LockedWidth = True
                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable.HeaderRows = 1

                widths6 = New Single() {25.0F, 10.0F, 10.0F}
                pdfTable.SetWidths(widths6)

                For i = 0 To dt.Rows.Count - 1

                    '1- ON VERIFIE QUE ON EST TOUJOURS DANS LE MOIS EN COURS
                    '1.1- ON DOIT TRAITER QUE LES MAINS COURANTE JOURNALIERE QUI SONT DANS LE MOIS ACTUEL

                    Integer.TryParse(Month(dt.Rows(i)("DATE_MAIN_COURANTE")), numeroDuMoiDuMoment)

                    If numeroDuMoiDuMoment = numeroDuMoiDateDeTravail Then

                        '2- PUIS ON CALCUL LE CUMULE DES 

                        'TAXE DE SEJOURS COLLECTEES
                        Dim NUM_RESERVATION As String = dt.Rows(i)("NUM_RESERVATION")

                        Dim taxeSejour As DataTable = Functions.getElementByCode(NUM_RESERVATION, "taxe_sejour_collectee", "NUM_RESERVATION")

                        If taxeSejour.Rows.Count > 0 Then

                            For j = 0 To taxeSejour.Rows.Count - 1

                                If CDate(GlobalVariable.DateDeTravail).ToShortDateString = CDate(dt.Rows(i)("DATE_MAIN_COURANTE")).ToShortDateString Then
                                    taxeDeSejour += taxeSejour.Rows(j)("TAXE_SEJOUR_COLLECTEE")
                                End If

                                taxeDeSejourCumule += taxeSejour.Rows(j)("TAXE_SEJOUR_COLLECTEE")

                            Next

                        End If

                        Dim table As DataTable = getElementByCode(dt.Rows(i)("NUM_RESERVATION"), "reserve_conf", "CODE_RESERVATION")

                        Dim NombreHeure As Integer = 1

                        If table.Rows.Count > 0 Then

                            'ON DOIT MULTIPLIER LE DAY USE PAR LE NOMBRE D'HEURE
                            If table.Rows(0)("DAY_USE") = 1 Then

                                Dim DEBUT As Date = CDate(table.Rows(0)("HEURE_ENTREE")).ToShortTimeString
                                Dim FIN As Date = CDate(table.Rows(0)("HEURE_SORTIE")).ToShortTimeString

                                NombreHeure = CType((FIN - DEBUT).TotalHours, Int32)

                            End If

                        End If

                        If CDate(DateDebut).ToShortDateString = CDate(dt.Rows(i)("DATE_MAIN_COURANTE")).ToShortDateString Then

                            cavejour += Double.Parse(dt.Rows(i)("CAVE"))
                            Consojour += Double.Parse(dt.Rows(i)("DIVERS"))
                            Eaujour += Double.Parse(dt.Rows(i)("CAFE"))

                            pdjJour += Double.Parse(dt.Rows(i)("PDJ"))
                            jourDej += Double.Parse(dt.Rows(i)("DEJEUNER"))
                            jourDinner += Double.Parse(dt.Rows(i)("DINER"))

                            restau += pdjJour + jourDej + jourDinner

                            bar += Double.Parse(dt.Rows(i)("BAR"))

                            hebergementDujours += Double.Parse(dt.Rows(i)("MONTANT_ACCORDE")) * NombreHeure
                            barRestaurantDuJour += Double.Parse(dt.Rows(i)("BAR_RESTAURANT"))

                            blanchisserrieDujours += Double.Parse(dt.Rows(i)("BLANCHISSERIE"))

                            autres += Double.Parse(dt.Rows(i)("SERVICES")) + Double.Parse(dt.Rows(i)("BOUTIQE")) + Double.Parse(dt.Rows(i)("CYBERCAFE")) + Double.Parse(dt.Rows(i)("AUTRES")) + Double.Parse(dt.Rows(i)("BOUTIQE")) + Double.Parse(dt.Rows(i)("SPORTS")) + Double.Parse(dt.Rows(i)("LOISIRS")) + Double.Parse(dt.Rows(i)("KIOSQUE_A_JOURNAUX"))

                        End If

                        caveCumule += Double.Parse(dt.Rows(i)("CAVE"))
                        ConsoCumule += Double.Parse(dt.Rows(i)("DIVERS"))
                        EauCumule += Double.Parse(dt.Rows(i)("CAFE"))

                        cumulepdjJour += Double.Parse(dt.Rows(i)("PDJ"))
                        CumuleDej += Double.Parse(dt.Rows(i)("DEJEUNER"))
                        CumuleDinner += Double.Parse(dt.Rows(i)("DINER"))

                        restauCumule += cumulepdjJour + CumuleDej + CumuleDinner

                        'EvenementCumule += Double.Parse(dt.Rows(i)("CAVE"))
                        barCumule += Double.Parse(dt.Rows(i)("BAR"))

                        hebergementDuCumule += Double.Parse(dt.Rows(i)("MONTANT_ACCORDE")) * NombreHeure
                        barRestaurantDuCumule += Double.Parse(dt.Rows(i)("BAR_RESTAURANT"))
                        blanchisserrieDuCumule += Double.Parse(dt.Rows(i)("BLANCHISSERIE"))

                        autresCumule += Double.Parse(dt.Rows(i)("SERVICES")) + Double.Parse(dt.Rows(i)("BOUTIQE")) + Double.Parse(dt.Rows(i)("CYBERCAFE")) + Double.Parse(dt.Rows(i)("AUTRES")) + Double.Parse(dt.Rows(i)("BOUTIQE")) + Double.Parse(dt.Rows(i)("SPORTS")) + Double.Parse(dt.Rows(i)("LOISIRS")) + Double.Parse(dt.Rows(i)("KIOSQUE_A_JOURNAUX"))

                    End If

                Next

                restauCumule = barRestaurantDuCumule - barCumule
                'GESTION DES RESERVATION DE TYPE EVENEMENTIELLE

                Dim evenementInfo As DataTable = evenementielle()

                If evenementInfo.Rows.Count > 0 Then

                    'evenementJournalier = 0

                    '1- CALCUL DU MONTANT ACCORDE
                    For m = 0 To evenementInfo.Rows.Count - 1

                        Dim CODE_RESERVATION As String = evenementInfo.Rows(m)("NUM_RESERVATION")

                        If CDate(evenementInfo.Rows(m)("DATE_MAIN_COURANTE")).ToShortDateString >= CDate(GlobalVariable.DateDeTravail).ToShortDateString And CDate(evenementInfo.Rows(m)("DATE_MAIN_COURANTE")).ToShortDateString <= CDate(GlobalVariable.DateDeTravail).ToShortDateString Then
                            evenementJournalier += evenementInfo.Rows(m)("HEBERGEMENT")
                        End If

                        evenementCumule += evenementInfo.Rows(m)("HEBERGEMENT")

                    Next

                    '2- CALCUL DES FORFAIT SUPPLEMENTAIRES

                End If

            End If

            Dim totalGeneral As Double = 0
            Dim totalGeneralCumule As Double = 0

            Dim evenement As DataTable

            totalGeneral = hebergementDujours + bar + autres + blanchisserrieDujours + restau
            totalGeneralCumule = hebergementDuCumule + barCumule + blanchisserrieDuCumule + autresCumule + restauCumule

            Dim grandTotalJournalier As Double = 0
            Dim grandTotalCumule As Double = 0

            grandTotalJournalier += grandTotalJournalier
            grandTotalCumule += grandTotalCumule

            pdfCell = New PdfPCell(New Paragraph("PRESTATIONS", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("JOURNALIER", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("CUMULE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("HEBERGEMENT", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(hebergementDujours, "#,##0"), pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(hebergementDuCumule, "#,##0"), pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("BAR", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(bar, "#,##0"), pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(barCumule, "#,##0"), pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("RESTAURANT", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            'restau = pdjJour + jourDej + jourDinner
            pdfCell = New PdfPCell(New Paragraph(Format(restau, "#,##0"), pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)
            'cumulepdjJour +CumuleDinner + CumuleDej
            pdfCell = New PdfPCell(New Paragraph(Format(restauCumule, "#,##0"), pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("TAXE DE SEJOURS", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(taxeDeSejour, "#,##0"), pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(taxeDeSejourCumule, "#,##0"), pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("EVENEMENTIEL", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(evenementJournalier, "#,##0"), pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(evenementCumule, "#,##0"), pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("BLANCHISSERIE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(blanchisserrieDujours, "#,##0"), pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(blanchisserrieDuCumule, "#,##0"), pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("AUTRES", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(autres, "#,##0"), pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(autresCumule, "#,##0"), pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("TOTAL DES ENTREES", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            pdfCell.Border = 0
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(totalGeneral, "#,##0"), pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(totalGeneralCumule, "#,##0"), pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            'DEPENSES
            pdfCell = New PdfPCell(New Paragraph("DEPENSES", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(0, "#,##0"), pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(0, "#,##0"), pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("BALANCE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)


            pdfCell = New PdfPCell(New Paragraph(Format(0, "#,##0"), pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(0, "#,##0"), pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfDoc.Add(pdfTable)

            '----------------- SITUATION DE LA DETTE DES CLIENT ENTREPRISE ----------------------------

            'Dim query11 As String = "SELECT CODE_FACTURE As REFERENCE, DATE_FACTURE AS DATE, LIBELLE_FACTURE AS LIBELLE, MONTANT_TTC AS MONTANT, MONTANT_AVANCE AS 'MONTANT SOLDE'  FROM facture, client WHERE ETAT_FACTURE = 1 AND facture.CODE_CLIENT=client.CODE_CLIENT AND TYPE_CLIENT = @TYPE_CLIENT ORDER BY DATE_FACTURE DESC"

            'SELECTION DES DIFFERENTS CLIENTS ENTREPRISES

            Dim query11 As String = "SELECT DISTINCT CODE_CLIENT FROM facture WHERE ETAT_FACTURE = 1 ORDER BY DATE_FACTURE DESC"

            Dim command11 As New MySqlCommand(query11, GlobalVariable.connect)
            'command2.Parameters.Add("@CODE_CLIENT", MySqlDbType.VarChar).Value = CODE_ENTREPRISE
            'command2.Parameters.Add("@CODE_RESERVATION", MySqlDbType.VarChar).Value = CODE_RESERVATION
            command11.Parameters.Add("@TYPE_CLIENT", MySqlDbType.VarChar).Value = "ENTREPRISE"

            Dim adapter11 As New MySqlDataAdapter(command11)

            Dim clientFacture As New DataTable()

            adapter11.Fill(clientFacture)

            If clientFacture.Rows.Count > 0 Then

                Dim CREDIT As Double = 0
                Dim DEBIT As Double = 0

                ordre += 1
                
                Dim p19 As Paragraph = New Paragraph(Chr(13) & ordre + 1 & "- SITUATION DE LA DETTE DES CLIENT ENTREPRISE DU [ " & GlobalVariable.DateDeTravail.AddDays(-1) & " ]" & Chr(13) & Chr(13))
                p19.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p19)

                pdfTable = New PdfPTable(4) 'Number of columns
                pdfTable.TotalWidth = 750.0F
                pdfTable.LockedWidth = True
                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable.HeaderRows = 1

                widths6 = New Single() {25.0F, 15.0F, 15.0F, 15.0F}
                pdfTable.SetWidths(widths6)

                pdfCell = New PdfPCell(New Paragraph("CLIENT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEBIT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CREDIT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("SOLDE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                Dim SOLDE As Double = 0
                Dim TOTALSOLDE As Double = 0
                Dim TOTALCREDIT As Double = 0
                Dim TOTALDEBIT As Double = 0

                Dim GrandtotalFactureClient As Double = 0
                Dim GrandtotalReglement As Double = 0

                For k = 0 To clientFacture.Rows.Count - 1

                    Dim CODE_CLIENT As String = clientFacture.Rows(k)("CODE_CLIENT")

                    Dim infoClient As DataTable = Functions.GetAllElementsOnTwoConditions(CODE_CLIENT, "client", "CODE_CLIENT", "ENTREPRISE", "TYPE_CLIENT")

                    If infoClient.Rows.Count > 0 Then

                        Dim query2 As String = "SELECT CODE_FACTURE As REFERENCE, DATE_FACTURE AS DATE, LIBELLE_FACTURE AS LIBELLE, MONTANT_TTC AS MONTANT, MONTANT_AVANCE AS 'MONTANT SOLDE', LETTRAGE  FROM facture WHERE ETAT_FACTURE = 1 AND CODE_CLIENT=@CODE_CLIENT ORDER BY DATE_FACTURE DESC"
                        Dim command2 As New MySqlCommand(query2, GlobalVariable.connect)
                        command2.Parameters.Add("@CODE_CLIENT", MySqlDbType.VarChar).Value = CODE_CLIENT

                        Dim adapter2 As New MySqlDataAdapter(command2)

                        Dim tableFacture As New DataTable()

                        adapter2.Fill(tableFacture)

                        Dim query03 As String = "SELECT REF_REGLEMENT, MODE_REGLEMENT ,NUM_REGLEMENT, MONTANT_VERSE, DATE_REGLEMENT, MODE_REGLEMENT, CODE_MODE , LETTRAGE FROM reglement WHERE CODE_CLIENT = @CODE_CLIENT ORDER BY DATE_REGLEMENT DESC"
                        Dim command03 As New MySqlCommand(query03, GlobalVariable.connect)

                        command03.Parameters.Add("@CODE_CLIENT", MySqlDbType.VarChar).Value = CODE_CLIENT
                        'command3.Parameters.Add("@CODE_RESERVATION", MySqlDbType.VarChar).Value = CODE_RESERVATION

                        Dim adapter03 As New MySqlDataAdapter(command03)
                        Dim tableReglement As New DataTable()

                        adapter03.Fill(tableReglement)

                        Dim totalFactureClient As Double = 0
                        Dim totalReglement As Double = 0

                        For j = 0 To tableFacture.Rows.Count - 1
                            totalFactureClient = totalFactureClient + tableFacture.Rows(j)("MONTANT")
                        Next

                        For l = 0 To tableReglement.Rows.Count - 1
                            totalReglement += tableReglement.Rows(l)("MONTANT_VERSE")
                        Next

                        GrandtotalFactureClient += totalFactureClient
                        GrandtotalReglement += totalReglement

                        'GunaTextBoxSoldeCompte.Text = Format(Double.Parse(totalReglement) - Double.Parse(totalFacture), "#,##0")

                        pdfCell = New PdfPCell(New Paragraph(infoClient.Rows(0)("NOM_CLIENT"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalFactureClient, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalReglement, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalReglement - totalFactureClient, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.AddCell(pdfCell)

                        totalFactureClient = 0
                        totalReglement = 0

                    End If

                Next

                pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(GrandtotalFactureClient, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(GrandtotalReglement, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(GrandtotalReglement - GrandtotalFactureClient, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

            End If
            ' --------------------------------------------- GESTION DES MODES DE REGLEMENTS ----------------------------------------------------------------

            '2- SELECTION DE L'ENSEMBLE DES MODES DE REGLEMENT LIES A UN CAISSIERS QUELCONQUES

            'Etats des client ayant un solde debiteur

            Dim getUserQuery8 = "SELECT DISTINCT MODE_REGLEMENT FROM reglement WHERE DATE_REGLEMENT BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & DateFinStat.ToString("yyyy-MM-dd") & "'  ORDER BY MODE_REGLEMENT ASC"

            Dim command8 As New MySqlCommand(getUserQuery8, GlobalVariable.connect)
            Dim adapter8 As New MySqlDataAdapter

            Dim dtModeReglement As New DataTable()

            adapter8.SelectCommand = command8

            adapter8.Fill(dtModeReglement)

            'CALCUL DU MONTANT TOTAL DES REGLEMENTS
            If dtModeReglement.Rows.Count > 0 Then

                ordre += 1

                Dim p18 As Paragraph = New Paragraph(Chr(13) & ordre + 1 & "- TRESORERIE DU  [ " & GlobalVariable.DateDeTravail.AddDays(-1) & " ]" & Chr(13) & Chr(13))
                p18.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p18)

                Dim pdfTable8 As New PdfPTable(3) 'Number of columns
                pdfTable8.TotalWidth = 750.0F
                pdfTable8.LockedWidth = True
                pdfTable8.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable8.HeaderRows = 1

                Dim widths8 As Single() = New Single() {25.0F, 10.0F, 10.0F}
                pdfTable8.SetWidths(widths8)

                Dim GrandTotalJounalier As Double = 0
                grandTotalCumule = 0

                pdfCell = New PdfPCell(New Paragraph("MODE DE REGLEMENT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable8.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("JOURNALIER", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable8.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CUMULE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable8.AddCell(pdfCell)


                For j = 0 To dtModeReglement.Rows.Count - 1

                    Dim MODE_REGLEMENT As String = dtModeReglement.Rows(j)("MODE_REGLEMENT")

                    Dim dtSpecific As New DataTable()

                    Dim getUserQuery1 = "SELECT * FROM reglement WHERE MODE_REGLEMENT=@MODE_REGLEMENT AND DATE_REGLEMENT BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & DateFinStat.ToString("yyyy-MM-dd") & "' ORDER BY DATE_REGLEMENT DESC"

                    Dim command9 As New MySqlCommand(getUserQuery1, GlobalVariable.connect)

                    command9.Parameters.Add("@MODE_REGLEMENT", MySqlDbType.VarChar).Value = MODE_REGLEMENT
                    Dim adapter9 As New MySqlDataAdapter

                    adapter9.SelectCommand = command9

                    adapter9.Fill(dtSpecific)

                    Dim jounalier As Double = 0

                    Dim Cumule As Double = 0

                    If dtSpecific.Rows.Count > 0 Then

                        jounalier = 0
                        Cumule = 0

                        For i = 0 To dtSpecific.Rows.Count - 1

                            If CDate(dtSpecific.Rows(i)("DATE_REGLEMENT")).ToShortDateString = CDate(GlobalVariable.DateDeTravail).ToShortDateString Then
                                jounalier += dtSpecific.Rows(i)("MONTANT_VERSE")
                                GrandTotalJounalier += dtSpecific.Rows(i)("MONTANT_VERSE")
                            End If

                            Cumule += dtSpecific.Rows(i)("MONTANT_VERSE")
                            grandTotalCumule += dtSpecific.Rows(i)("MONTANT_VERSE")

                        Next

                    End If

                    pdfCell = New PdfPCell(New Paragraph(MODE_REGLEMENT, pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.Border = 0
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable8.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(jounalier, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable8.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(Cumule, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable8.AddCell(pdfCell)

                Next

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable8.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(GrandTotalJounalier, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable8.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(grandTotalCumule, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable8.AddCell(pdfCell)

                pdfDoc.Add(pdfTable8)
                ' -----------------------------------------------------------------------------------------------------------------------------------------------

                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Process.Start(sfd.FileName)

            End If

        End If

    End Sub

    Public Shared Function evenementielle() As DataTable

        Dim getUserQuery = "SELECT CODE_CHAMBRE As 'CHAMBRE', DAY_USE, NUM_RESERVATION, main_courante_journaliere.NOM_CLIENT As 'NOM & PRENOM', DATE_ENTTRE As 'DATE ARRIVEE', DATE_SORTIE As 'DATE DEPART', NB_PERSONNES As 'NBRE DE PAX', PDJ, DEJEUNER, DINER, ENCAISSEMENT_ESPECE AS 'ESPECES', ENCAISSEMENT_CHEQUE AS 'CHEQUE', ENCAISSEMENT_CARTE_CREDIT As 'CARTE CREDIT', TELE AS 'MOBILE MONEY', main_Courante_journaliere.NUM_RESERVATION As 'RESERVATION', main_courante_journaliere.MONTANT_ACCORDE AS 'HEBERGEMENT', main_courante_journaliere.BAR_RESTAURANT AS 'BAR/RESTAURANT', BAR, main_courante_journaliere.SERVICES AS 'SERVICES', main_courante_journaliere.SALON_DE_BEAUTE AS 'SALON DE BEAUTE', main_courante_journaliere.BOUTIQE AS 'BOUTIQUE', main_courante_journaliere.CYBERCAFE As 'BUSINESS CENTER', main_courante_journaliere.SPORTS As 'SPORTS' , main_courante_journaliere.LOISIRS As 'LOISIRS', TOTAL_JOUR, main_courante_journaliere.KIOSQUE_A_JOURNAUX as 'JOURNAUX', main_courante_journaliere.BLANCHISSERIE As BLANCHISSERIE, main_courante_journaliere.AUTRES As 'AUTRES', TOTAL_JOUR As 'RECETTE DU JOUR', REPORT_VEILLE As 'REPORT VEILLE', TOTAL_GENERAL As 'TOTAL GENERAL', A_REPORTER As 'A REPORTER', DATE_MAIN_COURANTE FROM main_Courante_journaliere, reservation WHERE main_Courante_journaliere.NUM_RESERVATION = reservation.CODE_RESERVATION AND reservation.TYPE=@TYPE AND DAY_USE = 0 ORDER BY main_courante_journaliere.NOM_CLIENT ASC"

        Dim command As New MySqlCommand(getUserQuery, GlobalVariable.connect)

        'command.Parameters.Add("@DATE_DU_JOUR", MySqlDbType.Date).Value = GlobalVariable.DateDeTravail
        'command.Parameters.Add("@ETAT_MAIN_COURANTE", MySqlDbType.Int32).Value = 0
        'command.Parameters.Add("@ETAT_MAIN_COURANTE", MySqlDbType.Int32).Value = 1
        command.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = "salle"

        Dim adapter As New MySqlDataAdapter(command)

        Dim table As New DataTable()

        adapter.Fill(table)

        'RESERVATION CONFIRMEE
        'Dim getUserQuery1 = "SELECT CODE_CHAMBRE As 'CHAMBRE', DAY_USE, NUM_RESERVATION, main_courante_journaliere.NOM_CLIENT As 'NOM & PRENOM', DATE_ENTTRE As 'DATE ARRIVEE', DATE_SORTIE As 'DATE DEPART', NB_PERSONNES As 'NBRE DE PAX', PDJ, DEJEUNER, DINER, ENCAISSEMENT_ESPECE AS 'ESPECES', ENCAISSEMENT_CHEQUE AS 'CHEQUE', ENCAISSEMENT_CARTE_CREDIT As 'CARTE CREDIT', TELE AS 'MOBILE MONEY', main_Courante_journaliere.NUM_RESERVATION As 'RESERVATION', main_courante_journaliere.MONTANT_ACCORDE AS 'HEBERGEMENT', main_courante_journaliere.BAR_RESTAURANT AS 'BAR/RESTAURANT', BAR, main_courante_journaliere.SERVICES AS 'SERVICES', main_courante_journaliere.SALON_DE_BEAUTE AS 'SALON DE BEAUTE', main_courante_journaliere.BOUTIQE AS 'BOUTIQUE', main_courante_journaliere.CYBERCAFE As 'BUSINESS CENTER', main_courante_journaliere.SPORTS As 'SPORTS' , main_courante_journaliere.LOISIRS As 'LOISIRS', TOTAL_JOUR, main_courante_journaliere.KIOSQUE_A_JOURNAUX as 'JOURNAUX', main_courante_journaliere.BLANCHISSERIE As BLANCHISSERIE, main_courante_journaliere.AUTRES As 'AUTRES', TOTAL_JOUR As 'RECETTE DU JOUR', REPORT_VEILLE As 'REPORT VEILLE', TOTAL_GENERAL As 'TOTAL GENERAL', A_REPORTER As 'A REPORTER' FROM main_Courante_journaliere, reserve_conf WHERE ETAT_MAIN_COURANTE = @ETAT_MAIN_COURANTE AND DATE_MAIN_COURANTE = @DATE_DU_JOUR AND main_Courante_journaliere.NUM_RESERVATION = reserve_conf.CODE_RESERVATION AND reserve_conf.TYPE=@TYPE AND DAY_USE = 0 ORDER BY main_courante_journaliere.NOM_CLIENT ASC"

        'DATE_MAIN_COURANTE <= '" & DateFin.ToString("yyyy-MM-dd") & "' AND DATE_MAIN_COURANTE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND

        Dim getUserQuery1 = "SELECT CODE_CHAMBRE As 'CHAMBRE', DAY_USE, NUM_RESERVATION, main_courante_journaliere.NOM_CLIENT As 'NOM & PRENOM', DATE_ENTTRE As 'DATE ARRIVEE', DATE_SORTIE As 'DATE DEPART', NB_PERSONNES As 'NBRE DE PAX', PDJ, DEJEUNER, DINER, ENCAISSEMENT_ESPECE AS 'ESPECES', ENCAISSEMENT_CHEQUE AS 'CHEQUE', ENCAISSEMENT_CARTE_CREDIT As 'CARTE CREDIT', TELE AS 'MOBILE MONEY', main_Courante_journaliere.NUM_RESERVATION As 'RESERVATION', main_courante_journaliere.MONTANT_ACCORDE AS 'HEBERGEMENT', main_courante_journaliere.BAR_RESTAURANT AS 'BAR/RESTAURANT', BAR, main_courante_journaliere.SERVICES AS 'SERVICES', main_courante_journaliere.SALON_DE_BEAUTE AS 'SALON DE BEAUTE', main_courante_journaliere.BOUTIQE AS 'BOUTIQUE', main_courante_journaliere.CYBERCAFE As 'BUSINESS CENTER', main_courante_journaliere.SPORTS As 'SPORTS' , main_courante_journaliere.LOISIRS As 'LOISIRS', TOTAL_JOUR, main_courante_journaliere.KIOSQUE_A_JOURNAUX as 'JOURNAUX', main_courante_journaliere.BLANCHISSERIE As BLANCHISSERIE, main_courante_journaliere.AUTRES As 'AUTRES', TOTAL_JOUR As 'RECETTE DU JOUR', REPORT_VEILLE As 'REPORT VEILLE', TOTAL_GENERAL As 'TOTAL GENERAL', A_REPORTER As 'A REPORTER', DATE_MAIN_COURANTE FROM main_Courante_journaliere, reserve_conf WHERE main_Courante_journaliere.NUM_RESERVATION = reserve_conf.CODE_RESERVATION AND reserve_conf.TYPE=@TYPE AND DAY_USE = 0 ORDER BY main_courante_journaliere.NOM_CLIENT ASC"

        Dim command1 As New MySqlCommand(getUserQuery1, GlobalVariable.connect)

        'command1.Parameters.Add("@DATE_DU_JOUR", MySqlDbType.Date).Value = GlobalVariable.DateDeTravail
        'command1.Parameters.Add("@ETAT_MAIN_COURANTE", MySqlDbType.Int32).Value = 0
        'command1.Parameters.Add("@ETAT_MAIN_COURANTE", MySqlDbType.Int32).Value = 1
        command1.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = "salle"

        Dim adapter1 As New MySqlDataAdapter(command1)

        Dim table1 As New DataTable()

        adapter1.Fill(table1)

        table.Merge(table1)

        Return table

    End Function

    Public Shared Sub VenteNetParPointDeVente(ByVal dt As DataGridView, ByVal dateMainCouranteDebut As Date, ByVal dateMainCouranteFin As Date)

        'CHAMBRE', NUM_RESERVATION As 'RESERVATION', MONTANT_ACCORDE AS 'MONTANT',BAR_RESTAURANT AS 'BAR/RESTAURANT', SERVICES,SALON_DE_BEAUTE AS 'SALON DE BEAUTE', BOUTIQE AS 'BOUTIQUE', CYBERCAFE, AUTRES

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        If GlobalVariable.actualLanguageValue = 1 Then

            titreFichier = "SITUATION PAR SERVICE"
            tireDocument = titreFichier & Chr(13) & " DU " & dateMainCouranteDebut & " AU " & dateMainCouranteFin

        Else
            titreFichier = "DAILY FINANCIAL REPORT PER DEPARTMENT"
            tireDocument = titreFichier & Chr(13) & " OF " & dateMainCouranteDebut & " AU " & dateMainCouranteFin

        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then

            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4, 20, 20, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim nbreDeColonne As Integer = dt.Columns.Count

            Dim pdfTable As New PdfPTable(nbreDeColonne) 'Number of columns
            pdfTable.TotalWidth = 560.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single()

            If nbreDeColonne = 2 Then
                widths = New Single() {10.0F, 120.0F}
            ElseIf nbreDeColonne = 3 Then
                widths = New Single() {50.0F, 110.0F, 110.0F}
            ElseIf nbreDeColonne = 4 Then
                widths = New Single() {50.0F, 100.0F, 100.0F, 100.0F}
            ElseIf nbreDeColonne = 5 Then
                widths = New Single() {50.0F, 90.0F, 90.0F, 90.0F, 90.0F}
            ElseIf nbreDeColonne = 6 Then
                widths = New Single() {40.0F, 80.0F, 80.0F, 80.0F, 80.0F, 80.0F}
            ElseIf nbreDeColonne = 7 Then
                widths = New Single() {50.0F, 70.0F, 70.0F, 70.0F, 70.0F, 70.0F, 70.0F}
            ElseIf nbreDeColonne = 8 Then
                widths = New Single() {50.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F}
            ElseIf nbreDeColonne = 9 Then
                widths = New Single() {50.0F, 50.0F, 50.0F, 50.0F, 50.0F, 50.0F, 50.0F, 50.0F, 50.0F}
            ElseIf nbreDeColonne = 10 Then
                widths = New Single() {40.0F, 40.0F, 40.0F, 40.0F, 40.0F, 40.0F, 40.0F, 40.0F, 40.0F, 40.0F}
            ElseIf nbreDeColonne = 11 Then
                widths = New Single() {30.0F, 30.0F, 30.0F, 30.0F, 30.0F, 30.0F, 30.0F, 30.0F, 30.0F, 30.0F, 30.0F}
            ElseIf nbreDeColonne = 12 Then
                widths = New Single() {20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F}
            End If

            pdfTable.SetWidths(widths)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            Dim query_ As String = "SELECT DISTINCT TYPE_LIGNE_FACTURE AS SERVICE FROM ligne_facture WHERE DATE_FACTURE <= '" & dateMainCouranteFin.ToString("yyyy-MM-dd") & "' AND DATE_FACTURE >='" & dateMainCouranteDebut.ToString("yyyy-MM-dd") & "' ORDER BY TYPE_LIGNE_FACTURE ASC"
            Dim command_ As New MySqlCommand(query_, GlobalVariable.connect)

            Dim adapter_ As New MySqlDataAdapter

            Dim table_ As New DataTable()

            adapter_.SelectCommand = command_

            adapter_.Fill(table_)

            'If table_.Rows.Count > 0 Then

            'End If

            Dim k = -1 'index de la colonne taxe de sejours

            Dim vertiTaxe As Double = 0

            Dim nomDeColonne As String = ""

            If GlobalVariable.actualLanguageValue = 1 Or GlobalVariable.actualLanguageValue = 0 Then

                pdfCell = New PdfPCell(New Paragraph("DATE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                For i = 0 To table_.Rows.Count - 1

                    nomDeColonne = table_.Rows(i)("SERVICE")

                    If GlobalVariable.actualLanguageValue = 1 Then
                        If nomDeColonne.Contains("TAXE DE") Or nomDeColonne.Contains("TOURIST TAX") Then
                            k = i
                        End If
                    Else
                        If nomDeColonne.Contains("TOURIST TAX") Or nomDeColonne.Contains("TOURIST TAX") Then
                            k = i
                        End If
                    End If

                    pdfCell = New PdfPCell(New Paragraph(nomDeColonne, pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                Next

            End If

            Dim montantService_1 As Double = 0
            Dim montantService_2 As Double = 0
            Dim montantService_3 As Double = 0
            Dim montantService_4 As Double = 0
            Dim montantService_5 As Double = 0
            Dim montantService_6 As Double = 0
            Dim montantService_7 As Double = 0
            Dim montantService_8 As Double = 0
            Dim montantService_9 As Double = 0
            Dim montantService_10 As Double = 0
            Dim montantService_11 As Double = 0
            Dim montantService_12 As Double = 0

            Dim nobreResa As Integer = 0

                Dim ChiffresAffaires As Double = 0

                If dt.Rows.Count > 0 Then

                    nobreResa = dt.Rows.Count

                For i = 0 To dt.Rows.Count - 1

                    For j = 0 To dt.Columns.Count - 1

                        If j = 0 Then
                            pdfCell = New PdfPCell(New Paragraph(CDate(dt.Rows(i).Cells(j).Value.ToString).ToShortDateString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j > 0 Then
                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells(j).Value, "#,##0"), pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        End If

                        pdfTable.AddCell(pdfCell)

                        If j = 1 Then
                            montantService_1 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 2 Then
                            montantService_2 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 3 Then
                            montantService_3 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 4 Then
                            montantService_4 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 5 Then
                            montantService_5 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 6 Then
                            montantService_6 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 7 Then
                            montantService_7 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 8 Then
                            montantService_8 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 9 Then
                            montantService_9 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 10 Then
                            montantService_10 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 11 Then
                            montantService_11 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 12 Then
                            montantService_12 += dt.Rows(i).Cells(j).Value
                        End If

                        If k > -1 Then

                            If k + 1 = j Then
                                vertiTaxe += dt.Rows(i).Cells(j).Value
                            End If

                        End If

                        If j > 0 Then
                            ChiffresAffaires += dt.Rows(i).Cells(j).Value
                        End If

                    Next

                Next

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.Border = 0
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                For i = 0 To table_.Rows.Count - 1

                    If i = 0 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(montantService_1, "#,##0"), pColumn))
                    ElseIf i = 1 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(montantService_2, "#,##0"), pColumn))
                    ElseIf i = 2 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(montantService_3, "#,##0"), pColumn))
                    ElseIf i = 3 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(montantService_4, "#,##0"), pColumn))
                    ElseIf i = 4 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(montantService_5, "#,##0"), pColumn))
                    ElseIf i = 5 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(montantService_6, "#,##0"), pColumn))
                    ElseIf i = 6 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(montantService_7, "#,##0"), pColumn))
                    ElseIf i = 7 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(montantService_8, "#,##0"), pColumn))
                    ElseIf i = 8 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(montantService_9, "#,##0"), pColumn))
                    ElseIf i = 9 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(montantService_10, "#,##0"), pColumn))
                    ElseIf i = 10 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(montantService_11, "#,##0"), pColumn))
                    ElseIf i = 11 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(montantService_12, "#,##0"), pColumn))
                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    'pdfCell.Rotation = 270
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                Next

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = nbreDeColonne
                pdfCell.Border = 0
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph("TOTAL GENERATED INCOM : ", pColumn))
                Else
                    pdfCell = New PdfPCell(New Paragraph("TOTAL CHIFFRES D'AFFAIRES : ", pColumn))
                End If


                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = nbreDeColonne - 1
                pdfCell.Border = 0
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(ChiffresAffaires, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell = New PdfPCell(New Paragraph("TOTAL TOURIST TAX : ", pColumn))
                Else
                    pdfCell = New PdfPCell(New Paragraph("TOTAL TAXE DE SEJOUR : ", pColumn))
                End If

                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = nbreDeColonne - 1
                pdfCell.Border = 0
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiTaxe, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.Border = 0
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("--------------------", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = nbreDeColonne
                pdfCell.Border = 0
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NET : ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = nbreDeColonne - 1
                pdfCell.Border = 0
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(ChiffresAffaires - vertiTaxe, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = nbreDeColonne - 1
                pdfCell.Border = 0
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

                If True Then

                    '--------------------------------- en chambre -----------------------------------------------
                    Dim enChambre As Double = 0

                    Dim query As String = "SELECT CHAMBRE_ID AS 'CHAMBRE', NOM_CLIENT As 'NOM CLIENT', DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',ETAT_NOTE_RESERVATION AS 'STATUT',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_ENTTRE <= '" & dateMainCouranteDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & dateMainCouranteDebut.ToString("yyyy-MM-dd") & "' AND DAY_USE = @DAY_USE AND TYPE=@TYPE ORDER BY CHAMBRE_ID ASC"

                    Dim command As New MySqlCommand(query, GlobalVariable.connect)
                    command.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle
                    command.Parameters.Add("@DAY_USE", MySqlDbType.Int64).Value = 0

                    Dim adapter As New MySqlDataAdapter(command)
                    Dim table As New DataTable()
                    adapter.Fill(table)

                    If table.Rows.Count > 0 Then
                        enChambre = table.Rows.Count
                    End If
                    '--------------------------------------------------------------------------------------------

                    '--------------------------------- depart ---------------------------------------------------
                    Dim depart As Double = 0

                    Dim query1 As String = "SELECT NOM_CLIENT As 'NOM CLIENT', CHAMBRE_ID AS 'CHAMBRE',DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',ETAT_NOTE_RESERVATION AS 'STATUT',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_SORTIE >= '" & dateMainCouranteDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE <='" & dateMainCouranteDebut.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND DAY_USE = @DAY_USE ORDER BY CHAMBRE_ID ASC"

                    Dim command1 As New MySqlCommand(query1, GlobalVariable.connect)
                    command1.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle
                    command1.Parameters.Add("@DAY_USE", MySqlDbType.Int64).Value = 0

                    Dim adapter1 As New MySqlDataAdapter(command1)
                    Dim table1 As New DataTable()
                    adapter1.Fill(table1)

                    If (table1.Rows.Count > 0) Then
                        depart = table1.Rows.Count
                    End If
                    '--------------------------------------------------------------------------------------------

                    '*****-------------------------------INSERTION DES NOUVELLES INFORMATIONS --------------------------------------------------------

                    ' ----------------------------------------- TWO TABLES INTO A MAIN TABLE --------------------------------------------------
                    Dim mtable As PdfPTable = New PdfPTable(2)
                    mtable.TotalWidth = 1120.0F
                    Dim widthsmtable As Single() = New Single() {60.0F, 40.0F}
                    mtable.SetWidths(widthsmtable)
                    mtable.WidthPercentage = 100
                    mtable.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

                    Dim tableLeft As PdfPTable = New PdfPTable(1)
                    tableLeft.WidthPercentage = 100
                    tableLeft.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

                    Dim tableRight As PdfPTable = New PdfPTable(1)
                    tableRight.WidthPercentage = 100
                    tableRight.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

                    Dim rooms As New Room()

                    Dim HSRooms As Integer = rooms.HSRoomsOnly().Rows.Count
                    Dim roomsOnly As Integer = rooms.roomsOnly().Rows.Count

                    Dim occupe As Integer = enChambre - depart

                    Dim vendable As Integer = roomsOnly - HSRooms
                    Dim disponible As Integer = vendable - occupe

                    If GlobalVariable.actualLanguageValue = 1 Then

                        Dim p1 As Paragraph = New Paragraph(Chr(13) & "STATISTIQUES FINANCIERES" & Chr(13) & Chr(13))
                        p1.Alignment = Element.ALIGN_CENTER
                        pdfDoc.Add(p1)

                    Else

                        Dim p1 As Paragraph = New Paragraph(Chr(13) & "FINANCIAL REPORT" & Chr(13) & Chr(13))
                        p1.Alignment = Element.ALIGN_CENTER
                        pdfDoc.Add(p1)

                    End If


                    '------------------------------------------------------- RIGHT TABLE --------------------------------

                    Dim dateState As Date = GlobalVariable.DateDeTravail.ToShortDateString

                    'Dim DateDebutStat As Date = Functions.firstDayOfMonth(dateState)
                    'Dim DateFinStat As Date = Functions.lastDayOfMonth(dateState)

                    Dim DateDebutStat As Date = dateMainCouranteDebut.ToShortDateString
                    Dim DateFinStat As Date = dateMainCouranteFin.ToShortDateString

                    Dim pdfTable2 As New PdfPTable(3) 'Number of columns
                    pdfTable.TotalWidth = 560.0F
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.HeaderRows = 1

                    pdfTable2.WidthPercentage = 100
                    Dim widths2 As Single() = New Single() {25.0F, 25.0F, 25.0F}

                    pdfTable2.SetWidths(widths2)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("CAISSE", pColumn))
                    Else
                        pdfCell = New PdfPCell(New Paragraph("CASHIER", pColumn))
                    End If


                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    pdfCell.Colspan = 3
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable2.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("MODE REGLEMENT", pColumn))
                    Else
                        pdfCell = New PdfPCell(New Paragraph("PAYMENT METHOD", pColumn))
                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable2.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("DU JOUR", pColumn))
                    Else
                        pdfCell = New PdfPCell(New Paragraph("OF THE DAY", pColumn))
                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable2.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("DEPUIS LE DEBUT DU MOIS", pColumn))
                    Else
                        pdfCell = New PdfPCell(New Paragraph("FIRST DAY OF MONTH", pColumn))
                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable2.AddCell(pdfCell)

                    Dim getModeReglement = "SELECT DISTINCT MODE_REGLEMENT FROM reglement WHERE `DATE_REGLEMENT` BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & DateFinStat.ToString("yyyy-MM-dd") & "' ORDER BY DATE_REGLEMENT DESC"

                    Dim commandModeReg As New MySqlCommand(getModeReglement, GlobalVariable.connect)

                    Dim adapterModeReg As New MySqlDataAdapter

                    Dim dtModeReg As New DataTable()

                    adapterModeReg.SelectCommand = commandModeReg
                    adapterModeReg.Fill(dtModeReg)

                    If dtModeReg.Rows.Count > 0 Then

                        Dim totalEncaissementJournalier As Double = 0
                        Dim totalEncaissementCumule As Double = 0

                        For i = 0 To dtModeReg.Rows.Count - 1

                            Dim getReglement = "SELECT * FROM reglement WHERE MODE_REGLEMENT =@MODE_REGLEMENT AND DATE_REGLEMENT BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & DateFinStat.ToString("yyyy-MM-dd") & "' AND IMPRIMER IN (0,1,2) ORDER BY DATE_REGLEMENT DESC"

                            Dim commandReg As New MySqlCommand(getReglement, GlobalVariable.connect)
                            commandReg.Parameters.Add("@MODE_REGLEMENT", MySqlDbType.VarChar).Value = dtModeReg.Rows(i)("MODE_REGLEMENT")

                            Dim adapterReg As New MySqlDataAdapter

                            Dim dtReg As New DataTable()
                            'Dim command As New MySqlCommand(query, GlobalVariable.connect)

                            adapterReg.SelectCommand = commandReg
                            adapterReg.Fill(dtReg)

                            If dtReg.Rows.Count > 0 Then

                                Dim montantModeReglemtJour As Double = 0
                                Dim montantModeReglemtCumule As Double = 0

                                For j = 0 To dtReg.Rows.Count - 1

                                    If dtReg.Rows(j)("DATE_REGLEMENT") = dateState.ToString("yyyy-MM-dd") Then
                                        montantModeReglemtJour += dtReg.Rows(j)("MONTANT_VERSE")
                                        totalEncaissementJournalier += dtReg.Rows(j)("MONTANT_VERSE")
                                    End If

                                    If dtReg.Rows(j)("MODE_REGLEMENT").Equals("Gratuitée") Or dtReg.Rows(j)("MODE_REGLEMENT").Equals("GRATUITEE") Then

                                        If Double.Parse(dtReg.Rows(j)("MONTANT_VERSE")) > 0 Then
                                            montantModeReglemtCumule += dtReg.Rows(j)("MONTANT_VERSE")
                                        End If

                                    Else
                                        montantModeReglemtCumule += dtReg.Rows(j)("MONTANT_VERSE")
                                    End If

                                    totalEncaissementCumule += dtReg.Rows(j)("MONTANT_VERSE")

                                Next

                                pdfCell = New PdfPCell(New Paragraph(dtModeReg.Rows(i)("MODE_REGLEMENT").ToString.ToUpper, pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfCell.MinimumHeight = 14
                                'pdfCell.Border = 0
                                'pdfCell.Rotation = 270
                                pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable2.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(montantModeReglemtJour, "#,##0"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 14
                                'pdfCell.Rotation = 270
                                'pdfCell.Border = 0
                                pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable2.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(montantModeReglemtCumule, "#,##0"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 14
                                'pdfCell.Border = 0
                                'pdfCell.Rotation = 270
                                pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable2.AddCell(pdfCell)

                            End If

                        Next

                        If GlobalVariable.actualLanguageValue = 1 Then
                            pdfCell = New PdfPCell(New Paragraph("TOTAL NET : ", pColumn))
                        Else
                            pdfCell = New PdfPCell(New Paragraph("NET TOTAL : ", pColumn))
                        End If

                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.Border = 0
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalEncaissementJournalier, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 0
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalEncaissementCumule, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.Border = 0
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable2.AddCell(pdfCell)

                    End If

                    pdfDoc.Add(pdfTable2)

                    '----------------------------------------------------------------------------------------------------

                    Dim pdfTable2_ As New PdfPTable(3) 'Number of columns
                    pdfTable2_.TotalWidth = 260.0F
                    pdfTable2_.LockedWidth = True
                    pdfTable2_.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable2_.HeaderRows = 1

                    pdfTable2_.WidthPercentage = 100
                    Dim widths2_ As Single() = New Single() {25.0F, 25.0F, 25.0F}

                    pdfTable2_.SetWidths(widths2_)

                    'mtable.AddCell(tableLeft)

                    mtable.AddCell(pdfTable2_)

                    mtable.AddCell(tableRight)

                    pdfDoc.Add(mtable)

                    Dim pdfTable1_ As New PdfPTable(6) 'Number of columns
                    pdfTable1_.TotalWidth = 560
                    pdfTable1_.LockedWidth = True
                    pdfTable1_.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable1_.HeaderRows = 1

                    Dim widths1_ As Single() = New Single() {10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F}
                    pdfTable1_.SetWidths(widths1_)


                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph(Chr(13) & "SIGNATURE RECEPTION", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph(Chr(13) & "RECEPTIONIST'S SIGNATURE", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1_.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph(Chr(13) & "SIGNATURE CONTROLEUR", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph(Chr(13) & "CONTROLLERS'S SIGNATURE", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1_.AddCell(pdfCell)


                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph(Chr(13) & "SIGNATURE DIRECTEUR", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph(Chr(13) & "MANAGER'S SIGNATURE", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1_.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("----------------", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1_.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("----------------", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1_.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("----------------", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1_.AddCell(pdfCell)

                    pdfDoc.Add(pdfTable1_)

                End If

                pdfDoc.Close()


                    If GlobalVariable.actualLanguageValue = 1 Then
                        MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                    Else
                        MessageBox.Show("PDF successfully exported " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                    End If

                    Process.Start(sfd.FileName)

                Else

                    MessageBox.Show("Aucune Ligne de Fatcure à imprimer!")

                End If

            End If

    End Sub


    Public Shared Sub docMainCourante(ByVal dt As DataGridView, ByVal dateMainCouranteDebut As Date, ByVal dateMainCouranteFin As Date, Optional ByVal document As Integer = 0, Optional renvoie As Boolean = False)

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        Dim fichier As String = ""

        If document = 0 Then

            'IMPRESSION NORMAL DE LA MAINCOURANTE DEPUIS LA LISTE DES RAPPORTS

            If GlobalVariable.AncienneMainCourante Then

                If GlobalVariable.actualLanguageValue = 1 Then
                    titreFichier = "MAIN COURANTE CUMULE"
                    tireDocument = titreFichier & Chr(13) & " DU " & dateMainCouranteDebut & " AU " & dateMainCouranteFin

                Else
                    titreFichier = "CUMULATED FINANCIAL DAILY REPORT"
                    tireDocument = titreFichier & Chr(13) & " OF " & dateMainCouranteDebut & " AU " & dateMainCouranteFin

                End If

            Else

                If GlobalVariable.actualLanguageValue = 1 Then
                    titreFichier = "MAIN COURANTE JOURNALIERE"
                    tireDocument = titreFichier & " DU " & dateMainCouranteDebut.ToShortDateString
                Else
                    titreFichier = "DAILY FINANCIAL REPORT"
                    tireDocument = titreFichier & " OF " & dateMainCouranteDebut.ToShortDateString
                End If

            End If

        Else

            'GENERATION DE DOCUMENTS OU RENVOI DE DOCUMENTS DEJA EXISTANT

            If GlobalVariable.actualLanguageValue = 1 Then
                titreFichier = "MAIN COURANTE JOURNALIERE"
                tireDocument = titreFichier & " DU " & dateMainCouranteDebut.ToShortDateString
            Else
                titreFichier = "DAILY FINANCIAL REPORT"
                tireDocument = titreFichier & " OF " & dateMainCouranteDebut.ToShortDateString
            End If

            Dim nomDuDossierRapport As String = "RAPPORTS\MAINCOURANTES"

            Dim filePathAndDirectory As String = ""

            filePathAndDirectory = GlobalVariable.AgenceActuelle.Rows(0)("CHEMIN_SAUVEGARDE_AUTO") & "\" & nomDuDossierRapport & "\" & dateMainCouranteDebut.ToString("ddMMyy")

            My.Computer.FileSystem.CreateDirectory(filePathAndDirectory)

            If Not renvoie Then

                If GlobalVariable.actualLanguageValue = 1 Then
                    fichier = filePathAndDirectory & "\" & titreFichier & " DU " & GlobalVariable.DateDeTravail.AddDays(-1).ToString("ddMMyy") & ".pdf"
                Else
                    fichier = filePathAndDirectory & "\" & titreFichier & " OF " & GlobalVariable.DateDeTravail.AddDays(-1).ToString("ddMMyy") & ".pdf"
                End If

            Else

                If GlobalVariable.actualLanguageValue = 1 Then
                    fichier = filePathAndDirectory & "\" & titreFichier & " DU " & dateMainCouranteDebut.ToString("ddMMyy") & ".pdf"
                Else
                    fichier = filePathAndDirectory & "\" & titreFichier & " OF " & dateMainCouranteDebut.ToString("ddMMyy") & ".pdf"
                End If

            End If

        End If

        If True Then

            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A3.Rotate, 20, 20, 80, 40)

            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(fichier, FileMode.Create))
            'Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim pdfTable As New PdfPTable(21) 'Number of columns
            pdfTable.TotalWidth = 1150.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single() = New Single() {6.0F, 26.0F, 10.0F, 10.0F, 7.0F, 6.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 11.0F, 11.0F, 12.0F, 10.0F, 10.0F, 10.0F, 12.0F}
            pdfTable.SetWidths(widths)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            If GlobalVariable.actualLanguageValue = 1 Then


                pdfCell = New PdfPCell(New Paragraph("CH", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NUITS", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAX", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("HEBERG.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TAXE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PDEJ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEJ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DINER", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BAR", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BLANCHI.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("AUTRES", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("RECETTE JOUR", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("REPORT VEILLE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TOTAL GENERAL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ESPECES", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CARTE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("MOBILE MONEY", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("A REPORTER", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

            Else

                pdfCell = New PdfPCell(New Paragraph("RM", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("FIRST & LAST NAME", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ARRIVAL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEPART.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NIGHT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAX", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ROOM RATE.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TAXES", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BFAST", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("LUNCH", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DINNER", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BAR", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("LAUNDRY", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("MISC.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("REVENUE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BROUGHT FORWARD", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("GROSSE REVENUE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CASH", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BANK CARD", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("MOBILE MONEY", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TO CARRY FORWARD", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

            End If

            Dim vertiPax As Integer = 0
            Dim vertiHebergement As Double = 0
            Dim vertiBar As Double = 0
            Dim vertiPDJ As Double = 0
            Dim vertiDEJ As Double = 0
            Dim vertiDinner As Double = 0
            Dim vertiBlanchisserie As Double = 0
            Dim vertiAutres As Double = 0
            Dim vertiRecetteJour As Double = 0
            Dim vertiReportVeille As Double = 0
            Dim vertiTotalGeneral As Double = 0
            Dim vertiEncaissementEspeces As Double = 0
            Dim vertiCarte As Double = 0
            Dim vertiMobile As Double = 0
            Dim vertiAReporter As Double = 0
            Dim vertiNmbreNuitee As Integer = 0
            Dim totalChanbre As Integer = 0
            Dim vertiTaxe As Integer = 0

            Dim nobreResa As Integer = 0

            Dim totalCredit As Double = 0
            Dim totalCreditMensuel As Double = 0
            Dim totalDebit As Double = 0
            Dim totalDebitMensuel As Double = 0

            If dt.Rows.Count > 0 Then

                nobreResa = dt.Rows.Count

                For i = 0 To dt.Rows.Count - 1

                    For j = 0 To dt.Columns.Count - 1

                        'ON NE DOIT TRAITER LA DERNIERE COLONNE CAR ELLE CONTIENT LE NUMERO DE RESERVATION
                        'UTILISE POUR AFFICHER LES INFORMATIONS DES CLIENTS SUR LA MAINCOURANTE

                        If j < dt.Columns.Count - 1 Then

                            If j = 2 Or j = 3 Then
                                pdfCell = New PdfPCell(New Paragraph(CDate(dt.Rows(i).Cells(j).Value.ToString).ToShortDateString, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            ElseIf j > 4 Then
                                pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells(j).Value, "#,##0"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            Else
                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value.ToString, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            End If

                            'pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                            pdfTable.AddCell(pdfCell)

                            If j = 3 + 1 Then
                                'vertiNmbreNuitee += dt.Rows(i).Cells(j).Value
                            ElseIf j = 4 + 1 Then
                                vertiPax += dt.Rows(i).Cells(j).Value
                            ElseIf j = 5 + 1 Then
                                vertiHebergement += dt.Rows(i).Cells(j).Value
                            ElseIf j = 6 + 1 Then
                                vertiTaxe += dt.Rows(i).Cells(j).Value
                            ElseIf j = 7 + 1 Then
                                vertiPDJ += dt.Rows(i).Cells(j).Value
                            ElseIf j = 8 + 1 Then
                                vertiDEJ += dt.Rows(i).Cells(j).Value
                            ElseIf j = 9 + 1 Then
                                vertiDinner += dt.Rows(i).Cells(j).Value
                            ElseIf j = 10 + 1 Then
                                vertiBar += dt.Rows(i).Cells(j).Value
                            ElseIf j = 11 + 1 Then
                                vertiBlanchisserie += dt.Rows(i).Cells(j).Value
                            ElseIf j = 12 + 1 Then
                                vertiAutres += dt.Rows(i).Cells(j).Value
                            ElseIf j = 13 + 1 Then
                                vertiRecetteJour += dt.Rows(i).Cells(j).Value
                            ElseIf j = 14 + 1 Then
                                vertiReportVeille += dt.Rows(i).Cells(j).Value
                            ElseIf j = 15 + 1 Then
                                vertiTotalGeneral += dt.Rows(i).Cells(j).Value
                            ElseIf j = 16 + 1 Then
                                vertiEncaissementEspeces += dt.Rows(i).Cells(j).Value
                            ElseIf j = 17 + 1 Then
                                vertiCarte += dt.Rows(i).Cells(j).Value
                            ElseIf j = 18 + 1 Then
                                vertiMobile += dt.Rows(i).Cells(j).Value
                            ElseIf j = 19 + 1 Then
                                vertiAReporter += dt.Rows(i).Cells(j).Value
                            End If

                        End If

                    Next

                Next

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.Border = 0
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.Border = 0
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.Border = 0
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.Border = 0
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                'pdfCell = New PdfPCell(New Paragraph(vertiNmbreNuitee, pColumn))
                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Border = 0
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(vertiPax, pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiHebergement, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiTaxe, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiPDJ, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiDEJ, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiDinner, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiBar, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiBlanchisserie, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiAutres, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiRecetteJour, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiReportVeille, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiTotalGeneral, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiEncaissementEspeces, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiCarte, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiMobile, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiAReporter, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY

                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

                If Not GlobalVariable.AncienneMainCourante Then

                    '--------------------------------- en chambre -----------------------------------------------
                    Dim enChambre As Double = 0

                    Dim query As String = "SELECT CHAMBRE_ID AS 'CHAMBRE', NOM_CLIENT As 'NOM CLIENT', DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',ETAT_NOTE_RESERVATION AS 'STATUT',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_ENTTRE <= '" & dateMainCouranteDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & dateMainCouranteDebut.ToString("yyyy-MM-dd") & "' AND DAY_USE = @DAY_USE AND TYPE=@TYPE ORDER BY CHAMBRE_ID ASC"

                    Dim command As New MySqlCommand(query, GlobalVariable.connect)
                    command.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle
                    command.Parameters.Add("@DAY_USE", MySqlDbType.Int64).Value = 0

                    Dim adapter As New MySqlDataAdapter(command)
                    Dim table As New DataTable()
                    adapter.Fill(table)

                    If table.Rows.Count > 0 Then
                        enChambre = table.Rows.Count
                    End If
                    '--------------------------------------------------------------------------------------------

                    '--------------------------------- depart ---------------------------------------------------
                    Dim depart As Double = 0

                    Dim query1 As String = "SELECT NOM_CLIENT As 'NOM CLIENT', CHAMBRE_ID AS 'CHAMBRE',DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',ETAT_NOTE_RESERVATION AS 'STATUT',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_SORTIE >= '" & dateMainCouranteDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE <='" & dateMainCouranteDebut.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND DAY_USE = @DAY_USE ORDER BY CHAMBRE_ID ASC"

                    Dim command1 As New MySqlCommand(query1, GlobalVariable.connect)
                    command1.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle
                    command1.Parameters.Add("@DAY_USE", MySqlDbType.Int64).Value = 0

                    Dim adapter1 As New MySqlDataAdapter(command1)
                    Dim table1 As New DataTable()
                    adapter1.Fill(table1)

                    If (table1.Rows.Count > 0) Then
                        depart = table1.Rows.Count
                    End If
                    '--------------------------------------------------------------------------------------------

                    Dim dateState As Date = dateMainCouranteDebut
                    Dim DateDebutStat As Date = Functions.firstDayOfMonth(dateState)
                    'Dim DateFinStat As Date = Functions.lastDayOfMonth(dateState)
                    Dim DateFinStat As Date = GlobalVariable.DateDeTravail
                    'INSERTION DES DEPOT DE GARANTIE
                    '--------------------------------------------------------------------------------------------------------------------------------------

                    If True Then

                        Dim query1_ As String = "SELECT  CODE_UTILISATEUR_CREA,  `DATE_CREATION`, `CODE_RESERVATION`, `SOLDE`, NOM_CLIENT  FROM caution 
                        WHERE SOLDE > 0 AND DATE_CREATION BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & DateFinStat.ToString("yyyy-MM-dd") & "'"

                        Dim command1_ As New MySqlCommand(query1_, GlobalVariable.connect)
                        command1_.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle
                        command1_.Parameters.Add("@DAY_USE", MySqlDbType.Int64).Value = 0

                        Dim adapter1_ As New MySqlDataAdapter(command1_)
                        Dim table1_ As New DataTable()
                        adapter1_.Fill(table1_)

                        If (table1_.Rows.Count > 0) Then

                            If GlobalVariable.actualLanguageValue = 1 Then

                                Dim p1 As Paragraph = New Paragraph(Chr(13) & "DEPOT DE GARANTIE" & Chr(13) & Chr(13))
                                p1.Alignment = Element.ALIGN_CENTER
                                pdfDoc.Add(p1)

                            Else

                                Dim p1 As Paragraph = New Paragraph(Chr(13) & "CREDIT" & Chr(13) & Chr(13))
                                p1.Alignment = Element.ALIGN_CENTER
                                pdfDoc.Add(p1)

                            End If


                            Dim pdfTable__ As New PdfPTable(5) 'Number of columns
                            pdfTable__.TotalWidth = 1150.0F
                            pdfTable__.LockedWidth = True
                            pdfTable__.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable__.HeaderRows = 1

                            Dim widths__ As Single() = New Single() {10.0F, 20.0F, 15.0F, 15.0F, 15.0F}
                            pdfTable__.SetWidths(widths__)

                            'SELECTION DES CAUTION ASSOCIE AUX RESERVATION
                            pdfCell = New PdfPCell(New Paragraph("No", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable__.AddCell(pdfCell)

                            If GlobalVariable.actualLanguageValue = 1 Then
                                pdfCell = New PdfPCell(New Paragraph("Par", pColumn))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("By", pColumn))
                            End If
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable__.AddCell(pdfCell)

                            If GlobalVariable.actualLanguageValue = 1 Then
                                pdfCell = New PdfPCell(New Paragraph("Le", pColumn))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("On the", pColumn))
                            End If

                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable__.AddCell(pdfCell)

                            If GlobalVariable.actualLanguageValue = 1 Then
                                pdfCell = New PdfPCell(New Paragraph("Client", pColumn))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("Client", pColumn))
                            End If

                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable__.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("Credit", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable__.AddCell(pdfCell)

                            Dim CODE_CASSIER As String = ""
                            Dim CODE_RESERVATION As String = ""
                            Dim infoCaissier As DataTable
                            Dim infoResa As DataTable

                            Dim DATE_CREATION As Date
                            Dim atlestOneCredit As Boolean = False

                            For m = 0 To table1_.Rows.Count - 1

                                DATE_CREATION = table1_.Rows(m)("DATE_CREATION")

                                If dateState = DATE_CREATION Then

                                    atlestOneCredit = True

                                    pdfCell = New PdfPCell(New Paragraph(m + 1, pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfTable__.AddCell(pdfCell)

                                    For n = 0 To table1_.Columns.Count - 2

                                        If n = 0 Then

                                            CODE_CASSIER = table1_.Rows(m)(n)
                                            infoCaissier = Functions.getElementByCode(CODE_CASSIER, "utilisateurs", "CODE_UTILISATEUR")
                                            If infoCaissier.Rows.Count > 0 Then
                                                pdfCell = New PdfPCell(New Paragraph(infoCaissier.Rows(0)("NOM_UTILISATEUR"), pColumn))
                                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                            End If

                                        ElseIf n = 1 Then

                                            pdfCell = New PdfPCell(New Paragraph(table1_.Rows(m)(n), pColumn))
                                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                                        ElseIf n = 2 Then

                                            CODE_RESERVATION = table1_.Rows(m)(n)
                                            infoResa = Functions.getElementByCode(CODE_RESERVATION, "reservation", "CODE_RESERVATION")

                                            If Not infoResa.Rows.Count > 0 Then
                                                infoResa = Functions.getElementByCode(CODE_RESERVATION, "reserve_conf", "CODE_RESERVATION")
                                            End If

                                            If infoResa.Rows.Count > 0 Then
                                                pdfCell = New PdfPCell(New Paragraph(infoResa.Rows(0)("NOM_CLIENT") & " Chambre " & infoResa.Rows(0)("CHAMBRE_ID"), pColumn))
                                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                            Else
                                                pdfCell = New PdfPCell(New Paragraph(table1_.Rows(m)("NOM_CLIENT"), pColumn))
                                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                            End If

                                        ElseIf n = 3 Then

                                            If dateState = DATE_CREATION Then
                                                totalCredit += table1_.Rows(m)(n)
                                            End If

                                            totalCreditMensuel += table1_.Rows(m)(n)

                                            pdfCell = New PdfPCell(New Paragraph(Format(table1_.Rows(m)(n), "#,##0"), pColumn))
                                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                        End If

                                        If n >= 0 And n <= 3 Then

                                            pdfCell.MinimumHeight = 15
                                            pdfCell.PaddingLeft = 5.0F
                                            pdfTable__.AddCell(pdfCell)

                                        End If

                                    Next

                                End If

                            Next

                            If atlestOneCredit Then

                                pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.Colspan = 4
                                pdfTable__.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(totalCredit, "#,##0"), pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfTable__.AddCell(pdfCell)

                            End If

                            pdfDoc.Add(pdfTable__)

                        End If

                        '----------------------------------------
                    End If
                    '--------------------------------------------------------------------------------------------------------------------------------------

                    'GESTION DES TRANSFERT VERS LE COMPTE DEBITEURS

                    If True Then

                        Dim caisse As New Caisse()
                        Dim filtre As Integer = 3
                        Dim table1_ As New DataTable()
                        Dim infoSup As New DataTable()

                        Dim getUserQuery_ = "SELECT * FROM facture 
                        WHERE RESTE_A_PAYER > 0 AND DATE_FACTURE BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & DateFinStat.ToString("yyyy-MM-dd") & "'"
                        Dim command_ As New MySqlCommand(getUserQuery_, GlobalVariable.connect)
                        Dim adapter_ As New MySqlDataAdapter

                        adapter_.SelectCommand = command_
                        adapter_.Fill(table1_)

                        If (table1_.Rows.Count > 0) Then

                            If GlobalVariable.actualLanguageValue = 1 Then

                                Dim p1 As Paragraph = New Paragraph(Chr(13) & "DEBITEURS" & Chr(13) & Chr(13))
                                p1.Alignment = Element.ALIGN_CENTER
                                pdfDoc.Add(p1)

                            Else

                                Dim p1 As Paragraph = New Paragraph(Chr(13) & "DEBITEURS" & Chr(13) & Chr(13))
                                p1.Alignment = Element.ALIGN_CENTER
                                pdfDoc.Add(p1)

                            End If

                            Dim pdfTable__ As New PdfPTable(4) 'Number of columns
                            pdfTable__.TotalWidth = 1150.0F
                            pdfTable__.LockedWidth = True
                            pdfTable__.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable__.HeaderRows = 1

                            Dim widths__ As Single() = New Single() {10.0F, 20.0F, 15.0F, 15.0F}
                            pdfTable__.SetWidths(widths__)

                            'SELECTION DES CAUTION ASSOCIE AUX RESERVATION
                            pdfCell = New PdfPCell(New Paragraph("No", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable__.AddCell(pdfCell)

                            If GlobalVariable.actualLanguageValue = 1 Then
                                pdfCell = New PdfPCell(New Paragraph("Par", pColumn))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("By", pColumn))
                            End If

                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable__.AddCell(pdfCell)

                            If GlobalVariable.actualLanguageValue = 1 Then
                                pdfCell = New PdfPCell(New Paragraph("Pour", pColumn))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("For", pColumn))
                            End If

                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable__.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("Debit", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable__.AddCell(pdfCell)

                            Dim CODE_CASSIER As String = ""
                            Dim CODE_RESERVATION As String = ""
                            Dim infoCaissier As DataTable
                            Dim infoResa As DataTable

                            Dim CODE_CAISSIER As String = ""
                            Dim DATE_FACTURE As Date

                            Dim atlestOneDebit As Boolean = False

                            For m = 0 To table1_.Rows.Count - 1

                                DATE_FACTURE = table1_.Rows(m)("DATE_FACTURE")

                                If dateState = DATE_FACTURE Then

                                    atlestOneDebit = True

                                    pdfCell = New PdfPCell(New Paragraph(m + 1, pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfTable__.AddCell(pdfCell)

                                    CODE_CAISSIER = table1_.Rows(m)("CODE_UTILISATEUR_CREA")
                                    infoSup = Functions.getElementByCode(CODE_CAISSIER, "utilisateurs", "CODE_UTILISATEUR")
                                    If infoSup.Rows.Count > 0 Then
                                        CODE_CAISSIER = infoSup.Rows(0)("NOM_UTILISATEUR")
                                    End If

                                    pdfCell = New PdfPCell(New Paragraph(CODE_CAISSIER, pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfTable__.AddCell(pdfCell)

                                    Dim INTITULE As String = ""
                                    Dim NUMERO_COMPTE As String = table1_.Rows(m)("CODE_COMMANDE")
                                    Dim infoSupCompte As DataTable = Functions.getElementByCode(NUMERO_COMPTE, "compte", "NUMERO_COMPTE")
                                    If infoSupCompte.Rows.Count > 0 Then
                                        INTITULE = infoSupCompte.Rows(0)("INTITULE")
                                    End If
                                    pdfCell = New PdfPCell(New Paragraph(INTITULE, pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfTable__.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(table1_.Rows(m)("RESTE_A_PAYER"), "#,##0"), pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                    If dateState = DATE_FACTURE Then
                                        totalDebit += table1_.Rows(m)("RESTE_A_PAYER")
                                    End If

                                    pdfTable__.AddCell(pdfCell)

                                End If

                                totalDebitMensuel += table1_.Rows(m)("RESTE_A_PAYER")

                            Next

                            If atlestOneDebit Then

                                pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.Colspan = 3
                                pdfTable__.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(totalDebit, "#,##0"), pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfTable__.AddCell(pdfCell)

                            End If

                            pdfDoc.Add(pdfTable__)

                        End If

                        '----------------------------------------
                    End If

                    'GESTION DES GRATUITEES

                    If True Then

                        Dim p7 As Paragraph = New Paragraph(Chr(13) & " GRATUITES : " & Chr(13) & Chr(13))
                        p7.Alignment = Element.ALIGN_CENTER

                        Dim pdfTable2_ As New PdfPTable(7) 'Number of columns
                        pdfTable2_.TotalWidth = 1150.0F
                        pdfTable2_.LockedWidth = True
                        pdfTable2_.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable2_.HeaderRows = 1

                        Dim widths2_ As Single() = New Single() {10.0F, 40.0F, 10.0F, 8.0F, 15.0F, 40.0F, 20.0F}

                        pdfTable2_.SetWidths(widths2_)

                        Dim ligneFacture2 As New LigneFacture()


                        pdfCell = New PdfPCell(New Paragraph("No", pColumn))
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfTable2_.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 5
                        'pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable2_.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 5
                        'pdfCell.PaddingLeft = 5.0F
                        pdfTable2_.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 5
                        pdfTable2_.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 5
                        'pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable2_.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("FAIT PAR", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 5
                        pdfTable2_.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("AUTHORISE PAR", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 5
                        pdfTable2_.AddCell(pdfCell)

                        'ARTICLE D'UNE FAMILLE QUELCONQUE
                        Dim dtGratuite As DataTable = LigneFacture.ListeDesArticlesVendusGratuitement(dateMainCouranteDebut, dateMainCouranteDebut)

                        Dim totalDesVentes As Double = 0
                        Dim totalQte As Integer = 0

                        If dtGratuite.Rows.Count > 0 Then

                            pdfDoc.Add(p7)

                            For j = 0 To dtGratuite.Rows.Count - 1

                                pdfCell = New PdfPCell(New Paragraph(j + 1, pColumn))
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfTable2_.AddCell(pdfCell)

                                totalDesVentes += dtGratuite.Rows(j)("MONTANT TOTAL")

                                pdfCell = New PdfPCell(New Paragraph(dtGratuite.Rows(j)("LIBELLE ARTICLE"), pColumn))
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfTable2_.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(dtGratuite.Rows(j)("PRIX UNITAIRE"), "#,##0"), pColumn))
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfTable2_.AddCell(pdfCell)

                                Dim QUANTITE As Double = dtGratuite.Rows(j)("QUANTITE")

                                If QUANTITE = 0 Then
                                    QUANTITE = dtGratuite.Rows(j)("MONTANT TOTAL") / dtGratuite.Rows(j)("PRIX UNITAIRE")
                                End If

                                totalQte += QUANTITE

                                pdfCell = New PdfPCell(New Paragraph(Format(QUANTITE, "#,##0"), pColumn))
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfTable2_.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(dtGratuite.Rows(j)("MONTANT TOTAL"), "#,##0"), pColumn))
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                pdfTable2_.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(dtGratuite.Rows(j)("NOM_UTILISATEUR"), pColumn))
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfTable2_.AddCell(pdfCell)

                                Dim AUTHORISE_PAR As String = ""

                                Dim infoSup As DataTable = Functions.getElementByCode(dtGratuite.Rows(j)("NUMERO_BLOC_NOTE"), "reglement", "NUMERO_BLOC_NOTE")
                                If infoSup.Rows.Count > 0 Then
                                    AUTHORISE_PAR = infoSup.Rows(0)("MODE_REG_INFO_SUP_1")
                                End If
                                pdfCell = New PdfPCell(New Paragraph(AUTHORISE_PAR, pColumn))
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfTable2_.AddCell(pdfCell)

                            Next

                            pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.Colspan = 3
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable2_.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(totalQte, "#,##0"), pColumn))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable2_.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(totalDesVentes, "#,##0"), pColumn))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable2_.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("", pColumn))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.Border = 0
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable2_.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("", pColumn))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.Border = 0
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable2_.AddCell(pdfCell)

                        End If

                        pdfDoc.Add(pdfTable2_)

                    End If

                    '*****-------------------------------INSERTION DES NOUVELLES INFORMATIONS --------------------------------------------------------

                    ' ----------------------------------------- TWO TABLES INTO A MAIN TABLE --------------------------------------------------
                    Dim mtable As PdfPTable = New PdfPTable(2)
                    mtable.TotalWidth = 1120.0F
                    'Dim widthsmtable As Single() = New Single() {60.0F, 40.0F}
                    'mtable.SetWidths(widthsmtable)
                    mtable.WidthPercentage = 100
                    mtable.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

                    Dim tableLeft As PdfPTable = New PdfPTable(1)
                    tableLeft.WidthPercentage = 100
                    tableLeft.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

                    Dim tableRight As PdfPTable = New PdfPTable(1)
                    tableRight.WidthPercentage = 100
                    tableRight.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

                    Dim rooms As New Room()

                    Dim HSRooms As Integer = rooms.HSRoomsOnly().Rows.Count
                    Dim roomsOnly As Integer = rooms.roomsOnly().Rows.Count

                    Dim occupe As Integer = enChambre - depart

                    Dim vendable As Integer = roomsOnly - HSRooms
                    Dim disponible As Integer = vendable - occupe

                    If GlobalVariable.actualLanguageValue = 1 Then

                        Dim p1 As Paragraph = New Paragraph(Chr(13) & "STATISTIQUES" & Chr(13) & Chr(13))
                        p1.Alignment = Element.ALIGN_CENTER
                        pdfDoc.Add(p1)

                    Else

                        Dim p1 As Paragraph = New Paragraph(Chr(13) & "STATISTICS" & Chr(13) & Chr(13))
                        p1.Alignment = Element.ALIGN_CENTER
                        pdfDoc.Add(p1)

                    End If

                    '------------------------------------------------  LEFT TABLE--------------------------------------------------------------------------

                    Dim pdfTable1 As New PdfPTable(6) 'Number of columns
                    'pdfTable1.TotalWidth = 1120.0F
                    pdfTable1.TotalWidth = 570.0F
                    pdfTable1.LockedWidth = True
                    pdfTable1.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable1.HeaderRows = 1
                    'pdfTable1.WidthPercentage = 100
                    Dim widths1 As Single() = New Single() {10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F}
                    pdfTable1.SetWidths(widths1)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("TAUX D'OCCUPATION SANS CHAMBRES HORS SERVICES : " & Format(occupe * 100 / vendable, "#,##0.00") & " %", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("HOTEL OCCUPATION RATE EXCLUDING ROOMS OUT OF ORDER : " & Format(occupe * 100 / vendable, "#,##0.00") & " %", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)


                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("TAUX D'OCCUPATION AVEC CHAMBRES HORS SERVICES : " & Format(occupe * 100 / roomsOnly, "#,##0.00") & " %", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("HOTEL OCCUPATION RATE INCLUDING ROOMS OUT OF ORDER : " & Format(occupe * 100 / roomsOnly, "#,##0.00") & " %", pColumn))

                    End If
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)


                    If GlobalVariable.actualLanguageValue = 1 Then

                        If occupe > 0 Then
                            pdfCell = New PdfPCell(New Paragraph("PRIX MOYENS : " & Format(vertiHebergement / occupe, "#,##0.0") & " " & societe.Rows(0)("CODE_MONNAIE"), pColumn))
                        Else
                            pdfCell = New PdfPCell(New Paragraph("PRIX MOYENS : " & Format(0, "#,##0.0") & " " & societe.Rows(0)("CODE_MONNAIE"), pColumn))
                        End If

                    Else

                        If occupe > 0 Then
                            pdfCell = New PdfPCell(New Paragraph("AVERAGE DAILY RATE : " & Format(vertiHebergement / occupe, "#,##0.0") & " " & societe.Rows(0)("CODE_MONNAIE"), pColumn))
                        Else
                            pdfCell = New PdfPCell(New Paragraph("AVERAGE DAILY RATE : " & Format(0, "#,##0.0") & " " & societe.Rows(0)("CODE_MONNAIE"), pColumn))
                        End If

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)
                    '-----------------------------------------

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("CHAMBRES VENDUES", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("SOLD ROOMS", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("CHAMBRE DISPONIBLE", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("AVAILABLE ROOMS", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("CHAMBRES HORS SERVICES", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("ROOMS OUT OF ORDER", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(occupe & " / " & vendable, pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(disponible & " / " & vendable, pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(HSRooms & " / " & roomsOnly, pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 6
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 6
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)

                    tableLeft.AddCell(pdfTable1)

                    '------------------------------------------------------- RIGHT TABLE --------------------------------

                    'Dim dateState As Date = dateMainCouranteDebut
                    'Dim DateDebutStat As Date = Functions.firstDayOfMonth(dateState)
                    'Dim DateFinStat As Date = Functions.lastDayOfMonth(dateState)
                    'Dim DateFinStat As Date = GlobalVariable.DateDeTravail

                    Dim pdfTable2 As New PdfPTable(3) 'Number of columns
                    pdfTable.TotalWidth = 260.0F
                    'pdfTable.TotalWidth = 1120.0F
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.HeaderRows = 1

                    pdfTable2.WidthPercentage = 100
                    Dim widths2 As Single() = New Single() {25.0F, 25.0F, 25.0F}

                    pdfTable2.SetWidths(widths2)

                    pdfCell = New PdfPCell(New Paragraph("CAISSE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    pdfCell.Colspan = 3
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable2.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("MODE REGLEMENT", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable2.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("DU JOUR", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable2.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("DEPUIS LE DBUT DU MOIS", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable2.AddCell(pdfCell)
                    Dim getModeReglement = "SELECT DISTINCT MODE_REGLEMENT FROM reglement WHERE `DATE_REGLEMENT` BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & dateState.ToString("yyyy-MM-dd") & "' ORDER BY DATE_REGLEMENT DESC"

                    Dim commandModeReg As New MySqlCommand(getModeReglement, GlobalVariable.connect)

                    Dim adapterModeReg As New MySqlDataAdapter

                    Dim dtModeReg As New DataTable()

                    adapterModeReg.SelectCommand = commandModeReg
                    adapterModeReg.Fill(dtModeReg)

                    If dtModeReg.Rows.Count > 0 Then

                        Dim totalEncaissementJournalier As Double = 0
                        Dim totalEncaissementCumule As Double = 0

                        Dim totalGratuitee As Double = 0
                        Dim totalGratuiteeMensuel As Double = 0

                        For i = 0 To dtModeReg.Rows.Count - 1

                            Dim getReglement = "SELECT * FROM reglement WHERE MODE_REGLEMENT =@MODE_REGLEMENT AND DATE_REGLEMENT BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & dateState.ToString("yyyy-MM-dd") & "' ORDER BY DATE_REGLEMENT DESC"

                            Dim commandReg As New MySqlCommand(getReglement, GlobalVariable.connect)
                            commandReg.Parameters.Add("@MODE_REGLEMENT", MySqlDbType.VarChar).Value = dtModeReg.Rows(i)("MODE_REGLEMENT")

                            Dim adapterReg As New MySqlDataAdapter

                            Dim dtReg As New DataTable()
                            'Dim command As New MySqlCommand(query, GlobalVariable.connect)

                            adapterReg.SelectCommand = commandReg
                            adapterReg.Fill(dtReg)

                            If dtReg.Rows.Count > 0 Then

                                Dim montantModeReglemtJour As Double = 0
                                Dim montantModeReglemtCumule As Double = 0

                                For j = 0 To dtReg.Rows.Count - 1

                                    If dtModeReg.Rows(i)("MODE_REGLEMENT").Equals("Gratuitée") Or dtModeReg.Rows(i)("MODE_REGLEMENT").Equals("Free") Then

                                        If dtReg.Rows(j)("DATE_REGLEMENT") = dateState.ToString("yyyy-MM-dd") Then
                                            If dtReg.Rows(j)("MONTANT_VERSE") > 0 Then
                                                totalGratuitee += dtReg.Rows(j)("MONTANT_VERSE")
                                            End If
                                        End If

                                        If dtReg.Rows(j)("MONTANT_VERSE") > 0 Then
                                            totalGratuiteeMensuel += dtReg.Rows(j)("MONTANT_VERSE")
                                        End If

                                    End If

                                    If dtReg.Rows(j)("DATE_REGLEMENT") = dateState.ToString("yyyy-MM-dd") Then
                                        montantModeReglemtJour += dtReg.Rows(j)("MONTANT_VERSE")
                                        totalEncaissementJournalier += dtReg.Rows(j)("MONTANT_VERSE")
                                    End If

                                    montantModeReglemtCumule += dtReg.Rows(j)("MONTANT_VERSE")
                                    totalEncaissementCumule += dtReg.Rows(j)("MONTANT_VERSE")

                                Next

                                pdfCell = New PdfPCell(New Paragraph(dtModeReg.Rows(i)("MODE_REGLEMENT").ToString.ToUpper, pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfCell.MinimumHeight = 14
                                'pdfCell.Border = 0
                                'pdfCell.Rotation = 270
                                pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable2.AddCell(pdfCell)

                                If dtModeReg.Rows(i)("MODE_REGLEMENT").Equals("Gratuitée") Or dtModeReg.Rows(i)("MODE_REGLEMENT").Equals("Free") Then
                                    pdfCell = New PdfPCell(New Paragraph(Format(totalGratuitee, "#,##0"), pRow))
                                Else
                                    pdfCell = New PdfPCell(New Paragraph(Format(montantModeReglemtJour, "#,##0"), pRow))
                                End If

                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 14
                                'pdfCell.Rotation = 270
                                'pdfCell.Border = 0
                                pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable2.AddCell(pdfCell)

                                If dtModeReg.Rows(i)("MODE_REGLEMENT").Equals("Gratuitée") Or dtModeReg.Rows(i)("MODE_REGLEMENT").Equals("Free") Then
                                    pdfCell = New PdfPCell(New Paragraph(Format(totalGratuiteeMensuel, "#,##0"), pRow))
                                Else
                                    pdfCell = New PdfPCell(New Paragraph(Format(montantModeReglemtCumule, "#,##0"), pRow))
                                End If

                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 14
                                'pdfCell.Border = 0
                                'pdfCell.Rotation = 270
                                pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable2.AddCell(pdfCell)

                            End If

                        Next

                        pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.Border = 0
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalEncaissementJournalier, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 0
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalEncaissementCumule, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.Border = 0
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable2.AddCell(pdfCell)

                        '------------------------------ GESTION DES DEPOTS DE GARANTIE ET DES CREDITS -------------------------------------

                        pdfCell = New PdfPCell(New Paragraph("DEPOT DE GARANTIE", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.Border = 1
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalCredit, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 1
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalCreditMensuel, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.Border = 1
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("DEBITS", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.Border = 1
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalDebit, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 1
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalDebitMensuel, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.Border = 1
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable2.AddCell(pdfCell)

                        '------------------------------------------------------------------------------------------------------------------

                        pdfCell = New PdfPCell(New Paragraph("PRODUCTION", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.Border = 0
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(vertiRecetteJour, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 0
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 0
                        pdfTable2.AddCell(pdfCell)
                    End If

                    tableRight.AddCell(pdfTable2)

                    '----------------------------------------------------------------------------------------------------

                    mtable.AddCell(tableLeft)

                    mtable.AddCell(tableRight)

                    pdfDoc.Add(mtable)

                    Dim pdfTable1_ As New PdfPTable(6) 'Number of columns
                    pdfTable1_.TotalWidth = 1120.0F
                    pdfTable1_.LockedWidth = True
                    pdfTable1_.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable1_.HeaderRows = 1

                    Dim widths1_ As Single() = New Single() {10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F}
                    pdfTable1_.SetWidths(widths1_)


                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("SIGNATURE RECEPTION", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("RECEPTIONIST'S SIGNATURE", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1_.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("SIGNATURE CONTROLEUR", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("CONTROLLERS'S SIGNATURE", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1_.AddCell(pdfCell)


                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("SIGNATURE DIRECTEUR", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("MANAGER'S SIGNATURE", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1_.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("----------------", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1_.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("----------------", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1_.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("----------------", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1_.AddCell(pdfCell)

                    pdfDoc.Add(pdfTable1_)

                End If

                pdfDoc.Close()

                'MISE AJOURS DU CHEMIN DE LA MAINCOURANTE
                Dim dtRapport As DataTable = Functions.verificationExistenceCheminDesRapportsDuJours(dateMainCouranteDebut)

                If dtRapport.Rows.Count > 0 Then
                    Dim ID_RAPPORT = dtRapport.Rows(0)("ID_RAPPORT")
                    updateOfFields("rapport_auto", "CHEMIN_MAINCOURANTE", fichier, "ID_RAPPORT", ID_RAPPORT, 2)
                End If

            Else

                If document = 0 Then
                    MessageBox.Show("Aucune Ligne de Fatcure à imprimer!")
                End If

            End If

        End If

    End Sub


    Public Shared Sub RapportMainCourante(ByVal dt As DataGridView, ByVal dateMainCouranteDebut As Date, ByVal dateMainCouranteFin As Date)

        'CHAMBRE', NUM_RESERVATION As 'RESERVATION', MONTANT_ACCORDE AS 'MONTANT',BAR_RESTAURANT AS 'BAR/RESTAURANT', SERVICES,SALON_DE_BEAUTE AS 'SALON DE BEAUTE', BOUTIQE AS 'BOUTIQUE', CYBERCAFE, AUTRES

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        If GlobalVariable.AncienneMainCourante Then

            If GlobalVariable.actualLanguageValue = 1 Then
                titreFichier = "MAIN COURANTE CUMULE"
                tireDocument = titreFichier & Chr(13) & " DU " & dateMainCouranteDebut & " AU " & dateMainCouranteFin

            Else
                titreFichier = "CUMULATED FINANCIAL DAILY REPORT"
                tireDocument = titreFichier & Chr(13) & " OF " & dateMainCouranteDebut & " AU " & dateMainCouranteFin

            End If

        Else

            If GlobalVariable.actualLanguageValue = 1 Then
                titreFichier = "MAIN COURANTE JOURNALIERE"
                tireDocument = titreFichier & " DU " & dateMainCouranteDebut.ToShortDateString
            Else
                titreFichier = "DAILY FINANCIAL REPORT"
                tireDocument = titreFichier & " OF " & dateMainCouranteDebut.ToShortDateString
            End If

        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then

            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A3.Rotate, 20, 20, 80, 40)

            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            'Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim pdfTable As New PdfPTable(21) 'Number of columns
            pdfTable.TotalWidth = 1150.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single() = New Single() {6.0F, 26.0F, 10.0F, 10.0F, 7.0F, 6.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 11.0F, 11.0F, 12.0F, 10.0F, 10.0F, 10.0F, 12.0F}
            pdfTable.SetWidths(widths)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            If GlobalVariable.actualLanguageValue = 1 Then


                pdfCell = New PdfPCell(New Paragraph("CH", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NUITS", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAX", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("HEBERG.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TAXE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PDEJ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEJ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DINER", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BAR", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BLANCHI.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("AUTRES", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("RECETTE JOUR", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("REPORT VEILLE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TOTAL GENERAL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ESPECES", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CARTE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("MOBILE MONEY", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("A REPORTER", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

            Else

                pdfCell = New PdfPCell(New Paragraph("RM", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("FIRST & LAST NAME", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ARRIVAL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEPART.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NIGHT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAX", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ROOM RATE.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TAXES", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BFAST", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("LUNCH", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DINNER", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BAR", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("LAUNDRY", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("MISC.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("REVENUE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BROUGHT FORWARD", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("GROSSE REVENUE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CASH", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BANK CARD", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("MOBILE MONEY", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TO CARRY FORWARD", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

            End If

            Dim vertiPax As Integer = 0
            Dim vertiHebergement As Double = 0
            Dim vertiBar As Double = 0
            Dim vertiPDJ As Double = 0
            Dim vertiDEJ As Double = 0
            Dim vertiDinner As Double = 0
            Dim vertiBlanchisserie As Double = 0
            Dim vertiAutres As Double = 0
            Dim vertiRecetteJour As Double = 0
            Dim vertiReportVeille As Double = 0
            Dim vertiTotalGeneral As Double = 0
            Dim vertiEncaissementEspeces As Double = 0
            Dim vertiCarte As Double = 0
            Dim vertiMobile As Double = 0
            Dim vertiAReporter As Double = 0
            Dim vertiNmbreNuitee As Integer = 0
            Dim totalChanbre As Integer = 0
            Dim vertiTaxe As Integer = 0

            Dim nobreResa As Integer = 0

            Dim totalCredit As Double = 0
            Dim totalCreditMensuel As Double = 0
            Dim totalDebit As Double = 0
            Dim totalDebitMensuel As Double = 0

            If dt.Rows.Count > 0 Then

                nobreResa = dt.Rows.Count

                For i = 0 To dt.Rows.Count - 1

                    For j = 0 To dt.Columns.Count - 1

                        'ON NE DOIT TRAITER LA DERNIERE COLONNE CAR ELLE CONTIENT LE NUMERO DE RESERVATION
                        'UTILISE POUR AFFICHER LES INFORMATIONS DES CLIENTS SUR LA MAINCOURANTE

                        If j < dt.Columns.Count - 1 Then

                            If j = 2 Or j = 3 Then
                                pdfCell = New PdfPCell(New Paragraph(CDate(dt.Rows(i).Cells(j).Value.ToString).ToShortDateString, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            ElseIf j > 4 Then
                                pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells(j).Value, "#,##0"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            Else
                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value.ToString, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            End If

                            'pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                            pdfTable.AddCell(pdfCell)

                            If j = 3 + 1 Then
                                'vertiNmbreNuitee += dt.Rows(i).Cells(j).Value
                            ElseIf j = 4 + 1 Then
                                vertiPax += dt.Rows(i).Cells(j).Value
                            ElseIf j = 5 + 1 Then
                                vertiHebergement += dt.Rows(i).Cells(j).Value
                            ElseIf j = 6 + 1 Then
                                vertiTaxe += dt.Rows(i).Cells(j).Value
                            ElseIf j = 7 + 1 Then
                                vertiPDJ += dt.Rows(i).Cells(j).Value
                            ElseIf j = 8 + 1 Then
                                vertiDEJ += dt.Rows(i).Cells(j).Value
                            ElseIf j = 9 + 1 Then
                                vertiDinner += dt.Rows(i).Cells(j).Value
                            ElseIf j = 10 + 1 Then
                                vertiBar += dt.Rows(i).Cells(j).Value
                            ElseIf j = 11 + 1 Then
                                vertiBlanchisserie += dt.Rows(i).Cells(j).Value
                            ElseIf j = 12 + 1 Then
                                vertiAutres += dt.Rows(i).Cells(j).Value
                            ElseIf j = 13 + 1 Then
                                vertiRecetteJour += dt.Rows(i).Cells(j).Value
                            ElseIf j = 14 + 1 Then
                                vertiReportVeille += dt.Rows(i).Cells(j).Value
                            ElseIf j = 15 + 1 Then
                                vertiTotalGeneral += dt.Rows(i).Cells(j).Value
                            ElseIf j = 16 + 1 Then
                                vertiEncaissementEspeces += dt.Rows(i).Cells(j).Value
                            ElseIf j = 17 + 1 Then
                                vertiCarte += dt.Rows(i).Cells(j).Value
                            ElseIf j = 18 + 1 Then
                                vertiMobile += dt.Rows(i).Cells(j).Value
                            ElseIf j = 19 + 1 Then
                                vertiAReporter += dt.Rows(i).Cells(j).Value
                            End If

                        End If

                    Next

                Next

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.Border = 0
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.Border = 0
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.Border = 0
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.Border = 0
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                'pdfCell = New PdfPCell(New Paragraph(vertiNmbreNuitee, pColumn))
                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Border = 0
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(vertiPax, pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiHebergement, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiTaxe, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiPDJ, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiDEJ, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiDinner, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiBar, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiBlanchisserie, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiAutres, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiRecetteJour, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiReportVeille, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiTotalGeneral, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiEncaissementEspeces, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiCarte, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiMobile, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiAReporter, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY

                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

                If Not GlobalVariable.AncienneMainCourante Then

                    '--------------------------------- en chambre -----------------------------------------------
                    Dim enChambre As Double = 0

                    Dim query As String = "SELECT CHAMBRE_ID AS 'CHAMBRE', NOM_CLIENT As 'NOM CLIENT', DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',ETAT_NOTE_RESERVATION AS 'STATUT',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_ENTTRE <= '" & dateMainCouranteDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & dateMainCouranteDebut.ToString("yyyy-MM-dd") & "' AND DAY_USE = @DAY_USE AND TYPE=@TYPE ORDER BY CHAMBRE_ID ASC"

                    Dim command As New MySqlCommand(query, GlobalVariable.connect)
                    command.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle
                    command.Parameters.Add("@DAY_USE", MySqlDbType.Int64).Value = 0

                    Dim adapter As New MySqlDataAdapter(command)
                    Dim table As New DataTable()
                    adapter.Fill(table)

                    If table.Rows.Count > 0 Then
                        enChambre = table.Rows.Count
                    End If
                    '--------------------------------------------------------------------------------------------

                    '--------------------------------- depart ---------------------------------------------------
                    Dim depart As Double = 0

                    Dim query1 As String = "SELECT NOM_CLIENT As 'NOM CLIENT', CHAMBRE_ID AS 'CHAMBRE',DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',ETAT_NOTE_RESERVATION AS 'STATUT',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_SORTIE >= '" & dateMainCouranteDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE <='" & dateMainCouranteDebut.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND DAY_USE = @DAY_USE ORDER BY CHAMBRE_ID ASC"

                    Dim command1 As New MySqlCommand(query1, GlobalVariable.connect)
                    command1.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle
                    command1.Parameters.Add("@DAY_USE", MySqlDbType.Int64).Value = 0

                    Dim adapter1 As New MySqlDataAdapter(command1)
                    Dim table1 As New DataTable()
                    adapter1.Fill(table1)

                    If (table1.Rows.Count > 0) Then
                        depart = table1.Rows.Count
                    End If
                    '--------------------------------------------------------------------------------------------

                    Dim dateState As Date = dateMainCouranteDebut
                    Dim DateDebutStat As Date = Functions.firstDayOfMonth(dateState)
                    'Dim DateFinStat As Date = Functions.lastDayOfMonth(dateState)
                    Dim DateFinStat As Date = GlobalVariable.DateDeTravail
                    'INSERTION DES DEPOT DE GARANTIE
                    '--------------------------------------------------------------------------------------------------------------------------------------

                    If True Then

                        Dim query1_ As String = "SELECT  CODE_UTILISATEUR_CREA,  `DATE_CREATION`, `CODE_RESERVATION`, `SOLDE`, NOM_CLIENT  FROM caution 
                        WHERE SOLDE > 0 AND DATE_CREATION BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & DateFinStat.ToString("yyyy-MM-dd") & "'"

                        Dim command1_ As New MySqlCommand(query1_, GlobalVariable.connect)
                        command1_.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle
                        command1_.Parameters.Add("@DAY_USE", MySqlDbType.Int64).Value = 0

                        Dim adapter1_ As New MySqlDataAdapter(command1_)
                        Dim table1_ As New DataTable()
                        adapter1_.Fill(table1_)

                        If (table1_.Rows.Count > 0) Then

                            If GlobalVariable.actualLanguageValue = 1 Then

                                Dim p1 As Paragraph = New Paragraph(Chr(13) & "DEPOT DE GARANTIE" & Chr(13) & Chr(13))
                                p1.Alignment = Element.ALIGN_CENTER
                                pdfDoc.Add(p1)

                            Else

                                Dim p1 As Paragraph = New Paragraph(Chr(13) & "CREDIT" & Chr(13) & Chr(13))
                                p1.Alignment = Element.ALIGN_CENTER
                                pdfDoc.Add(p1)

                            End If


                            Dim pdfTable__ As New PdfPTable(5) 'Number of columns
                            pdfTable__.TotalWidth = 1150.0F
                            pdfTable__.LockedWidth = True
                            pdfTable__.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable__.HeaderRows = 1

                            Dim widths__ As Single() = New Single() {10.0F, 20.0F, 15.0F, 15.0F, 15.0F}
                            pdfTable__.SetWidths(widths__)

                            'SELECTION DES CAUTION ASSOCIE AUX RESERVATION
                            pdfCell = New PdfPCell(New Paragraph("No", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable__.AddCell(pdfCell)

                            If GlobalVariable.actualLanguageValue = 1 Then
                                pdfCell = New PdfPCell(New Paragraph("Par", pColumn))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("By", pColumn))
                            End If
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable__.AddCell(pdfCell)

                            If GlobalVariable.actualLanguageValue = 1 Then
                                pdfCell = New PdfPCell(New Paragraph("Le", pColumn))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("On the", pColumn))
                            End If

                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable__.AddCell(pdfCell)

                            If GlobalVariable.actualLanguageValue = 1 Then
                                pdfCell = New PdfPCell(New Paragraph("Client", pColumn))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("Client", pColumn))
                            End If

                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable__.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("Credit", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable__.AddCell(pdfCell)

                            Dim CODE_CASSIER As String = ""
                            Dim CODE_RESERVATION As String = ""
                            Dim infoCaissier As DataTable
                            Dim infoResa As DataTable

                            Dim DATE_CREATION As Date
                            Dim atlestOneCredit As Boolean = False

                            For m = 0 To table1_.Rows.Count - 1

                                DATE_CREATION = table1_.Rows(m)("DATE_CREATION")

                                If dateState = DATE_CREATION Then

                                    atlestOneCredit = True

                                    pdfCell = New PdfPCell(New Paragraph(m + 1, pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfTable__.AddCell(pdfCell)

                                    For n = 0 To table1_.Columns.Count - 2

                                        If n = 0 Then

                                            CODE_CASSIER = table1_.Rows(m)(n)
                                            infoCaissier = Functions.getElementByCode(CODE_CASSIER, "utilisateurs", "CODE_UTILISATEUR")
                                            If infoCaissier.Rows.Count > 0 Then
                                                pdfCell = New PdfPCell(New Paragraph(infoCaissier.Rows(0)("NOM_UTILISATEUR"), pColumn))
                                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                            End If

                                        ElseIf n = 1 Then

                                            pdfCell = New PdfPCell(New Paragraph(table1_.Rows(m)(n), pColumn))
                                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                                        ElseIf n = 2 Then

                                            CODE_RESERVATION = table1_.Rows(m)(n)
                                            infoResa = Functions.getElementByCode(CODE_RESERVATION, "reservation", "CODE_RESERVATION")

                                            If Not infoResa.Rows.Count > 0 Then
                                                infoResa = Functions.getElementByCode(CODE_RESERVATION, "reserve_conf", "CODE_RESERVATION")
                                            End If

                                            If infoResa.Rows.Count > 0 Then
                                                pdfCell = New PdfPCell(New Paragraph(infoResa.Rows(0)("NOM_CLIENT") & " Chambre " & infoResa.Rows(0)("CHAMBRE_ID"), pColumn))
                                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                            Else
                                                pdfCell = New PdfPCell(New Paragraph(table1_.Rows(m)("NOM_CLIENT"), pColumn))
                                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                            End If

                                        ElseIf n = 3 Then

                                            If dateState = DATE_CREATION Then
                                                totalCredit += table1_.Rows(m)(n)
                                            End If

                                            totalCreditMensuel += table1_.Rows(m)(n)

                                            pdfCell = New PdfPCell(New Paragraph(Format(table1_.Rows(m)(n), "#,##0"), pColumn))
                                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                        End If

                                        If n >= 0 And n <= 3 Then

                                            pdfCell.MinimumHeight = 15
                                            pdfCell.PaddingLeft = 5.0F
                                            pdfTable__.AddCell(pdfCell)

                                        End If

                                    Next

                                End If

                            Next

                            If atlestOneCredit Then

                                pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.Colspan = 4
                                pdfTable__.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(totalCredit, "#,##0"), pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfTable__.AddCell(pdfCell)

                            End If

                            pdfDoc.Add(pdfTable__)

                        End If

                        '----------------------------------------
                    End If
                    '--------------------------------------------------------------------------------------------------------------------------------------

                    'GESTION DES TRANSFERT VERS LE COMPTE DEBITEURS

                    If True Then

                        Dim caisse As New Caisse()
                        Dim filtre As Integer = 3
                        Dim table1_ As New DataTable()
                        Dim infoSup As New DataTable()

                        Dim getUserQuery_ = "SELECT * FROM facture 
                        WHERE RESTE_A_PAYER > 0 AND DATE_FACTURE BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & DateFinStat.ToString("yyyy-MM-dd") & "'"
                        Dim command_ As New MySqlCommand(getUserQuery_, GlobalVariable.connect)
                        Dim adapter_ As New MySqlDataAdapter

                        adapter_.SelectCommand = command_
                        adapter_.Fill(table1_)

                        If (table1_.Rows.Count > 0) Then

                            If GlobalVariable.actualLanguageValue = 1 Then

                                Dim p1 As Paragraph = New Paragraph(Chr(13) & "DEBITEURS" & Chr(13) & Chr(13))
                                p1.Alignment = Element.ALIGN_CENTER
                                pdfDoc.Add(p1)

                            Else

                                Dim p1 As Paragraph = New Paragraph(Chr(13) & "DEBITEURS" & Chr(13) & Chr(13))
                                p1.Alignment = Element.ALIGN_CENTER
                                pdfDoc.Add(p1)

                            End If

                            Dim pdfTable__ As New PdfPTable(4) 'Number of columns
                            pdfTable__.TotalWidth = 1150.0F
                            pdfTable__.LockedWidth = True
                            pdfTable__.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable__.HeaderRows = 1

                            Dim widths__ As Single() = New Single() {10.0F, 20.0F, 15.0F, 15.0F}
                            pdfTable__.SetWidths(widths__)

                            'SELECTION DES CAUTION ASSOCIE AUX RESERVATION
                            pdfCell = New PdfPCell(New Paragraph("No", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable__.AddCell(pdfCell)

                            If GlobalVariable.actualLanguageValue = 1 Then
                                pdfCell = New PdfPCell(New Paragraph("Par", pColumn))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("By", pColumn))
                            End If

                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable__.AddCell(pdfCell)

                            If GlobalVariable.actualLanguageValue = 1 Then
                                pdfCell = New PdfPCell(New Paragraph("Pour", pColumn))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("For", pColumn))
                            End If

                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable__.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("Debit", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable__.AddCell(pdfCell)

                            Dim CODE_CASSIER As String = ""
                            Dim CODE_RESERVATION As String = ""
                            Dim infoCaissier As DataTable
                            Dim infoResa As DataTable

                            Dim CODE_CAISSIER As String = ""
                            Dim DATE_FACTURE As Date

                            Dim atlestOneDebit As Boolean = False

                            For m = 0 To table1_.Rows.Count - 1

                                DATE_FACTURE = table1_.Rows(m)("DATE_FACTURE")

                                If dateState = DATE_FACTURE Then

                                    atlestOneDebit = True

                                    pdfCell = New PdfPCell(New Paragraph(m + 1, pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfTable__.AddCell(pdfCell)

                                    CODE_CAISSIER = table1_.Rows(m)("CODE_UTILISATEUR_CREA")
                                    infoSup = Functions.getElementByCode(CODE_CAISSIER, "utilisateurs", "CODE_UTILISATEUR")
                                    If infoSup.Rows.Count > 0 Then
                                        CODE_CAISSIER = infoSup.Rows(0)("NOM_UTILISATEUR")
                                    End If

                                    pdfCell = New PdfPCell(New Paragraph(CODE_CAISSIER, pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfTable__.AddCell(pdfCell)

                                    Dim INTITULE As String = ""
                                    Dim NUMERO_COMPTE As String = table1_.Rows(m)("CODE_COMMANDE")
                                    Dim infoSupCompte As DataTable = Functions.getElementByCode(NUMERO_COMPTE, "compte", "NUMERO_COMPTE")
                                    If infoSupCompte.Rows.Count > 0 Then
                                        INTITULE = infoSupCompte.Rows(0)("INTITULE")
                                    End If
                                    pdfCell = New PdfPCell(New Paragraph(INTITULE, pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfTable__.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(table1_.Rows(m)("RESTE_A_PAYER"), "#,##0"), pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                    If dateState = DATE_FACTURE Then
                                        totalDebit += table1_.Rows(m)("RESTE_A_PAYER")
                                    End If

                                    pdfTable__.AddCell(pdfCell)

                                End If

                                totalDebitMensuel += table1_.Rows(m)("RESTE_A_PAYER")

                            Next

                            If atlestOneDebit Then

                                pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.Colspan = 3
                                pdfTable__.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(totalDebit, "#,##0"), pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfTable__.AddCell(pdfCell)

                            End If

                            pdfDoc.Add(pdfTable__)

                        End If

                        '----------------------------------------
                    End If

                    'GESTION DES GRATUITEES

                    If True Then

                        Dim p7 As Paragraph = New Paragraph(Chr(13) & " GRATUITES : " & Chr(13) & Chr(13))
                        p7.Alignment = Element.ALIGN_CENTER

                        Dim pdfTable2_ As New PdfPTable(7) 'Number of columns
                        pdfTable2_.TotalWidth = 1150.0F
                        pdfTable2_.LockedWidth = True
                        pdfTable2_.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable2_.HeaderRows = 1

                        Dim widths2_ As Single() = New Single() {10.0F, 40.0F, 10.0F, 8.0F, 15.0F, 40.0F, 20.0F}

                        pdfTable2_.SetWidths(widths2_)

                        Dim ligneFacture2 As New LigneFacture()


                        pdfCell = New PdfPCell(New Paragraph("No", pColumn))
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfTable2_.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 5
                        'pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable2_.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 5
                        'pdfCell.PaddingLeft = 5.0F
                        pdfTable2_.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 5
                        pdfTable2_.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 5
                        'pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable2_.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("FAIT PAR", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 5
                        pdfTable2_.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("AUTHORISE PAR", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 5
                        pdfTable2_.AddCell(pdfCell)

                        'ARTICLE D'UNE FAMILLE QUELCONQUE
                        Dim dtGratuite As DataTable = LigneFacture.ListeDesArticlesVendusGratuitement(dateMainCouranteDebut, dateMainCouranteDebut)

                        Dim totalDesVentes As Double = 0
                        Dim totalQte As Integer = 0

                        If dtGratuite.Rows.Count > 0 Then

                            pdfDoc.Add(p7)

                            For j = 0 To dtGratuite.Rows.Count - 1

                                pdfCell = New PdfPCell(New Paragraph(j + 1, pColumn))
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfTable2_.AddCell(pdfCell)

                                totalDesVentes += dtGratuite.Rows(j)("MONTANT TOTAL")

                                pdfCell = New PdfPCell(New Paragraph(dtGratuite.Rows(j)("LIBELLE ARTICLE"), pColumn))
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfTable2_.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(dtGratuite.Rows(j)("PRIX UNITAIRE"), "#,##0"), pColumn))
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfTable2_.AddCell(pdfCell)

                                Dim QUANTITE As Double = dtGratuite.Rows(j)("QUANTITE")

                                If QUANTITE = 0 Then
                                    QUANTITE = dtGratuite.Rows(j)("MONTANT TOTAL") / dtGratuite.Rows(j)("PRIX UNITAIRE")
                                End If

                                totalQte += QUANTITE

                                pdfCell = New PdfPCell(New Paragraph(Format(QUANTITE, "#,##0"), pColumn))
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfTable2_.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(dtGratuite.Rows(j)("MONTANT TOTAL"), "#,##0"), pColumn))
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                pdfTable2_.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(dtGratuite.Rows(j)("NOM_UTILISATEUR"), pColumn))
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfTable2_.AddCell(pdfCell)

                                Dim AUTHORISE_PAR As String = ""

                                Dim infoSup As DataTable = Functions.getElementByCode(dtGratuite.Rows(j)("NUMERO_BLOC_NOTE"), "reglement", "NUMERO_BLOC_NOTE")
                                If infoSup.Rows.Count > 0 Then
                                    AUTHORISE_PAR = infoSup.Rows(0)("MODE_REG_INFO_SUP_1")
                                End If
                                pdfCell = New PdfPCell(New Paragraph(AUTHORISE_PAR, pColumn))
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfTable2_.AddCell(pdfCell)

                            Next

                            pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.Colspan = 3
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable2_.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(totalQte, "#,##0"), pColumn))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable2_.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(totalDesVentes, "#,##0"), pColumn))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable2_.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("", pColumn))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.Border = 0
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable2_.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("", pColumn))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.Border = 0
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable2_.AddCell(pdfCell)

                        End If

                        pdfDoc.Add(pdfTable2_)

                    End If

                    '*****-------------------------------INSERTION DES NOUVELLES INFORMATIONS --------------------------------------------------------

                    ' ----------------------------------------- TWO TABLES INTO A MAIN TABLE --------------------------------------------------
                    Dim mtable As PdfPTable = New PdfPTable(2)
                    mtable.TotalWidth = 1120.0F
                    'Dim widthsmtable As Single() = New Single() {60.0F, 40.0F}
                    'mtable.SetWidths(widthsmtable)
                    mtable.WidthPercentage = 100
                    mtable.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

                    Dim tableLeft As PdfPTable = New PdfPTable(1)
                    tableLeft.WidthPercentage = 100
                    tableLeft.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

                    Dim tableRight As PdfPTable = New PdfPTable(1)
                    tableRight.WidthPercentage = 100
                    tableRight.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

                    Dim rooms As New Room()

                    Dim HSRooms As Integer = rooms.HSRoomsOnly().Rows.Count
                    Dim roomsOnly As Integer = rooms.roomsOnly().Rows.Count

                    Dim occupe As Integer = enChambre - depart

                    Dim vendable As Integer = roomsOnly - HSRooms
                    Dim disponible As Integer = vendable - occupe

                    If GlobalVariable.actualLanguageValue = 1 Then

                        Dim p1 As Paragraph = New Paragraph(Chr(13) & "STATISTIQUES" & Chr(13) & Chr(13))
                        p1.Alignment = Element.ALIGN_CENTER
                        pdfDoc.Add(p1)

                    Else

                        Dim p1 As Paragraph = New Paragraph(Chr(13) & "STATISTICS" & Chr(13) & Chr(13))
                        p1.Alignment = Element.ALIGN_CENTER
                        pdfDoc.Add(p1)

                    End If

                    '------------------------------------------------  LEFT TABLE--------------------------------------------------------------------------

                    Dim pdfTable1 As New PdfPTable(6) 'Number of columns
                    'pdfTable1.TotalWidth = 1120.0F
                    pdfTable1.TotalWidth = 570.0F
                    pdfTable1.LockedWidth = True
                    pdfTable1.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable1.HeaderRows = 1
                    'pdfTable1.WidthPercentage = 100
                    Dim widths1 As Single() = New Single() {10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F}
                    pdfTable1.SetWidths(widths1)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("TAUX D'OCCUPATION SANS CHAMBRES HORS SERVICES : " & Format(occupe * 100 / vendable, "#,##0.00") & " %", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("HOTEL OCCUPATION RATE EXCLUDING ROOMS OUT OF ORDER : " & Format(occupe * 100 / vendable, "#,##0.00") & " %", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)


                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("TAUX D'OCCUPATION AVEC CHAMBRES HORS SERVICES : " & Format(occupe * 100 / roomsOnly, "#,##0.00") & " %", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("HOTEL OCCUPATION RATE INCLUDING ROOMS OUT OF ORDER : " & Format(occupe * 100 / roomsOnly, "#,##0.00") & " %", pColumn))

                    End If
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)


                    If GlobalVariable.actualLanguageValue = 1 Then

                        If occupe > 0 Then
                            pdfCell = New PdfPCell(New Paragraph("PRIX MOYENS : " & Format(vertiHebergement / occupe, "#,##0.0") & " " & societe.Rows(0)("CODE_MONNAIE"), pColumn))
                        Else
                            pdfCell = New PdfPCell(New Paragraph("PRIX MOYENS : " & Format(0, "#,##0.0") & " " & societe.Rows(0)("CODE_MONNAIE"), pColumn))
                        End If

                    Else

                        If occupe > 0 Then
                            pdfCell = New PdfPCell(New Paragraph("AVERAGE DAILY RATE : " & Format(vertiHebergement / occupe, "#,##0.0") & " " & societe.Rows(0)("CODE_MONNAIE"), pColumn))
                        Else
                            pdfCell = New PdfPCell(New Paragraph("AVERAGE DAILY RATE : " & Format(0, "#,##0.0") & " " & societe.Rows(0)("CODE_MONNAIE"), pColumn))
                        End If

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)
                    '-----------------------------------------

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("CHAMBRES VENDUES", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("SOLD ROOMS", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("CHAMBRE DISPONIBLE", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("AVAILABLE ROOMS", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("CHAMBRES HORS SERVICES", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("ROOMS OUT OF ORDER", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(occupe & " / " & vendable, pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(disponible & " / " & vendable, pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(HSRooms & " / " & roomsOnly, pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 6
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 6
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)

                    tableLeft.AddCell(pdfTable1)

                    '------------------------------------------------------- RIGHT TABLE --------------------------------

                    'Dim dateState As Date = dateMainCouranteDebut
                    'Dim DateDebutStat As Date = Functions.firstDayOfMonth(dateState)
                    'Dim DateFinStat As Date = Functions.lastDayOfMonth(dateState)
                    'Dim DateFinStat As Date = GlobalVariable.DateDeTravail

                    Dim pdfTable2 As New PdfPTable(3) 'Number of columns
                    pdfTable.TotalWidth = 260.0F
                    'pdfTable.TotalWidth = 1120.0F
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.HeaderRows = 1

                    pdfTable2.WidthPercentage = 100
                    Dim widths2 As Single() = New Single() {25.0F, 25.0F, 25.0F}

                    pdfTable2.SetWidths(widths2)

                    pdfCell = New PdfPCell(New Paragraph("CAISSE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    pdfCell.Colspan = 3
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable2.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("MODE REGLEMENT", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable2.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("DU JOUR", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable2.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("DEPUIS LE DBUT DU MOIS", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable2.AddCell(pdfCell)
                    Dim getModeReglement = "SELECT DISTINCT MODE_REGLEMENT FROM reglement WHERE `DATE_REGLEMENT` BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & dateState.ToString("yyyy-MM-dd") & "' ORDER BY DATE_REGLEMENT DESC"

                    Dim commandModeReg As New MySqlCommand(getModeReglement, GlobalVariable.connect)

                    Dim adapterModeReg As New MySqlDataAdapter

                    Dim dtModeReg As New DataTable()

                    adapterModeReg.SelectCommand = commandModeReg
                    adapterModeReg.Fill(dtModeReg)

                    If dtModeReg.Rows.Count > 0 Then

                        Dim totalEncaissementJournalier As Double = 0
                        Dim totalEncaissementCumule As Double = 0

                        Dim totalGratuitee As Double = 0
                        Dim totalGratuiteeMensuel As Double = 0

                        For i = 0 To dtModeReg.Rows.Count - 1

                            Dim getReglement = "SELECT * FROM reglement WHERE MODE_REGLEMENT =@MODE_REGLEMENT AND DATE_REGLEMENT BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & dateState.ToString("yyyy-MM-dd") & "' ORDER BY DATE_REGLEMENT DESC"

                            Dim commandReg As New MySqlCommand(getReglement, GlobalVariable.connect)
                            commandReg.Parameters.Add("@MODE_REGLEMENT", MySqlDbType.VarChar).Value = dtModeReg.Rows(i)("MODE_REGLEMENT")

                            Dim adapterReg As New MySqlDataAdapter

                            Dim dtReg As New DataTable()
                            'Dim command As New MySqlCommand(query, GlobalVariable.connect)

                            adapterReg.SelectCommand = commandReg
                            adapterReg.Fill(dtReg)

                            If dtReg.Rows.Count > 0 Then

                                Dim montantModeReglemtJour As Double = 0
                                Dim montantModeReglemtCumule As Double = 0

                                For j = 0 To dtReg.Rows.Count - 1

                                    If dtModeReg.Rows(i)("MODE_REGLEMENT").Equals("Gratuitée") Or dtModeReg.Rows(i)("MODE_REGLEMENT").Equals("Free") Then

                                        If dtReg.Rows(j)("DATE_REGLEMENT") = dateState.ToString("yyyy-MM-dd") Then
                                            If dtReg.Rows(j)("MONTANT_VERSE") > 0 Then
                                                totalGratuitee += dtReg.Rows(j)("MONTANT_VERSE")
                                            End If
                                        End If

                                        If dtReg.Rows(j)("MONTANT_VERSE") > 0 Then
                                            totalGratuiteeMensuel += dtReg.Rows(j)("MONTANT_VERSE")
                                        End If

                                    End If

                                    If dtReg.Rows(j)("DATE_REGLEMENT") = dateState.ToString("yyyy-MM-dd") Then
                                        montantModeReglemtJour += dtReg.Rows(j)("MONTANT_VERSE")
                                        totalEncaissementJournalier += dtReg.Rows(j)("MONTANT_VERSE")
                                    End If

                                    montantModeReglemtCumule += dtReg.Rows(j)("MONTANT_VERSE")
                                    totalEncaissementCumule += dtReg.Rows(j)("MONTANT_VERSE")

                                Next

                                pdfCell = New PdfPCell(New Paragraph(dtModeReg.Rows(i)("MODE_REGLEMENT").ToString.ToUpper, pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfCell.MinimumHeight = 14
                                'pdfCell.Border = 0
                                'pdfCell.Rotation = 270
                                pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable2.AddCell(pdfCell)

                                If dtModeReg.Rows(i)("MODE_REGLEMENT").Equals("Gratuitée") Or dtModeReg.Rows(i)("MODE_REGLEMENT").Equals("Free") Then
                                    pdfCell = New PdfPCell(New Paragraph(Format(totalGratuitee, "#,##0"), pRow))
                                Else
                                    pdfCell = New PdfPCell(New Paragraph(Format(montantModeReglemtJour, "#,##0"), pRow))
                                End If

                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 14
                                'pdfCell.Rotation = 270
                                'pdfCell.Border = 0
                                pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable2.AddCell(pdfCell)

                                If dtModeReg.Rows(i)("MODE_REGLEMENT").Equals("Gratuitée") Or dtModeReg.Rows(i)("MODE_REGLEMENT").Equals("Free") Then
                                    pdfCell = New PdfPCell(New Paragraph(Format(totalGratuiteeMensuel, "#,##0"), pRow))
                                Else
                                    pdfCell = New PdfPCell(New Paragraph(Format(montantModeReglemtCumule, "#,##0"), pRow))
                                End If

                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 14
                                'pdfCell.Border = 0
                                'pdfCell.Rotation = 270
                                pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable2.AddCell(pdfCell)

                            End If

                        Next

                        pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.Border = 0
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalEncaissementJournalier, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 0
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalEncaissementCumule, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.Border = 0
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable2.AddCell(pdfCell)

                        '------------------------------ GESTION DES DEPOTS DE GARANTIE ET DES CREDITS -------------------------------------

                        pdfCell = New PdfPCell(New Paragraph("DEPOT DE GARANTIE", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.Border = 1
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalCredit, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 1
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalCreditMensuel, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.Border = 1
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("DEBITS", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.Border = 1
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalDebit, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 1
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalDebitMensuel, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.Border = 1
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable2.AddCell(pdfCell)

                        '------------------------------------------------------------------------------------------------------------------

                        pdfCell = New PdfPCell(New Paragraph("PRODUCTION", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.Border = 0
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(vertiRecetteJour, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 0
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 0
                        pdfTable2.AddCell(pdfCell)
                    End If

                    tableRight.AddCell(pdfTable2)

                    '----------------------------------------------------------------------------------------------------

                    mtable.AddCell(tableLeft)

                    mtable.AddCell(tableRight)

                    pdfDoc.Add(mtable)

                    Dim pdfTable1_ As New PdfPTable(6) 'Number of columns
                    pdfTable1_.TotalWidth = 1120.0F
                    pdfTable1_.LockedWidth = True
                    pdfTable1_.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable1_.HeaderRows = 1

                    Dim widths1_ As Single() = New Single() {10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F}
                    pdfTable1_.SetWidths(widths1_)


                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("SIGNATURE RECEPTION", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("RECEPTIONIST'S SIGNATURE", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1_.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("SIGNATURE CONTROLEUR", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("CONTROLLERS'S SIGNATURE", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1_.AddCell(pdfCell)


                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("SIGNATURE DIRECTEUR", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("MANAGER'S SIGNATURE", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1_.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("----------------", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1_.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("----------------", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1_.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("----------------", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1_.AddCell(pdfCell)

                    pdfDoc.Add(pdfTable1_)

                End If

                pdfDoc.Close()

                If GlobalVariable.actualLanguageValue = 1 Then
                    MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Else
                    MessageBox.Show("PDF successfully exported " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                End If

                Process.Start(sfd.FileName)

            End If

        End If

    End Sub

    Public Shared Sub rapportDesReservationAnnulees()

        Dim DateDebut As Date = GlobalVariable.DateDeTravail.ToString("yyyy-MM-dd")

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        tireDocument = "RESERVATIONS ANNULEES " & Chr(13) & " du " & GlobalVariable.DateDeTravail & " " & Now().ToLongTimeString
        titreFichier = "RESERVATIONS ANNULEES "

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then
            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 13, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & Chr(13) & tireDocument & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            Dim pdfTable7 As New PdfPTable(6) 'Number of columns
            pdfTable7.TotalWidth = 750.0F
            pdfTable7.LockedWidth = True
            pdfTable7.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable7.HeaderRows = 1

            Dim widths7 As Single() = New Single() {9.0F, 9.0F, 20.0F, 9.0F, 9.0F, 9.0F}
            pdfTable7.SetWidths(widths7)

            pdfCell = New PdfPCell(New Paragraph("N° RESERVATION", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable7.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("N° CHAMBRE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable7.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM ", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable7.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("SOLDE ", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable7.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable7.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable7.AddCell(pdfCell)

            Dim query7 As String = "SELECT CODE_RESERVATION AS 'RESERVATION', CHAMBRE_ID AS 'CHAMBRE', NOM_CLIENT As 'NOM & PRENOM', SOLDE_RESERVATION AS 'SOLDE', DATE_ENTTRE As 'DATE ARRIVEE', DATE_SORTIE As 'DATE DEPART' FROM reservation WHERE DATE_ENTTRE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 2 AND TYPE=@TYPE ORDER BY CODE_RESERVATION DESC"

            Dim command7 As New MySqlCommand(query7, GlobalVariable.connect)
            command7.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle

            Dim adapter7 As New MySqlDataAdapter(command7)
            Dim tableReservationAnnulee As New DataTable()
            adapter7.Fill(tableReservationAnnulee)

            If tableReservationAnnulee.Rows.Count > 0 Then

                For i = 0 To tableReservationAnnulee.Rows.Count - 1

                    For j = 0 To tableReservationAnnulee.Columns.Count - 1

                        'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        If j = 3 Then
                            pdfCell = New PdfPCell(New Paragraph(Format(tableReservationAnnulee.Rows(i)(j), "#,##0"), pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        Else
                            pdfCell = New PdfPCell(New Paragraph(tableReservationAnnulee.Rows(i)(j).ToString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        End If

                        If j = 1 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        End If

                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable7.AddCell(pdfCell)
                    Next

                Next

                pdfDoc.Add(pdfTable7)

            End If

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub listeDesPetitsDejeuner(ByVal datePetitDejeuner As Date)

        Dim DateDebut As Date = datePetitDejeuner.ToString("yyyy-MM-dd")

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        'tireDocument = "CLIENTS AYANT DROIT AU PETIT DEJEUNER " & " du " & GlobalVariable.DateDeTravail & " " & Now().ToLongTimeString
        'titreFichier = "CLIENTS AYANT DROIT AU PETIT DEJEUNER "

        If GlobalVariable.actualLanguageValue = 1 Then
            tireDocument = "CLIENTS AYANT DROIT AU PETIT DEJEUNER " & " DU " & DateDebut & " " & Now().ToLongTimeString
            titreFichier = "CLIENTS AYANT DROIT AU PETIT DEJEUNER "
        Else
            tireDocument = "CLIENTS ENTITLED TO BREAKFAST " & " OF THE " & DateDebut & " " & Now().ToLongTimeString
            titreFichier = "CLIENTS ENTITLED TO BREAKFAST "
        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then

            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 13, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            Dim pdfTable4 As New PdfPTable(8) 'Number of columns
            pdfTable4.TotalWidth = 750.0F
            pdfTable4.LockedWidth = True
            pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable4.HeaderRows = 1

            'Dim widths4 As Single() = New Single() {9.0F, 6.0F, 20.0F, 9.0F, 9.0F, 9.0F, 6.0F, 9.0F, 9.0F}
            Dim widths4 As Single() = New Single() {11.0F, 5.0F, 20.0F, 9.0F, 9.0F, 6.0F, 9.0F, 9.0F}
            pdfTable4.SetWidths(widths4)

            If GlobalVariable.actualLanguageValue = 0 Then

                pdfCell = New PdfPCell(New Paragraph("N° RESA", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ROOM", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NAMES ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                'pdfCell = New PdfPCell(New Paragraph("BALANCE ", pColumn))
                'pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                'pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                'pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ARRIVAL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEPARTURE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("N° BKF", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PRICE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

            Else

                pdfCell = New PdfPCell(New Paragraph("N° RESA", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("N° CH.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                'pdfCell = New PdfPCell(New Paragraph("SOLDE ", pColumn))
                'pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                'pdfCell.MinimumHeight = 15
                ' pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                'pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("N° PDJ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

            End If

            'Dim query4 As String = "SELECT CODE_RESERVATION AS 'RESERVATION', CHAMBRE_ID AS 'CHAMBRE', NOM_CLIENT As 'NOM & PRENOM', SOLDE_RESERVATION AS 'SOLDE', DATE_ENTTRE As 'DATE ARRIVEE', DATE_SORTIE As 'DATE DEPART', PETIT_DEJEUNER, BFK_COST FROM reserve_conf WHERE DATE_ENTTRE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 1 AND TYPE=@TYPE AND PETIT_DEJEUNER >= @PETIT_DEJEUNER ORDER BY CHAMBRE_ID ASC"
            Dim query4 As String = "SELECT CODE_RESERVATION AS 'RESERVATION', CHAMBRE_ID AS 'CHAMBRE', NOM_CLIENT As 'NOM & PRENOM', DATE_ENTTRE As 'DATE ARRIVEE', DATE_SORTIE As 'DATE DEPART', PETIT_DEJEUNER, BFK_COST FROM reserve_conf WHERE DATE_ENTTRE < '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 1 AND TYPE=@TYPE AND PETIT_DEJEUNER >= @PETIT_DEJEUNER ORDER BY CHAMBRE_ID ASC"

            Dim command4 As New MySqlCommand(query4, GlobalVariable.connect)
            command4.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle
            command4.Parameters.Add("@PETIT_DEJEUNER", MySqlDbType.Int64).Value = 1

            Dim adapter4 As New MySqlDataAdapter(command4)
            Dim tableArrivee As New DataTable()
            adapter4.Fill(tableArrivee)

            If tableArrivee.Rows.Count > 0 Then

                Dim BFK_UP As Double = 0
                Dim BFK_QTY As Double = 0
                Dim TOTAL_BFK As Integer = 0
                Dim TOTAL_COST As Double = 0
                For i = 0 To tableArrivee.Rows.Count - 1

                    BFK_UP = 0
                    BFK_QTY = 0

                    For j = 0 To tableArrivee.Columns.Count - 1

                        If j = 3 Or j = 4 Then
                            pdfCell = New PdfPCell(New Paragraph(CDate(tableArrivee.Rows(i)(j)).ToShortDateString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                        ElseIf j = 5 Or j = 6 Then

                            pdfCell = New PdfPCell(New Paragraph(Format(tableArrivee.Rows(i)(j), "#,##0"), pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                            If j = 5 Then
                                Double.TryParse(tableArrivee.Rows(i)(j), BFK_QTY)
                                TOTAL_BFK += BFK_QTY
                            Else
                                Double.TryParse(tableArrivee.Rows(i)(j), BFK_UP)
                            End If

                        Else
                            pdfCell = New PdfPCell(New Paragraph(tableArrivee.Rows(i)(j).ToString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                        End If

                        If j = 1 Or j = 3 Or j = 4 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        End If

                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable4.AddCell(pdfCell)

                        If j = 6 Then

                            TOTAL_COST += BFK_QTY * BFK_UP
                            pdfCell = New PdfPCell(New Paragraph(Format(BFK_QTY * BFK_UP, "#,##0"), pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable4.AddCell(pdfCell)

                        End If

                    Next

                Next

                pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.Colspan = 5
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(TOTAL_BFK, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(TOTAL_COST, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfTable4.AddCell(pdfCell)

                pdfDoc.Add(pdfTable4)

            End If

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub rapportDesEnchambre()

        Dim DateDebut As Date = GlobalVariable.DateDeTravail.ToString("yyyy-MM-dd")

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        tireDocument = "RAPPORTS DES EN CHAMBRES " & " du " & GlobalVariable.DateDeTravail & " " & Now().ToLongTimeString
        titreFichier = "RAPPORTS DES EN CHAMBRES "

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then
            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 13, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            Dim pdfTable4 As New PdfPTable(6) 'Number of columns
            pdfTable4.TotalWidth = 750.0F
            pdfTable4.LockedWidth = True
            pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable4.HeaderRows = 1

            Dim widths4 As Single() = New Single() {9.0F, 9.0F, 20.0F, 9.0F, 9.0F, 9.0F}
            pdfTable4.SetWidths(widths4)

            'Etats des client ayant un solde debiteur
            Dim p14 As Paragraph = New Paragraph(Chr(13) & Chr(13) & "En chambre du [ " & GlobalVariable.DateDeTravail & " ]" & Chr(13) & Chr(13))
            p14.Alignment = Element.ALIGN_LEFT
            'pdfDoc.Add(p14)

            pdfCell = New PdfPCell(New Paragraph("N° RESERVATION", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("N° CHAMBRE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM ", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("SOLDE ", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            Dim query4 As String = "SELECT CODE_RESERVATION AS 'RESERVATION', CHAMBRE_ID AS 'CHAMBRE', NOM_CLIENT As 'NOM & PRENOM', SOLDE_RESERVATION AS 'SOLDE', DATE_ENTTRE As 'DATE ARRIVEE', DATE_SORTIE As 'DATE DEPART' FROM reserve_conf WHERE DATE_ENTTRE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 1 AND TYPE=@TYPE ORDER BY ID_RESERVATION DESC"

            Dim command4 As New MySqlCommand(query4, GlobalVariable.connect)
            command4.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle

            Dim adapter4 As New MySqlDataAdapter(command4)
            Dim tableArrivee As New DataTable()
            adapter4.Fill(tableArrivee)

            If tableArrivee.Rows.Count > 0 Then

                For i = 0 To tableArrivee.Rows.Count - 1

                    For j = 0 To tableArrivee.Columns.Count - 1

                        'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        If j = 3 Then
                            pdfCell = New PdfPCell(New Paragraph(Format(tableArrivee.Rows(i)(j), "#,##0"), pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        Else
                            pdfCell = New PdfPCell(New Paragraph(tableArrivee.Rows(i)(j).ToString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        End If

                        If j = 1 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        End If

                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable4.AddCell(pdfCell)
                    Next

                Next

                pdfDoc.Add(pdfTable4)

            End If

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub rapportDesArrivees()

        Dim DateDebut As Date = GlobalVariable.DateDeTravail.ToString("yyyy-MM-dd")

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        If GlobalVariable.DocumentToGenerate = "arrivee" Then
            tireDocument = "ARRIVEES " & " du " & GlobalVariable.DateDeTravail & " " & Now().ToLongTimeString
            titreFichier = "ARRIVEES "

        ElseIf GlobalVariable.DocumentToGenerate = "attendue" Then
            tireDocument = "RESERVATIONS ATTENDUES " & " du " & GlobalVariable.DateDeTravail & " " & Now().ToLongTimeString
            titreFichier = "RESERVATIONS ATTENDUES "

        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then
            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 13, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & Chr(13) & tireDocument & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            Dim pdfTable4 As New PdfPTable(6) 'Number of columns
            pdfTable4.TotalWidth = 750.0F
            pdfTable4.LockedWidth = True
            pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable4.HeaderRows = 1

            Dim widths4 As Single() = New Single() {9.0F, 9.0F, 20.0F, 9.0F, 9.0F, 9.0F}
            pdfTable4.SetWidths(widths4)

            'Etats des client ayant un solde debiteur
            Dim p14 As Paragraph = New Paragraph(Chr(13) & Chr(13) & "4- Arrivees du [ " & GlobalVariable.DateDeTravail & " ]" & Chr(13) & Chr(13))
            p14.Alignment = Element.ALIGN_LEFT
            pdfDoc.Add(p14)

            pdfCell = New PdfPCell(New Paragraph("N° RESERVATION", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("N° CHAMBRE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM ", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("SOLDE ", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            Dim query4 As String = ""

            If GlobalVariable.DocumentToGenerate = "arrivee" Then
                query4 = "SELECT CODE_RESERVATION AS 'RESERVATION', CHAMBRE_ID AS 'CHAMBRE', NOM_CLIENT As 'NOM & PRENOM', SOLDE_RESERVATION AS 'SOLDE', DATE_ENTTRE As 'DATE ARRIVEE', DATE_SORTIE As 'DATE DEPART' FROM reserve_conf WHERE DATE_ENTTRE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_ENTTRE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 1 AND TYPE=@TYPE ORDER BY CODE_RESERVATION DESC"
            ElseIf GlobalVariable.DocumentToGenerate = "attendue" Then
                query4 = "SELECT CODE_RESERVATION AS 'RESERVATION', CHAMBRE_ID AS 'CHAMBRE', NOM_CLIENT As 'NOM & PRENOM', SOLDE_RESERVATION AS 'SOLDE', DATE_ENTTRE As 'DATE ARRIVEE', DATE_SORTIE As 'DATE DEPART' FROM reservation WHERE DATE_ENTTRE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_ENTTRE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 0 AND TYPE=@TYPE ORDER BY CODE_RESERVATION DESC"
            End If


            Dim command4 As New MySqlCommand(query4, GlobalVariable.connect)
            command4.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle

            Dim adapter4 As New MySqlDataAdapter(command4)
            Dim tableArrivee As New DataTable()
            adapter4.Fill(tableArrivee)

            If tableArrivee.Rows.Count > 0 Then

                For i = 0 To tableArrivee.Rows.Count - 1

                    For j = 0 To tableArrivee.Columns.Count - 1

                        'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        If j = 3 Then
                            pdfCell = New PdfPCell(New Paragraph(Format(tableArrivee.Rows(i)(j), "#,##0"), pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        Else
                            pdfCell = New PdfPCell(New Paragraph(tableArrivee.Rows(i)(j).ToString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        End If

                        If j = 1 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        End If

                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable4.AddCell(pdfCell)
                    Next

                Next

                pdfDoc.Add(pdfTable4)

            End If

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub rapportDesSejoursClotures()

        Dim DateDebut As Date = GlobalVariable.DateDeTravail.ToString("yyyy-MM-dd")

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        tireDocument = "SEJOURS CLOTURES " & " DU " & GlobalVariable.DateDeTravail & " " & Now().ToLongTimeString
        titreFichier = "SEJOURS CLOTURES "

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then
            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 13, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            Dim pdfTable6 As New PdfPTable(6) 'Number of columns
            pdfTable6.TotalWidth = 750.0F
            pdfTable6.LockedWidth = True
            pdfTable6.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable6.HeaderRows = 1

            Dim widths6 As Single() = New Single() {9.0F, 9.0F, 20.0F, 9.0F, 9.0F, 9.0F}
            pdfTable6.SetWidths(widths6)

            pdfCell = New PdfPCell(New Paragraph("N° RESERVATION", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable6.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("N° CHAMBRE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable6.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM ", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable6.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("SOLDE ", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable6.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable6.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable6.AddCell(pdfCell)

            Dim query6 As String = "SELECT CODE_RESERVATION AS 'RESERVATION', CHAMBRE_ID AS 'CHAMBRE', NOM_CLIENT As 'NOM & PRENOM', SOLDE_RESERVATION AS 'SOLDE', DATE_ENTTRE As 'DATE ARRIVEE', DATE_SORTIE As 'DATE DEPART' FROM reserve_conf WHERE DATE_SORTIE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 0 AND TYPE=@TYPE ORDER BY CHAMBRE_ID ASC"

            Dim command6 As New MySqlCommand(query6, GlobalVariable.connect)
            command6.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle

            Dim adapter6 As New MySqlDataAdapter(command6)
            Dim tableSejourCloture As New DataTable()
            adapter6.Fill(tableSejourCloture)

            If tableSejourCloture.Rows.Count > 0 Then

                For i = 0 To tableSejourCloture.Rows.Count - 1

                    For j = 0 To tableSejourCloture.Columns.Count - 1

                        'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        If j = 3 Then
                            pdfCell = New PdfPCell(New Paragraph(Format(tableSejourCloture.Rows(i)(j), "#,##0"), pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        Else
                            pdfCell = New PdfPCell(New Paragraph(tableSejourCloture.Rows(i)(j).ToString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        End If

                        If j = 1 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        End If

                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable6.AddCell(pdfCell)
                    Next

                Next

                pdfDoc.Add(pdfTable6)

            End If

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub rapportEtatsDesChambres()

        Dim DateDebut As Date = GlobalVariable.DateDeTravail.ToString("yyyy-MM-dd")

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        tireDocument = "ETAT DES CHAMBRES " & " du " & GlobalVariable.DateDeTravail & " " & Now().ToLongTimeString
        titreFichier = "ETAT DES CHAMBRES "

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then
            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 13, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim HeaderFont As New Font(Font.FontFamily.COURIER, 18, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontInfoSup As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 11, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            pdfDoc.Open()
            'pdfWrite.PageEvent = New HeaderFooter

            '------------------------------------------------------- HEADER -------------------------------------------------
            '------------------------------------------------------------------------
            Dim pdfCell As PdfPCell = Nothing

            Dim img() As Byte
            img = societe.Rows(0)("LOGO")

            Dim mStream As New MemoryStream(img)

            Dim logo As Image
            logo = Image.GetInstance(img)
            logo.ScalePercent(40.0F)

            Dim pHeaderLogo As New PdfPTable(1)
            pHeaderLogo.TotalWidth = pdfDoc.PageSize.Width
            pHeaderLogo.DefaultCell.Border = 0

            pdfCell = New PdfPCell(logo)
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.PaddingLeft = 5.0F
            pdfCell.Border = 0 'used to remove borders on the cells
            pHeaderLogo.AddCell(pdfCell)
            pHeaderLogo.WriteSelectedRows(0, -1, 0, pdfDoc.GetTop(pdfDoc.TopMargin) + 125, pdfWrite.DirectContent)

            Dim pHeader As New PdfPTable(1)
            pHeader.TotalWidth = pdfDoc.PageSize.Width
            pHeader.DefaultCell.Border = 0

            pdfCell = New PdfPCell(New Paragraph(societe.Rows(0)("RAISON_SOCIALE"), HeaderFont))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.PaddingLeft = 5.0F
            pdfCell.Border = 0 'used to remove borders on the cells
            pHeader.AddCell(pdfCell)

            'pHeader.WriteSelectedRows(0, -1, document.LeftMargin, document.GetTop(document.TopMargin) + 110, writer.DirectContent)
            pHeader.WriteSelectedRows(0, -1, 0, pdfDoc.GetTop(pdfDoc.TopMargin) + 150, pdfWrite.DirectContent)

            Dim pHeaderSubTitle As New PdfPTable(1)
            pHeaderSubTitle.TotalWidth = pdfDoc.PageSize.Width
            pHeaderSubTitle.DefaultCell.Border = 0

            pdfCell = New PdfPCell(New Paragraph(societe.Rows(0)("PAYS") & " - " & societe.Rows(0)("VILLE") & Chr(13) & "TELEPHONE: " & societe.Rows(0)("TELEPHONE") & Chr(13) & "EMAIL: " & societe.Rows(0)("EMAIL"), fontInfoSup))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.PaddingLeft = 15.0F
            pdfCell.Border = 0
            'pHeaderSubTitle.AddCell(pdfCell)
            'pHeaderSubTitle.WriteSelectedRows(0, -1, 0, pdfDoc.GetTop(pdfDoc.TopMargin) + 120, pdfWrite.DirectContent)

            Dim pHeaderSubTitle1 As New PdfPTable(1)
            pHeaderSubTitle1.TotalWidth = pdfDoc.PageSize.Width
            pHeaderSubTitle1.DefaultCell.Border = 0

            pdfCell = New PdfPCell(New Paragraph("BOITE POSTALE: " & societe.Rows(0)("BOITE_POSTALE") & Chr(13) & societe.Rows(0)("NUM_CONTRIBUABLE") & Chr(13) & societe.Rows(0)("NUM_REGISTRE"), fontInfoSup))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.PaddingLeft = 15.0F
            pdfCell.Border = 0
            'pHeaderSubTitle1.AddCell(pdfCell)
            'pHeaderSubTitle1.WriteSelectedRows(0, -1, 0, pdfDoc.GetTop(pdfDoc.TopMargin) + 80, pdfWrite.DirectContent)


            '-------------------------------------------------------------------------------------------------------------------------------
            '--------------- END HEADER -------------------------------------------------------------------------------------
            'pdfWrite.PageEvent = New HeaderFooter

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            Dim pdfTable6 As New PdfPTable(3) 'Number of columns
            pdfTable6.TotalWidth = 500.0F
            pdfTable6.LockedWidth = True
            pdfTable6.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable6.HeaderRows = 1

            Dim widths6 As Single() = New Single() {20.0F, 15.0F, 20.0F}
            pdfTable6.SetWidths(widths6)

            pdfCell = New PdfPCell(New Paragraph("CHAMBRE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable6.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("ETAT CHAMBRE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable6.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("LIBELLE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable6.AddCell(pdfCell)

            Dim query6 As String = "SELECT CODE_CHAMBRE AS 'CODE CHAMBRE', ETAT_CHAMBRE_NOTE As 'ETAT CHAMBRE',LIBELLE_CHAMBRE AS 'LIBELLE' From chambre WHERE CODE_AGENCE = @CODE_AGENCE AND TYPE=@TYPE ORDER BY CODE_CHAMBRE ASC"

            Dim command6 As New MySqlCommand(query6, GlobalVariable.connect)
            command6.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle
            command6.Parameters.Add("@CODE_AGENCE", MySqlDbType.VarChar).Value = GlobalVariable.codeAgence

            Dim adapter6 As New MySqlDataAdapter(command6)
            Dim tableSejourCloture As New DataTable()
            adapter6.Fill(tableSejourCloture)

            If tableSejourCloture.Rows.Count > 0 Then

                For i = 0 To tableSejourCloture.Rows.Count - 1

                    For j = 0 To tableSejourCloture.Columns.Count - 1

                        pdfCell = New PdfPCell(New Paragraph(tableSejourCloture.Rows(i)(j), pRow))

                        If j = 0 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        Else
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        End If

                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable6.AddCell(pdfCell)
                    Next

                Next

                pdfDoc.Add(pdfTable6)

            End If

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub

    Structure resumeInfo

        Dim nomEmploye As String
        Dim montant As Double

    End Structure

    Structure resumeModeInfo

        Dim mode As String
        Dim montant As Double

    End Structure


    Public Shared Sub docRapportDesCaissesPeriodique(ByVal DateDebut As Date, ByVal DateFin As Date, Optional ByVal renvoie As Boolean = False)

        'Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}
        Dim dateMainCouranteDebut As Date = DateDebut
        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0
        Dim GrandTotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        Dim DateAfficher As String

        If DateDebut = DateFin Then
            DateAfficher = DateDebut.ToShortDateString
        Else
            DateAfficher = DateDebut.ToShortDateString & " AU " & DateFin.ToShortDateString
        End If

        If GlobalVariable.actualLanguageValue = 1 Then
            tireDocument = "SITUATION DE CAISSE DU "
            titreFichier = "SITUATION DE CAISSE DU"
        Else
            tireDocument = "CASHIER SITUATION OF "
            titreFichier = "CASHIER SITUATION OF"
        End If

        Dim fichier As String = ""
        Dim nomDuDossierRapport As String = "RAPPORTS\ENCAISSEMENTS"

        Dim filePathAndDirectory As String = ""

        filePathAndDirectory = GlobalVariable.AgenceActuelle.Rows(0)("CHEMIN_SAUVEGARDE_AUTO") & "\" & nomDuDossierRapport & "\" & dateMainCouranteDebut.ToString("ddMMyy")

        My.Computer.FileSystem.CreateDirectory(filePathAndDirectory)

        If Not renvoie Then

            If GlobalVariable.actualLanguageValue = 1 Then
                fichier = filePathAndDirectory & "\" & titreFichier & " DU " & GlobalVariable.DateDeTravail.AddDays(-1).ToString("ddMMyy") & ".pdf"
            Else
                fichier = filePathAndDirectory & "\" & titreFichier & " OF " & GlobalVariable.DateDeTravail.AddDays(-1).ToString("ddMMyy") & ".pdf"
            End If

        Else

            If GlobalVariable.actualLanguageValue = 1 Then
                fichier = filePathAndDirectory & "\" & titreFichier & " DU " & dateMainCouranteDebut.ToString("ddMMyy") & ".pdf"
            Else
                fichier = filePathAndDirectory & "\" & titreFichier & " OF " & dateMainCouranteDebut.ToString("ddMMyy") & ".pdf"
            End If

        End If
        '------------------------------------------------------

        If True Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(fichier, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim dtCaissier As New DataTable()
            Dim adapter0 As New MySqlDataAdapter
            Dim getUserQuery0 As String = ""

            '2- TOUS LES REGLEMENTS SUR UNE PERIODE
            getUserQuery0 = "SELECT DISTINCT CODE_CAISSIER FROM reglement WHERE DATE_REGLEMENT >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_REGLEMENT <= '" & DateFin.ToString("yyyy-MM-dd") & "' ORDER BY DATE_REGLEMENT DESC"

            Dim command0 As New MySqlCommand(getUserQuery0, GlobalVariable.connect)
            adapter0.SelectCommand = command0

            adapter0.Fill(dtCaissier)

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & " " & DateAfficher & " " & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            Dim resumeDesCaissiers(dtCaissier.Rows.Count) As resumeInfo

            Dim montantEncaisseResume As Double = 0
            Dim montantEncaisseResumeParMode As Double = 0
            Dim montantEncaisseResumeParModeNet As Double = 0
            Dim GrandTotalDepot As Double = 0

            Dim pdfCell As PdfPCell = Nothing

            If dtCaissier.Rows.Count > 0 Then

                Dim m As Integer = -1

                For l = 0 To dtCaissier.Rows.Count - 1

                    Dim CODE_CAISSIER As String = dtCaissier.Rows(l)("CODE_CAISSIER")

                    montantEncaisseResume = 0

                    '2- SELECTION DE L'ENSEMBLE DES MODES DE REGLEMENT LIES A UN CAISSIERS QUELCONQUES

                    Dim getUserQuery = "SELECT DISTINCT MODE_REGLEMENT FROM reglement WHERE CODE_CAISSIER = @CODE_CAISSIER AND DATE_REGLEMENT >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_REGLEMENT <= '" & DateFin.ToString("yyyy-MM-dd") & "' ORDER BY MODE_REGLEMENT ASC"

                    Dim command As New MySqlCommand(getUserQuery, GlobalVariable.connect)

                    command.Parameters.Add("@CODE_CAISSIER", MySqlDbType.VarChar).Value = CODE_CAISSIER
                    Dim adapter As New MySqlDataAdapter

                    Dim dtModeReglement As New DataTable()

                    adapter.SelectCommand = command

                    adapter.Fill(dtModeReglement)

                    'CALCUL DU MONTANT TOTAL DES REGLEMENTS

                    GrandTotalFacture += 0

                    Dim caisseInfo As DataTable = Functions.getElementByCode(CODE_CAISSIER, "caisse", "CODE_UTILISATEUR")

                    If caisseInfo.Rows.Count > 0 Then

                        If Trim(caisseInfo.Rows(0)("TYPE_CAISSE")) = "Caisse principale" Then
                            Continue For
                        End If

                    End If

                    Dim Caissier = New Paragraph(Chr(13) & "CAISSIER : " & getElementByCode(CODE_CAISSIER, "utilisateurs", "CODE_UTILISATEUR").Rows(0)("NOM_UTILISATEUR"), pColumn)

                    pdfDoc.Add(Caissier)

                    Dim total_facture_gratuite As Double = 0

                    For j = 0 To dtModeReglement.Rows.Count - 1


                        '3- AFFICHAGE DES LIGNES DE REGLEMENT LIES A UN CAISSIER ET A UN MODE DE REGLEMENT SPECIFIC

                        Dim pdfTable As New PdfPTable(3) 'Number of columns
                        pdfTable.TotalWidth = 520.0F
                        pdfTable.LockedWidth = True
                        pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.HeaderRows = 1

                        Dim widths As Single() = New Single() {2.0F, 10.0F, 2.5F}
                        pdfTable.SetWidths(widths)

                        Dim p1 = New Paragraph(dtModeReglement.Rows(j)("MODE_REGLEMENT") & Chr(13) & Chr(13), pColumn)

                        pdfDoc.Add(p1)

                        Dim MODE_REGLEMENT As String = dtModeReglement.Rows(j)("MODE_REGLEMENT")

                        pdfCell = New PdfPCell(New Paragraph("DATE", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("MODE REGLEMENT", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        'pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("MONTANT", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable.AddCell(pdfCell)

                        TotalFacture = 0

                        Dim dtSpecific As New DataTable()

                        Dim getUserQuery1 = "SELECT * FROM reglement WHERE CODE_CAISSIER = @CODE_CAISSIER AND DATE_REGLEMENT >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_REGLEMENT <= '" & DateFin.ToString("yyyy-MM-dd") & "' AND MODE_REGLEMENT=@MODE_REGLEMENT ORDER BY DATE_REGLEMENT DESC"

                        Dim command1 As New MySqlCommand(getUserQuery1, GlobalVariable.connect)

                        command1.Parameters.Add("@CODE_CAISSIER", MySqlDbType.VarChar).Value = CODE_CAISSIER
                        command1.Parameters.Add("@MODE_REGLEMENT", MySqlDbType.VarChar).Value = MODE_REGLEMENT
                        Dim adapter1 As New MySqlDataAdapter
                        'Dim command As New MySqlCommand(query, GlobalVariable.connect)

                        adapter1.SelectCommand = command1

                        adapter1.Fill(dtSpecific)

                        If dtSpecific.Rows.Count > 0 Then

                            For i = 0 To dtSpecific.Rows.Count - 1

                                If MODE_REGLEMENT.Equals("Free") Or MODE_REGLEMENT.Equals("Gratuitée") Then

                                    If dtSpecific.Rows(i)("MONTANT_VERSE") > 0 Then

                                        pdfCell = New PdfPCell(New Paragraph(dtSpecific.Rows(i)("DATE_REGLEMENT"), font1))
                                        pdfCell.MinimumHeight = 15
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(dtSpecific.Rows(i)("REF_REGLEMENT"), font1))
                                        pdfCell.MinimumHeight = 15
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(dtSpecific.Rows(i)("MODE_REGLEMENT"), font1))
                                        pdfCell.MinimumHeight = 15
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                        'pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(Format(dtSpecific.Rows(i)("MONTANT_VERSE"), "#,##0"), font1))
                                        pdfCell.MinimumHeight = 15
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfTable.AddCell(pdfCell)

                                        total_facture_gratuite += dtSpecific.Rows(i)("MONTANT_VERSE")

                                    Else

                                    End If

                                Else

                                    pdfCell = New PdfPCell(New Paragraph(dtSpecific.Rows(i)("DATE_REGLEMENT"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(dtSpecific.Rows(i)("REF_REGLEMENT"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(dtSpecific.Rows(i)("MODE_REGLEMENT"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    'pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(dtSpecific.Rows(i)("MONTANT_VERSE"), "#,##0"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                    pdfTable.AddCell(pdfCell)

                                End If

                                TotalFacture += dtSpecific.Rows(i)("MONTANT_VERSE")

                                GrandTotalFacture += dtSpecific.Rows(i)("MONTANT_VERSE")

                            Next

                            montantEncaisseResume += TotalFacture

                            pdfDoc.Add(pdfTable)

                            '------------------------------------------------------------------------
                            Dim pSpace As New PdfPCell(New Paragraph(Chr(13) & Chr(13) & Chr(13)))
                            'pdfDoc.Add(pdfTable)

                            Dim pdfTable2 As New PdfPTable(3) 'Number of columns

                            pdfTable2.TotalWidth = 520.0F
                            pdfTable2.LockedWidth = True
                            pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                            'pdfTable2.HeaderRows = 1

                            Dim widths2 As Single() = New Single() {2.0F, 10.0F, 2.5F}
                            pdfTable2.SetWidths(widths2)

                            Dim pdfCell2 As PdfPCell = Nothing

                            pdfCell2 = New PdfPCell(New Paragraph("TOTAL: ", fontTotal))
                            pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell2.MinimumHeight = 18
                            pdfCell2.PaddingLeft = 15.0F
                            pdfCell2.Border = 0
                            pdfCell2.Colspan = 2
                            pdfTable2.AddCell(pdfCell2)

                            If MODE_REGLEMENT.Equals("Free") Or MODE_REGLEMENT.Equals("Gratuitée") Then
                                pdfCell2 = New PdfPCell(New Paragraph(Format(total_facture_gratuite, "#,##0"), fontTotal))
                            Else
                                pdfCell2 = New PdfPCell(New Paragraph(Format(TotalFacture, "#,##0"), fontTotal))
                            End If

                            pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell2.MinimumHeight = 18
                            pdfCell2.PaddingLeft = 5.0F
                            'pdfCell2.Border = 0
                            pdfTable2.AddCell(pdfCell2)

                            pdfDoc.Add(pdfTable2)

                        End If

                        resumeDesCaissiers(l).nomEmploye = getElementByCode(CODE_CAISSIER, "utilisateurs", "CODE_UTILISATEUR").Rows(0)("NOM_UTILISATEUR")
                        resumeDesCaissiers(l).montant = montantEncaisseResume

                    Next

                    'GESTION DES DEPOTS DE GARANTIES
                    Dim totalDepot As Double = 0

                    Dim p1_ = New Paragraph("DEPOT DE GARANTIE" & Chr(13) & Chr(13), pColumn)
                    pdfDoc.Add(p1_)

                    Dim pdfTable2_ As New PdfPTable(3) 'Number of columns

                    pdfTable2_.TotalWidth = 520.0F
                    pdfTable2_.LockedWidth = True
                    pdfTable2_.HorizontalAlignment = Element.ALIGN_RIGHT
                    'pdfTable2_.HeaderRows = 1

                    Dim pdfCell_1 As New PdfPCell

                    Dim widths2_ As Single() = New Single() {2.0F, 10.0F, 2.5F}
                    pdfTable2_.SetWidths(widths2_)

                    Dim depotDeGarantie As DataTable = Functions.ensembleDesDepotsDeGaranties(DateDebut, DateFin, CODE_CAISSIER)

                    If depotDeGarantie.Rows.Count > 0 Then

                        For i = 0 To depotDeGarantie.Rows.Count - 1

                            pdfCell_1 = New PdfPCell(New Paragraph(depotDeGarantie.Rows(i)("DATE_CREATION"), font1))
                            pdfCell_1.MinimumHeight = 15
                            pdfCell_1.PaddingLeft = 5.0F
                            pdfCell_1.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfTable2_.AddCell(pdfCell_1)

                            pdfCell_1 = New PdfPCell(New Paragraph(depotDeGarantie.Rows(i)("NOM_CLIENT"), font1))
                            pdfCell_1.MinimumHeight = 15
                            pdfCell_1.PaddingLeft = 5.0F
                            pdfCell_1.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfTable2_.AddCell(pdfCell_1)

                            totalDepot += depotDeGarantie.Rows(i)("CREDIT")
                            GrandTotalDepot += depotDeGarantie.Rows(i)("CREDIT")
                            pdfCell_1 = New PdfPCell(New Paragraph(Format(depotDeGarantie.Rows(i)("CREDIT"), "#,##0"), font1))
                            pdfCell_1.MinimumHeight = 15
                            pdfCell_1.PaddingLeft = 5.0F
                            pdfCell_1.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable2_.AddCell(pdfCell_1)

                        Next

                        resumeDesCaissiers(l).montant += totalDepot

                        pdfCell_1 = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                        pdfCell_1.MinimumHeight = 15
                        pdfCell_1.PaddingLeft = 5.0F
                        pdfCell_1.Colspan = 2
                        pdfCell_1.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable2_.AddCell(pdfCell_1)

                        pdfCell_1 = New PdfPCell(New Paragraph(Format(totalDepot, "#,##0"), fontTotal))
                        pdfCell_1.MinimumHeight = 15
                        pdfCell_1.PaddingLeft = 5.0F
                        pdfCell_1.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable2_.AddCell(pdfCell_1)

                        pdfDoc.Add(pdfTable2_)

                    End If

                Next

                '-----------------------------------------------TABLE 01----------------------------------------------------------------------------------
                Dim p04_ As Paragraph = New Paragraph(Chr(13) & " RESUME DES ENCAISSEMENTS PAR MODE" & Chr(13) & Chr(13), pRow)
                If GlobalVariable.actualLanguageValue = 0 Then
                    p04_ = New Paragraph(Chr(13) & " SUMMARY OF CASH RECEIVED GROUPED BY PAYMENT METHOD " & Chr(13) & Chr(13), pRow)
                End If
                p04_.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p04_)

                Dim pdfTable02 As New PdfPTable(2) 'Number of columns
                pdfTable02.TotalWidth = 520.0F
                pdfTable02.LockedWidth = True
                pdfTable02.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable02.HeaderRows = 1

                Dim widths02 As Single() = New Single() {50.0F, 20.0F}
                pdfTable02.SetWidths(widths02)

                Dim getUserQuery_ = "SELECT DISTINCT MODE_REGLEMENT FROM reglement WHERE DATE_REGLEMENT >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_REGLEMENT <= '" & DateFin.ToString("yyyy-MM-dd") & "' ORDER BY MODE_REGLEMENT ASC"
                Dim command_ As New MySqlCommand(getUserQuery_, GlobalVariable.connect)
                Dim adapter_ As New MySqlDataAdapter
                Dim dtModeReglement_ As New DataTable()

                adapter_.SelectCommand = command_
                adapter_.Fill(dtModeReglement_)

                Dim exractFree As Double = 0
                Dim montantDuMode As Double = 0

                For l = 0 To dtModeReglement_.Rows.Count - 1

                    montantDuMode = montantTotalDuModePeriodique(DateDebut, DateFin, dtModeReglement_.Rows(l)("MODE_REGLEMENT"))
                    montantEncaisseResumeParMode += montantDuMode
                    If dtModeReglement_.Rows(l)("MODE_REGLEMENT").Equals("Free") Or dtModeReglement_.Rows(l)("MODE_REGLEMENT").Equals("Gratuitée") Then
                        exractFree += montantDuMode
                    End If
                    pdfCell = New PdfPCell(New Paragraph(dtModeReglement_.Rows(l)("MODE_REGLEMENT"), pRow))
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfCell.MinimumHeight = 5
                    pdfCell.PaddingLeft = 15.0F

                    pdfTable02.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(montantDuMode, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 5
                    pdfCell.PaddingLeft = 15.0F

                    pdfTable02.AddCell(pdfCell)

                Next

                pdfCell = New PdfPCell(New Paragraph("DEPOT DE GARANTIE", pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 5
                pdfCell.PaddingLeft = 15.0F

                pdfTable02.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(GrandTotalDepot, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 5
                pdfCell.PaddingLeft = 15.0F

                pdfTable02.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("GRAND TOTAL :", pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                pdfCell.PaddingLeft = 15.0F
                pdfTable02.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(montantEncaisseResumeParMode + GrandTotalDepot, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 5
                pdfCell.PaddingLeft = 15.0F
                pdfTable02.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NET TOTAL :", pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                pdfCell.PaddingLeft = 15.0F
                pdfTable02.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(montantEncaisseResumeParMode + GrandTotalDepot - exractFree, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 5
                pdfCell.PaddingLeft = 15.0F
                pdfTable02.AddCell(pdfCell)

                pdfDoc.Add(pdfTable02)

                '-----------------------------------------------TABLE 01----------------------------------------------------------------------------------
                Dim p04 As Paragraph = New Paragraph(Chr(13) & " RESUME DES ENCAISSEMENTS PAR CAISSIER" & Chr(13) & Chr(13), pRow)
                If GlobalVariable.actualLanguageValue = 0 Then
                    p04 = New Paragraph(Chr(13) & " SUMMARY OF CASH RECEIVED GROUPED BY CASHIER " & Chr(13) & Chr(13), pRow)
                End If
                p04.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p04)

                Dim pdfTable01 As New PdfPTable(2) 'Number of columns
                pdfTable01.TotalWidth = 520.0F
                pdfTable01.LockedWidth = True
                pdfTable01.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.HeaderRows = 1

                Dim widths01 As Single() = New Single() {50.0F, 20.0F}
                pdfTable01.SetWidths(widths01)

                For l = 0 To dtCaissier.Rows.Count - 1

                    If resumeDesCaissiers(l).montant > 0 Then

                        pdfCell = New PdfPCell(New Paragraph(resumeDesCaissiers(l).nomEmploye, pRow))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 15.0F

                        pdfTable01.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(resumeDesCaissiers(l).montant, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 15.0F

                        pdfTable01.AddCell(pdfCell)

                    End If

                Next

                pdfCell = New PdfPCell(New Paragraph("GRAND TOTAL :", pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                pdfCell.PaddingLeft = 15.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(GrandTotalFacture + GrandTotalDepot, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 5
                pdfCell.PaddingLeft = 15.0F
                pdfTable01.AddCell(pdfCell)

                pdfDoc.Add(pdfTable01)
                '------------------------------------------------------

                'Dim lettreEnChiffre = New Paragraph("Arrêter la présente à la somme de : " & Format(GrandTotalFacture, "#,##0") & " (" & NBLT(GrandTotalFacture) & ") " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                Dim lettreEnChiffre

                If GlobalVariable.actualLanguageValue = 1 Then
                    lettreEnChiffre = New Paragraph(Chr(13) & "Arrêter la présente à la somme de : " & Format(GrandTotalFacture + GrandTotalDepot, "#,##0") & " (" & NBLT(GrandTotalFacture + GrandTotalDepot) & ") " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                Else
                    lettreEnChiffre = New Paragraph(Chr(13) & "To settle the present amount at : " & Format(GrandTotalFacture + GrandTotalDepot, "#,##0") & " (" & NBLT(GrandTotalFacture + GrandTotalDepot) & ") " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                End If

                pdfDoc.Add(lettreEnChiffre)

                pdfDoc.Close()

                Dim dtRapport As DataTable = Functions.verificationExistenceCheminDesRapportsDuJours(dateMainCouranteDebut)

                If dtRapport.Rows.Count > 0 Then
                    Dim ID_RAPPORT = dtRapport.Rows(0)("ID_RAPPORT")
                    updateOfFields("rapport_auto", "CHEMIN_REGLEMENT", fichier, "ID_RAPPORT", ID_RAPPORT, 2)
                End If

            End If

        End If

    End Sub

    Public Shared Sub rapportDesCaissesPeriodique(ByVal DateDebut As Date, ByVal DateFin As Date, ByVal CASHIER As String)

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0
        Dim GrandTotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        Dim DateAfficher As String

        If DateDebut = DateFin Then
            DateAfficher = DateDebut.ToShortDateString
        Else
            DateAfficher = DateDebut.ToShortDateString & " AU " & DateFin.ToShortDateString
        End If

        If GlobalVariable.actualLanguageValue = 1 Then
            tireDocument = "SITUATION DE CAISSE DU "
            titreFichier = "SITUATION DE CAISSE DU " & DateAfficher.ToString
        Else
            tireDocument = "CASHIER SITUATION OF "
            titreFichier = "CASHIER SITUATION OF " & DateAfficher.ToString
        End If

        sfd.FileName = tireDocument & (Date.Now().ToString("ddMMyyHms"))

        '------------------------------------------------------

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim dtCaissier As New DataTable()
            Dim adapter0 As New MySqlDataAdapter
            Dim getUserQuery0 As String = ""

            If Not Trim(CASHIER) = "" Then
                '1- REGLEMENTS D'UN CAISSIER SUR UNE PERIODE
                getUserQuery0 = "SELECT DISTINCT CODE_CAISSIER FROM reglement WHERE DATE_REGLEMENT >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_REGLEMENT <= '" & DateFin.ToString("yyyy-MM-dd") & "' AND CODE_CAISSIER=@CODE_UTILISATEUR_CREA ORDER BY DATE_REGLEMENT DESC"

                Dim command0 As New MySqlCommand(getUserQuery0, GlobalVariable.connect)
                adapter0.SelectCommand = command0

                command0.Parameters.Add("@CODE_UTILISATEUR_CREA", MySqlDbType.VarChar).Value = CASHIER

            Else
                '2- TOUS LES REGLEMENTS SUR UNE PERIODE
                getUserQuery0 = "SELECT DISTINCT CODE_CAISSIER FROM reglement WHERE DATE_REGLEMENT >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_REGLEMENT <= '" & DateFin.ToString("yyyy-MM-dd") & "' ORDER BY DATE_REGLEMENT DESC"

                Dim command0 As New MySqlCommand(getUserQuery0, GlobalVariable.connect)
                adapter0.SelectCommand = command0
            End If

            adapter0.Fill(dtCaissier)

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & " " & DateAfficher & " " & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            Dim resumeDesCaissiers(dtCaissier.Rows.Count) As resumeInfo

            Dim montantEncaisseResume As Double = 0
            Dim montantEncaisseResumeParMode As Double = 0
            Dim montantEncaisseResumeParModeNet As Double = 0
            Dim GrandTotalDepot As Double = 0

            Dim pdfCell As PdfPCell = Nothing

            If dtCaissier.Rows.Count > 0 Then

                Dim m As Integer = -1

                For l = 0 To dtCaissier.Rows.Count - 1

                    Dim CODE_CAISSIER As String = dtCaissier.Rows(l)("CODE_CAISSIER")

                    montantEncaisseResume = 0

                    '2- SELECTION DE L'ENSEMBLE DES MODES DE REGLEMENT LIES A UN CAISSIERS QUELCONQUES

                    Dim getUserQuery = "SELECT DISTINCT MODE_REGLEMENT FROM reglement WHERE CODE_CAISSIER = @CODE_CAISSIER AND DATE_REGLEMENT >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_REGLEMENT <= '" & DateFin.ToString("yyyy-MM-dd") & "' ORDER BY MODE_REGLEMENT ASC"

                    Dim command As New MySqlCommand(getUserQuery, GlobalVariable.connect)

                    command.Parameters.Add("@CODE_CAISSIER", MySqlDbType.VarChar).Value = CODE_CAISSIER
                    Dim adapter As New MySqlDataAdapter

                    Dim dtModeReglement As New DataTable()

                    adapter.SelectCommand = command

                    adapter.Fill(dtModeReglement)

                    'CALCUL DU MONTANT TOTAL DES REGLEMENTS

                    GrandTotalFacture += 0

                    Dim caisseInfo As DataTable = Functions.getElementByCode(CODE_CAISSIER, "caisse", "CODE_UTILISATEUR")

                    If caisseInfo.Rows.Count > 0 Then

                        If Trim(caisseInfo.Rows(0)("TYPE_CAISSE")) = "Caisse principale" Then
                            Continue For
                        End If

                    End If

                    Dim Caissier = New Paragraph(Chr(13) & "CAISSIER : " & getElementByCode(CODE_CAISSIER, "utilisateurs", "CODE_UTILISATEUR").Rows(0)("NOM_UTILISATEUR"), pColumn)

                    pdfDoc.Add(Caissier)

                    Dim total_facture_gratuite As Double = 0

                    For j = 0 To dtModeReglement.Rows.Count - 1


                        '3- AFFICHAGE DES LIGNES DE REGLEMENT LIES A UN CAISSIER ET A UN MODE DE REGLEMENT SPECIFIC

                        Dim pdfTable As New PdfPTable(3) 'Number of columns
                        pdfTable.TotalWidth = 520.0F
                        pdfTable.LockedWidth = True
                        pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.HeaderRows = 1

                        Dim widths As Single() = New Single() {2.0F, 10.0F, 2.5F}
                        pdfTable.SetWidths(widths)

                        Dim p1 = New Paragraph(dtModeReglement.Rows(j)("MODE_REGLEMENT") & Chr(13) & Chr(13), pColumn)

                        pdfDoc.Add(p1)

                        Dim MODE_REGLEMENT As String = dtModeReglement.Rows(j)("MODE_REGLEMENT")

                        pdfCell = New PdfPCell(New Paragraph("DATE", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("MODE REGLEMENT", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        'pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("MONTANT", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable.AddCell(pdfCell)

                        TotalFacture = 0

                        Dim dtSpecific As New DataTable()

                        Dim getUserQuery1 = "SELECT * FROM reglement WHERE CODE_CAISSIER = @CODE_CAISSIER AND DATE_REGLEMENT >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_REGLEMENT <= '" & DateFin.ToString("yyyy-MM-dd") & "' AND MODE_REGLEMENT=@MODE_REGLEMENT ORDER BY DATE_REGLEMENT DESC"

                        Dim command1 As New MySqlCommand(getUserQuery1, GlobalVariable.connect)

                        command1.Parameters.Add("@CODE_CAISSIER", MySqlDbType.VarChar).Value = CODE_CAISSIER
                        command1.Parameters.Add("@MODE_REGLEMENT", MySqlDbType.VarChar).Value = MODE_REGLEMENT
                        Dim adapter1 As New MySqlDataAdapter
                        'Dim command As New MySqlCommand(query, GlobalVariable.connect)

                        adapter1.SelectCommand = command1

                        adapter1.Fill(dtSpecific)

                        If dtSpecific.Rows.Count > 0 Then

                            For i = 0 To dtSpecific.Rows.Count - 1

                                If MODE_REGLEMENT.Equals("Free") Or MODE_REGLEMENT.Equals("Gratuitée") Then

                                    If dtSpecific.Rows(i)("MONTANT_VERSE") > 0 Then

                                        pdfCell = New PdfPCell(New Paragraph(dtSpecific.Rows(i)("DATE_REGLEMENT"), font1))
                                        pdfCell.MinimumHeight = 15
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(dtSpecific.Rows(i)("REF_REGLEMENT"), font1))
                                        pdfCell.MinimumHeight = 15
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(dtSpecific.Rows(i)("MODE_REGLEMENT"), font1))
                                        pdfCell.MinimumHeight = 15
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                        'pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(Format(dtSpecific.Rows(i)("MONTANT_VERSE"), "#,##0"), font1))
                                        pdfCell.MinimumHeight = 15
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfTable.AddCell(pdfCell)

                                        total_facture_gratuite += dtSpecific.Rows(i)("MONTANT_VERSE")

                                    Else

                                    End If

                                Else

                                    pdfCell = New PdfPCell(New Paragraph(dtSpecific.Rows(i)("DATE_REGLEMENT"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(dtSpecific.Rows(i)("REF_REGLEMENT"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(dtSpecific.Rows(i)("MODE_REGLEMENT"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    'pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(dtSpecific.Rows(i)("MONTANT_VERSE"), "#,##0"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                    pdfTable.AddCell(pdfCell)

                                End If

                                TotalFacture += dtSpecific.Rows(i)("MONTANT_VERSE")

                                GrandTotalFacture += dtSpecific.Rows(i)("MONTANT_VERSE")

                            Next

                            montantEncaisseResume += TotalFacture

                            pdfDoc.Add(pdfTable)

                            '------------------------------------------------------------------------
                            Dim pSpace As New PdfPCell(New Paragraph(Chr(13) & Chr(13) & Chr(13)))
                            'pdfDoc.Add(pdfTable)

                            Dim pdfTable2 As New PdfPTable(3) 'Number of columns

                            pdfTable2.TotalWidth = 520.0F
                            pdfTable2.LockedWidth = True
                            pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                            'pdfTable2.HeaderRows = 1

                            Dim widths2 As Single() = New Single() {2.0F, 10.0F, 2.5F}
                            pdfTable2.SetWidths(widths2)

                            Dim pdfCell2 As PdfPCell = Nothing

                            pdfCell2 = New PdfPCell(New Paragraph("TOTAL: ", fontTotal))
                            pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell2.MinimumHeight = 18
                            pdfCell2.PaddingLeft = 15.0F
                            pdfCell2.Border = 0
                            pdfCell2.Colspan = 2
                            pdfTable2.AddCell(pdfCell2)

                            If MODE_REGLEMENT.Equals("Free") Or MODE_REGLEMENT.Equals("Gratuitée") Then
                                pdfCell2 = New PdfPCell(New Paragraph(Format(total_facture_gratuite, "#,##0"), fontTotal))
                            Else
                                pdfCell2 = New PdfPCell(New Paragraph(Format(TotalFacture, "#,##0"), fontTotal))
                            End If

                            pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell2.MinimumHeight = 18
                            pdfCell2.PaddingLeft = 5.0F
                            'pdfCell2.Border = 0
                            pdfTable2.AddCell(pdfCell2)

                            pdfDoc.Add(pdfTable2)

                        End If

                        resumeDesCaissiers(l).nomEmploye = getElementByCode(CODE_CAISSIER, "utilisateurs", "CODE_UTILISATEUR").Rows(0)("NOM_UTILISATEUR")
                        resumeDesCaissiers(l).montant = montantEncaisseResume

                    Next

                    'GESTION DES DEPOTS DE GARANTIES
                    Dim totalDepot As Double = 0

                    Dim p1_ = New Paragraph("DEPOT DE GARANTIE" & Chr(13) & Chr(13), pColumn)
                    pdfDoc.Add(p1_)

                    Dim pdfTable2_ As New PdfPTable(3) 'Number of columns

                    pdfTable2_.TotalWidth = 520.0F
                    pdfTable2_.LockedWidth = True
                    pdfTable2_.HorizontalAlignment = Element.ALIGN_RIGHT
                    'pdfTable2_.HeaderRows = 1

                    Dim pdfCell_1 As New PdfPCell

                    Dim widths2_ As Single() = New Single() {2.0F, 10.0F, 2.5F}
                    pdfTable2_.SetWidths(widths2_)

                    Dim depotDeGarantie As DataTable = Functions.ensembleDesDepotsDeGaranties(DateDebut, DateFin, CODE_CAISSIER)

                    If depotDeGarantie.Rows.Count > 0 Then

                        For i = 0 To depotDeGarantie.Rows.Count - 1

                            pdfCell_1 = New PdfPCell(New Paragraph(depotDeGarantie.Rows(i)("DATE_CREATION"), font1))
                            pdfCell_1.MinimumHeight = 15
                            pdfCell_1.PaddingLeft = 5.0F
                            pdfCell_1.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfTable2_.AddCell(pdfCell_1)

                            pdfCell_1 = New PdfPCell(New Paragraph(depotDeGarantie.Rows(i)("NOM_CLIENT"), font1))
                            pdfCell_1.MinimumHeight = 15
                            pdfCell_1.PaddingLeft = 5.0F
                            pdfCell_1.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfTable2_.AddCell(pdfCell_1)

                            totalDepot += depotDeGarantie.Rows(i)("CREDIT")
                            GrandTotalDepot += depotDeGarantie.Rows(i)("CREDIT")
                            pdfCell_1 = New PdfPCell(New Paragraph(Format(depotDeGarantie.Rows(i)("CREDIT"), "#,##0"), font1))
                            pdfCell_1.MinimumHeight = 15
                            pdfCell_1.PaddingLeft = 5.0F
                            pdfCell_1.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable2_.AddCell(pdfCell_1)

                        Next

                        resumeDesCaissiers(l).montant += totalDepot

                        pdfCell_1 = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                        pdfCell_1.MinimumHeight = 15
                        pdfCell_1.PaddingLeft = 5.0F
                        pdfCell_1.Colspan = 2
                        pdfCell_1.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable2_.AddCell(pdfCell_1)

                        pdfCell_1 = New PdfPCell(New Paragraph(Format(totalDepot, "#,##0"), fontTotal))
                        pdfCell_1.MinimumHeight = 15
                        pdfCell_1.PaddingLeft = 5.0F
                        pdfCell_1.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable2_.AddCell(pdfCell_1)

                        pdfDoc.Add(pdfTable2_)

                    End If

                Next

                '-----------------------------------------------TABLE 01----------------------------------------------------------------------------------
                Dim p04_ As Paragraph = New Paragraph(Chr(13) & " RESUME DES ENCAISSEMENTS PAR MODE" & Chr(13) & Chr(13), pRow)
                If GlobalVariable.actualLanguageValue = 0 Then
                    p04_ = New Paragraph(Chr(13) & " SUMMARY OF CASH RECEIVED GROUPED BY PAYMENT METHOD " & Chr(13) & Chr(13), pRow)
                End If
                p04_.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p04_)

                Dim pdfTable02 As New PdfPTable(2) 'Number of columns
                pdfTable02.TotalWidth = 520.0F
                pdfTable02.LockedWidth = True
                pdfTable02.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable02.HeaderRows = 1

                Dim widths02 As Single() = New Single() {50.0F, 20.0F}
                pdfTable02.SetWidths(widths02)

                Dim getUserQuery_ = "SELECT DISTINCT MODE_REGLEMENT FROM reglement WHERE DATE_REGLEMENT >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_REGLEMENT <= '" & DateFin.ToString("yyyy-MM-dd") & "' ORDER BY MODE_REGLEMENT ASC"
                Dim command_ As New MySqlCommand(getUserQuery_, GlobalVariable.connect)
                Dim adapter_ As New MySqlDataAdapter
                Dim dtModeReglement_ As New DataTable()

                adapter_.SelectCommand = command_
                adapter_.Fill(dtModeReglement_)

                Dim exractFree As Double = 0
                Dim montantDuMode As Double = 0

                For l = 0 To dtModeReglement_.Rows.Count - 1

                    montantDuMode = montantTotalDuModePeriodique(DateDebut, DateFin, dtModeReglement_.Rows(l)("MODE_REGLEMENT"))
                    montantEncaisseResumeParMode += montantDuMode
                    If dtModeReglement_.Rows(l)("MODE_REGLEMENT").Equals("Free") Or dtModeReglement_.Rows(l)("MODE_REGLEMENT").Equals("Gratuitée") Then
                        exractFree += montantDuMode
                    End If
                    pdfCell = New PdfPCell(New Paragraph(dtModeReglement_.Rows(l)("MODE_REGLEMENT"), pRow))
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfCell.MinimumHeight = 5
                    pdfCell.PaddingLeft = 15.0F

                    pdfTable02.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(montantDuMode, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 5
                    pdfCell.PaddingLeft = 15.0F

                    pdfTable02.AddCell(pdfCell)

                Next

                pdfCell = New PdfPCell(New Paragraph("DEPOT DE GARANTIE", pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 5
                pdfCell.PaddingLeft = 15.0F

                pdfTable02.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(GrandTotalDepot, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 5
                pdfCell.PaddingLeft = 15.0F

                pdfTable02.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("GRAND TOTAL :", pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                pdfCell.PaddingLeft = 15.0F
                pdfTable02.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(montantEncaisseResumeParMode + GrandTotalDepot, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 5
                pdfCell.PaddingLeft = 15.0F
                pdfTable02.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NET TOTAL :", pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                pdfCell.PaddingLeft = 15.0F
                pdfTable02.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(montantEncaisseResumeParMode + GrandTotalDepot - exractFree, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 5
                pdfCell.PaddingLeft = 15.0F
                pdfTable02.AddCell(pdfCell)

                pdfDoc.Add(pdfTable02)

                '-----------------------------------------------TABLE 01----------------------------------------------------------------------------------
                Dim p04 As Paragraph = New Paragraph(Chr(13) & " RESUME DES ENCAISSEMENTS PAR CAISSIER" & Chr(13) & Chr(13), pRow)
                If GlobalVariable.actualLanguageValue = 0 Then
                    p04 = New Paragraph(Chr(13) & " SUMMARY OF CASH RECEIVED GROUPED BY CASHIER " & Chr(13) & Chr(13), pRow)
                End If
                p04.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p04)

                Dim pdfTable01 As New PdfPTable(2) 'Number of columns
                pdfTable01.TotalWidth = 520.0F
                pdfTable01.LockedWidth = True
                pdfTable01.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.HeaderRows = 1

                Dim widths01 As Single() = New Single() {50.0F, 20.0F}
                pdfTable01.SetWidths(widths01)

                For l = 0 To dtCaissier.Rows.Count - 1

                    If resumeDesCaissiers(l).montant > 0 Then

                        pdfCell = New PdfPCell(New Paragraph(resumeDesCaissiers(l).nomEmploye, pRow))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 15.0F

                        pdfTable01.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(resumeDesCaissiers(l).montant, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 15.0F

                        pdfTable01.AddCell(pdfCell)

                    End If

                Next

                pdfCell = New PdfPCell(New Paragraph("GRAND TOTAL :", pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                pdfCell.PaddingLeft = 15.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(GrandTotalFacture + GrandTotalDepot, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 5
                pdfCell.PaddingLeft = 15.0F
                pdfTable01.AddCell(pdfCell)

                pdfDoc.Add(pdfTable01)
                '------------------------------------------------------

                'Dim lettreEnChiffre = New Paragraph("Arrêter la présente à la somme de : " & Format(GrandTotalFacture, "#,##0") & " (" & NBLT(GrandTotalFacture) & ") " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                Dim lettreEnChiffre

                If GlobalVariable.actualLanguageValue = 1 Then
                    lettreEnChiffre = New Paragraph(Chr(13) & "Arrêter la présente à la somme de : " & Format(GrandTotalFacture + GrandTotalDepot, "#,##0") & " (" & NBLT(GrandTotalFacture + GrandTotalDepot) & ") " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                Else
                    lettreEnChiffre = New Paragraph(Chr(13) & "To settle the present amount at : " & Format(GrandTotalFacture + GrandTotalDepot, "#,##0") & " (" & NBLT(GrandTotalFacture + GrandTotalDepot) & ") " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                End If

                pdfDoc.Add(lettreEnChiffre)

                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Process.Start(sfd.FileName)

            End If

        End If

    End Sub

    '---------------------------------------- ECRITURE DES CHIFFRES EN LETTRE -----------------------------------------------------

    Shared chiffre() As String
    Shared dizaine() As String
    Shared chaine As String

    Private Shared Sub init()

        ReDim dizaine(7) ' *** tableau contenant les noms des dizaines
        dizaine(1) = "Dix"
        dizaine(2) = "Vingt"
        dizaine(3) = "Trente"
        dizaine(4) = "Quarante"
        dizaine(5) = "Cinquante"
        dizaine(6) = "Soixante"

        ReDim chiffre(20) ' *** tableau contenant le nom des 19 premiers nombres en lettres
        chiffre(1) = "Un"
        chiffre(2) = "Deux"
        chiffre(3) = "Trois"
        chiffre(4) = "Quatre"
        chiffre(5) = "Cinq"
        chiffre(6) = "Six"
        chiffre(7) = "Sept"
        chiffre(8) = "Huit"
        chiffre(9) = "Neuf"
        chiffre(10) = "Dix"
        chiffre(11) = "Onze"
        chiffre(12) = "Douze"
        chiffre(13) = "Treize"
        chiffre(14) = "Quatorze"
        chiffre(15) = "Quinze"
        chiffre(16) = "Seize"
        chiffre(17) = "Dix-sept"
        chiffre(18) = "Dix-huit"
        chiffre(19) = "Dix-neuf"

    End Sub

    Public Shared Function NBLT(ByVal nb As Long) As String

        Call init()

        If nb = 0 Then
            NBLT = "Zéro"
            Exit Function
        End If

        chaine = ""

        Decompose(nb)

        chaine = Replace(chaine, "  ", " ")
        chaine = Replace(chaine, "- ", "-")
        NBLT = chaine

    End Function

    Private Shared Function Decompose(ByVal Nombre As Long) As String

        If Nombre < 0 Then
            Nombre = Math.Abs(Nombre)
        End If

        Dim Reste As Long

        If Nombre >= (10 ^ 9) Then

            Reste = Nombre Mod (10 ^ 9)
            Nombre = Nombre \ (10 ^ 9)

            If Nombre > 10 Then
                Decompose(Nombre)
            Else
                chaine += chiffre(Convert.ToInt16(Nombre))
            End If

            chaine += " milliard"
            If Nombre > 1 Then
                chaine += "s"
            End If

            Decompose(Reste)

        Else

            If Nombre >= (10 ^ 6) Then

                Reste = Nombre Mod (10 ^ 6)
                Nombre = Nombre \ (10 ^ 6)

                If Nombre > 10 Then
                    Decompose(Nombre)
                Else
                    chaine += " " & chiffre(Convert.ToInt16(Nombre))
                End If

                chaine += " million"

                If Nombre > 1 Then
                    chaine += "s"
                End If

                Decompose(Reste)

            Else

                If Nombre >= (10 ^ 3) Then

                    Reste = Nombre Mod (10 ^ 3)
                    Nombre = Nombre \ (10 ^ 3)

                    If Nombre > 10 Then
                        Decompose(Nombre)
                    Else
                        If Nombre > 1 Then
                            chaine += " " & chiffre(Convert.ToInt16(Nombre))
                        End If
                    End If

                    chaine += " mille"

                    Decompose(Reste)

                Else

                    If Nombre >= (100) Then

                        Reste = Nombre Mod (100)
                        Nombre = Nombre \ (100)

                        If Nombre > 10 Then
                            Decompose(Nombre)
                        Else
                            If Nombre > 1 Then
                                chaine += " " & chiffre(Convert.ToInt16(Nombre))
                            End If
                        End If

                        chaine += " cent"
                        If Nombre > 1 And Reste = 0 Then
                            chaine += "s"
                        End If

                        Decompose(Reste)

                    Else

                        If Nombre >= 80 And Nombre < 100 Then

                            Reste = Nombre Mod 20
                            Nombre = Nombre \ 20

                            If Nombre > 10 Then
                                Decompose(Nombre)
                            Else
                                chaine += " " & chiffre(Convert.ToInt16(Nombre))
                            End If

                            chaine += "-vingt"

                            Decompose(Reste)

                        Else

                            If Nombre < 20 And Nombre > 9 Then

                                chaine += " " & chiffre(Convert.ToInt16(Nombre))

                            Else

                                If Nombre > 19 And Nombre < 70 Then

                                    Reste = Nombre Mod 10
                                    Nombre = Nombre \ 10

                                    If Nombre > 10 Then
                                        Decompose(Nombre)
                                    Else
                                        chaine += " " & dizaine(Convert.ToInt16(Nombre))
                                    End If

                                    If Reste = 1 Then
                                        chaine += " et" ' Cas particlier (Ving et un , trante et un , etc...)
                                    Else
                                        If Reste <> 0 Then
                                            chaine += "-"
                                        End If
                                    End If

                                    Decompose(Reste)

                                Else

                                    If Nombre >= 70 And Nombre < 80 Then

                                        chaine += " soixante-"
                                        Reste = Nombre - 60

                                        If Reste >= 10 Or Reste <= 19 Then
                                            chaine += " " & chiffre(Convert.ToInt16(Reste))

                                        End If

                                    Else

                                        If Nombre < 10 Then
                                            chaine += " " & chiffre(Convert.ToInt16(Nombre))
                                        End If

                                    End If

                                End If
                            End If
                        End If
                    End If
                End If
            End If
        End If
    End Function

    '------------------------------------ END ECRITURE DES CHIFFRES EN LETTRE -----------------------------------------------------

    Public Shared Sub miseAjourDesDuTYpeDeChambreDansLeReservations()

        'SELECTION DES CHAMBRES CONFIRMEE
        Dim queryEnChambre As String = "SELECT CHAMBRE_ID , CODE_TYPE_CHAMBRE, CODE_RESERVATION FROM reserve_temp, chambre WHERE chambre.CODE_CHAMBRE = reserve_temp.CHAMBRE_ID "

        Dim commandEnChambre As New MySqlCommand(queryEnChambre, GlobalVariable.connect)
        commandEnChambre.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = "chambre"

        Dim adapterEnChambre As New MySqlDataAdapter(commandEnChambre)
        Dim tableEnChambre As New DataTable()
        adapterEnChambre.Fill(tableEnChambre)

        If (tableEnChambre.Rows.Count > 0) Then

            For i = 0 To tableEnChambre.Rows.Count - 1

                Dim updateQuery As String = "UPDATE `reserve_temp` SET `TYPE_CHAMBRE` = @TYPE_CHAMBRE WHERE CODE_RESERVATION = @CODE_RESERVATION"

                Dim commandupdateQuery As New MySqlCommand(updateQuery, GlobalVariable.connect)

                commandupdateQuery.Parameters.Add("@TYPE_CHAMBRE", MySqlDbType.VarChar).Value = tableEnChambre.Rows(i)("CODE_TYPE_CHAMBRE")
                commandupdateQuery.Parameters.Add("@CODE_RESERVATION", MySqlDbType.VarChar).Value = tableEnChambre.Rows(i)("CODE_RESERVATION")

                commandupdateQuery.ExecuteNonQuery()

            Next

        End If

    End Sub

    'FONCTION PERMETTANT DE RETRANCHER OU D'AJOUTER UNE VALEUR SPECIFIQUE D'UN CHAMP SPECIFIQUE

    Public Shared Sub updateOfFieldsAddSubtract(ByVal nomDelaTable As String, ByVal nomDuChamp As String, ByVal ValeurDuChamp As String, ByVal nomDuChampDuCode As String, ByVal valeurDuChampDuCode As String, ByVal variableType As Integer)

        Dim updateQuery As String = "UPDATE `" & nomDelaTable & "` SET `" & nomDuChamp & "` = " & nomDuChamp & " + @valeurDuChamp WHERE " & nomDuChampDuCode & " = @valeurDuChampDuCode"

        Dim command As New MySqlCommand(updateQuery, GlobalVariable.connect)

        'variableType : 0 = Integer
        'variableType : 1 = Double
        'variableType : 2 = String

        If variableType = 0 Or variableType = 3 Then
            ValeurDuChamp = CType(ValeurDuChamp, Integer)
            command.Parameters.Add("@valeurDuChamp", MySqlDbType.Int64).Value = ValeurDuChamp
        ElseIf variableType = 1 Then
            ValeurDuChamp = CType(ValeurDuChamp, Double)
            command.Parameters.Add("@valeurDuChamp", MySqlDbType.Double).Value = ValeurDuChamp
        ElseIf variableType = 2 Then
            command.Parameters.Add("@valeurDuChamp", MySqlDbType.VarChar).Value = ValeurDuChamp
        End If

        command.Parameters.Add("@valeurDuChampDuCode", MySqlDbType.VarChar).Value = valeurDuChampDuCode 'LE CODE POUR LA CONDITION WHERE DE LA REQUETTE

        command.ExecuteNonQuery()

    End Sub

    'CETTE FONCTION PERMET DE CHANGER L'ETAT ENTIER, DOUBLE OU STRING D'UN CHAMP OU D'UNE TABLE

    Public Shared Sub updateOfFields(ByVal nomDelaTable As String, ByVal nomDuChamp As String, ByVal ValeurDuChamp As String, ByVal nomDuChampDuCode As String, ByVal valeurDuChampDuCode As String, ByVal variableType As Integer)

        Dim updateQuery As String = "UPDATE `" & nomDelaTable & "` SET `" & nomDuChamp & "` = @valeurDuChamp WHERE " & nomDuChampDuCode & " = @valeurDuChampDuCode"

        Dim command As New MySqlCommand(updateQuery, GlobalVariable.connect)

        'variableType : 0 = Integer
        'variableType : 1 = Double
        'variableType : 2 = String

        If variableType = 0 Or variableType = 3 Then
            ValeurDuChamp = CType(ValeurDuChamp, Integer)
            command.Parameters.Add("@valeurDuChamp", MySqlDbType.Int64).Value = ValeurDuChamp
        ElseIf variableType = 1 Then
            ValeurDuChamp = CType(ValeurDuChamp, Double)
            command.Parameters.Add("@valeurDuChamp", MySqlDbType.Double).Value = ValeurDuChamp
        ElseIf variableType = 2 Then
            command.Parameters.Add("@valeurDuChamp", MySqlDbType.VarChar).Value = ValeurDuChamp
        End If

        command.Parameters.Add("@valeurDuChampDuCode", MySqlDbType.VarChar).Value = valeurDuChampDuCode 'LE CODE POUR LA CONDITION WHERE DE LA REQUETTE

        command.ExecuteNonQuery()

    End Sub

    'CETTE FONCTION ASSOCIE DES LIGNES INDIVUELS A UNE GRANDE LIGNE'
    'EN REMPLISSANT LES LIGNES INDIVIDUEL DU CODE DES LIGNES PARENTS EN GROS ON PRENDS LE CODE DE LA LIGNE MERE ON CHARGE DANS LES LIGNE FILLE

    Public Shared Sub rattacherDesLignesIndividuelAUnUneLigneParent(ByVal NUM_REGLEMENT As String, ByVal CODE_FACTURE As String, ByVal IMPRIMER As Integer, ByVal CODE_ARTICLE As String, ByVal CODE_RESERVATION As String)

        Dim updateQuery As String = "UPDATE `reglement` SET NUM_FACTURE =@CODE_FACTURE, `IMPRIMER`=@IMPRIMER WHERE NUM_REGLEMENT=@NUM_REGLEMENT AND CODE_RESERVATION=@CODE_RESERVATION AND IMPRIMER=@IMPRIMER_OLD"

        Dim command As New MySqlCommand(updateQuery, GlobalVariable.connect)

        command.Parameters.Add("@NUM_REGLEMENT", MySqlDbType.VarChar).Value = NUM_REGLEMENT

        command.Parameters.Add("@CODE_FACTURE", MySqlDbType.VarChar).Value = CODE_FACTURE
        command.Parameters.Add("@CODE_RESERVATION", MySqlDbType.VarChar).Value = CODE_RESERVATION

        command.Parameters.Add("@IMPRIMER", MySqlDbType.Int64).Value = IMPRIMER

        'POUR NE PAS TRAITER LES INFORMATIONS DEJA TRAITEES
        command.Parameters.Add("@IMPRIMER_OLD", MySqlDbType.Int64).Value = 0

        'command.Parameters.Add("@CODE_ARTICLE", MySqlDbType.VarChar).Value = CODE_ARTICLE

        'Opening the connection
        'connect.openConnection()

        'Excuting the command and testing if everything went on well
        command.ExecuteNonQuery()

    End Sub

    Public Shared Sub miseAjourReglementBanqueTransaction()

        '1- ON RECUPERE L'ENSEMBLE DES REGLEMENTS DE TYPE CARTE DE CREDIT

        Dim query As String = "SELECT * FROM `reglement` WHERE `MODE_REGLEMENT` LIKE '%Carte de crédit%'"

        Dim command As New MySqlCommand(query, GlobalVariable.connect)

        Dim adapter As New MySqlDataAdapter(command)
        Dim table As New DataTable()
        adapter.Fill(table)

        If (table.Rows.Count > 0) Then

            For i = 0 To table.Rows.Count - 1

                '2- POUR CHAQUE LIGNE ON VERIFIE SON EXITENCE DANS LA TABLE banque_transaction

                Dim banqueTransaction As DataTable = Functions.getElementByCode(table.Rows(i)("NUM_REGLEMENT"), "reglement", "NUM_REGLEMENT")

                '3- SI NON ON INSERE UNE LIGNE DANS BANQUE TRANSACTION

                If Not banqueTransaction.Rows.Count > 1 Then

                    Dim banque As New Banque()
                    Dim CODE_BANQUE As String = ""

                    'Dim MODE_REGELEMENT As String = modeReglement
                    'Dim CODE_AGENCE As String = modeReglement
                    'Dim CODE_REGLEMENT As String = NUM_REGLEMENT
                    'Dim DEBIT As Double = 0
                    'Dim CREDIT As Double = MONTANT_REGLEMENT
                    'Dim CODE_TRANSCATION As String = Functions.GeneratingRandomCodePanne("banque_transaction", "")

                    'INFORMATION SUPLLEMTAIRE LIEES A LA CARTE DE CREDIT
                    'banque.insertBanqueTransactions(CODE_BANQUE, MODE_REGELEMENT, CODE_REGLEMENT, DEBIT, CREDIT, CODE_AGENCE, CODE_TRANSCATION)

                End If

                Dim updateQuery As String = "UPDATE `reserve_conf` SET `TYPE_CHAMBRE` = @TYPE_CHAMBRE WHERE CODE_RESERVATION = @CODE_RESERVATION"

                Dim commandupdateQuery As New MySqlCommand(updateQuery, GlobalVariable.connect)

                commandupdateQuery.Parameters.Add("@TYPE_CHAMBRE", MySqlDbType.VarChar).Value = table.Rows(i)("CODE_TYPE_CHAMBRE")
                commandupdateQuery.Parameters.Add("@CODE_RESERVATION", MySqlDbType.VarChar).Value = table.Rows(i)("CODE_RESERVATION")

                commandupdateQuery.ExecuteNonQuery()

            Next

        End If
    End Sub


    Public Shared Function RetounerLaSommeDesValeursDuChamp(ByVal TABLE_NAME As String, ByVal FIELD_NAME As String, ByVal FIELD_NAME_VALUE As String) As Double

        Dim query As String = "SELECT SUM(MONTANT_BLOC_NOTE) AS somme FROM " & TABLE_NAME & " WHERE " & FIELD_NAME & " =@FIELD_NAME_VALUE"

        Dim command As New MySqlCommand(query, GlobalVariable.connect)
        command.Parameters.Add("@FIELD_NAME_VALUE", MySqlDbType.VarChar).Value = FIELD_NAME_VALUE

        Dim adapter As New MySqlDataAdapter(command)
        Dim table As New DataTable()
        adapter.Fill(table)

        Dim somme As Double = 0

        If (table.Rows.Count > 0) Then

            somme = table.Rows(0)("somme")

        End If

    End Function

    Public Shared Function returningColorFromString(ByVal colorString As String) As String()

        If colorString.Contains("[A=") Then


            Dim paramCouleur() As String

            colorString = colorString.Replace("Color [A=", "").Replace("]", "").Replace("R=", "").Replace("G=", "").Replace("B=", "")

            paramCouleur = colorString.Split(",")

            Return paramCouleur

        Else

            Dim paramCouleur(2) As String

            colorString = colorString.Replace("Color [", "").Replace("]", "")

            paramCouleur(0) = colorString
            paramCouleur(1) = ""

            Return paramCouleur

        End If

    End Function

    Public Shared Function historiquesDuMarche(ByVal CODE_ARTICLE As String, ByVal dateDeRecherche As Date) As Double

        Dim montant As Double = 0

        Dim TYPE_BORDEREAUX_1 As String = "Liste du Marché"
        Dim FillingListquery_ As String = "SELECT ligne_bordereaux.PRIX_TOTAL_HT FROM bordereaux, ligne_bordereaux WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "') AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND ligne_bordereaux.CODE_ARTICLE=@CODE_ARTICLE AND DATE_BORDEREAU >= '" & dateDeRecherche.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <= '" & dateDeRecherche.ToString("yyyy-MM-dd") & "' AND ETAT_BORDEREAU NOT IN ('0')"

        Dim commandList_ As New MySqlCommand(FillingListquery_, GlobalVariable.connect)
        commandList_.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
        commandList_.Parameters.Add("@CODE_ARTICLE", MySqlDbType.VarChar).Value = CODE_ARTICLE

        Dim adapterList_ As New MySqlDataAdapter(commandList_)
        Dim dt As New DataTable()

        adapterList_.Fill(dt)

        If dt.Rows.Count > 0 Then

            For i = 0 To dt.Rows.Count - 1
                montant += dt.Rows(i)("PRIX_TOTAL_HT")
            Next

        End If

        Return montant

    End Function

    Public Shared Function nombreDeClientEnChambre(ByVal dateDuJour As Date, ByVal typeChambreOuSalle As String) As Integer

        Dim nombreEnChambre As Integer = 0

        Dim query As String = "SELECT NB_PERSONNES AS PAX FROM reserve_conf WHERE DATE_ENTTRE <= '" & dateDuJour.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & dateDuJour.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 1 AND TYPE=@TYPE ORDER BY CHAMBRE_ID ASC"

        Dim command As New MySqlCommand(query, GlobalVariable.connect)
        command.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = typeChambreOuSalle

        Dim adapter As New MySqlDataAdapter(command)
        Dim table As New DataTable()
        adapter.Fill(table)

        If table.Rows.Count > 0 Then

            For i = 0 To table.Rows.Count - 1
                nombreEnChambre += table.Rows(i)("PAX")
            Next

        End If

        Return nombreEnChambre

    End Function

    Public Shared Function nombreDeTraiteur(ByVal dateDuJour As Date, ByVal dateDuJour_1 As Date, ByVal typeChambreOuSalle As String) As DataTable

        Dim nombrePax As Integer = 0

        Dim query As String = "SELECT * FROM reserve_conf WHERE DATE_ENTTRE >= '" & dateDuJour.ToString("yyyy-MM-dd") & "' AND DATE_ENTTRE <='" & dateDuJour_1.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 1 AND TYPE=@TYPE ORDER BY CHAMBRE_ID ASC"

        Dim command As New MySqlCommand(query, GlobalVariable.connect)
        command.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = typeChambreOuSalle

        Dim adapter As New MySqlDataAdapter(command)
        Dim table As New DataTable()
        adapter.Fill(table)

        If table.Rows.Count > 0 Then
            Return table
        End If

    End Function

    Public Shared Async Sub ultrMessage(ByVal fileToSend As String, ByVal text_document As Integer, ByVal documentTitle As String, ByVal message As String, ByVal typeDeDocument As Integer, Optional ByVal phoneNumber As String = "", Optional ByVal ETAT_BORDEREAU As Integer = 10)

        Dim Out As Integer

        Dim haveInternet As Boolean = checkInternetCOnnection()

        If haveInternet Then

            Try

                'text_document = 0 : MESSAGE
                'text_document = 1 : MESSAGE + DOCUMENTS

                'AND 

                'typeDeDocument = 0 ' MAINCOURANTE JOURNALIERE
                'typeDeDocument = 1 ' ECONOMAT GESTION DES BONS

                Dim WebRequest As HttpWebRequest
                Dim WebRequest_ As HttpWebRequest

                Dim instance_id As String = GlobalVariable.AgenceActuelle.Rows(0)("instance_id")
                Dim token As String = GlobalVariable.AgenceActuelle.Rows(0)("token")

                Dim mobile_number As String = ""

                If typeDeDocument = 0 Then 'MAINCOURANTE JOURNALIERE

                    If Not Trim(GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_1")).Equals("") Then
                        mobile_number = GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_1")
                    End If

                    If Not Trim(GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_2")).Equals("") Then
                        If Trim(mobile_number).Equals("") Then
                            mobile_number = GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_2")
                        Else
                            mobile_number += "," & GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_2")
                        End If
                    End If

                    If Not Trim(GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_3")).Equals("") Then
                        If Trim(mobile_number).Equals("") Then
                            mobile_number = GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_3")
                        Else
                            mobile_number += "," & GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_3")
                        End If
                    End If

                    If Not Trim(GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_4")).Equals("") Then
                        If Trim(mobile_number).Equals("") Then
                            mobile_number = GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_4")
                        Else
                            mobile_number += "," & GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_4")
                        End If
                    End If

                    If Not Trim(GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_5")).Equals("") Then
                        If Trim(mobile_number).Equals("") Then
                            mobile_number = GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_5")
                        Else
                            mobile_number += "," & GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_5")
                        End If
                    End If

                    If Not Trim(GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_6")).Equals("") Then
                        If Trim(mobile_number).Equals("") Then
                            mobile_number = GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_6")
                        Else
                            mobile_number += "," & GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_6")
                        End If
                    End If

                    If Not Trim(GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_7")).Equals("") Then
                        If Trim(mobile_number).Equals("") Then
                            mobile_number = GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_7")
                        Else
                            mobile_number += "," & GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_7")
                        End If
                    End If

                ElseIf typeDeDocument = 1 Then 'BON DE REQUISITION OU LISTE DU MARCHE

                    'CONTROLEUR
                    If ETAT_BORDEREAU = 0 Then
                        If Not Trim(GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_3")).Equals("") Then
                            mobile_number = GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_3")
                        End If
                    End If

                    'COMPTABLE :  VERIFIER
                    If ETAT_BORDEREAU = 1 Then
                        If Not Trim(GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_2")).Equals("") Then
                            mobile_number = GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_2")
                        End If
                    End If

                    'PDG : VALIDER
                    If ETAT_BORDEREAU = 2 Then
                        If Not Trim(GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_5")).Equals("") Then
                            mobile_number = GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_5")
                        End If
                    End If

                    'ECONOM : COMMANDER
                    If ETAT_BORDEREAU = 3 Then
                        If Not Trim(GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_1")).Equals("") Then
                            mobile_number = GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_1")
                        End If
                    End If

                    If Not ETAT_BORDEREAU = 2 Then
                        mobile_number += "," & GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_2")
                    End If

                    If Not ETAT_BORDEREAU = 1 Then
                        mobile_number += "," & GlobalVariable.AgenceActuelle.Rows(0)("WHATSAPP_2")
                    End If

                ElseIf typeDeDocument = 2 Then
                    mobile_number = phoneNumber
                End If

                If text_document = 0 Then ' ENVOIE D'UN MESSAGE

                    Dim ultramsgApiUrl_ As String = "https://api.ultramsg.com/" + instance_id + "/messages/chat"
                    WebRequest = HttpWebRequest.Create(ultramsgApiUrl_)
                    Dim postdata_ As String = "token=" + token + "&to=" + mobile_number + "&body=" & "(" & GlobalVariable.AgenceActuelle.Rows(0)("NOM_AGENCE") & Chr(13) & message
                    Dim enc_ As UTF8Encoding = New System.Text.UTF8Encoding()
                    Dim postdatabytes_ As Byte() = enc_.GetBytes(postdata_)
                    WebRequest.Method = "POST"
                    WebRequest.ContentType = "application/x-www-form-urlencoded"
                    WebRequest.GetRequestStream().Write(postdatabytes_, 0, postdatabytes_.Length)

                    Dim ret_ As New System.IO.StreamReader(WebRequest.GetResponse().GetResponseStream())

                ElseIf text_document = 1 Then

                    '--------------------- DOCUMENT  -------------------------------------------

                    Dim bytes As Byte() = IO.File.ReadAllBytes(fileToSend)
                    Dim file As String = Convert.ToBase64String(bytes)
                    WebRequest = HttpWebRequest.Create("https://api.ultramsg.com/" + instance_id + "/messages/document")
                    Dim postdata As String = "token=" + token + "&to=" + mobile_number + "&document=" & HttpUtility.UrlEncode(file) & "&filename=" & documentTitle & "(" & GlobalVariable.AgenceActuelle.Rows(0)("NOM_AGENCE") & ").pdf"
                    Dim enc As UTF8Encoding = New System.Text.UTF8Encoding()
                    Dim postdatabytes As Byte() = enc.GetBytes(postdata)
                    WebRequest.Method = "POST"
                    WebRequest.ContentType = "application/x-www-form-urlencoded"
                    WebRequest.GetRequestStream().Write(postdatabytes, 0, postdatabytes.Length)

                    Dim ret As New System.IO.StreamReader(WebRequest.GetResponse().GetResponseStream())

                ElseIf text_document = 2 Then

                    '--------------------- TEXT -------------------------------------------
                    Dim ultramsgApiUrl_ As String = "https://api.ultramsg.com/" + instance_id + "/messages/chat"
                    WebRequest_ = HttpWebRequest.Create(ultramsgApiUrl_)
                    Dim postdata_ As String = "token=" + token + "&to=" + mobile_number + "&body=" & "(" & GlobalVariable.AgenceActuelle.Rows(0)("NOM_AGENCE") & ")" & Chr(13) & message
                    Dim enc_ As UTF8Encoding = New System.Text.UTF8Encoding()
                    Dim postdatabytes_ As Byte() = enc_.GetBytes(postdata_)
                    WebRequest_.Method = "POST"
                    WebRequest_.ContentType = "application/x-www-form-urlencoded"
                    WebRequest_.GetRequestStream().Write(postdatabytes_, 0, postdatabytes_.Length)

                    Dim ret_ As New System.IO.StreamReader(WebRequest_.GetResponse().GetResponseStream())

                End If

            Catch ex As Exception
                'MessageBox.Show(ex.Message, "Message WhatsApp", MessageBoxButtons.OK, MessageBoxIcon.Information)
            End Try

        Else

            'noInternetMessage()

        End If

    End Sub

    Public Shared Function checkInternetCOnnection() As Boolean

        Try

            If My.Computer.Network.IsAvailable Then
                Return True
            Else
                Return False
            End If

        Catch ex As Exception
            'MessageBox.Show(ex.Message, "Message WhatsApp", MessageBoxButtons.OK, MessageBoxIcon.Information)
        End Try

    End Function


    Public Shared Async Sub ultrMessageSimpleText(ByVal message As String, ByVal mobile_number As String)

        Dim Out As Integer

        Dim haveInternet As Boolean = checkInternetCOnnection()

        If haveInternet Then

            Try

                message = GlobalVariable.AgenceActuelle.Rows(0)("NOM_AGENCE") & " " & Chr(13) & message

                Dim WebRequest As HttpWebRequest
                Dim instance_id As String = GlobalVariable.AgenceActuelle.Rows(0)("instance_id")
                Dim token As String = GlobalVariable.AgenceActuelle.Rows(0)("token")

                Dim ultramsgApiUrl_ As String = "https://api.ultramsg.com/" + instance_id + "/messages/chat"
                WebRequest = HttpWebRequest.Create(ultramsgApiUrl_)
                Dim postdata_ As String = "token=" + token + "&to=" + mobile_number + "&body=" & message
                Dim enc_ As UTF8Encoding = New System.Text.UTF8Encoding()
                Dim postdatabytes_ As Byte() = enc_.GetBytes(postdata_)
                WebRequest.Method = "POST"
                WebRequest.ContentType = "application/x-www-form-urlencoded"
                WebRequest.GetRequestStream().Write(postdatabytes_, 0, postdatabytes_.Length)

                Dim ret As New System.IO.StreamReader(WebRequest.GetResponse().GetResponseStream())

            Catch ex As Exception
                'MessageBox.Show(ex.Message, "Message WhatsApp", MessageBoxButtons.OK, MessageBoxIcon.Information)
            End Try

        Else

            'noInternetMessage()

        End If

    End Sub

    Public Shared Sub noInternetMessage()

        If GlobalVariable.actualLanguageValue = 1 Then
            MessageBox.Show("Pas d'Internet", "Envoyer document", MessageBoxButtons.OK, MessageBoxIcon.Information)
        Else
            MessageBox.Show("No Internet", "Send document", MessageBoxButtons.OK, MessageBoxIcon.Information)
        End If

    End Sub

    Public Shared Sub setFieldToZero(ByVal tableName As String, ByVal fieldName As String, ByVal fieldNameValue As Integer, ByVal DateDebut As Date, ByVal DateFin As Date)

        Dim updateQuery As String = "UPDATE `" & tableName & "` SET `" & fieldName & "` = @fieldNameValue 
        WHERE DATE_ENTTRE <= '" & DateFin.ToString("yyyy-MM-dd") & "' AND DATE_ENTTRE >='" & DateDebut.ToString("yyyy-MM-dd") & "' "

        Dim commandupdateQuery As New MySqlCommand(updateQuery, GlobalVariable.connect)

        commandupdateQuery.Parameters.Add("@fieldNameValue", MySqlDbType.Int64).Value = fieldNameValue

        commandupdateQuery.ExecuteNonQuery()

    End Sub

    Public Shared Sub updateMontantBlocNOteEnChambre(ByVal NUMERO_BLOC_NOTE As String, ByVal CODE_RESERVATION As String, ByVal MONTANT As Double)

        Dim updateQuery As String = "UPDATE `ligne_facture_bloc_note` SET `MONTANT_BLOC_NOTE` = MONTANT_BLOC_NOTE + @MONTANT_BLOC_NOTE WHERE CODE_RESERVATION = @CODE_RESERVATION AND NUMERO_BLOC_NOTE = @NUMERO_BLOC_NOTE"

        Dim commandupdateQuery As New MySqlCommand(updateQuery, GlobalVariable.connect)

        commandupdateQuery.Parameters.Add("@NUMERO_BLOC_NOTE", MySqlDbType.VarChar).Value = NUMERO_BLOC_NOTE
        commandupdateQuery.Parameters.Add("@CODE_RESERVATION", MySqlDbType.VarChar).Value = CODE_RESERVATION
        commandupdateQuery.Parameters.Add("@MONTANT_BLOC_NOTE", MySqlDbType.Double).Value = MONTANT

        commandupdateQuery.ExecuteNonQuery()

    End Sub

    Public Shared Sub updateEtatBlocNOteEnChambre(ByVal NUMERO_BLOC_NOTE As String, ByVal CODE_RESERVATION As String, ByVal ETAT_BLOC_NOTE As Integer)

        Dim updateQuery As String = "UPDATE `ligne_facture_bloc_note` SET `ETAT_BLOC_NOTE` = @ETAT_BLOC_NOTE WHERE CODE_RESERVATION = @CODE_RESERVATION AND NUMERO_BLOC_NOTE = @NUMERO_BLOC_NOTE"

        Dim commandupdateQuery As New MySqlCommand(updateQuery, GlobalVariable.connect)

        commandupdateQuery.Parameters.Add("@NUMERO_BLOC_NOTE", MySqlDbType.VarChar).Value = NUMERO_BLOC_NOTE
        commandupdateQuery.Parameters.Add("@CODE_RESERVATION", MySqlDbType.VarChar).Value = CODE_RESERVATION
        commandupdateQuery.Parameters.Add("@ETAT_BLOC_NOTE", MySqlDbType.Int32).Value = ETAT_BLOC_NOTE

        commandupdateQuery.ExecuteNonQuery()

    End Sub

    Public Shared Function alerteNavette() As Integer

        Dim query As String = ""
        Dim query01 As String = ""

        Dim DateDebut As Date = GlobalVariable.DateDeTravail

        query = "SELECT `COMPANIE` FROM `navette`
                    WHERE navette.DATE_DEPART >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND navette.DATE_DEPART <= '" & DateDebut.ToString("yyyy-MM-dd") & "' "

        query01 = "SELECT `COMPANIE` FROM `navette`
                    WHERE navette.DATE_ARRIVEE >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND navette.DATE_ARRIVEE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' "

        Dim command As New MySqlCommand(query, GlobalVariable.connect)

        Dim adapter As New MySqlDataAdapter(command)
        Dim navette As New DataTable()
        adapter.Fill(navette)

        Dim command01 As New MySqlCommand(query01, GlobalVariable.connect)

        Dim adapter01 As New MySqlDataAdapter(command01)
        Dim navette01 As New DataTable()
        adapter01.Fill(navette01)

        navette.Merge(navette01)

        If navette.Rows.Count > 0 Then
            Return navette.Rows.Count
        Else
            Return 0
        End If

    End Function

    Public Shared Function alerteConsignes() As Integer

        Dim infoConsigne As DataTable = Functions.getElementByCode(0, "cahier_consigne", "ETAT_CONSIGNE")

        If infoConsigne.Rows.Count > 0 Then

            Return infoConsigne.Rows.Count
        Else
            Return 0
        End If

    End Function

    Public Shared Sub miseMainCouranteApreAnnulationDeCharge(ByVal ID_LIGNE_FACTURE As Integer)

        Dim ligneFactureTempContent As New DataTable()

        Dim mainsCourante As New MainCourantes()

        Dim lignefacture As New LigneFacture()

        ligneFactureTempContent = Functions.getElementByCode(ID_LIGNE_FACTURE, "ligne_facture", "ID_LIGNE_FACTURE")

        Dim CODE_ARTICLE As String = ""
        Dim NATURE As String = ""

        Dim PRIX_VENTE As Double = 0

        If ligneFactureTempContent.Rows.Count > 0 Then

            For i = 0 To ligneFactureTempContent.Rows.Count - 1

                Dim CODE_FACTURE As String = ligneFactureTempContent.Rows(i)("CODE_FACTURE")
                Dim CODE_RESERVATION As String = ligneFactureTempContent.Rows(i)("CODE_RESERVATION")
                Dim CODE_MOUVEMENT As String = ligneFactureTempContent.Rows(i)("CODE_MOUVEMENT")
                Dim CODE_CHAMBRE As String = ligneFactureTempContent.Rows(i)("CODE_CHAMBRE")
                Dim CODE_MODE_PAIEMENT As String = ligneFactureTempContent.Rows(i)("CODE_MODE_PAIEMENT")
                Dim NUMERO_PIECE As String = ligneFactureTempContent.Rows(i)("NUMERO_PIECE")
                Dim POINT_DE_VENTE As String = ligneFactureTempContent.Rows(i)("TYPE_LIGNE_FACTURE")
                CODE_ARTICLE = ligneFactureTempContent.Rows(i)("CODE_ARTICLE")

                Dim LIBELLE_FACTURE As String = ligneFactureTempContent.Rows(i)("LIBELLE_FACTURE") & " [" & CODE_CHAMBRE & "]"

                Dim QUANTITE_AVANT_MOVEMENT As Double = 0
                Dim CMUP As Double = 0

                Dim NOMBRE_DE_PORTION As Double = 0

                '-------------------------

                Dim CONTENANCE As Double = 0

                Dim articleInfo As DataTable = Functions.getElementByCode(CODE_ARTICLE, "article", "CODE_ARTICLE")

                Dim reduction As Boolean = False

                'ON DETERMINE SI LA LIGNE EST REDUCTION OU PAS

                If Not articleInfo.Rows.Count > 0 Then

                    CODE_ARTICLE = ligneFactureTempContent.Rows(i)("NUMERO_SERIE_DEBUT")
                    articleInfo = Functions.getElementByCode(CODE_ARTICLE, "article", "CODE_ARTICLE")

                    reduction = True

                End If

                Dim unite As DataTable
                '-----------------------
                Dim ficheTechnique As DataTable

                Dim NOM_ARTICLE As String = ""

                Dim FUSIONNEE As String = ligneFactureTempContent.Rows(i)("FUSIONNEE")
                Dim PRIX_UNITAIRE_TTC As Double = ligneFactureTempContent.Rows(i)("PRIX_UNITAIRE_TTC")
                PRIX_VENTE = ligneFactureTempContent.Rows(i)("PRIX_UNITAIRE_TTC")
                Dim MONTANT_TTC As Double = ligneFactureTempContent.Rows(i)("MONTANT_TTC")
                Dim HEURE_FACTURE As DateTime = ligneFactureTempContent.Rows(i)("HEURE_FACTURE")

                Dim FAMILLE_ARTICLE As String = ""

                If articleInfo.Rows.Count > 0 Then

                    '----------------------- END GESTION DU REMPLISSAGE DE LA MAIN COURANTE JOURNALIERE -------------------------------

                    Dim TABLE As String = "main_courante_journaliere"
                    Dim CODE_MAIN_COURANTE_JOURNALIERE As String = GlobalVariable.codeMainCouranteJournaliereToUpdate

                    FAMILLE_ARTICLE = articleInfo.Rows(0)("CODE_FAMILLE")

                    Dim FIELDVALUE As Double = MONTANT_TTC
                    Dim FIELD As String = ""

                    If Trim(FAMILLE_ARTICLE) = "BOISSONS" Then
                        'TRAITEMENT DES BOISSONS
                        FIELD = "BAR"
                        mainsCourante.updateMainCouranteJournaliereConsommationBarRestau(CODE_MAIN_COURANTE_JOURNALIERE, TABLE, FIELD, FIELDVALUE)

                        If FUSIONNEE = "EAU MINERAL" Then
                            FIELD = "CAFE"
                            mainsCourante.updateMainCouranteJournaliereConsommationBarRestau(CODE_MAIN_COURANTE_JOURNALIERE, TABLE, FIELD, FIELDVALUE)
                        Else
                            If ligneFactureTempContent.Rows(i)("VALEUR_CONSO") > 0 Then
                                FIELD = "DIVERS" 'CONSOMMATION
                                mainsCourante.updateMainCouranteJournaliereConsommationBarRestau(CODE_MAIN_COURANTE_JOURNALIERE, TABLE, FIELD, FIELDVALUE)
                            Else
                                FIELD = "CAVE"
                                mainsCourante.updateMainCouranteJournaliereConsommationBarRestau(CODE_MAIN_COURANTE_JOURNALIERE, TABLE, FIELD, FIELDVALUE)
                            End If
                        End If

                    ElseIf Trim(FAMILLE_ARTICLE) = "ALIMENTS(REPAS)" Then

                        'ON EXCLU LES REPAS DE TYPE PETIT DEJEUENER DU CONTROLE DU TEMPS
                        'If FUSIONNEE = "PETIT DEJEUNER" Then
                        If FUSIONNEE = "PETIT DEJEUNER" Then
                            FIELD = "PDJ"
                            mainsCourante.updateMainCouranteJournaliereConsommationBarRestau(CODE_MAIN_COURANTE_JOURNALIERE, TABLE, FIELD, FIELDVALUE)
                        Else

                            'TRAITEMENTS DES ALIMENTS DE TYPE DEJEUENER/DINER

                            '1- ON DOIT DETERMINER LA NATURE EN PASSANT L'HEURE DE VENTE DE L'ARTICLE
                            Dim momentDeVente As Date = CDate(HEURE_FACTURE).ToLongTimeString

                            NATURE = Trim(lignefacture.determintationDeLaNatureDuRePas(momentDeVente))

                            '2- DETERMINATION DU CHAMP A METTRE AJOUR DANS 

                            If Trim(NATURE).Equals("DEJEUNER") Then
                                FIELD = "DEJEUNER"
                            ElseIf Trim(NATURE).Equals("DINER") Then
                                FIELD = "DINER"
                            Else
                                FIELD = "DEJEUNER"
                            End If

                            mainsCourante.updateMainCouranteJournaliereConsommationBarRestau(CODE_MAIN_COURANTE_JOURNALIERE, TABLE, FIELD, FIELDVALUE * -1)

                        End If

                    Else
                        FUSIONNEE = ligneFactureTempContent.Rows(i)("FUSIONNEE")
                    End If

                    'Dim PDJ As Double = 0 'PETITE DEJEUNER
                    'Dim DEJEUNER As Double = 0 'DEJEUNER
                    'Dim DINER As Double = 0 'DINER
                    'Dim CAFE As Double = 0 'EAU MINERAL
                    'Dim BAR As Double = 0 'FAMILLE ARTICLE = BOISSONS
                    'Dim CAVE As Double = 0 '
                    'Dim DIVERS As Double = 0 'CONSOMMATION

                    '--------------------------------------------------------------------------------------------------------------

                    NOM_ARTICLE = articleInfo.Rows(0)("DESIGNATION_FR")

                    If Not reduction Then

                        QUANTITE_AVANT_MOVEMENT = Functions.getElementByCode(CODE_ARTICLE, "article", "CODE_ARTICLE").Rows(0)("QUANTITE")
                        CMUP = Functions.getElementByCode(CODE_ARTICLE, "article", "CODE_ARTICLE").Rows(0)("PRIX_ACHAT_HT")

                        CONTENANCE = articleInfo.Rows(0)("CONTENANCE")

                        'FICHE TECHNIQUE DE L'ARTICLE EN VENTE
                        ficheTechnique = Functions.getElementByCode(articleInfo.Rows(0)("CODE_CLE"), "fiche_technique", "CODE_FICHE_TECHNIQUE")
                        'CODE_CLE = CODE_FICHE_TECHNIQUE

                        Dim UNITE_COMPTAGE As String = articleInfo.Rows(0)("UNITE_COMPTAGE")

                        unite = Functions.getElementByCode(UNITE_COMPTAGE, "unite_comptage", "CODE_UNITE_DE_COMPTAGE")

                    End If

                End If

                'MISE A JOURS DE LA MAINCOURANTE PAR APPORT A CHAQUE POINT DE VENTE
                lignefacture.miseAjourDeLaMainCouranteParApportAPlusieursPointDeVente(NOM_ARTICLE, POINT_DE_VENTE, MONTANT_TTC)

                Dim CODE_LOT As String = ligneFactureTempContent.Rows(i)("CODE_LOT")
                Dim MONTANT_HT As Double = ligneFactureTempContent.Rows(i)("MONTANT_HT")
                Dim TAXE As Double = ligneFactureTempContent.Rows(i)("TAXE")

                Dim QUANTITE As Double = 0

                Dim QUANTITE_LIGNE_FACTURE As Double = ligneFactureTempContent.Rows(i)("QUANTITE")
                'TRAITEMENT DES CONSOMMATIONS

                Dim DATE_FACTURE As Date = ligneFactureTempContent.Rows(i)("DATE_FACTURE")

                Dim ETAT_FACTURE As Integer = ligneFactureTempContent.Rows(i)("ETAT_FACTURE")
                Dim DATE_OCCUPATION As Date = ligneFactureTempContent.Rows(i)("DATE_OCCUPATION")
                Dim HEURE_OCCUPATION As DateTime = ligneFactureTempContent.Rows(i)("HEURE_OCCUPATION")

                Dim TYPE_LIGNE_FACTURE As String = ligneFactureTempContent.Rows(i)("TYPE_LIGNE_FACTURE")
                Dim NUMERO_SERIE As String = ligneFactureTempContent.Rows(i)("NUMERO_SERIE")
                Dim NUMERO_ORDRE As Integer = ligneFactureTempContent.Rows(i)("NUMERO_ORDRE")
                Dim DESCRIPTION As String = ligneFactureTempContent.Rows(i)("DESCRIPTION")
                Dim CODE_UTILISATEUR_CREA As String = ligneFactureTempContent.Rows(i)("CODE_UTILISATEUR_CREA")
                Dim CODE_AGENCE As String = ligneFactureTempContent.Rows(i)("CODE_AGENCE")
                Dim MONTANT_REMISE As Double = ligneFactureTempContent.Rows(i)("MONTANT_REMISE")
                Dim MONTANT_TAXE As Double = ligneFactureTempContent.Rows(i)("MONTANT_TAXE")
                Dim NUMERO_SERIE_DEBUT As String = ligneFactureTempContent.Rows(i)("NUMERO_SERIE_DEBUT")
                Dim NUMERO_SERIE_FIN As String = ligneFactureTempContent.Rows(i)("NUMERO_SERIE_FIN")
                Dim CODE_MAGASIN As String = ligneFactureTempContent.Rows(i)("CODE_MAGASIN")

                Dim TYPE As String = ligneFactureTempContent.Rows(i)("TYPE")
                Dim NUMERO_BLOC_NOTE As String = ligneFactureTempContent.Rows(i)("NUMERO_BLOC_NOTE")
                Dim GRIFFE_UTILISATEUR As String = ligneFactureTempContent.Rows(i)("GRIFFE_UTILISATEUR")
                Dim VALEUR_CONSO As Double = ligneFactureTempContent.Rows(i)("VALEUR_CONSO")

                lignefacture.insertLigneFacture(CODE_FACTURE, CODE_RESERVATION, CODE_MOUVEMENT, CODE_CHAMBRE, CODE_MODE_PAIEMENT, NUMERO_PIECE, CODE_ARTICLE, CODE_LOT, MONTANT_HT, TAXE, QUANTITE_LIGNE_FACTURE, PRIX_UNITAIRE_TTC, MONTANT_TTC, DATE_FACTURE, HEURE_FACTURE, ETAT_FACTURE, DATE_OCCUPATION, HEURE_OCCUPATION, LIBELLE_FACTURE, TYPE_LIGNE_FACTURE, NUMERO_SERIE, NUMERO_ORDRE, DESCRIPTION, CODE_UTILISATEUR_CREA, CODE_AGENCE, MONTANT_REMISE, MONTANT_TAXE, NUMERO_SERIE_DEBUT, NUMERO_SERIE_FIN, CODE_MAGASIN, FUSIONNEE, TYPE, NUMERO_BLOC_NOTE, GRIFFE_UTILISATEUR, VALEUR_CONSO)

                'MISE A JOURS DE LA FUSIONNEE DANS LIGNE FACTURES

                If FAMILLE_ARTICLE = "ALIMENTS(REPAS)" Then
                    If Not FUSIONNEE = "PETIT DEJEUNER" Then
                        lignefacture.miseAjoursSousFamilleArticleDansLigneFacture(CODE_FACTURE, NATURE, CODE_ARTICLE)
                    End If
                End If

                '------------------------------------------
                Dim econom As New Economat()

                'ON SE RASSURE DE PAS EFFECTIVE GERER LES QUANTITE POUR LES REMISE

                If Not reduction Then

                    'MISE A JOUR DE LA QUANTITE DES LIGNE L'ARTICLE COMPOSE

                    'LA QUANTITE A DESTOCKER EST FONCTION DE LA GRANDE UNITE DE STOCKAGE
                    ' CAR NECESSISTANT DES CONVERSIONDE DE L'UNITE DE VENTE -> L'UNITE DE STOCKAGE:
                    '1- ON STOCK EN GRANDE UNITE PRINCIPALEMENT
                    '2- ON VENT EN PETITE UNITE 
                    '3- ON DECREMENTE LE STOCK EN GRANDE UNITE
                    '3.1- DONC IL EST NECESSAIRE DE RECONVERTIR DE L'UNITE DE VENTE (PETITE UNITE OU CONSO) VERS LA GRANDE UNITE POUR UNE EQUIVALENCE LORS DE LA SOUSATRACTION

                    'CONVERSION DE LA GRANDE QUANTITE EN UNITE DE STOCKAGE

                    'QUANTITE EST EN UNITE DE VENTE => PETITE UNITE

                    Dim gestionDesStock As Integer = Functions.getElementByCode(CODE_AGENCE, "agence", "CODE_AGENCE").Rows(0)("GERER_STOCK")
                    QUANTITE = QUANTITE_LIGNE_FACTURE
                    'If gestionDesStock = 1 Then
                    Dim QUANTITE_A_CONVERTIR As Double = QUANTITE
                    QUANTITE = lignefacture.conversionUniteDeVenteAUniteDeDestockage(unite, QUANTITE_A_CONVERTIR)
                    'End If

                    Dim qteDouble As Double = 0
                    Dim valeurDeConversion As Double = 0

                    Double.TryParse(QUANTITE, qteDouble)

                    Dim TABLE_SOURCEA_DESTOCKER As String = "article"
                    Dim QUANTITE_ARTICLE_A_DESTOCKER As Double = ((qteDouble * -1))

                    If ligneFactureTempContent.Rows(i)("VALEUR_CONSO") > 0 Then
                        QUANTITE_ARTICLE_A_DESTOCKER = QUANTITE * -1
                    End If

                    'L'ARTICLE ETANT A LA CARTE IL NE FAIT PAS L'OBJET D'UN SUIVIE DE STOCK
                    If ficheTechnique.Rows.Count > 0 Then
                        Dim QUANTITE_ARTICLE_A_DESTOCKER_PLAT As Double = 0
                        econom.gestionStockagesEtDeStockages(Trim(CODE_ARTICLE), TABLE_SOURCEA_DESTOCKER, QUANTITE_ARTICLE_A_DESTOCKER_PLAT)
                    Else
                        econom.gestionStockagesEtDeStockages(Trim(CODE_ARTICLE), TABLE_SOURCEA_DESTOCKER, QUANTITE_ARTICLE_A_DESTOCKER)
                    End If

                    'INSCRIPTION DES LIGNES DE MOUVEMENTS

                    Dim entre_en_stock As Double = 0

                    Dim sortie_de_stock As Double = QUANTITE_ARTICLE_A_DESTOCKER

                    Dim DATE_PEREMPTION As Date

                    Dim LIBELLE_MOUVEMENT As String = "vente de d'article"

                    Dim TYPE_MOUVEMENT As String = "sortie de stock"

                    Dim QUANTITE_ENTREE As Double = 0
                    Dim QUANTITE_SORTIE As Double = sortie_de_stock
                    Dim VALEUR_ENTREE As Double = 0
                    Dim VALEUR_SORTIE As String = sortie_de_stock

                    Dim ETAT_MOUVEMENT As String = ""
                    Dim DATE_MOUVEMENT As Date = GlobalVariable.DateDeTravail

                    'GESTION DES LIGNES DE MOUVEMENT SSI NOUS GERONS LES BON DE RECEPTION VALIDE

                    Dim CODE_BORDEREAUX_MOV As String = "vente"

                    'INSERTION DU MOVEMENT DE STOCK
                    If econom.insertLigneMovement(CODE_MOUVEMENT, LIBELLE_MOUVEMENT, TYPE_MOUVEMENT, ETAT_MOUVEMENT, DATE_MOUVEMENT, CODE_MAGASIN, CODE_ARTICLE, CODE_LOT, QUANTITE_ENTREE, QUANTITE_SORTIE, VALEUR_ENTREE, VALEUR_SORTIE, CODE_UTILISATEUR_CREA, GlobalVariable.codeAgence, CODE_BORDEREAUX_MOV, QUANTITE_AVANT_MOVEMENT, CMUP) Then

                    End If

                    ' END INSCRIPTION DES LIGNES DE MOUVEMENTS

                    'LES ARTICLES A LA CARTE SONT DESTOCKER A LA VENTE PAR APPORT A LEUR FICHE TECHNIQUE
                    'pour un destockages deux conditions sont necessaires:
                    '1- Etre un article a la carte
                    '2- Etre un article compose dertmine par une fiche technique

                    '--------------------------------

                    Dim ETAT_BORDEREAU As Integer = 0
                    'ON VERIFIE SI L'ARTICLE APPARTIENT A UNE FICHE TECHNIQUE AUQUEL CAS ON VA DESTOCKER LES ELEMENTS LE CONSTITUANT

                    'Dim ficheTechnique As DataTable = Functions.getElementByCode(Trim(CODE_ARTICLE), "fiche_technique", "CODE_ARTICLE")
                    'Dim ficheTechnique As DataTable = Functions.getElementByCode(ligneFactureTempContent.Rows(i)("CODE_CLE"), "fiche_technique", "CODE_ARTICLE")

                    If ficheTechnique.Rows.Count > 0 Then

                        'GESTION DES COMMANDES CUISINES ------------------------
                        NOMBRE_DE_PORTION = qteDouble

                        If NOMBRE_DE_PORTION < 0 Then
                            NOMBRE_DE_PORTION = NOMBRE_DE_PORTION * -1
                        End If

                        Dim RANDOM_CODE As String = Functions.GeneratingRandomCodePanne("article", "")

                        Dim CODE_FICHE_TECHNIQUE As String = ficheTechnique.Rows(0)("CODE_FICHE_TECHNIQUE")

                        Dim article As New Article()

                        Dim CODE_ARTICLE_FICHE = CODE_ARTICLE

                        Dim DATE_PREPARATION As Date = GlobalVariable.DateDeTravail

                        article.commandeCuisine(CODE_ARTICLE_FICHE, NOM_ARTICLE, CODE_FICHE_TECHNIQUE, NOMBRE_DE_PORTION, DATE_PREPARATION, RANDOM_CODE, PRIX_VENTE)

                    End If

                End If

            Next

        End If

    End Sub

    Public Shared Function clientDejaEnChambre(ByVal CHAMBRE_ID As String) As Boolean

        If Trim(CHAMBRE_ID).Equals("") Or Trim(CHAMBRE_ID).Equals("-") Then
            Return True
        Else

            Dim DateDebut As Date = GlobalVariable.DateDeTravail.ToString("yyyy-MM-dd")

            Dim query As String = "SELECT CHAMBRE_ID FROM reserve_conf WHERE DATE_ENTTRE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 1 AND TYPE=@TYPE AND CHAMBRE_ID=@CHAMBRE_ID ORDER BY CHAMBRE_ID ASC"

            Dim command As New MySqlCommand(query, GlobalVariable.connect)
            command.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle
            command.Parameters.Add("@CHAMBRE_ID", MySqlDbType.VarChar).Value = CHAMBRE_ID

            Dim adapter As New MySqlDataAdapter(command)
            Dim table As New DataTable()
            adapter.Fill(table)

            If table.Rows.Count > 0 Then
                Return True
            Else
                Return False 'ON PEUT PROCEDER A L'ENREGISTREMENT
            End If

        End If

    End Function

    Public Shared Sub verifionsQueLesBlocNoteSontDansLeBonEtat(ByVal DateDeSituation As Date, ByVal ETAT_BLOC_NOTE As Integer)

        '1- ON RECHERCHE TOUS LES BLOCS REGLES MAIS DANS LE MAUVAIS ETAT DONC TOUJOURS DISPONIBLE 
        'ET VISIBLE POUR REGLEMENT (ETAT_BLOC_NOTE DEVANT ETRE 2 MET EST TOUJOURS A 1) 
        'ICI IL S'AGIT D'UN BLOC NOTE REGLE MAIS DANS UN ETAT NON REGLE

        Dim NEW_ETAT_BLOC_NOTE As Integer = 2

        Dim getUserQuery = "SELECT * FROM ligne_facture_bloc_note WHERE DATE_CREATION >= '" & DateDeSituation.ToString("yyyy-MM-dd") & "' AND DATE_CREATION <= '" & DateDeSituation.ToString("yyyy-MM-dd") & "' AND ETAT_BLOC_NOTE = @ETAT_BLOC_NOTE ORDER BY NUMERO_BLOC_NOTE ASC"

        Dim command As New MySqlCommand(getUserQuery, GlobalVariable.connect)

        command.Parameters.Add("@ETAT_BLOC_NOTE", MySqlDbType.Int64).Value = ETAT_BLOC_NOTE ' = 1

        Dim adapter As New MySqlDataAdapter

        Dim dt As New DataTable()

        adapter.SelectCommand = command
        adapter.Fill(dt)

        Dim nomDelaTable As String = "ligne_facture_bloc_note"
        Dim nomDuChamp As String = "ETAT_BLOC_NOTE"
        Dim ValeurDuChamp As String = NEW_ETAT_BLOC_NOTE
        Dim nomDuChampDuCode As String = "ID_BLOC_NOTE"
        Dim valeurDuChampDuCode As Integer
        Dim variableType As Integer = 0
        Dim ID_BLOC_NOTE As Integer

        For i = 0 To dt.Rows.Count - 1

            '1.1- SI LE MONTANT A ENCAISSER >= AU MONTANT ENCAISSE ALORS LE BLOC NOTE EST DANS UN MAUVAIS ETAT
            If dt.Rows(i)("MONTANT_BLOC_NOTE") = dt.Rows(i)("MONTANT_ENCAISSEMENT") And dt.Rows(i)("MONTANT_BLOC_NOTE") > 0 Then
                Dim NUMERO_BLOC_NOTE As String = dt.Rows(i)("NUMERO_BLOC_NOTE")
                updateOfFields("ligne_facture_bloc_note", "ETAT_BLOC_NOTE", NEW_ETAT_BLOC_NOTE, "NUMERO_BLOC_NOTE", NUMERO_BLOC_NOTE, 0)
            End If

        Next

        '2- ON RECHERCHE TOUS LES BLOCS NON REGLES MAIS DANS UN ETAT REGLE DONC PAS DISPONIBLE POUR REGELEMENT (ETAT_BLOC_NOTE DEVANT ETRE 1 MET EST A 2) 

        Dim NEW_ETAT_BLOC_NOTE_ As Integer = 1

        Dim getUserQuery_ = "SELECT * FROM ligne_facture_bloc_note WHERE DATE_CREATION >= '" & DateDeSituation.ToString("yyyy-MM-dd") & "' AND DATE_CREATION <= '" & DateDeSituation.ToString("yyyy-MM-dd") & "' AND ETAT_BLOC_NOTE = @ETAT_BLOC_NOTE ORDER BY NUMERO_BLOC_NOTE ASC"

        Dim command_ As New MySqlCommand(getUserQuery, GlobalVariable.connect)
        ETAT_BLOC_NOTE = 2
        command_.Parameters.Add("@ETAT_BLOC_NOTE", MySqlDbType.Int64).Value = ETAT_BLOC_NOTE

        Dim adapter_ As New MySqlDataAdapter

        Dim dt_ As New DataTable()

        adapter_.SelectCommand = command_
        adapter_.Fill(dt_)

        Dim nomDelaTable_ As String = "ligne_facture_bloc_note"
        Dim nomDuChamp_ As String = "ETAT_BLOC_NOTE"
        Dim ValeurDuChamp_ As String = NEW_ETAT_BLOC_NOTE
        Dim nomDuChampDuCode_ As String = "ID_BLOC_NOTE"
        Dim valeurDuChampDuCode_ As Integer
        Dim variableType_ As Integer = 3

        For i = 0 To dt_.Rows.Count - 1

            '2.1- SI LE MONTANT A ENCAISSER > ENCAISSE ALORS LE BLOC NOTE EST DANS UN MAUVAIS ETAT

            If dt_.Rows(i)("MONTANT_BLOC_NOTE") > dt_.Rows(i)("MONTANT_ENCAISSEMENT") Then

                Dim NUMERO_BLOC_NOTE As String = dt_.Rows(i)("NUMERO_BLOC_NOTE")

                If Not Trim(dt_.Rows(i)("CODE_RESERVATION")).Equals("") Then
                    NEW_ETAT_BLOC_NOTE_ = 0
                End If

                updateOfFields("ligne_facture_bloc_note", "ETAT_BLOC_NOTE", NEW_ETAT_BLOC_NOTE_, "NUMERO_BLOC_NOTE", NUMERO_BLOC_NOTE, 0)

                NEW_ETAT_BLOC_NOTE_ = 1

            End If

        Next

        Dim updateQuery_1 As String = "UPDATE `ligne_facture` SET NUMERO_BLOC_NOTE=NUMERO_SERIE_FIN 
        WHERE FUSIONNEE NOT IN ('HEBERGEMENT','','TAXE DE SEJOURS','HALL RENTING','ACCOMMODATION','TOURIST TAX','LOCATION SALLE') AND 
        NUMERO_BLOC_NOTE = '' AND NUMERO_SERIE_FIN NOT IN ('')"

        Dim command_1 As New MySqlCommand(updateQuery_1, GlobalVariable.connect)

        command_1.ExecuteNonQuery()

    End Sub

    Public Shared Function detentionDeCaisse(ByVal CODE_UTILISATEUR As String) As Boolean

        Dim possedeUneCaisse As Boolean = False

        Dim caisse As DataTable = Functions.getElementByCode(CODE_UTILISATEUR, "caisse", "CODE_UTILISATEUR")

        If caisse.Rows.Count > 0 Then
            possedeUneCaisse = True
        End If

        Return possedeUneCaisse

    End Function

    Public Shared Function exonereDelaTVA(ByVal CODE_CLIENT As String) As Boolean

        Dim exonore As Boolean = False 'PAS EXONERE DE LA TVA

        Dim infoSupClient As DataTable = Functions.getElementByCode(CODE_CLIENT, "client", "CODE_CLIENT")

        If infoSupClient.Rows.Count > 0 Then

            If infoSupClient.Rows(0)("TVA") = 0 Then 'EXONERE DE LA TVA
                exonore = True
            End If

        End If

        Return exonore

    End Function

    Public Shared Function exonereDelaTVAComplet(ByVal CODE_RESERVATION As String) As Boolean

        Dim exonore As Boolean = False 'PAS EXONERE

        If Not Trim(CODE_RESERVATION).Equals("") Then

            Dim ETAT_RESERVATION As Integer = 1
            Dim infoSupResa As DataTable = getElementByCode(CODE_RESERVATION, "reserve_conf", "CODE_RESERVATION")
            Dim CODE_ENTREPRISE As String = ""
            Dim CODE_CLIENT As String = ""

            If infoSupResa.Rows.Count > 0 Then

                '1- ON CHERCHE A SAVOIR SI LA RESERVATION EST ASSOCIE A UNE ENTREPRISE 
                CODE_ENTREPRISE = infoSupResa.Rows(0)("CODE_ENTREPRISE")
                CODE_CLIENT = infoSupResa.Rows(0)("CLIENT_ID")

                'SI NON ON UTILISERA LE CODE DE L'INDIVIDU POUR SAVOIR SI EXONERA OU PAS
                If Trim(CODE_ENTREPRISE).Equals("") Then
                    exonore = Functions.exonereDelaTVA(CODE_CLIENT)
                Else
                    'SI OUI ON UTILISERA LE CODE DE L'ENTREPRISE POUR SAVOIR DETERMINE SI EXONERA OU PAS
                    exonore = Functions.exonereDelaTVA(CODE_ENTREPRISE)
                End If

            End If

        End If

        Return exonore

    End Function

    Public Shared Function prixDeVenteDuMagasin(ByVal CODE_MAGASIN As String, ByVal article As DataTable, ByVal i As Integer) As Double

        Dim PRIX_UTILISE As Double = 0

        Dim infoMagasin As DataTable = Functions.getElementByCode(CODE_MAGASIN, "magasin", "CODE_MAGASIN")

        If infoMagasin.Rows.Count > 0 Then

            If infoMagasin.Rows(0)("PRIX_UTILISE") = 1 Then
                PRIX_UTILISE = article.Rows(i)("PRIX_VENTE_HT")
            ElseIf infoMagasin.Rows(0)("PRIX_UTILISE") = 2 Then
                PRIX_UTILISE = article.Rows(i)("PRIX_VENTE1_HT")
            ElseIf infoMagasin.Rows(0)("PRIX_UTILISE") = 3 Then
                PRIX_UTILISE = article.Rows(i)("PRIX_VENTE2_HT")
            ElseIf infoMagasin.Rows(0)("PRIX_UTILISE") = 4 Then
                PRIX_UTILISE = article.Rows(i)("PRIX_VENTE3_HT")
            Else
                PRIX_UTILISE = article.Rows(i)("PRIX_VENTE_HT")
            End If

        Else
            PRIX_UTILISE = article.Rows(i)("PRIX_VENTE_HT")
        End If

        Return PRIX_UTILISE

    End Function

    Public Shared Function nombreDeJourAInsererDansLEncodeur(ByVal DATE_ENTTRE As Date, ByVal DATE_DE_TRAVAIL As Date, ByVal CODE_RESERVATION As String) As Integer

        Dim infoResa As DataTable = Functions.getElementByCode(CODE_RESERVATION, "reserve_conf", "CODE_RESERVATION")

        Dim MONTANT_ACCORDE As Double = 0

        If infoResa.Rows.Count > 0 Then
            MONTANT_ACCORDE = infoResa.Rows(0)("MONTANT_ACCORDE")
        End If

        Dim infoReglement As DataTable = Functions.getElementByCode(CODE_RESERVATION, "reglement", "CODE_RESERVATION")

        Dim TOTAL_ENCAISSE As Double = 0

        If infoReglement.Rows.Count > 0 Then

            For i = 0 To infoReglement.Rows.Count - 1
                TOTAL_ENCAISSE += infoReglement.Rows(i)("MONTANT_VERSE")
            Next

        End If

        'PRENDRE EN COMPTE LES CONSOMMATION DU CLIENT ET DEDUIRE DU MONTANT ENCAISSE
        Dim MONTANT_CONSOMME As Double = 0

        Dim nombreDeJourAEncoder As Integer = 0

        Dim SOLDE As Double = TOTAL_ENCAISSE - MONTANT_CONSOMME

        '1------------------------------------ TRAITEMENT POUR LES NUITEES ----------------------------------

        If MONTANT_ACCORDE > 0 Then
            'ON DETERMINE LE NOMBRE DE NUIT QUE LE SOLDE PERMET D'ENCODER
            nombreDeJourAEncoder = Math.Floor(SOLDE / MONTANT_ACCORDE)
        End If

        Dim nombreDeJourDejaConsommee As Integer = 0

        nombreDeJourDejaConsommee = CType((DATE_DE_TRAVAIL - DATE_ENTTRE).TotalDays, Int32)

        Dim nombreDeJourRestantAEncoder As Integer = 0

        nombreDeJourRestantAEncoder = nombreDeJourAEncoder - nombreDeJourDejaConsommee

        '2----------------------------------- TRAITEMENT POUR LES SIESTE NON FAIT -------------------------------
        Return nombreDeJourRestantAEncoder

    End Function

    Public Shared Function magasinActuelEtShiftDunUtilisateur()

        If GlobalVariable.AgenceActuelle.Rows.Count > 0 Then

            If GlobalVariable.AgenceActuelle.Rows(0)("GERER_STOCK") = 1 Then

                Dim CODE_UTILISATEUR As String = GlobalVariable.ConnectedUser.Rows(0)("CODE_UTILISATEUR")
                Dim DATE_SHIFT As Date = GlobalVariable.DateDeTravail

                Dim ligne_facture As New LigneFacture()
                Dim shiftExist As DataTable = ligne_facture.existenceDuShiftDunUtilisateur(CODE_UTILISATEUR, DATE_SHIFT)

                If Not shiftExist.Rows.Count > 0 Then
                    Functions.choixDeMagasinOuPas()
                Else

                    GlobalVariable.magasinActuel = shiftExist.Rows(0)("CODE_MAGASIN")
                    GlobalVariable.shiftActuel = shiftExist.Rows(0)("INDEX_SHIFT")

                End If

            End If

        End If

    End Function

    Public Shared Sub ListeDesMainCourantesCumul(ByVal date_debut As Date, ByVal date_fin As Date)

        Dim changerSigne As Integer = -1

        Dim DocumentToGenerate As String = "chambre"
        Dim calculDuMontantAReporter

        If True Then

            'MAINCOURANTE JOURNALIERE

            'Functions.AffectingTitleToAForm("SITUATION MENSUEL DE L'ETABLISSEMENT", GunaLabelGeneral)

            Dim DateDebut As Date = date_debut.ToString("yyyy-MM-dd")
            Dim DateFin As Date = date_fin.ToString("yyyy-MM-dd")
            '2klg
            Dim nombreDejour As Integer = CType((DateFin - DateDebut).TotalDays, Int32)


            'RESERVATION 

            '1- ON DOIT RECUPER LES MAINS COURANTE DE CHAQUE JOUR PAR APPORT A L'INTERVAL DE DATE
            RapportFacturesForm.DataGridViewRapports.Columns.Clear()
            RapportFacturesForm.DataGridViewRapports.Rows.Clear()

            '------------------ ADD COLUMNS --------------------

            RapportFacturesForm.DataGridViewRapports.Columns.Add("DATE", "DATE")
            RapportFacturesForm.DataGridViewRapports.Columns.Add("HEBERGEMENT", "HEBERGEMENT")
            RapportFacturesForm.DataGridViewRapports.Columns.Add("TAXE", "TAXE")
            RapportFacturesForm.DataGridViewRapports.Columns.Add("PDJ", "PDJ")
            RapportFacturesForm.DataGridViewRapports.Columns.Add("DEJEUNER", "DEJEUNER")
            RapportFacturesForm.DataGridViewRapports.Columns.Add("DINER", "DINER")
            RapportFacturesForm.DataGridViewRapports.Columns.Add("BAR", "BAR")
            RapportFacturesForm.DataGridViewRapports.Columns.Add("BLANCHISSERIE", "BLANCHISSERIE")
            RapportFacturesForm.DataGridViewRapports.Columns.Add("AUTRES", "AUTRES")
            RapportFacturesForm.DataGridViewRapports.Columns.Add("RECETTE_DU_JOUR", "RECETTE DU JOUR") 'TOTAL DU JOUR
            RapportFacturesForm.DataGridViewRapports.Columns.Add("REPORT_VEILLE", "REPORT VEILLE")
            RapportFacturesForm.DataGridViewRapports.Columns.Add("TOTAL_GENERAL", "TOTAL GENERAL")
            RapportFacturesForm.DataGridViewRapports.Columns.Add("ESPECES", "ESPECES")
            RapportFacturesForm.DataGridViewRapports.Columns.Add("CARTE", "CARTE")
            RapportFacturesForm.DataGridViewRapports.Columns.Add("MOBILE_MONEY", "MOBILE MONEY")
            RapportFacturesForm.DataGridViewRapports.Columns.Add("A_REPORTER", "A REPORTER")

            Dim REPORT_VEILLE As Double = 0

            For j = 0 To nombreDejour

                Dim TOTAL_ENCAISSEMENT As Double = 0
                Dim RESTAURANT As Double = 0
                Dim BAR As Double = 0
                Dim AUTRES_VENTE As Double = 0
                Dim TOTAL_RECETTE As Double = 0

                Dim HEBERGEMENT As Double = 0
                Dim taxeDeSejours As Double = 0

                Dim RETRANCHEMENTHEBERGEMENT As Double = 0
                Dim RETRANCHEMENTTAXEDESEJOUR As Double = 0

                Dim DEJEUNER As Double = 0
                Dim PDJ As Double = 0
                Dim DINER As Double = 0
                Dim BLANCHISSERIE As Double = 0
                Dim RECETTE_DU_JOUR As Double = 0

                Dim TOTAL_GENERAL As Double = 0
                Dim ESPECES As Double = 0
                Dim CARTE_CREDIT As Double = 0
                Dim MOBILE_MONEY As Double = 0
                Dim A_REPORTER As Double = 0
                Dim ARRHES As Double = 0

                '1.1- INCREMENTATION DE LA DATE APRES CHAQUE RECUPERATION ET AFFICHAGE DE DONNEES

                Dim DateStat As Date = DateDebut.AddDays(j)

                HEBERGEMENT = Functions.ListeDesMainCourantesDujours(DateStat)

                If j = 0 Then
                    REPORT_VEILLE = RapportFacturesForm.calculDuMontantAReporterDelaVeillePourLePremierJour(DateStat)
                End If

                Dim getUserQuery1 = "SELECT CHAMBRE_ID As 'CHAMBRE', DAY_USE, NUM_RESERVATION, ARRHES, main_courante_journaliere.NOM_CLIENT As 'NOM & PRENOM', DATE_ENTTRE As 'DATE ARRIVEE', DATE_SORTIE As 'DATE DEPART', NB_PERSONNES As 'NBRE DE PAX', PDJ, DEJEUNER, DINER,CAVE, CAFE, DIVERS, ENCAISSEMENT_ESPECE AS 'ESPECES', ENCAISSEMENT_CHEQUE AS 'CHEQUE', ENCAISSEMENT_CARTE_CREDIT As 'CARTE CREDIT', TELE AS 'MOBILE MONEY', main_Courante_journaliere.NUM_RESERVATION As 'RESERVATION', main_courante_journaliere.MONTANT_ACCORDE AS 'HEBERGEMENT', main_courante_journaliere.BAR_RESTAURANT AS 'BAR/RESTAURANT', BAR, main_courante_journaliere.SERVICES AS 'SERVICES', main_courante_journaliere.SALON_DE_BEAUTE AS 'SALON DE BEAUTE', main_courante_journaliere.BOUTIQE AS 'BOUTIQUE', main_courante_journaliere.CYBERCAFE As 'BUSINESS CENTER', main_courante_journaliere.SPORTS As 'SPORTS' , main_courante_journaliere.LOISIRS As 'LOISIRS', TOTAL_JOUR, main_courante_journaliere.KIOSQUE_A_JOURNAUX as 'JOURNAUX', main_courante_journaliere.BLANCHISSERIE As BLANCHISSERIE, main_courante_journaliere.AUTRES As 'AUTRES', TOTAL_JOUR As 'RECETTE DU JOUR', REPORT_VEILLE As 'REPORT VEILLE', TOTAL_GENERAL As 'TOTAL GENERAL', A_REPORTER As 'A REPORTER', HEURE_ENTREE, HEURE_SORTIE,TAUX_OCCUPATION_PCT As 'TAXE DE SEJOUR' FROM main_Courante_journaliere, reserve_conf WHERE DATE_MAIN_COURANTE <= '" & DateStat.ToString("yyyy-MM-dd") & "' AND DATE_MAIN_COURANTE >='" & DateStat.ToString("yyyy-MM-dd") & "' AND main_Courante_journaliere.NUM_RESERVATION = reserve_conf.CODE_RESERVATION AND reserve_conf.TYPE=@TYPE ORDER BY CODE_CHAMBRE ASC"

                Dim command1 As New MySqlCommand(getUserQuery1, GlobalVariable.connect)

                'command1.Parameters.Add("@DATE_DU_JOUR", MySqlDbType.Date).Value = GlobalVariable.DateDeTravail
                'command1.Parameters.Add("@ETAT_MAIN_COURANTE", MySqlDbType.Int32).Value = 0
                'command1.Parameters.Add("@ETAT_MAIN_COURANTE", MySqlDbType.Int32).Value = 1
                command1.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = DocumentToGenerate

                Dim adapter1 As New MySqlDataAdapter(command1)

                Dim table As New DataTable()

                adapter1.Fill(table)

                '-----------------------------------------HEBERGEMENT-------------------------------------------------------------

                'Dim getUserQuery01_ = "SELECT * FROM `ligne_facture` WHERE DATE_FACTURE >='" & DateStat.ToString("yyyy-MM-dd") & "' AND DATE_FACTURE <='" & DateStat.ToString("yyyy-MM-dd") & "'
                'And `TYPE_LIGNE_FACTURE` LIKE 'HEBERGEMENT'"

                Dim getUserQuery01_ = "SELECT * FROM `ligne_facture` WHERE DATE_FACTURE >='" & DateStat.ToString("yyyy-MM-dd") & "' AND DATE_FACTURE <='" & DateStat.ToString("yyyy-MM-dd") & "'
                And `FUSIONNEE` IN ('HEBERGEMENT', 'ACCOMMODATION')"

                Dim command01_ As New MySqlCommand(getUserQuery01_, GlobalVariable.connect)
                Dim adapter01_ As New MySqlDataAdapter(command01_)

                Dim table01_ As New DataTable()

                adapter01_.Fill(table01_)

                If Not table01_ Is Nothing Then
                    If table01_.Rows.Count > 0 Then
                        For i = 0 To table01_.Rows.Count - 1
                            HEBERGEMENT += table01_.Rows(i)("MONTANT_TTC")
                        Next
                    End If
                End If

                '--------------------------------------------------------------------------------------------------------------------
                '-------------------------------------------------------- MAINCOURANTE ----------------------------------------------

                Dim getUserQuery01 = "SELECT CODE_CHAMBRE As 'CHAMBRE', NUM_RESERVATION, ARRHES, main_courante_autres.NOM_CLIENT As 'NOM & PRENOM', PDJ, DEJEUNER, DINER, CAVE, CAFE, DIVERS, ENCAISSEMENT_ESPECE AS 'ESPECES', ENCAISSEMENT_CHEQUE AS 'CHEQUE', ENCAISSEMENT_CARTE_CREDIT As 'CARTE CREDIT', TELE AS 'MOBILE MONEY', main_Courante_autres.NUM_RESERVATION As 'RESERVATION', main_courante_autres.MONTANT_ACCORDE AS 'HEBERGEMENT', main_courante_autres.BAR_RESTAURANT AS 'BAR/RESTAURANT', BAR, main_courante_autres.SERVICES AS 'SERVICES', main_courante_autres.SALON_DE_BEAUTE AS 'SALON DE BEAUTE', main_courante_autres.BOUTIQE AS 'BOUTIQUE', main_courante_autres.CYBERCAFE As 'BUSINESS CENTER', main_courante_autres.SPORTS As 'SPORTS' , main_courante_autres.LOISIRS As 'LOISIRS', TOTAL_JOUR, main_courante_autres.KIOSQUE_A_JOURNAUX as 'JOURNAUX', main_courante_autres.BLANCHISSERIE As BLANCHISSERIE, main_courante_autres.AUTRES As 'AUTRES', TOTAL_JOUR As 'RECETTE DU JOUR', REPORT_VEILLE As 'REPORT VEILLE', TOTAL_GENERAL As 'TOTAL GENERAL', A_REPORTER As 'A REPORTER' FROM main_Courante_autres WHERE DATE_MAIN_COURANTE <= '" & DateStat.ToString("yyyy-MM-dd") & "' AND DATE_MAIN_COURANTE >='" & DateStat.ToString("yyyy-MM-dd") & "' ORDER BY main_courante_autres.NOM_CLIENT ASC"

                Dim command01 As New MySqlCommand(getUserQuery01, GlobalVariable.connect)

                'command1.Parameters.Add("@DATE_DU_JOUR", MySqlDbType.Date).Value = GlobalVariable.DateDeTravail
                'command1.Parameters.Add("@ETAT_MAIN_COURANTE", MySqlDbType.Int32).Value = 0
                'command1.Parameters.Add("@ETAT_MAIN_COURANTE", MySqlDbType.Int32).Value = 1
                command01.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = DocumentToGenerate

                Dim adapter01 As New MySqlDataAdapter(command01)

                Dim table0 As New DataTable()

                adapter01.Fill(table0)


                If table.Rows.Count > 0 Then

                    '------------------ FAILED COLUMNS -----------------

                    '2. ON DOIT FAIRE LA SOMME DES MAINCOURANTE POUR N'AVOIR QUE UNE SEULE DATE
                    '2.1 LES EN CAHMBRES

                    For i = 0 To table.Rows.Count - 1

                        Dim NUMERO_RESERVATION As String = table.Rows(i)("NUM_RESERVATION")

                        RESTAURANT += table.Rows(i)("PDJ") + table.Rows(i)("DEJEUNER") + table.Rows(i)("DINER")
                        BAR += table.Rows(i)("CAFE") + table.Rows(i)("CAVE") + table.Rows(i)("DIVERS")

                        PDJ += table.Rows(i)("PDJ")
                        DEJEUNER += table.Rows(i)("DEJEUNER")
                        DINER += table.Rows(i)("DINER")
                        BLANCHISSERIE += table.Rows(i)("BLANCHISSERIE")

                        RECETTE_DU_JOUR += table.Rows(i)("RECETTE DU JOUR")
                        'REPORT_VEILLE += table.Rows(i)("REPORT VEILLE")
                        'TOTAL_GENERAL += table.Rows(i)("TOTAL GENERAL")

                        ESPECES += table.Rows(i)("ESPECES")
                        CARTE_CREDIT += table.Rows(i)("CARTE CREDIT") + table.Rows(i)("CHEQUE")
                        MOBILE_MONEY += table.Rows(i)("MOBILE MONEY")
                        'A_REPORTER += table.Rows(i)("A REPORTER")
                        ARRHES += table.Rows(i)("ARRHES")

                        'Dim RESTAURANT As Double = table.Rows(i)("CAVE") + table.Rows(i)("DIVERS") + table.Rows(i)("CAFE")

                        AUTRES_VENTE += table.Rows(i)("SERVICES") + table.Rows(i)("SALON DE BEAUTE") + table.Rows(i)("BOUTIQUE") + table.Rows(i)("BUSINESS CENTER") + table.Rows(i)("SPORTS") + table.Rows(i)("LOISIRS") + table.Rows(i)("JOURNAUX") + table.Rows(i)("AUTRES")

                        Dim nuits As Integer = 0

                        Dim arrivee As Date = CDate(table.Rows(i)("DATE ARRIVEE")).ToShortDateString
                        Dim depart As Date = CDate(table.Rows(i)("DATE DEPART")).ToShortDateString

                        Dim dateTravail As Date = CDate(GlobalVariable.DateDeTravail).ToShortDateString
                        Dim dateMainCourante As Date = GlobalVariable.DateDeTravail.AddDays(-1).ToShortDateString

                        'taxeDeSejours += table.Rows(i)("TAXE DE SEJOUR")

                        Dim SERVICE As String = ""
                        If GlobalVariable.actualLanguageValue = 1 Then
                            SERVICE = "TAXE DE SEJOURS"
                        Else
                            SERVICE = "TOURIST TAX"
                        End If

                        taxeDeSejours += Functions.totalDunServiceUnCertainJourSpecifique(DateStat, SERVICE, table.Rows(i)("NUM_RESERVATION"))

                        'HEBERGEMENT += table.Rows(i)("HEBERGEMENT")

                        Dim HEBERGEMENT_ As Double = table.Rows(i)("HEBERGEMENT")
                        Dim taxeDeSejours_ As Double = table.Rows(i)("TAXE DE SEJOUR")

                        nuits = CType((depart - arrivee).TotalDays, Int64)

                        Dim PAX As Integer = table.Rows(i)("NBRE DE PAX")

                        If PAX <= 0 Then
                            PAX = 1
                        End If

                        If AUTRES_VENTE < 0 Then
                            AUTRES_VENTE = 0
                        End If

                        TOTAL_ENCAISSEMENT += table.Rows(i)("ESPECES") + table.Rows(i)("CARTE CREDIT") + table.Rows(i)("MOBILE MONEY") + table.Rows(i)("CHEQUE")

                    Next

                    'TOTAL_RECETTE = AUTRES_VENTE + HEBERGEMENT + RESTAURANT + BAR + BLANCHISSERIE

                    'MAINcourantes comptoires
                    For i = 0 To table0.Rows.Count - 1

                        RESTAURANT += table0.Rows(i)("PDJ") + table0.Rows(i)("DEJEUNER") + table0.Rows(i)("DINER")
                        BAR += table0.Rows(i)("CAFE") + table0.Rows(i)("CAVE") + table0.Rows(i)("DIVERS")
                        RECETTE_DU_JOUR += table0.Rows(i)("RECETTE DU JOUR")

                        PDJ += table0.Rows(i)("PDJ")
                        DEJEUNER += table0.Rows(i)("DEJEUNER")
                        DINER += table0.Rows(i)("DINER")
                        BLANCHISSERIE += table0.Rows(i)("BLANCHISSERIE")

                        AUTRES_VENTE += table0.Rows(i)("SERVICES") + table0.Rows(i)("SALON DE BEAUTE") + table0.Rows(i)("BOUTIQUE") + table0.Rows(i)("BUSINESS CENTER") + table0.Rows(i)("SPORTS") + table0.Rows(i)("LOISIRS") + table0.Rows(i)("JOURNAUX") + table0.Rows(i)("AUTRES")
                        BLANCHISSERIE += table0.Rows(i)("BLANCHISSERIE")
                        TOTAL_ENCAISSEMENT += table0.Rows(i)("ESPECES") + table0.Rows(i)("CARTE CREDIT") + table0.Rows(i)("MOBILE MONEY") + table0.Rows(i)("CHEQUE")

                        'REPORT_VEILLE += table0.Rows(i)("REPORT VEILLE")
                        'TOTAL_GENERAL += table0.Rows(i)("TOTAL GENERAL")

                        ESPECES += table0.Rows(i)("ESPECES")
                        CARTE_CREDIT += table0.Rows(i)("CARTE CREDIT") + table0.Rows(i)("CHEQUE")
                        MOBILE_MONEY += table0.Rows(i)("MOBILE MONEY")
                        'A_REPORTER += table0.Rows(i)("A REPORTER")
                        ARRHES += table0.Rows(i)("ARRHES")

                    Next

                    TOTAL_RECETTE = (AUTRES_VENTE + HEBERGEMENT + PDJ + DEJEUNER + DINER + BAR + BLANCHISSERIE + taxeDeSejours)
                    'TOTAL_GENERAL = TOTAL_RECETTE + A_REPORTER + REPORT_VEILLE
                    TOTAL_GENERAL = (TOTAL_RECETTE) + (REPORT_VEILLE * changerSigne)
                    TOTAL_ENCAISSEMENT = ESPECES + CARTE_CREDIT + MOBILE_MONEY
                    A_REPORTER = TOTAL_ENCAISSEMENT - TOTAL_GENERAL

                    RapportFacturesForm.DataGridViewRapports.Rows.Add(DateStat.ToShortDateString(), HEBERGEMENT, taxeDeSejours, PDJ, DEJEUNER, DINER, BAR, BLANCHISSERIE, AUTRES_VENTE, TOTAL_RECETTE, REPORT_VEILLE, TOTAL_GENERAL * changerSigne, ESPECES, CARTE_CREDIT, MOBILE_MONEY, A_REPORTER)

                    REPORT_VEILLE = A_REPORTER

                Else

                    'RapportFacturesForm.DataGridViewRapports.Visible = False
                    'RapportFacturesForm.DataGridViewRapports.Columns.Clear()

                End If

            Next

            If RapportFacturesForm.DataGridViewRapports.Rows.Count > 0 Then

                RapportFacturesForm.DataGridViewRapports.Columns("HEBERGEMENT").DefaultCellStyle.Format = "#,##0"
                RapportFacturesForm.DataGridViewRapports.Columns("HEBERGEMENT").DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight

                'RapportFacturesForm.DataGridViewRapports.Columns("NBRE_PAX").DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleCenter

                RapportFacturesForm.DataGridViewRapports.Columns("PDJ").DefaultCellStyle.Format = "#,##0"
                RapportFacturesForm.DataGridViewRapports.Columns("PDJ").DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight

                RapportFacturesForm.DataGridViewRapports.Columns("TAXE").DefaultCellStyle.Format = "#,##0"
                RapportFacturesForm.DataGridViewRapports.Columns("TAXE").DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight

                'RapportFacturesForm.DataGridViewRapports.Columns("NUITEE").DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleCenter

                RapportFacturesForm.DataGridViewRapports.Columns("DEJEUNER").DefaultCellStyle.Format = "#,##0"
                RapportFacturesForm.DataGridViewRapports.Columns("DEJEUNER").DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight

                RapportFacturesForm.DataGridViewRapports.Columns("DINER").DefaultCellStyle.Format = "#,##0"
                RapportFacturesForm.DataGridViewRapports.Columns("DINER").DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight

                RapportFacturesForm.DataGridViewRapports.Columns("BAR").DefaultCellStyle.Format = "#,##0"
                RapportFacturesForm.DataGridViewRapports.Columns("BAR").DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight

                RapportFacturesForm.DataGridViewRapports.Columns("ESPECES").DefaultCellStyle.Format = "#,##0"
                RapportFacturesForm.DataGridViewRapports.Columns("ESPECES").DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight

                RapportFacturesForm.DataGridViewRapports.Columns("CARTE").DefaultCellStyle.Format = "#,##0"
                RapportFacturesForm.DataGridViewRapports.Columns("CARTE").DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight

                RapportFacturesForm.DataGridViewRapports.Columns("MOBILE_MONEY").DefaultCellStyle.Format = "#,##0"
                RapportFacturesForm.DataGridViewRapports.Columns("MOBILE_MONEY").DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight

                RapportFacturesForm.DataGridViewRapports.Columns("BLANCHISSERIE").DefaultCellStyle.Format = "#,##0"
                RapportFacturesForm.DataGridViewRapports.Columns("BLANCHISSERIE").DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight

                RapportFacturesForm.DataGridViewRapports.Columns("RECETTE_DU_JOUR").DefaultCellStyle.Format = "#,##0"
                RapportFacturesForm.DataGridViewRapports.Columns("RECETTE_DU_JOUR").DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight

                RapportFacturesForm.DataGridViewRapports.Columns("REPORT_VEILLE").DefaultCellStyle.Format = "#,##0"
                RapportFacturesForm.DataGridViewRapports.Columns("REPORT_VEILLE").DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight

                RapportFacturesForm.DataGridViewRapports.Columns("TOTAL_GENERAL").DefaultCellStyle.Format = "#,##0"
                RapportFacturesForm.DataGridViewRapports.Columns("TOTAL_GENERAL").DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight

                RapportFacturesForm.DataGridViewRapports.Columns("A_REPORTER").DefaultCellStyle.Format = "#,##0"
                RapportFacturesForm.DataGridViewRapports.Columns("A_REPORTER").DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight

                RapportFacturesForm.DataGridViewRapports.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.AllCells

            End If
            '--------------------------------------------------------------------------------------------------------------------


        End If

        'connect.closeConnection()

    End Sub

    Public Shared Sub docRapportMainCouranteMensuel(ByVal dt As DataGridView, ByVal dateMainCouranteDebut As Date,
                                                    ByVal dateMainCouranteFin As Date, Optional ByVal renvoie As Boolean = False)

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        If GlobalVariable.actualLanguageValue = 1 Then
            titreFichier = "MAIN COURANTE CUMULE"
            tireDocument = titreFichier & Chr(13) & " DU " & dateMainCouranteDebut & " AU " & dateMainCouranteFin
        Else
            titreFichier = "CUMULATED FINANCIAL DAILY REPORT"
            tireDocument = titreFichier & Chr(13) & " OF " & dateMainCouranteDebut & " AU " & dateMainCouranteFin
        End If

        Dim fichier As String = ""
        Dim nomDuDossierRapport As String = "RAPPORTS\MAINCOURANTE_CUMULE"

        Dim filePathAndDirectory As String = ""

        filePathAndDirectory = GlobalVariable.AgenceActuelle.Rows(0)("CHEMIN_SAUVEGARDE_AUTO") & "\" & nomDuDossierRapport & "\" & dateMainCouranteDebut.ToString("ddMMyy")

        My.Computer.FileSystem.CreateDirectory(filePathAndDirectory)

        If Not renvoie Then

            If GlobalVariable.actualLanguageValue = 1 Then
                fichier = filePathAndDirectory & "\" & titreFichier & " DU " & GlobalVariable.DateDeTravail.AddDays(-1).ToString("ddMMyy") & ".pdf"
            Else
                fichier = filePathAndDirectory & "\" & titreFichier & " OF " & GlobalVariable.DateDeTravail.AddDays(-1).ToString("ddMMyy") & ".pdf"
            End If

        Else

            If GlobalVariable.actualLanguageValue = 1 Then
                fichier = filePathAndDirectory & "\" & titreFichier & " DU " & dateMainCouranteDebut.ToString("ddMMyy") & ".pdf"
            Else
                fichier = filePathAndDirectory & "\" & titreFichier & " OF " & dateMainCouranteDebut.ToString("ddMMyy") & ".pdf"
            End If

        End If

        If True Then

            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A3.Rotate, 20, 20, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(fichier, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim pdfTable As New PdfPTable(16) 'Number of columns
            pdfTable.TotalWidth = 1150.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single() = New Single() {10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 11.0F, 11.0F, 12.0F, 10.0F, 10.0F, 10.0F, 12.0F}
            pdfTable.SetWidths(widths)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            If GlobalVariable.actualLanguageValue = 1 Then

                pdfCell = New PdfPCell(New Paragraph("DATE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("HEBERG.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TAXE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PDEJ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEJ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DINER", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BAR", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BLANCHI.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("AUTRES", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("RECETTE JOUR", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("REPORT VEILLE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TOTAL GENERAL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ESPECES", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CARTE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("MOBILE MONEY", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("A REPORTER", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

            Else

                pdfCell = New PdfPCell(New Paragraph("DATE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ROOM RATE.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TAXES", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BFAST", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("LUNCH", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DINNER", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BAR", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("LAUNDRY", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("MISC.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("REVENUE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BROUGHT FORWARD", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("GROSSE REVENUE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CASH", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BANK CARD", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("MOBILE MONEY", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TO CARRY FORWARD", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

            End If

            Dim vertiPax As Integer = 0
            Dim vertiHebergement As Double = 0
            Dim vertiBar As Double = 0
            Dim vertiPDJ As Double = 0
            Dim vertiDEJ As Double = 0
            Dim vertiDinner As Double = 0
            Dim vertiBlanchisserie As Double = 0
            Dim vertiAutres As Double = 0
            Dim vertiRecetteJour As Double = 0
            Dim vertiReportVeille As Double = 0
            Dim vertiTotalGeneral As Double = 0
            Dim vertiEncaissementEspeces As Double = 0
            Dim vertiCarte As Double = 0
            Dim vertiMobile As Double = 0
            Dim vertiAReporter As Double = 0
            Dim vertiNmbreNuitee As Integer = 0
            Dim totalChanbre As Integer = 0
            Dim vertiTaxe As Integer = 0

            Dim nobreResa As Integer = 0

            If dt.Rows.Count > 0 Then

                nobreResa = dt.Rows.Count

                For i = 0 To dt.Rows.Count - 1

                    For j = 0 To dt.Columns.Count - 1

                        'ON NE DOIT TRAITER LA DERNIERE COLONNE CAR ELLE CONTIENT LE NUMERO DE RESERVATION
                        'UTILISE POUR AFFICHER LES INFORMATIONS DES CLIENTS SUR LA MAINCOURANTE

                        'If j < dt.Columns.Count - 1 Then

                        If j = 0 Then
                            pdfCell = New PdfPCell(New Paragraph(CDate(dt.Rows(i).Cells(j).Value.ToString).ToShortDateString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j > 0 Then
                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells(j).Value, "#,##0"), pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        End If

                        'pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                        pdfTable.AddCell(pdfCell)

                        If j = 1 Then
                            vertiHebergement += dt.Rows(i).Cells(j).Value
                        ElseIf j = 2 Then
                            vertiTaxe += dt.Rows(i).Cells(j).Value
                        ElseIf j = 3 Then
                            vertiPDJ += dt.Rows(i).Cells(j).Value
                        ElseIf j = 4 Then
                            vertiDEJ += dt.Rows(i).Cells(j).Value
                        ElseIf j = 5 Then
                            vertiDinner += dt.Rows(i).Cells(j).Value
                        ElseIf j = 6 Then
                            vertiBar += dt.Rows(i).Cells(j).Value
                        ElseIf j = 7 Then
                            vertiBlanchisserie += dt.Rows(i).Cells(j).Value
                        ElseIf j = 8 Then
                            vertiAutres += dt.Rows(i).Cells(j).Value
                        ElseIf j = 9 Then
                            vertiRecetteJour += dt.Rows(i).Cells(j).Value
                        ElseIf j = 10 Then
                            vertiReportVeille += dt.Rows(i).Cells(j).Value
                        ElseIf j = 11 Then
                            vertiTotalGeneral += dt.Rows(i).Cells(j).Value
                        ElseIf j = 12 Then
                            vertiEncaissementEspeces += dt.Rows(i).Cells(j).Value
                        ElseIf j = 13 Then
                            vertiCarte += dt.Rows(i).Cells(j).Value
                        ElseIf j = 14 Then
                            vertiMobile += dt.Rows(i).Cells(j).Value
                        ElseIf j = 15 Then
                            vertiAReporter += dt.Rows(i).Cells(j).Value
                        End If

                        'End If

                    Next

                Next

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.Border = 0
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiHebergement, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiTaxe, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiPDJ, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiDEJ, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiDinner, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiBar, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiBlanchisserie, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiAutres, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiRecetteJour, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiReportVeille, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiTotalGeneral, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiEncaissementEspeces, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiCarte, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiMobile, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiAReporter, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY

                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

                If Not GlobalVariable.AncienneMainCourante Then

                    '--------------------------------- en chambre -----------------------------------------------
                    Dim enChambre As Double = 0

                    Dim query As String = "SELECT CHAMBRE_ID AS 'CHAMBRE', NOM_CLIENT As 'NOM CLIENT', DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',ETAT_NOTE_RESERVATION AS 'STATUT',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_ENTTRE <= '" & dateMainCouranteDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & dateMainCouranteDebut.ToString("yyyy-MM-dd") & "' AND DAY_USE = @DAY_USE AND TYPE=@TYPE ORDER BY CHAMBRE_ID ASC"

                    Dim command As New MySqlCommand(query, GlobalVariable.connect)
                    command.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle
                    command.Parameters.Add("@DAY_USE", MySqlDbType.Int64).Value = 0

                    Dim adapter As New MySqlDataAdapter(command)
                    Dim table As New DataTable()
                    adapter.Fill(table)

                    If table.Rows.Count > 0 Then
                        enChambre = table.Rows.Count
                    End If
                    '--------------------------------------------------------------------------------------------

                    '--------------------------------- depart ---------------------------------------------------
                    Dim depart As Double = 0

                    Dim query1 As String = "SELECT NOM_CLIENT As 'NOM CLIENT', CHAMBRE_ID AS 'CHAMBRE',DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',ETAT_NOTE_RESERVATION AS 'STATUT',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_SORTIE >= '" & dateMainCouranteDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE <='" & dateMainCouranteDebut.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND DAY_USE = @DAY_USE ORDER BY CHAMBRE_ID ASC"

                    Dim command1 As New MySqlCommand(query1, GlobalVariable.connect)
                    command1.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle
                    command1.Parameters.Add("@DAY_USE", MySqlDbType.Int64).Value = 0

                    Dim adapter1 As New MySqlDataAdapter(command1)
                    Dim table1 As New DataTable()
                    adapter1.Fill(table1)

                    If (table1.Rows.Count > 0) Then
                        depart = table1.Rows.Count
                    End If
                    '--------------------------------------------------------------------------------------------

                    '*****-------------------------------INSERTION DES NOUVELLES INFORMATIONS --------------------------------------------------------

                    ' ----------------------------------------- TWO TABLES INTO A MAIN TABLE --------------------------------------------------
                    Dim mtable As PdfPTable = New PdfPTable(2)
                    mtable.TotalWidth = 1120.0F
                    Dim widthsmtable As Single() = New Single() {60.0F, 40.0F}
                    mtable.SetWidths(widthsmtable)
                    mtable.WidthPercentage = 100
                    mtable.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

                    Dim tableLeft As PdfPTable = New PdfPTable(1)
                    tableLeft.WidthPercentage = 100
                    tableLeft.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

                    Dim tableRight As PdfPTable = New PdfPTable(1)
                    tableRight.WidthPercentage = 100
                    tableRight.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

                    Dim rooms As New Room()

                    Dim HSRooms As Integer = rooms.HSRoomsOnly().Rows.Count
                    Dim roomsOnly As Integer = rooms.roomsOnly().Rows.Count

                    Dim occupe As Integer = enChambre - depart

                    Dim vendable As Integer = roomsOnly - HSRooms
                    Dim disponible As Integer = vendable - occupe

                    If GlobalVariable.actualLanguageValue = 1 Then

                        Dim p1 As Paragraph = New Paragraph(Chr(13) & "STATISTIQUES" & Chr(13) & Chr(13))
                        p1.Alignment = Element.ALIGN_CENTER
                        pdfDoc.Add(p1)

                    Else

                        Dim p1 As Paragraph = New Paragraph(Chr(13) & "STATISTICS" & Chr(13) & Chr(13))
                        p1.Alignment = Element.ALIGN_CENTER
                        pdfDoc.Add(p1)

                    End If

                    '------------------------------------------------  LEFT TABLE--------------------------------------------------------------------------

                    Dim pdfTable1 As New PdfPTable(6) 'Number of columns
                    'pdfTable1.TotalWidth = 1120.0F
                    pdfTable1.TotalWidth = 700.0F
                    pdfTable1.LockedWidth = True
                    pdfTable1.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable1.HeaderRows = 1
                    'pdfTable1.WidthPercentage = 100
                    Dim widths1 As Single() = New Single() {10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F}
                    pdfTable1.SetWidths(widths1)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("TAUX D'OCCUPATION SANS CHAMBRES HORS SERVICES : " & Format(occupe * 100 / vendable, "#,##0.00") & " %", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("HOTEL OCCUPATION RATE EXCLUDING ROOMS OUT OF ORDER : " & Format(occupe * 100 / vendable, "#,##0.00") & " %", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)


                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("TAUX D'OCCUPATION AVEC CHAMBRES HORS SERVICES : " & Format(occupe * 100 / roomsOnly, "#,##0.00") & " %", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("HOTEL OCCUPATION RATE INCLUDING ROOMS OUT OF ORDER : " & Format(occupe * 100 / roomsOnly, "#,##0.00") & " %", pColumn))

                    End If
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)


                    If GlobalVariable.actualLanguageValue = 1 Then

                        If occupe > 0 Then
                            pdfCell = New PdfPCell(New Paragraph("PRIX MOYENS : " & Format(vertiHebergement / occupe, "#,##0.0") & " " & societe.Rows(0)("CODE_MONNAIE"), pColumn))
                        Else
                            pdfCell = New PdfPCell(New Paragraph("PRIX MOYENS : " & Format(0, "#,##0.0") & " " & societe.Rows(0)("CODE_MONNAIE"), pColumn))
                        End If

                    Else

                        If occupe > 0 Then
                            pdfCell = New PdfPCell(New Paragraph("AVERAGE DAILY RATE : " & Format(vertiHebergement / occupe, "#,##0.0") & " " & societe.Rows(0)("CODE_MONNAIE"), pColumn))
                        Else
                            pdfCell = New PdfPCell(New Paragraph("AVERAGE DAILY RATE : " & Format(0, "#,##0.0") & " " & societe.Rows(0)("CODE_MONNAIE"), pColumn))
                        End If

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)
                    '-----------------------------------------

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("CHAMBRES VENDUES", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("SOLD ROOMS", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("CHAMBRE DISPONIBLE", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("AVAILABLE ROOMS", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("CHAMBRES HORS SERVICES", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("ROOMS OUT OF ORDER", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(occupe & " / " & vendable, pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(disponible & " / " & vendable, pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(HSRooms & " / " & roomsOnly, pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 6
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 6
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)

                    tableLeft.AddCell(pdfTable1)

                    '------------------------------------------------------- RIGHT TABLE --------------------------------

                    Dim dateState As Date = GlobalVariable.DateDeTravail.ToShortDateString

                    'Dim DateDebutStat As Date = Functions.firstDayOfMonth(dateState)
                    'Dim DateFinStat As Date = Functions.lastDayOfMonth(dateState)

                    Dim DateDebutStat As Date = dateMainCouranteDebut.ToShortDateString
                    Dim DateFinStat As Date = dateMainCouranteFin.ToShortDateString

                    Dim pdfTable2 As New PdfPTable(3) 'Number of columns
                    pdfTable.TotalWidth = 260.0F
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.HeaderRows = 1

                    pdfTable2.WidthPercentage = 100
                    Dim widths2 As Single() = New Single() {25.0F, 25.0F, 25.0F}

                    pdfTable2.SetWidths(widths2)

                    pdfCell = New PdfPCell(New Paragraph("CAISSE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    pdfCell.Colspan = 3
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable2.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("MODE REGLEMENT", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable2.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("DU JOUR", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable2.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("DEPUIS LE DBUT DU MOIS", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable2.AddCell(pdfCell)

                    Dim getModeReglement = "SELECT DISTINCT MODE_REGLEMENT FROM reglement WHERE `DATE_REGLEMENT` BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & DateFinStat.ToString("yyyy-MM-dd") & "' ORDER BY DATE_REGLEMENT DESC"

                    Dim commandModeReg As New MySqlCommand(getModeReglement, GlobalVariable.connect)

                    Dim adapterModeReg As New MySqlDataAdapter

                    Dim dtModeReg As New DataTable()

                    adapterModeReg.SelectCommand = commandModeReg
                    adapterModeReg.Fill(dtModeReg)

                    If dtModeReg.Rows.Count > 0 Then

                        Dim totalEncaissementJournalier As Double = 0
                        Dim totalEncaissementCumule As Double = 0

                        For i = 0 To dtModeReg.Rows.Count - 1

                            Dim getReglement = "SELECT * FROM reglement WHERE MODE_REGLEMENT =@MODE_REGLEMENT AND DATE_REGLEMENT BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & DateFinStat.ToString("yyyy-MM-dd") & "' AND IMPRIMER IN (0,1,2) ORDER BY DATE_REGLEMENT DESC"

                            Dim commandReg As New MySqlCommand(getReglement, GlobalVariable.connect)
                            commandReg.Parameters.Add("@MODE_REGLEMENT", MySqlDbType.VarChar).Value = dtModeReg.Rows(i)("MODE_REGLEMENT")

                            Dim adapterReg As New MySqlDataAdapter

                            Dim dtReg As New DataTable()
                            'Dim command As New MySqlCommand(query, GlobalVariable.connect)

                            adapterReg.SelectCommand = commandReg
                            adapterReg.Fill(dtReg)

                            If dtReg.Rows.Count > 0 Then

                                Dim montantModeReglemtJour As Double = 0
                                Dim montantModeReglemtCumule As Double = 0

                                For j = 0 To dtReg.Rows.Count - 1

                                    If dtReg.Rows(j)("DATE_REGLEMENT") = dateState.ToString("yyyy-MM-dd") Then
                                        montantModeReglemtJour += dtReg.Rows(j)("MONTANT_VERSE")
                                        totalEncaissementJournalier += dtReg.Rows(j)("MONTANT_VERSE")
                                    End If

                                    If dtReg.Rows(j)("MODE_REGLEMENT").Equals("Gratuitée") Or dtReg.Rows(j)("MODE_REGLEMENT").Equals("GRATUITEE") Then

                                        If Double.Parse(dtReg.Rows(j)("MONTANT_VERSE")) > 0 Then
                                            montantModeReglemtCumule += dtReg.Rows(j)("MONTANT_VERSE")
                                        End If

                                    Else
                                        montantModeReglemtCumule += dtReg.Rows(j)("MONTANT_VERSE")
                                    End If

                                    totalEncaissementCumule += dtReg.Rows(j)("MONTANT_VERSE")

                                Next

                                pdfCell = New PdfPCell(New Paragraph(dtModeReg.Rows(i)("MODE_REGLEMENT").ToString.ToUpper, pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfCell.MinimumHeight = 14
                                'pdfCell.Border = 0
                                'pdfCell.Rotation = 270
                                pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable2.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(montantModeReglemtJour, "#,##0"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 14
                                'pdfCell.Rotation = 270
                                'pdfCell.Border = 0
                                pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable2.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(montantModeReglemtCumule, "#,##0"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 14
                                'pdfCell.Border = 0
                                'pdfCell.Rotation = 270
                                pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable2.AddCell(pdfCell)

                            End If

                        Next

                        pdfCell = New PdfPCell(New Paragraph("TOTAL NET : ", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.Border = 0
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalEncaissementJournalier, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 0
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalEncaissementCumule, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.Border = 0
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("PRODUCTION", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.Border = 0
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(vertiRecetteJour, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 0
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 0
                        pdfTable2.AddCell(pdfCell)

                    End If

                    tableRight.AddCell(pdfTable2)

                    '----------------------------------------------------------------------------------------------------

                    Dim pdfTable2_ As New PdfPTable(3) 'Number of columns
                    pdfTable2_.TotalWidth = 260.0F
                    pdfTable2_.LockedWidth = True
                    pdfTable2_.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable2_.HeaderRows = 1

                    pdfTable2_.WidthPercentage = 100
                    Dim widths2_ As Single() = New Single() {25.0F, 25.0F, 25.0F}

                    pdfTable2_.SetWidths(widths2_)

                    'mtable.AddCell(tableLeft)

                    mtable.AddCell(pdfTable2_)

                    mtable.AddCell(tableRight)

                    pdfDoc.Add(mtable)

                    Dim pdfTable1_ As New PdfPTable(6) 'Number of columns
                    pdfTable1_.TotalWidth = 1120.0F
                    pdfTable1_.LockedWidth = True
                    pdfTable1_.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable1_.HeaderRows = 1

                    Dim widths1_ As Single() = New Single() {10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F}
                    pdfTable1_.SetWidths(widths1_)


                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("SIGNATURE RECEPTION", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("RECEPTIONIST'S SIGNATURE", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1_.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("SIGNATURE CONTROLEUR", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("CONTROLLERS'S SIGNATURE", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1_.AddCell(pdfCell)


                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("SIGNATURE DIRECTEUR", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("MANAGER'S SIGNATURE", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1_.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("----------------", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1_.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("----------------", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1_.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("----------------", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1_.AddCell(pdfCell)

                    pdfDoc.Add(pdfTable1_)

                End If

                Dim dtRapport As DataTable = Functions.verificationExistenceCheminDesRapportsDuJours(GlobalVariable.DateDeTravail.AddDays(-1))

                If dtRapport.Rows.Count > 0 Then
                    Dim ID_RAPPORT = dtRapport.Rows(0)("ID_RAPPORT")
                    updateOfFields("rapport_auto", "CHEMIN_MAINCOURANTE_CUMUL", fichier, "ID_RAPPORT", ID_RAPPORT, 2)
                End If

                pdfDoc.Close()

            End If

        End If

    End Sub

    Public Shared Sub RapportMainCouranteMensuel(ByVal dt As DataGridView, ByVal dateMainCouranteDebut As Date, ByVal dateMainCouranteFin As Date)

        'CHAMBRE', NUM_RESERVATION As 'RESERVATION', MONTANT_ACCORDE AS 'MONTANT',BAR_RESTAURANT AS 'BAR/RESTAURANT', SERVICES,SALON_DE_BEAUTE AS 'SALON DE BEAUTE', BOUTIQE AS 'BOUTIQUE', CYBERCAFE, AUTRES

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        If GlobalVariable.actualLanguageValue = 1 Then
            titreFichier = "MAIN COURANTE CUMULE"
            tireDocument = titreFichier & Chr(13) & " DU " & dateMainCouranteDebut & " AU " & dateMainCouranteFin

        Else
            titreFichier = "CUMULATED FINANCIAL DAILY REPORT"
            tireDocument = titreFichier & Chr(13) & " OF " & dateMainCouranteDebut & " AU " & dateMainCouranteFin

        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then

            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A3.Rotate, 20, 20, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim pdfTable As New PdfPTable(16) 'Number of columns
            pdfTable.TotalWidth = 1150.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single() = New Single() {10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 11.0F, 11.0F, 12.0F, 10.0F, 10.0F, 10.0F, 12.0F}
            pdfTable.SetWidths(widths)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            If GlobalVariable.actualLanguageValue = 1 Then

                pdfCell = New PdfPCell(New Paragraph("DATE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("HEBERG.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TAXE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PDEJ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEJ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DINER", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BAR", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BLANCHI.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("AUTRES", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("RECETTE JOUR", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("REPORT VEILLE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TOTAL GENERAL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ESPECES", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CARTE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("MOBILE MONEY", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("A REPORTER", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

            Else

                pdfCell = New PdfPCell(New Paragraph("DATE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ROOM RATE.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TAXES", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BFAST", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("LUNCH", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DINNER", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BAR", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("LAUNDRY", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("MISC.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("REVENUE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BROUGHT FORWARD", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("GROSSE REVENUE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CASH", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BANK CARD", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("MOBILE MONEY", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TO CARRY FORWARD", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

            End If

            Dim vertiPax As Integer = 0
            Dim vertiHebergement As Double = 0
            Dim vertiBar As Double = 0
            Dim vertiPDJ As Double = 0
            Dim vertiDEJ As Double = 0
            Dim vertiDinner As Double = 0
            Dim vertiBlanchisserie As Double = 0
            Dim vertiAutres As Double = 0
            Dim vertiRecetteJour As Double = 0
            Dim vertiReportVeille As Double = 0
            Dim vertiTotalGeneral As Double = 0
            Dim vertiEncaissementEspeces As Double = 0
            Dim vertiCarte As Double = 0
            Dim vertiMobile As Double = 0
            Dim vertiAReporter As Double = 0
            Dim vertiNmbreNuitee As Integer = 0
            Dim totalChanbre As Integer = 0
            Dim vertiTaxe As Integer = 0

            Dim nobreResa As Integer = 0

            If dt.Rows.Count > 0 Then

                nobreResa = dt.Rows.Count

                For i = 0 To dt.Rows.Count - 1

                    For j = 0 To dt.Columns.Count - 1

                        'ON NE DOIT TRAITER LA DERNIERE COLONNE CAR ELLE CONTIENT LE NUMERO DE RESERVATION
                        'UTILISE POUR AFFICHER LES INFORMATIONS DES CLIENTS SUR LA MAINCOURANTE

                        'If j < dt.Columns.Count - 1 Then

                        If j = 0 Then
                            pdfCell = New PdfPCell(New Paragraph(CDate(dt.Rows(i).Cells(j).Value.ToString).ToShortDateString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j > 0 Then
                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells(j).Value, "#,##0"), pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        End If

                        'pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                        pdfTable.AddCell(pdfCell)

                        If j = 1 Then
                            vertiHebergement += dt.Rows(i).Cells(j).Value
                        ElseIf j = 2 Then
                            vertiTaxe += dt.Rows(i).Cells(j).Value
                        ElseIf j = 3 Then
                            vertiPDJ += dt.Rows(i).Cells(j).Value
                        ElseIf j = 4 Then
                            vertiDEJ += dt.Rows(i).Cells(j).Value
                        ElseIf j = 5 Then
                            vertiDinner += dt.Rows(i).Cells(j).Value
                        ElseIf j = 6 Then
                            vertiBar += dt.Rows(i).Cells(j).Value
                        ElseIf j = 7 Then
                            vertiBlanchisserie += dt.Rows(i).Cells(j).Value
                        ElseIf j = 8 Then
                            vertiAutres += dt.Rows(i).Cells(j).Value
                        ElseIf j = 9 Then
                            vertiRecetteJour += dt.Rows(i).Cells(j).Value
                        ElseIf j = 10 Then
                            vertiReportVeille += dt.Rows(i).Cells(j).Value
                        ElseIf j = 11 Then
                            vertiTotalGeneral += dt.Rows(i).Cells(j).Value
                        ElseIf j = 12 Then
                            vertiEncaissementEspeces += dt.Rows(i).Cells(j).Value
                        ElseIf j = 13 Then
                            vertiCarte += dt.Rows(i).Cells(j).Value
                        ElseIf j = 14 Then
                            vertiMobile += dt.Rows(i).Cells(j).Value
                        ElseIf j = 15 Then
                            vertiAReporter += dt.Rows(i).Cells(j).Value
                        End If

                        'End If

                    Next

                Next

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.Border = 0
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiHebergement, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiTaxe, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfCell.Rotation = 270
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiPDJ, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiDEJ, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiDinner, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiBar, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiBlanchisserie, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiAutres, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiRecetteJour, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiReportVeille, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiTotalGeneral, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiEncaissementEspeces, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiCarte, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiMobile, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(vertiAReporter, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.Rotation = 270
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY

                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

                If Not GlobalVariable.AncienneMainCourante Then

                    '--------------------------------- en chambre -----------------------------------------------
                    Dim enChambre As Double = 0

                    Dim query As String = "SELECT CHAMBRE_ID AS 'CHAMBRE', NOM_CLIENT As 'NOM CLIENT', DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',ETAT_NOTE_RESERVATION AS 'STATUT',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_ENTTRE <= '" & dateMainCouranteDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & dateMainCouranteDebut.ToString("yyyy-MM-dd") & "' AND DAY_USE = @DAY_USE AND TYPE=@TYPE ORDER BY CHAMBRE_ID ASC"

                    Dim command As New MySqlCommand(query, GlobalVariable.connect)
                    command.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle
                    command.Parameters.Add("@DAY_USE", MySqlDbType.Int64).Value = 0

                    Dim adapter As New MySqlDataAdapter(command)
                    Dim table As New DataTable()
                    adapter.Fill(table)

                    If table.Rows.Count > 0 Then
                        enChambre = table.Rows.Count
                    End If
                    '--------------------------------------------------------------------------------------------

                    '--------------------------------- depart ---------------------------------------------------
                    Dim depart As Double = 0

                    Dim query1 As String = "SELECT NOM_CLIENT As 'NOM CLIENT', CHAMBRE_ID AS 'CHAMBRE',DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',ETAT_NOTE_RESERVATION AS 'STATUT',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_SORTIE >= '" & dateMainCouranteDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE <='" & dateMainCouranteDebut.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND DAY_USE = @DAY_USE ORDER BY CHAMBRE_ID ASC"

                    Dim command1 As New MySqlCommand(query1, GlobalVariable.connect)
                    command1.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle
                    command1.Parameters.Add("@DAY_USE", MySqlDbType.Int64).Value = 0

                    Dim adapter1 As New MySqlDataAdapter(command1)
                    Dim table1 As New DataTable()
                    adapter1.Fill(table1)

                    If (table1.Rows.Count > 0) Then
                        depart = table1.Rows.Count
                    End If
                    '--------------------------------------------------------------------------------------------

                    '*****-------------------------------INSERTION DES NOUVELLES INFORMATIONS --------------------------------------------------------

                    ' ----------------------------------------- TWO TABLES INTO A MAIN TABLE --------------------------------------------------
                    Dim mtable As PdfPTable = New PdfPTable(2)
                    mtable.TotalWidth = 1120.0F
                    Dim widthsmtable As Single() = New Single() {60.0F, 40.0F}
                    mtable.SetWidths(widthsmtable)
                    mtable.WidthPercentage = 100
                    mtable.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

                    Dim tableLeft As PdfPTable = New PdfPTable(1)
                    tableLeft.WidthPercentage = 100
                    tableLeft.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

                    Dim tableRight As PdfPTable = New PdfPTable(1)
                    tableRight.WidthPercentage = 100
                    tableRight.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

                    Dim rooms As New Room()

                    Dim HSRooms As Integer = rooms.HSRoomsOnly().Rows.Count
                    Dim roomsOnly As Integer = rooms.roomsOnly().Rows.Count

                    Dim occupe As Integer = enChambre - depart

                    Dim vendable As Integer = roomsOnly - HSRooms
                    Dim disponible As Integer = vendable - occupe

                    If GlobalVariable.actualLanguageValue = 1 Then

                        Dim p1 As Paragraph = New Paragraph(Chr(13) & "STATISTIQUES" & Chr(13) & Chr(13))
                        p1.Alignment = Element.ALIGN_CENTER
                        pdfDoc.Add(p1)

                    Else

                        Dim p1 As Paragraph = New Paragraph(Chr(13) & "STATISTICS" & Chr(13) & Chr(13))
                        p1.Alignment = Element.ALIGN_CENTER
                        pdfDoc.Add(p1)

                    End If

                    '------------------------------------------------  LEFT TABLE--------------------------------------------------------------------------

                    Dim pdfTable1 As New PdfPTable(6) 'Number of columns
                    'pdfTable1.TotalWidth = 1120.0F
                    pdfTable1.TotalWidth = 700.0F
                    pdfTable1.LockedWidth = True
                    pdfTable1.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable1.HeaderRows = 1
                    'pdfTable1.WidthPercentage = 100
                    Dim widths1 As Single() = New Single() {10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F}
                    pdfTable1.SetWidths(widths1)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("TAUX D'OCCUPATION SANS CHAMBRES HORS SERVICES : " & Format(occupe * 100 / vendable, "#,##0.00") & " %", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("HOTEL OCCUPATION RATE EXCLUDING ROOMS OUT OF ORDER : " & Format(occupe * 100 / vendable, "#,##0.00") & " %", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)


                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("TAUX D'OCCUPATION AVEC CHAMBRES HORS SERVICES : " & Format(occupe * 100 / roomsOnly, "#,##0.00") & " %", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("HOTEL OCCUPATION RATE INCLUDING ROOMS OUT OF ORDER : " & Format(occupe * 100 / roomsOnly, "#,##0.00") & " %", pColumn))

                    End If
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)


                    If GlobalVariable.actualLanguageValue = 1 Then

                        If occupe > 0 Then
                            pdfCell = New PdfPCell(New Paragraph("PRIX MOYENS : " & Format(vertiHebergement / occupe, "#,##0.0") & " " & societe.Rows(0)("CODE_MONNAIE"), pColumn))
                        Else
                            pdfCell = New PdfPCell(New Paragraph("PRIX MOYENS : " & Format(0, "#,##0.0") & " " & societe.Rows(0)("CODE_MONNAIE"), pColumn))
                        End If

                    Else

                        If occupe > 0 Then
                            pdfCell = New PdfPCell(New Paragraph("AVERAGE DAILY RATE : " & Format(vertiHebergement / occupe, "#,##0.0") & " " & societe.Rows(0)("CODE_MONNAIE"), pColumn))
                        Else
                            pdfCell = New PdfPCell(New Paragraph("AVERAGE DAILY RATE : " & Format(0, "#,##0.0") & " " & societe.Rows(0)("CODE_MONNAIE"), pColumn))
                        End If

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)
                    '-----------------------------------------

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("CHAMBRES VENDUES", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("SOLD ROOMS", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("CHAMBRE DISPONIBLE", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("AVAILABLE ROOMS", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("CHAMBRES HORS SERVICES", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("ROOMS OUT OF ORDER", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(occupe & " / " & vendable, pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(disponible & " / " & vendable, pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(HSRooms & " / " & roomsOnly, pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 6
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 6
                    pdfCell.Border = 0
                    pdfTable1.AddCell(pdfCell)

                    tableLeft.AddCell(pdfTable1)

                    '------------------------------------------------------- RIGHT TABLE --------------------------------

                    Dim dateState As Date = GlobalVariable.DateDeTravail.ToShortDateString

                    'Dim DateDebutStat As Date = Functions.firstDayOfMonth(dateState)
                    'Dim DateFinStat As Date = Functions.lastDayOfMonth(dateState)

                    Dim DateDebutStat As Date = dateMainCouranteDebut.ToShortDateString
                    Dim DateFinStat As Date = dateMainCouranteFin.ToShortDateString

                    Dim pdfTable2 As New PdfPTable(3) 'Number of columns
                    pdfTable.TotalWidth = 260.0F
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.HeaderRows = 1

                    pdfTable2.WidthPercentage = 100
                    Dim widths2 As Single() = New Single() {25.0F, 25.0F, 25.0F}

                    pdfTable2.SetWidths(widths2)

                    pdfCell = New PdfPCell(New Paragraph("CAISSE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    pdfCell.Colspan = 3
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable2.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("MODE REGLEMENT", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable2.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("DU JOUR", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable2.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("DEPUIS LE DBUT DU MOIS", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable2.AddCell(pdfCell)

                    Dim getModeReglement = "SELECT DISTINCT MODE_REGLEMENT FROM reglement WHERE `DATE_REGLEMENT` BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & DateFinStat.ToString("yyyy-MM-dd") & "' ORDER BY DATE_REGLEMENT DESC"

                    Dim commandModeReg As New MySqlCommand(getModeReglement, GlobalVariable.connect)

                    Dim adapterModeReg As New MySqlDataAdapter

                    Dim dtModeReg As New DataTable()

                    adapterModeReg.SelectCommand = commandModeReg
                    adapterModeReg.Fill(dtModeReg)

                    If dtModeReg.Rows.Count > 0 Then

                        Dim totalEncaissementJournalier As Double = 0
                        Dim totalEncaissementCumule As Double = 0

                        For i = 0 To dtModeReg.Rows.Count - 1

                            Dim getReglement = "SELECT * FROM reglement WHERE MODE_REGLEMENT =@MODE_REGLEMENT AND DATE_REGLEMENT BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & DateFinStat.ToString("yyyy-MM-dd") & "' AND IMPRIMER IN (0,1,2) ORDER BY DATE_REGLEMENT DESC"

                            Dim commandReg As New MySqlCommand(getReglement, GlobalVariable.connect)
                            commandReg.Parameters.Add("@MODE_REGLEMENT", MySqlDbType.VarChar).Value = dtModeReg.Rows(i)("MODE_REGLEMENT")

                            Dim adapterReg As New MySqlDataAdapter

                            Dim dtReg As New DataTable()
                            'Dim command As New MySqlCommand(query, GlobalVariable.connect)

                            adapterReg.SelectCommand = commandReg
                            adapterReg.Fill(dtReg)

                            If dtReg.Rows.Count > 0 Then

                                Dim montantModeReglemtJour As Double = 0
                                Dim montantModeReglemtCumule As Double = 0

                                For j = 0 To dtReg.Rows.Count - 1

                                    If dtReg.Rows(j)("DATE_REGLEMENT") = dateState.ToString("yyyy-MM-dd") Then
                                        montantModeReglemtJour += dtReg.Rows(j)("MONTANT_VERSE")
                                        totalEncaissementJournalier += dtReg.Rows(j)("MONTANT_VERSE")
                                    End If

                                    If dtReg.Rows(j)("MODE_REGLEMENT").Equals("Gratuitée") Or dtReg.Rows(j)("MODE_REGLEMENT").Equals("GRATUITEE") Then

                                        If Double.Parse(dtReg.Rows(j)("MONTANT_VERSE")) > 0 Then
                                            montantModeReglemtCumule += dtReg.Rows(j)("MONTANT_VERSE")
                                        End If

                                    Else
                                        montantModeReglemtCumule += dtReg.Rows(j)("MONTANT_VERSE")
                                    End If

                                    totalEncaissementCumule += dtReg.Rows(j)("MONTANT_VERSE")

                                Next

                                pdfCell = New PdfPCell(New Paragraph(dtModeReg.Rows(i)("MODE_REGLEMENT").ToString.ToUpper, pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfCell.MinimumHeight = 14
                                'pdfCell.Border = 0
                                'pdfCell.Rotation = 270
                                pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable2.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(montantModeReglemtJour, "#,##0"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 14
                                'pdfCell.Rotation = 270
                                'pdfCell.Border = 0
                                pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable2.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(montantModeReglemtCumule, "#,##0"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 14
                                'pdfCell.Border = 0
                                'pdfCell.Rotation = 270
                                pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable2.AddCell(pdfCell)

                            End If

                        Next

                        pdfCell = New PdfPCell(New Paragraph("TOTAL NET : ", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.Border = 0
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalEncaissementJournalier, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 0
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalEncaissementCumule, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.Border = 0
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("PRODUCTION", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.Border = 0
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(vertiRecetteJour, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 0
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 14
                        'pdfCell.Rotation = 270
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 0
                        pdfTable2.AddCell(pdfCell)

                    End If

                    tableRight.AddCell(pdfTable2)

                    '----------------------------------------------------------------------------------------------------

                    Dim pdfTable2_ As New PdfPTable(3) 'Number of columns
                    pdfTable2_.TotalWidth = 260.0F
                    pdfTable2_.LockedWidth = True
                    pdfTable2_.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable2_.HeaderRows = 1

                    pdfTable2_.WidthPercentage = 100
                    Dim widths2_ As Single() = New Single() {25.0F, 25.0F, 25.0F}

                    pdfTable2_.SetWidths(widths2_)

                    'mtable.AddCell(tableLeft)

                    mtable.AddCell(pdfTable2_)

                    mtable.AddCell(tableRight)

                    pdfDoc.Add(mtable)

                    Dim pdfTable1_ As New PdfPTable(6) 'Number of columns
                    pdfTable1_.TotalWidth = 1120.0F
                    pdfTable1_.LockedWidth = True
                    pdfTable1_.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable1_.HeaderRows = 1

                    Dim widths1_ As Single() = New Single() {10.0F, 10.0F, 10.0F, 10.0F, 10.0F, 10.0F}
                    pdfTable1_.SetWidths(widths1_)


                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("SIGNATURE RECEPTION", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("RECEPTIONIST'S SIGNATURE", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1_.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("SIGNATURE CONTROLEUR", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("CONTROLLERS'S SIGNATURE", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1_.AddCell(pdfCell)


                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("SIGNATURE DIRECTEUR", pColumn))

                    Else
                        pdfCell = New PdfPCell(New Paragraph("MANAGER'S SIGNATURE", pColumn))

                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1_.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("----------------", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1_.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("----------------", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 2
                    pdfTable1_.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("----------------", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable1_.AddCell(pdfCell)

                    pdfDoc.Add(pdfTable1_)

                End If

                pdfDoc.Close()


                If GlobalVariable.actualLanguageValue = 1 Then
                    MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                Else
                    MessageBox.Show("PDF successfully exported " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                End If

                Process.Start(sfd.FileName)

            Else

                MessageBox.Show("Aucune Ligne de Fatcure à imprimer!")

            End If

        End If

    End Sub

    Public Shared Sub miseAjoursHebergementetTaxeDeSejour()

        Dim updateQuery1 As String = ""
        If GlobalVariable.actualLanguageValue = 1 Then
            updateQuery1 = "UPDATE `ligne_facture` SET `TYPE_LIGNE_FACTURE`='TAXE DE SEJOURS' WHERE `FUSIONNEE`='TAXE DE SEJOURS' AND TYPE_LIGNE_FACTURE=''"
        Else
            updateQuery1 = "UPDATE `ligne_facture` SET `TYPE_LIGNE_FACTURE`='TOURIST TAX' WHERE `FUSIONNEE`='TOURIST TAX' AND TYPE_LIGNE_FACTURE=''"
        End If
        Dim command1 As New MySqlCommand(updateQuery1, GlobalVariable.connect)
        command1.ExecuteNonQuery()

        Dim updateQuery1_ As String = ""
        If GlobalVariable.actualLanguageValue = 1 Then
            updateQuery1_ = "UPDATE `ligne_facture` SET `TYPE_LIGNE_FACTURE`='HEBERGEMENT' WHERE `FUSIONNEE`='HEBERGEMENT' AND TYPE_LIGNE_FACTURE=''"
        Else
            updateQuery1_ = "UPDATE `ligne_facture` SET `TYPE_LIGNE_FACTURE`='ACCOMMODATION' WHERE `FUSIONNEE`='ACCOMMODATION' AND TYPE_LIGNE_FACTURE=''"
        End If
        Dim command1_ As New MySqlCommand(updateQuery1_, GlobalVariable.connect)
        command1_.ExecuteNonQuery()

        Dim updateQuery1_1 As String = ""
        If GlobalVariable.actualLanguageValue = 1 Then
            updateQuery1_1 = "UPDATE `ligne_facture` SET `TYPE_LIGNE_FACTURE`='LOCATION SALLE' WHERE `FUSIONNEE`='LOCATION SALLE' AND TYPE_LIGNE_FACTURE=''"
        Else
            updateQuery1_1 = "UPDATE `ligne_facture` SET `TYPE_LIGNE_FACTURE`='HALL RENTING' WHERE `FUSIONNEE`='HALL RENTING' AND TYPE_LIGNE_FACTURE=''"
        End If
        Dim command1_1 As New MySqlCommand(updateQuery1_1, GlobalVariable.connect)
        command1_1.ExecuteNonQuery()

        Dim updateQuery2 As String = ""
        If GlobalVariable.actualLanguageValue = 1 Then
            updateQuery2 = "UPDATE `ligne_facture` SET `TYPE_LIGNE_FACTURE`='HEBERGEMENT', `FUSIONNEE`='HEBERGEMENT' 
            WHERE `TYPE_LIGNE_FACTURE`='SERVICES' AND `LIBELLE_FACTURE` LIKE '%HEBERGEMENT%' AND TYPE_LIGNE_FACTURE=''"
        Else
            updateQuery2 = "UPDATE `ligne_facture` SET `TYPE_LIGNE_FACTURE`='ACCOMMODATION', `FUSIONNEE`='ACCOMMODATION' 
            WHERE `TYPE_LIGNE_FACTURE`='SERVICES' AND `LIBELLE_FACTURE` LIKE '%ACCOMMODATION%' AND TYPE_LIGNE_FACTURE=''"
        End If
        Dim command2 As New MySqlCommand(updateQuery2, GlobalVariable.connect)
        command2.ExecuteNonQuery()

        Dim updateQuery3 As String = ""
        If GlobalVariable.actualLanguageValue = 1 Then
            updateQuery3 = "UPDATE `ligne_facture` SET `TYPE_LIGNE_FACTURE`='LOCATION SALLE', `FUSIONNEE`='LOCATION SALLE'
             WHERE `TYPE_LIGNE_FACTURE`='SERVICES' And `LIBELLE_FACTURE` LIKE '%LOCATION SALLE%'"
        Else
            updateQuery3 = "UPDATE `ligne_facture` SET `TYPE_LIGNE_FACTURE`='HALL RENTING', `FUSIONNEE`='HALL RENTING'
            WHERE `TYPE_LIGNE_FACTURE`='SERVICES' AND `LIBELLE_FACTURE` LIKE '%HALL RENT%'"
        End If
        Dim command3 As New MySqlCommand(updateQuery3, GlobalVariable.connect)
        command3.ExecuteNonQuery()

        Dim updateQuery4 As String = ""
        If GlobalVariable.actualLanguageValue = 1 Then
            updateQuery4 = "UPDATE `ligne_facture` SET `TYPE_LIGNE_FACTURE`='TAXE DE SEJOURS', `FUSIONNEE`='TAXE DE SEJOURS'
            WHERE `TYPE_LIGNE_FACTURE`='SERVICES' AND `LIBELLE_FACTURE` LIKE '%TAXE DE SEJOUR%'"
        Else
            updateQuery4 = "UPDATE `ligne_facture` SET `TYPE_LIGNE_FACTURE`='TOURIST TAX', `FUSIONNEE`='TOURIST TAX'
            WHERE `TYPE_LIGNE_FACTURE`='SERVICES' AND `LIBELLE_FACTURE` LIKE '%TOURIST TAX%'"
        End If
        Dim command4 As New MySqlCommand(updateQuery4, GlobalVariable.connect)
        command4.ExecuteNonQuery()

        Dim updateQuery5 As String = ""
        If GlobalVariable.actualLanguageValue = 0 Then
            updateQuery5 = "UPDATE `ligne_facture` SET `TYPE_LIGNE_FACTURE` = 'TOURIST TAX', `FUSIONNEE` = 'TOURIST TAX' WHERE `FUSIONNEE` LIKE '%TAXE DE SEJOUR%'"
            Dim command5 As New MySqlCommand(updateQuery5, GlobalVariable.connect)

            command5.ExecuteNonQuery()
        End If

        Dim updateQuery6 As String = ""
        If GlobalVariable.actualLanguageValue = 0 Then
            updateQuery6 = "UPDATE `ligne_facture` SET `FUSIONNEE`='HEBERGEMENT' WHERE `TYPE_LIGNE_FACTURE`='HEBERGEMENT' And FUSIONNEE In ('')"
        Else
            updateQuery6 = "UPDATE `ligne_facture` SET `FUSIONNEE`='ACCOMMODATION' WHERE `TYPE_LIGNE_FACTURE`='ACCOMMODATION' And FUSIONNEE In ('')"
        End If
        Dim command6 As New MySqlCommand(updateQuery6, GlobalVariable.connect)
        command6.ExecuteNonQuery()

        Dim updateQuery7 As String = ""

        updateQuery7 = "UPDATE `ligne_facture` SET `FUSIONNEE` = 'DEJEUNER' WHERE `FUSIONNEE` LIKE '%DEJEUNER%' AND FUSIONNEE NOT IN ('PETIT DEJEUNER')"
        Dim command7 As New MySqlCommand(updateQuery7, GlobalVariable.connect)
        command7.ExecuteNonQuery()

    End Sub

    Public Shared Sub fabricationProforma(ByVal dt As DataGridView, ByVal client As String)

        '2klg

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0
        'Dim totalNormal As Double = 0
        Dim totalTVA As Double = 0
        Dim TAxeSejour As Double = 0
        Dim SoldeNet As Double = 0
        Dim TotalVersement As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        Dim exonere As Boolean = False

        tireDocument = "PROFORMA N° : "
        titreFichier = "PROFORMA DE "

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & client & " " & (Date.Now().ToString("ddMMyyHHmmss"))

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))

            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim Date_facture_reglement As Date = GlobalVariable.DateDeTravail

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & Chr(13) & tireDocument & Date.Now().ToString("ddMMyyHHmm") & Chr(13) & "DATE : " & Date_facture_reglement & Chr(13), pColumn)
            p10.Alignment = Element.ALIGN_LEFT

            pdfDoc.Add(p10)

            Dim termes As String = Chr(13) & "CLIENT : " & client & Chr(13) & Chr(13)
            pdfDoc.Add(New Paragraph(termes, pRow))

            Dim pdfTable_ As New PdfPTable(3) 'Number of columns
            pdfTable_.TotalWidth = 530.0F
            pdfTable_.LockedWidth = True
            pdfTable_.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable_.HeaderRows = 1

            Dim widths_ As Single() = New Single() {6.0F, 1.7F, 2.5F}

            pdfTable_.SetWidths(widths_)

            pdfCell = New PdfPCell(New Paragraph("DESIAGNTION", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable_.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable_.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("MONTANT", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable_.AddCell(pdfCell)

            Dim totalSejour As Double = 0

            Dim dateEntree As Date
            Dim dateSortie As Date

            Dim nbreNuitee As Integer = 0
            Dim nbreNuiteeTotal As Integer = 0

            Dim CODE_RESERVATION As String = ""

            For i = 0 To dt.Rows.Count - 1

                CODE_RESERVATION = dt.Rows(i).Cells("RESERVATION").Value.ToString
                dateEntree = CDate(dt.Rows(i).Cells("DATE ENTREE").Value.ToString).ToShortDateString
                dateSortie = CDate(dt.Rows(i).Cells("DATE SORTIE").Value.ToString).ToShortDateString
                nbreNuitee = CType((dateSortie - dateEntree).TotalDays, Int32)
                nbreNuiteeTotal += nbreNuitee
                totalSejour += nbreNuitee * dt.Rows(i).Cells("PRIX/NUITEE").Value

                Dim reglement As DataTable = Functions.getElementByCode(CODE_RESERVATION, "reglement", "CODE_RESERVATION")

                If reglement.Rows.Count > 0 Then

                    For j = 0 To reglement.Rows.Count - 1
                        TotalVersement += reglement.Rows(j)("MONTANT_VERSE")
                    Next

                End If

                Dim infoTaxe As DataTable = Functions.getElementByCode(CODE_RESERVATION, "taxe_sejour_collectee", "NUM_RESERVATION")

                If infoTaxe.Rows.Count > 0 Then

                    For j = 0 To infoTaxe.Rows.Count - 1
                        TAxeSejour += infoTaxe.Rows(j)("TAXE_SEJOUR_COLLECTEE") * nbreNuitee
                    Next

                End If

            Next

            pdfCell = New PdfPCell(New Paragraph("HEBERGEMENT", font1))
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfTable_.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(nbreNuiteeTotal, font1))
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfTable_.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(totalSejour * -1, "#,##0"), font1))
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable_.AddCell(pdfCell)

            If TotalVersement > 0 Then

                pdfCell = New PdfPCell(New Paragraph("DEPOSIT", font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfTable_.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(1, font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable_.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(TotalVersement, "#,##0"), font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable_.AddCell(pdfCell)

            End If

            If TAxeSejour > 0 Then

                pdfCell = New PdfPCell(New Paragraph("TAXE DE SEJOUR", font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfTable_.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable_.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(TAxeSejour * -1, "#,##0"), font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable_.AddCell(pdfCell)

            End If

            pdfDoc.Add(pdfTable_)

            '-------------------------------------------------------

            Dim termes_ As String = Chr(13) & " DEATAILS DU GROUPE " & Chr(13) & Chr(13)
            pdfDoc.Add(New Paragraph(termes_, pRow))

            Dim pdfTable As New PdfPTable(6) 'Number of columns
            pdfTable.TotalWidth = 530.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single() = New Single() {5.0F, 1.7F, 1.7F, 1.2F, 1.5F, 1.5F}

            pdfTable.SetWidths(widths)
            pdfCell = New PdfPCell(New Paragraph("NOM", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("NUITEES", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("TARIF", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            Dim montantAccorde As Double = 0

            For i = 0 To dt.Rows.Count - 1

                dateEntree = CDate(dt.Rows(i).Cells("DATE ENTREE").Value.ToString).ToShortDateString
                dateSortie = CDate(dt.Rows(i).Cells("DATE SORTIE").Value.ToString).ToShortDateString

                pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells("NOM CLIENT").Value.ToString, font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(dateEntree, font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(dateSortie, font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfTable.AddCell(pdfCell)

                montantAccorde = dt.Rows(i).Cells("PRIX/NUITEE").Value
                nbreNuitee = CType((dateSortie - dateEntree).TotalDays, Int32)
                totalSejour = nbreNuitee * montantAccorde

                pdfCell = New PdfPCell(New Paragraph(nbreNuitee, font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(montantAccorde, "#,##0"), font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(totalSejour, "#,##0"), font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable.AddCell(pdfCell)

                TotalFacture += totalSejour

            Next

            pdfDoc.Add(pdfTable)

            '------------------------------------------------------------------------

            '----------------------------- TOTAL HT -----------------------------------
            Dim pdfTable06 As New PdfPTable(4)

            pdfTable06.TotalWidth = 530.0F
            pdfTable06.LockedWidth = True
            pdfTable06.HorizontalAlignment = Element.ALIGN_RIGHT

            Dim widths06 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
            pdfTable06.SetWidths(widths06)

            Dim pdfCell06 As PdfPCell = Nothing

            '------------------------------ DEBUT RECAPITULATIF OU BILAN ------------------------------------

            pdfCell06 = New PdfPCell(New Paragraph("", fontTotal))
            pdfCell06.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell06.MinimumHeight = 18
            pdfCell06.PaddingLeft = 15.0F
            pdfCell06.Colspan = 4
            pdfCell06.Border = 0
            pdfTable06.AddCell(pdfCell06)

            pdfCell06 = New PdfPCell(New Paragraph("TOTAL : ", fontTotal))
            pdfCell06.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell06.MinimumHeight = 18
            pdfCell06.PaddingLeft = 15.0F
            pdfCell06.Colspan = 3
            pdfCell06.Border = 0
            pdfTable06.AddCell(pdfCell06)

            Dim TAXE_SEJOUR As Double = 0

            pdfCell06 = New PdfPCell(New Paragraph(Format(TotalFacture, "#,##0"), fontTotal))
            pdfCell06.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell06.MinimumHeight = 18
            pdfCell06.PaddingLeft = 5.0F
            pdfCell06.Border = 0
            pdfTable06.AddCell(pdfCell06)

            pdfDoc.Add(pdfTable06)

            '--------------------------------------------------------------------------

            If TAxeSejour >= 0 Then

                Dim pdfTable6 As New PdfPTable(4) 'Number of columns

                pdfTable6.TotalWidth = 530.0F
                pdfTable6.LockedWidth = True
                pdfTable6.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfTable4.HeaderRows = 1

                Dim widths6 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
                pdfTable6.SetWidths(widths6)

                Dim pdfCell6 As PdfPCell = Nothing

                pdfCell6 = New PdfPCell(New Paragraph("TAXE DE SEJOURS : ", fontTotal))
                pdfCell6.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell6.MinimumHeight = 18
                pdfCell6.PaddingLeft = 15.0F
                pdfCell6.Colspan = 3
                pdfCell6.Border = 0
                pdfTable6.AddCell(pdfCell6)

                'Dim TAXE_SEJOUR As Double = 0

                pdfCell6 = New PdfPCell(New Paragraph(Format(TAxeSejour, "#,##0"), fontTotal))
                pdfCell6.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell6.MinimumHeight = 18
                pdfCell6.PaddingLeft = 5.0F
                pdfCell6.Border = 0
                pdfTable6.AddCell(pdfCell6)

                pdfDoc.Add(pdfTable6)

            End If

            Dim pdfTable7 As New PdfPTable(4) 'Number of columns

            pdfTable7.TotalWidth = 530.0F
            pdfTable7.LockedWidth = True
            pdfTable7.HorizontalAlignment = Element.ALIGN_RIGHT
            'pdfTable7.HeaderRows = 1

            Dim widths7 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
            pdfTable7.SetWidths(widths7)

            Dim pdfCell7 As PdfPCell = Nothing

            SoldeNet = TotalVersement - (TotalFacture + TAxeSejour)

            Dim terme As String = ""

            If SoldeNet > 0 Then
                terme = "FAVEUR CLIENT : "
            ElseIf SoldeNet = 0 Then
                terme = "SOLDE NUL : "
            ElseIf 0 > SoldeNet Then
                terme = "A REGLER : "
            End If

            pdfCell7 = New PdfPCell(New Paragraph(terme, fontTotal))
            pdfCell7.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell7.MinimumHeight = 18
            pdfCell7.PaddingLeft = 15.0F
            pdfCell7.Colspan = 3
            pdfCell7.Border = 0
            pdfTable7.AddCell(pdfCell7)

            If SoldeNet < 0 Then
                'SoldeNet *= -1
            End If

            pdfCell7 = New PdfPCell(New Paragraph(Format(SoldeNet, "#,##0"), fontTotal))
            pdfCell7.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell7.MinimumHeight = 18
            pdfCell7.PaddingLeft = 5.0F
            pdfCell7.Border = 0
            pdfTable7.AddCell(pdfCell7)

            pdfDoc.Add(pdfTable7)

            '----------------------------------------

            Dim chiffreEnLettre = New Paragraph(Chr(13) & Chr(13) & "Arrêter la présente à la somme de: " & NBLT(TotalFacture + TAxeSejour) & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE"), pRow)

            pdfDoc.Add(chiffreEnLettre)

            Dim signature = New Paragraph(Chr(13) & Chr(13) & "             SIGNATURE DU CLIENT                                                            SIGNATURE DE L'HOTEL", pRow)

            pdfDoc.Add(signature)


            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub priseEnChargeDesConsommationsDuBarRestaurant(ByVal resa As DataTable)

        If resa IsNot Nothing Then

            If resa.Rows.Count > 0 Then

                Dim CODE_RESERVATION As String = resa.Rows(0)("CODE_RESERVATION")

                Dim CODE_RESERAVTION_DE_TETE As String = ""

                'ON DETERMINE SI LE BAR-RESTAURANT EST PRIS EN CHARGE
                'LA PRISE EN CHARGE DU BAR-RESTAU PEUT ETRE PRIS EN COMPTE DANS LES CADRES SUIVANTS :

                '1- PREMIER CAS : POUR INSTRUCTION DE ROUTAGE VERS UNE RESERVATION
                '2- DEUXIEME CAS : POUR UNE RESERVATION DE GROUP

                Dim GROUPE As String = resa.Rows(0)("GROUPE")

                If Not Trim(GROUPE).Equals("") Then
                    'PREMIER CAS
                    Dim infoGroupe As DataTable = Functions.GetAllElementsOnCondition(GROUPE, "reserve_conf", "GROUPE")

                    If infoGroupe.Rows.Count > 0 Then

                        '- ON RECHERCHE LA RESERVATION DE TETE : PETIT_DEJEUNER_ROUTAGE = 1

                        For j = 0 To infoGroupe.Rows.Count - 1

                            If infoGroupe.Rows(j)("PETIT_DEJEUNER_ROUTAGE") = 1 Then
                                CODE_RESERAVTION_DE_TETE = infoGroupe.Rows(j)("CODE_RESERVATION")
                            End If

                        Next

                    End If

                Else

                    '2EM CAS : 
                    Dim CHAMBRE As String = resa.Rows(0)("CHAMBRE_ROUTAGE")

                    If Not CHAMBRE.Equals("") Then
                        Dim dateDuJour As Date = GlobalVariable.DateDeTravail
                        Dim infoSupResa As DataTable = InfoDUnEnChambre(CHAMBRE, dateDuJour)

                        If infoSupResa IsNot Nothing Then

                            If infoSupResa.Rows.Count > 0 Then
                                CODE_RESERAVTION_DE_TETE = infoSupResa.Rows(0)("CODE_RESERVATION")
                            End If

                        End If

                    End If

                End If

                If Not Trim(CODE_RESERAVTION_DE_TETE).Equals("") Then

                    '- BASCULER TOUTES LES CONSOMMATIONS DE CODE_RESERVATION VERS CODE_RESERAVTION_DE_TETE
                    basculementDesChargesPriseEnChargeInstructionBarRestaurant(CODE_RESERVATION, CODE_RESERAVTION_DE_TETE)

                End If

            End If

        End If

    End Sub

    Public Shared Function InfoDUnEnChambre(ByVal CHAMBRE As String, ByVal dateDuJour As Date) As DataTable

        'Dim dateDuJour As Date = GlobalVariable.DateDeTravail.ToShortDateString

        Dim query01 As String = "SELECT * FROM reserve_conf WHERE DATE_ENTTRE <= '" & dateDuJour.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & dateDuJour.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 1 AND CHAMBRE_ID=@CHAMBRE_ID ORDER BY CHAMBRE_ID ASC"

        Dim command01 As New MySqlCommand(query01, GlobalVariable.connect)
        command01.Parameters.Add("@CHAMBRE_ID", MySqlDbType.VarChar).Value = CHAMBRE

        Dim adapter01 As New MySqlDataAdapter(command01)
        Dim table As New DataTable()
        adapter01.Fill(table)

        Return table

    End Function

    Public Shared Function enChambreParType(ByVal dateDU As Date, ByVal dateAu As Date, ByVal TYPE_CHAMBRE As String) As DataTable

        Dim query01 As String = "SELECT * FROM reserve_conf WHERE DATE_SORTIE > '" & dateDU.ToString("yyyy-MM-dd") & "' AND DATE_ENTTRE <='" & dateDU.ToString("yyyy-MM-dd") & "' AND TYPE_CHAMBRE=@TYPE_CHAMBRE AND TYPE=@TYPE AND DAY_USE = 0"

        Dim command01 As New MySqlCommand(query01, GlobalVariable.connect)
        command01.Parameters.Add("@TYPE_CHAMBRE", MySqlDbType.VarChar).Value = TYPE_CHAMBRE
        command01.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = "chambre"

        Dim adapter01 As New MySqlDataAdapter(command01)
        Dim table As New DataTable()
        adapter01.Fill(table)

        Return table

    End Function

    Public Shared Function enChambrePrixMoyen(ByVal dateDU As Date, ByVal dateAu As Date, ByVal TYPE_CHAMBRE As String) As Double

        Dim montantTotal As Double = 0

        Dim query01 As String = "SELECT * FROM reserve_conf WHERE DATE_SORTIE > '" & dateDU.ToString("yyyy-MM-dd") & "' AND DATE_ENTTRE <='" & dateDU.ToString("yyyy-MM-dd") & "' AND TYPE_CHAMBRE=@TYPE_CHAMBRE AND TYPE=@TYPE AND DAY_USE = 0"

        Dim command01 As New MySqlCommand(query01, GlobalVariable.connect)
        command01.Parameters.Add("@TYPE_CHAMBRE", MySqlDbType.VarChar).Value = TYPE_CHAMBRE
        command01.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = "chambre"

        Dim adapter01 As New MySqlDataAdapter(command01)
        Dim table As New DataTable()
        adapter01.Fill(table)

        For i = 0 To table.Rows.Count - 1
            montantTotal += table.Rows(i)("MONTANT_ACCORDE")
        Next

        Return montantTotal

    End Function

    Public Shared Function tauxOccupationJournalier(ByVal j As Integer, ByVal roomTypes As DataTable, ByVal dateStat As Date) As Double

        Dim roomType As String = ""

        Dim nbreChambreVendu As Integer = 0
        Dim nbreChambreTotalDuType As Integer = 0

        If j = 0 Then

            roomType = roomTypes.Rows(j)("CODE_TYPE_CHAMBRE")
            nbreChambreVendu = Functions.enChambreParType(dateStat, dateStat, roomType).Rows.Count

            Dim nombreDeChambreDUnCertainType As DataTable = Functions.getElementByCode(roomType, "chambre", "CODE_TYPE_CHAMBRE")

            If nombreDeChambreDUnCertainType.Rows.Count > 0 Then
                nbreChambreTotalDuType = nombreDeChambreDUnCertainType.Rows.Count
            Else
                Return 0
            End If

            If nbreChambreTotalDuType > 0 Then
                Return (nbreChambreVendu / nbreChambreTotalDuType) * 100
            Else
                Return 0
            End If

        ElseIf j = 1 Then

            roomType = roomTypes.Rows(j)("CODE_TYPE_CHAMBRE")
            nbreChambreVendu = Functions.enChambreParType(dateStat, dateStat, roomType).Rows.Count

            Dim nombreDeChambreDUnCertainType As DataTable = Functions.getElementByCode(roomType, "chambre", "CODE_TYPE_CHAMBRE")

            If nombreDeChambreDUnCertainType.Rows.Count > 0 Then
                nbreChambreTotalDuType = nombreDeChambreDUnCertainType.Rows.Count
            End If

            If nbreChambreTotalDuType > 0 Then
                Return (nbreChambreVendu / nbreChambreTotalDuType) * 100
            Else
                Return 0
            End If

        ElseIf j = 2 Then
            roomType = roomTypes.Rows(j)("CODE_TYPE_CHAMBRE")
            nbreChambreVendu = Functions.enChambreParType(dateStat, dateStat, roomType).Rows.Count

            Dim nombreDeChambreDUnCertainType As DataTable = Functions.getElementByCode(roomType, "chambre", "CODE_TYPE_CHAMBRE")

            If nombreDeChambreDUnCertainType.Rows.Count > 0 Then
                nbreChambreTotalDuType = nombreDeChambreDUnCertainType.Rows.Count
            End If

            If nbreChambreTotalDuType > 0 Then
                Return (nbreChambreVendu / nbreChambreTotalDuType) * 100
            Else
                Return 0
            End If
        ElseIf j = 3 Then
            roomType = roomTypes.Rows(j)("CODE_TYPE_CHAMBRE")
            nbreChambreVendu = Functions.enChambreParType(dateStat, dateStat, roomType).Rows.Count

            Dim nombreDeChambreDUnCertainType As DataTable = Functions.getElementByCode(roomType, "chambre", "CODE_TYPE_CHAMBRE")

            If nombreDeChambreDUnCertainType.Rows.Count > 0 Then
                nbreChambreTotalDuType = nombreDeChambreDUnCertainType.Rows.Count
            End If

            If nbreChambreTotalDuType > 0 Then
                Return (nbreChambreVendu / nbreChambreTotalDuType) * 100
            Else
                Return 0
            End If
        ElseIf j = 4 Then
            roomType = roomTypes.Rows(j)("CODE_TYPE_CHAMBRE")
            nbreChambreVendu = Functions.enChambreParType(dateStat, dateStat, roomType).Rows.Count

            Dim nombreDeChambreDUnCertainType As DataTable = Functions.getElementByCode(roomType, "chambre", "CODE_TYPE_CHAMBRE")

            If nombreDeChambreDUnCertainType.Rows.Count > 0 Then
                nbreChambreTotalDuType = nombreDeChambreDUnCertainType.Rows.Count
            End If

            If nbreChambreTotalDuType > 0 Then
                Return (nbreChambreVendu / nbreChambreTotalDuType) * 100
            Else
                Return 0
            End If
        ElseIf j = 5 Then

            roomType = roomTypes.Rows(j)("CODE_TYPE_CHAMBRE")
            nbreChambreVendu = Functions.enChambreParType(dateStat, dateStat, roomType).Rows.Count

            Dim nombreDeChambreDUnCertainType As DataTable = Functions.getElementByCode(roomType, "chambre", "CODE_TYPE_CHAMBRE")

            If nombreDeChambreDUnCertainType.Rows.Count > 0 Then
                nbreChambreTotalDuType = nombreDeChambreDUnCertainType.Rows.Count
            End If

            If nbreChambreTotalDuType > 0 Then
                Return (nbreChambreVendu / nbreChambreTotalDuType) * 100
            Else
                Return 0
            End If

        End If

    End Function

    Public Shared Function tauxOccupationDuMois(ByVal dateDebut As Date, Optional ByVal moisActuel As Integer = 0) As Double

        'moisActuel = 1 : Mois En cours
        'moisActuel = 0 : Mois Dernier

        Dim dateFin As Date

        If moisActuel = 1 Then

            dateFin = GlobalVariable.DateDeTravail.ToShortDateString
            dateDebut = Functions.firstDayOfMonth(dateDebut)

        Else

            dateDebut = dateDebut.AddMonths(-1)
            dateDebut = Functions.firstDayOfMonth(dateDebut)
            dateFin = Functions.lastDayOfMonth(dateDebut)

        End If

        Dim tauxOccupation As Double = 0

        Dim nombreDeJour As Integer = DateDiff(DateInterval.Day, dateDebut, dateFin)
        nombreDeJour += 1

        Dim roomTypes As DataTable = Functions.GetAllElementsOnCondition("chambre", "type_chambre", "TYPE")

        Dim TOJ_1 As Double = 0
        Dim TOJ_2 As Double = 0
        Dim TOJ_3 As Double = 0
        Dim TOJ_4 As Double = 0
        Dim TOJ_5 As Double = 0
        Dim TOJ_6 As Double = 0

        Dim nombreDeType As Integer = 1
        Dim cumulTotal As Double = 0

        If roomTypes.Rows.Count > 0 Then

            Dim cumul As Double = 0

            nombreDeType = roomTypes.Rows.Count

            For i = 0 To nombreDeJour

                cumul = 0

                Dim dateTOJ As Date = dateDebut.AddDays(i).ToShortDateString

                For j = 0 To roomTypes.Rows.Count - 1

                    If j = 0 Then
                        'TOJ_1 += tauxOccupationJournalier(j, roomTypes, dateTOJ)
                    ElseIf j = 1 Then
                        'TOJ_2 += tauxOccupationJournalier(j, roomTypes, dateTOJ)
                    ElseIf j = 2 Then
                        'TOJ_3 += tauxOccupationJournalier(j, roomTypes, dateTOJ)
                    ElseIf j = 3 Then
                        'TOJ_4 += tauxOccupationJournalier(j, roomTypes, dateTOJ)
                    ElseIf j = 4 Then
                        'TOJ_5 += tauxOccupationJournalier(j, roomTypes, dateTOJ)
                    ElseIf j = 5 Then
                        'TOJ_6 += tauxOccupationJournalier(j, roomTypes, dateTOJ)
                    End If

                    cumul += tauxOccupationJournalier(j, roomTypes, dateTOJ)

                Next

                cumulTotal += cumul / nombreDeType

            Next

            'tauxOccupation = TOJ_1 + TOJ_2 + TOJ_3 + TOJ_4 + TOJ_5 + TOJ_6

        End If

        If nombreDeJour > 0 Then

            Return cumulTotal / nombreDeJour
            'Return (tauxOccupation / nombreDeJour) / nombreDeType
        Else
            Return tauxOccupation
        End If

    End Function

    'POUR L'ENVOI DES LIENS GOOGLE MAP AU CLIENT AYANT RESERVE
    Public Shared Function listeDesReservationQuiRecevrontLeLienGoogleMap(ByVal date_de_travail As Date) As DataTable

        Dim DateDebut As Date = date_de_travail.AddDays(1).ToString("yyyy-MM-dd")

        Dim query As String = "SELECT CHAMBRE_ID AS 'CHAMBRE', NOM_CLIENT As 'NOM CLIENT', CLIENT_ID, CODE_RESERVATION, DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE',ETAT_NOTE_RESERVATION AS 'STATUT',NB_PERSONNES As 'PERSONNE(S)', GROUPE FROM reservation WHERE DATE_ENTTRE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_ENTTRE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 0 AND LIEN_GOOGLE_MAP = 0 ORDER BY CHAMBRE_ID ASC"

        Dim command As New MySqlCommand(query, GlobalVariable.connect)

        Dim adapter As New MySqlDataAdapter(command)
        Dim table As New DataTable()
        adapter.Fill(table)

        If (table.Rows.Count > 0) Then

            Return table

        End If

    End Function

    Public Shared Sub retablissementDesPictogrammeCorrecteDuDashBoard(ByVal DateDebut As Date)

        Dim rooms As DataTable = Functions.allTableFields("chambre")

        If rooms.Rows.Count > 0 Then

            For i = 0 To rooms.Rows.Count - 1

                Dim CHAMBRE_ID As String = rooms.Rows(i)("CODE_CHAMBRE")
                Dim ETAT_CHAMBRE_NOTE As String = rooms.Rows(i)("ETAT_CHAMBRE_NOTE")

                Dim query As String = "SELECT * FROM reserve_conf WHERE DATE_ENTTRE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 1 AND CHAMBRE_ID=@CHAMBRE_ID ORDER BY CHAMBRE_ID ASC"
                Dim command As New MySqlCommand(query, GlobalVariable.connect)

                command.Parameters.Add("@CHAMBRE_ID", MySqlDbType.VarChar).Value = CHAMBRE_ID
                Dim adapter As New MySqlDataAdapter(command)
                Dim table As New DataTable()
                adapter.Fill(table)

                Dim ETAT_CHAMBRE_NOTE_VALUE As String = ""

                If (table.Rows.Count > 0) Then

                    If ETAT_CHAMBRE_NOTE.Contains("propre") Then
                        ETAT_CHAMBRE_NOTE_VALUE = "Occupée propre"
                    Else
                        ETAT_CHAMBRE_NOTE_VALUE = "Occupée sale"
                    End If

                Else

                    If ETAT_CHAMBRE_NOTE.Contains("propre") Then
                        ETAT_CHAMBRE_NOTE_VALUE = "Libre propre"
                    Else
                        ETAT_CHAMBRE_NOTE_VALUE = "Libre sale"
                    End If

                End If

                If ETAT_CHAMBRE_NOTE.Contains("Libre") Or ETAT_CHAMBRE_NOTE.Contains("Occupée") Then
                    Functions.updateOfFields("chambre", "ETAT_CHAMBRE_NOTE", ETAT_CHAMBRE_NOTE_VALUE, "CODE_CHAMBRE", CHAMBRE_ID, 2)
                End If

            Next

        End If

    End Sub

    Public Shared Function reservationPayeeDujour(ByVal DateDebut As Date)

        Dim query As String = "SELECT * FROM reservation WHERE DATE_ENTTRE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 0 AND SOLDE_RESERVATION > 0"
        Dim command As New MySqlCommand(query, GlobalVariable.connect)

        'command.Parameters.Add("@CHAMBRE_ID", MySqlDbType.VarChar).Value = CHAMBRE_ID
        Dim adapter As New MySqlDataAdapter(command)
        Dim table As New DataTable()
        adapter.Fill(table)

        Return table

    End Function

    Public Shared Sub basculementDesChargesPriseEnChargeInstructionBarRestaurant(ByVal CODE_RESERAVTION As String, ByVal CODE_RESERAVTION_DE_TETE As String)



    End Sub

    'PERMET DE DETERMINER LES EN CHAMBRES D'UN JOUR PRECIS

    Public Shared Function enChambreDuJour(ByVal dateDuJour As Date)

        Dim query01 As String = "SELECT * FROM reserve_conf WHERE DATE_ENTTRE <= '" & dateDuJour.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & dateDuJour.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 1 ORDER BY CHAMBRE_ID ASC"

        Dim command01 As New MySqlCommand(query01, GlobalVariable.connect)

        Dim adapter01 As New MySqlDataAdapter(command01)
        Dim table As New DataTable()
        adapter01.Fill(table)

        Return table

    End Function

    Public Shared Function departEffectueDuJour(ByVal dateDuJour As Date)

        Dim query01 As String = "SELECT * FROM reserve_conf WHERE DATE_SORTIE <= '" & dateDuJour.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & dateDuJour.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 0 ORDER BY CHAMBRE_ID ASC"

        Dim command01 As New MySqlCommand(query01, GlobalVariable.connect)

        Dim adapter01 As New MySqlDataAdapter(command01)
        Dim table As New DataTable()
        adapter01.Fill(table)

        Return table

    End Function

    Public Shared Function checkInEffectueDuJour(ByVal dateDuJour As Date)

        Dim query01 As String = "SELECT * FROM reserve_conf WHERE DATE_ENTTRE <= '" & dateDuJour.ToString("yyyy-MM-dd") & "' 
        AND DATE_ENTTRE >='" & dateDuJour.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 1 ORDER BY CHAMBRE_ID ASC"

        Dim command01 As New MySqlCommand(query01, GlobalVariable.connect)

        Dim adapter01 As New MySqlDataAdapter(command01)
        Dim table As New DataTable()
        adapter01.Fill(table)

        Return table

    End Function

    Public Shared Function dayUseEffectueDuJour(ByVal dateDuJour As Date)

        Dim query01 As String = "SELECT * FROM reserve_conf WHERE DATE_ENTTRE <= '" & dateDuJour.ToString("yyyy-MM-dd") & "' 
        AND DATE_ENTTRE >='" & dateDuJour.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 1 AND DAY_USE = 1 ORDER BY CHAMBRE_ID ASC"

        Dim command01 As New MySqlCommand(query01, GlobalVariable.connect)

        Dim adapter01 As New MySqlDataAdapter(command01)
        Dim table As New DataTable()
        adapter01.Fill(table)

        Return table
    End Function

    Public Shared Function montantTotalDuModePeriodique(ByVal DateDebut As Date, ByVal DateFin As Date, ByVal MODE_REGLEMENT As String)

        Dim montant As Double = 0

        Dim getUserQuery_ = "SELECT MONTANT_VERSE FROM reglement WHERE DATE_REGLEMENT >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_REGLEMENT <= '" & DateFin.ToString("yyyy-MM-dd") & "' AND MODE_REGLEMENT =@MODE_REGLEMENT"
        Dim command_ As New MySqlCommand(getUserQuery_, GlobalVariable.connect)
        command_.Parameters.Add("@MODE_REGLEMENT", MySqlDbType.VarChar).Value = MODE_REGLEMENT
        Dim adapter_ As New MySqlDataAdapter
        Dim dtModeReglement_ As New DataTable()

        adapter_.SelectCommand = command_
        adapter_.Fill(dtModeReglement_)

        If dtModeReglement_.Rows.Count > 0 Then
            For i = 0 To dtModeReglement_.Rows.Count - 1
                If MODE_REGLEMENT.Equals("Free") Or MODE_REGLEMENT.Equals("Gratuitée") Then
                    If dtModeReglement_.Rows(i)("MONTANT_VERSE") > 0 Then
                        montant += dtModeReglement_.Rows(i)("MONTANT_VERSE")
                    End If
                Else
                    montant += dtModeReglement_.Rows(i)("MONTANT_VERSE")
                End If
            Next
        End If

        Return montant

    End Function

    Public Shared Function etatNoteBlocNote(ByVal ETAT As Integer)

        'ETAT_BLOC_NOTE = 0 : COMPTOIR
        'ETAT_BLOC_NOTE = 1 : EN CHAMBRE
        'ETAT_BLOC_NOTE = 2 : GRATUITEE
        'ETAT_BLOC_NOTE = 3 : COMPTE

        Dim statutBlocNte As String = ""

        If GlobalVariable.actualLanguageValue = 1 Then
            If ETAT = 0 Then
                statutBlocNte = "COMPTOIR"
            ElseIf ETAT = 1 Then
                statutBlocNte = "EN CHAMBRE"
            ElseIf ETAT = 2 Then
                statutBlocNte = "GRATUITEE"
            ElseIf ETAT = 3 Then
                statutBlocNte = "COMPTE"
            End If
        Else
            If ETAT = 0 Then
                statutBlocNte = "WALK IN"
            ElseIf ETAT = 1 Then
                statutBlocNte = "IN HOUSE"
            ElseIf ETAT = 2 Then
                statutBlocNte = "FREE"
            ElseIf ETAT = 3 Then
                statutBlocNte = "ACCOUNT"
            End If
        End If

        Return statutBlocNte

    End Function

    Public Shared Function totalDunServiceUnCertainJour(ByVal dateDuJour As Date, ByVal SERVICE As String)

        Dim montantTotal As Double = 0

        Dim getUserQuery_ = "SELECT * FROM ligne_facture WHERE DATE_FACTURE >= '" & dateDuJour.ToString("yyyy-MM-dd") & "' AND DATE_FACTURE <= '" & dateDuJour.ToString("yyyy-MM-dd") & "' AND FUSIONNEE = @SERVICE"
        Dim command_ As New MySqlCommand(getUserQuery_, GlobalVariable.connect)
        command_.Parameters.Add("@SERVICE", MySqlDbType.VarChar).Value = SERVICE
        Dim adapter_ As New MySqlDataAdapter
        Dim dt As New DataTable()
        adapter_.SelectCommand = command_
        adapter_.Fill(dt)

        If dt.Rows.Count > 0 Then
            For i = 0 To dt.Rows.Count - 1
                montantTotal += dt.Rows(i)("MONTANT_TTC")
            Next
        End If

        Return montantTotal

    End Function

    Public Shared Function totalDunServiceUnCertainJourSpecifique(ByVal dateDuJour As Date, ByVal SERVICE As String, ByVal CODE_RESERVATION As String)

        Dim montantTotal As Double = 0

        Dim getUserQuery_ = "SELECT * FROM ligne_facture WHERE DATE_FACTURE >= '" & dateDuJour.ToString("yyyy-MM-dd") & "' AND DATE_FACTURE <= '" & dateDuJour.ToString("yyyy-MM-dd") & "'
        AND FUSIONNEE = @SERVICE AND CODE_RESERVATION=@CODE_RESERVATION"
        Dim command_ As New MySqlCommand(getUserQuery_, GlobalVariable.connect)
        command_.Parameters.Add("@SERVICE", MySqlDbType.VarChar).Value = SERVICE
        command_.Parameters.Add("@CODE_RESERVATION", MySqlDbType.VarChar).Value = CODE_RESERVATION
        Dim adapter_ As New MySqlDataAdapter
        Dim dt As New DataTable()
        adapter_.SelectCommand = command_
        adapter_.Fill(dt)

        If dt.Rows.Count > 0 Then
            For i = 0 To dt.Rows.Count - 1
                montantTotal += dt.Rows(i)("MONTANT_TTC")
            Next
        End If

        Return montantTotal

    End Function

    Public Shared Sub miseAJourDuMontantAReporter(ByVal dateDuJour As Date, ByVal CODE_RESERVATION As String)

        Dim A_REPORTER As Double = Functions.SituationDeReservation(CODE_RESERVATION)

        Dim getUserQuery_ = "UPDATE main_courante_journaliere SET A_REPORTER = @A_REPORTER WHERE DATE_MAIN_COURANTE >= '" & dateDuJour.ToString("yyyy-MM-dd") & "' AND DATE_MAIN_COURANTE <= '" & dateDuJour.ToString("yyyy-MM-dd") & "' AND NUM_RESERVATION = @CODE_RESERVATION"
        Dim command_ As New MySqlCommand(getUserQuery_, GlobalVariable.connect)
        command_.Parameters.Add("@A_REPORTER", MySqlDbType.Double).Value = A_REPORTER
        command_.Parameters.Add("@CODE_RESERVATION", MySqlDbType.VarChar).Value = CODE_RESERVATION

        command_.ExecuteNonQuery()

    End Sub

    Public Shared Sub miseAJourMontantAccorderApresFacturationAnticipe(ByVal dateDuJour As Date, ByVal CODE_RESERVATION As String, ByVal MONTANT_ACCORDE As Double, ByVal TAXE As Double)

        Dim A_REPORTER As Double = Functions.SituationDeReservation(CODE_RESERVATION)

        Dim getUserQuery_ = "UPDATE main_courante_journaliere SET MONTANT_ACCORDE = MONTANT_ACCORDE + @MONTANT_ACCORDE, TAUX_OCCUPATION_PCT=@TAUX_OCCUPATION_PCT,
        TOTAL_JOUR = TOTAL_JOUR + @MONTANT_ACCORDE + @TAUX_OCCUPATION_PCT, TOTAL_GENERAL=TOTAL_GENERAL + @MONTANT_ACCORDE + @TAUX_OCCUPATION_PCT
        WHERE DATE_MAIN_COURANTE >= '" & dateDuJour.ToString("yyyy-MM-dd") & "' AND DATE_MAIN_COURANTE <= '" & dateDuJour.ToString("yyyy-MM-dd") & "' 
        AND NUM_RESERVATION = @CODE_RESERVATION"
        Dim command_ As New MySqlCommand(getUserQuery_, GlobalVariable.connect)
        command_.Parameters.Add("@MONTANT_ACCORDE", MySqlDbType.Double).Value = MONTANT_ACCORDE
        command_.Parameters.Add("@TAUX_OCCUPATION_PCT", MySqlDbType.Double).Value = TAXE
        command_.Parameters.Add("@CODE_RESERVATION", MySqlDbType.VarChar).Value = CODE_RESERVATION

        command_.ExecuteNonQuery()

    End Sub

    Public Shared Sub suppressionDesLignesDeFacturationPourLaMensualite(ByVal CODE_RESERVATION As String, ByVal dateDuJour As Date)

        Dim getUserQuery_ = "DELETE from ligne_facture 
        WHERE DATE_FACTURE >= '" & dateDuJour.ToString("yyyy-MM-dd") & "' AND DATE_FACTURE <= '" & dateDuJour.ToString("yyyy-MM-dd") & "' 
        AND CODE_RESERVATION = @CODE_RESERVATION AND FUSIONNEE IN ('HEBERGEMENT', 'ACCOMMODATION')"
        Dim command_ As New MySqlCommand(getUserQuery_, GlobalVariable.connect)
        command_.Parameters.Add("@CODE_RESERVATION", MySqlDbType.VarChar).Value = CODE_RESERVATION

        command_.ExecuteNonQuery()

    End Sub

    Public Shared Function insertionDuNumeroDeCompteDansLesFacturesNePossedantPas()

        Dim montantTotal As Double = 0

        Dim getUserQuery_ = "SELECT * FROM facture WHERE CODE_COMMANDE IN ('')"
        Dim command_ As New MySqlCommand(getUserQuery_, GlobalVariable.connect)
        Dim adapter_ As New MySqlDataAdapter
        Dim dt As New DataTable()
        adapter_.SelectCommand = command_
        adapter_.Fill(dt)

        If dt.Rows.Count > 0 Then

            For i = 0 To dt.Rows.Count - 1

                Dim CODE_FACTURE As String = dt.Rows(i)("CODE_FACTURE")
                Dim CODE_CLIENT As String = dt.Rows(i)("CODE_CLIENT")

                Dim getUserQuery_1 = "SELECT * FROM compte WHERE CODE_CLIENT = @CODE_CLIENT"
                Dim command_1 As New MySqlCommand(getUserQuery_1, GlobalVariable.connect)
                command_1.Parameters.Add("@CODE_CLIENT", MySqlDbType.VarChar).Value = CODE_CLIENT
                Dim adapter_1 As New MySqlDataAdapter
                Dim dt1 As New DataTable()
                adapter_1.SelectCommand = command_1
                adapter_1.Fill(dt1)

                If dt1.Rows.Count > 0 Then

                    Dim NUMERO_COMPTE As String = dt1.Rows(0)("NUMERO_COMPTE")
                    Functions.updateOfFields("facture", "CODE_COMMANDE", NUMERO_COMPTE, "CODE_FACTURE", CODE_FACTURE, 2)

                End If

            Next

        End If

        Return montantTotal

    End Function

    Public Shared Function ListeDesMainCourantesDujours(ByVal DateDebutDuJOur As Date)

        Dim changerSigne As Integer = -1
        Dim HEBERGEMENT_TOTAL As Double = 0


        'MAINCOURANTE JOURNALIERE
        Dim dateTravail As Date = CDate(GlobalVariable.DateDeTravail).ToShortDateString
        Dim dateMainCourante As Date = DateDebutDuJOur.ToShortDateString

        Dim DateDebut As Date = DateDebutDuJOur.ToString("yyyy-MM-dd")
        Dim DateFin As Date = DateDebutDuJOur.ToString("yyyy-MM-dd")

        'RESERVATION 
        Dim ETAT_MAIN_COURANTE As Integer = 0

            If dateMainCourante < dateTravail Then
                ETAT_MAIN_COURANTE = 1
            End If

            Dim getUserQuery1 = "SELECT CHAMBRE_ID As 'CHAMBRE', DAY_USE, NUM_RESERVATION, ARRHES, main_courante_journaliere.NOM_CLIENT As 'NOM & PRENOM', DATE_ENTTRE As 'DATE ARRIVEE',
            DATE_SORTIE As 'DATE DEPART', NB_PERSONNES As 'NBRE DE PAX', PDJ, DEJEUNER, DINER,CAVE, CAFE, DIVERS, ENCAISSEMENT_ESPECE AS 'ESPECES', ENCAISSEMENT_CHEQUE AS 'CHEQUE',
            ENCAISSEMENT_CARTE_CREDIT As 'CARTE CREDIT', TELE AS 'MOBILE MONEY', main_Courante_journaliere.NUM_RESERVATION As 'RESERVATION', 
            main_courante_journaliere.MONTANT_ACCORDE AS 'HEBERGEMENT', main_courante_journaliere.BAR_RESTAURANT AS 'BAR/RESTAURANT', BAR,
            main_courante_journaliere.SERVICES AS 'SERVICES', main_courante_journaliere.SALON_DE_BEAUTE AS 'SALON DE BEAUTE', main_courante_journaliere.BOUTIQE AS 'BOUTIQUE',
            main_courante_journaliere.CYBERCAFE As 'BUSINESS CENTER', main_courante_journaliere.SPORTS As 'SPORTS' , main_courante_journaliere.LOISIRS As 'LOISIRS',
            TOTAL_JOUR, main_courante_journaliere.KIOSQUE_A_JOURNAUX as 'JOURNAUX', main_courante_journaliere.BLANCHISSERIE As BLANCHISSERIE, main_courante_journaliere.AUTRES As 'AUTRES'
            , TOTAL_JOUR As 'RECETTE DU JOUR', REPORT_VEILLE As 'REPORT VEILLE', TOTAL_GENERAL As 'TOTAL GENERAL', A_REPORTER As 'A REPORTER', HEURE_ENTREE, HEURE_SORTIE,
            TAUX_OCCUPATION_PCT As 'TAXE DE SEJOUR', ANTICIPE FROM main_Courante_journaliere, reserve_conf WHERE DATE_MAIN_COURANTE <= '" & DateFin.ToString("yyyy-MM-dd") & "' 
            AND DATE_MAIN_COURANTE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND main_Courante_journaliere.NUM_RESERVATION = reserve_conf.CODE_RESERVATION 
            AND reserve_conf.TYPE=@TYPE AND ETAT_MAIN_COURANTE=@ETAT_MAIN_COURANTE ORDER BY CODE_CHAMBRE ASC"

            Dim command1 As New MySqlCommand(getUserQuery1, GlobalVariable.connect)

            'command1.Parameters.Add("@DATE_DU_JOUR", MySqlDbType.Date).Value = GlobalVariable.DateDeTravail
            'command1.Parameters.Add("@ETAT_MAIN_COURANTE", MySqlDbType.Int32).Value = 0
            command1.Parameters.Add("@ETAT_MAIN_COURANTE", MySqlDbType.Int32).Value = ETAT_MAIN_COURANTE
            command1.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.DocumentToGenerate

            Dim adapter1 As New MySqlDataAdapter(command1)

            Dim table As New DataTable()

            adapter1.Fill(table)

            '-------------------------------------------------------- MAINCOURANTE ----------------------------------------------

            Dim getUserQuery01 = "SELECT CODE_CHAMBRE As 'CHAMBRE', NUM_RESERVATION, ARRHES, main_courante_autres.NOM_CLIENT As 'NOM & PRENOM', PDJ, DEJEUNER, DINER, CAVE, CAFE, DIVERS, ENCAISSEMENT_ESPECE AS 'ESPECES', ENCAISSEMENT_CHEQUE AS 'CHEQUE', ENCAISSEMENT_CARTE_CREDIT As 'CARTE CREDIT', TELE AS 'MOBILE MONEY', main_Courante_autres.NUM_RESERVATION As 'RESERVATION', main_courante_autres.MONTANT_ACCORDE AS 'HEBERGEMENT', main_courante_autres.BAR_RESTAURANT AS 'BAR/RESTAURANT', BAR, main_courante_autres.SERVICES AS 'SERVICES', main_courante_autres.SALON_DE_BEAUTE AS 'SALON DE BEAUTE', main_courante_autres.BOUTIQE AS 'BOUTIQUE', main_courante_autres.CYBERCAFE As 'BUSINESS CENTER', main_courante_autres.SPORTS As 'SPORTS' , main_courante_autres.LOISIRS As 'LOISIRS', TOTAL_JOUR, main_courante_autres.KIOSQUE_A_JOURNAUX as 'JOURNAUX', main_courante_autres.BLANCHISSERIE As BLANCHISSERIE, main_courante_autres.AUTRES As 'AUTRES', TOTAL_JOUR As 'RECETTE DU JOUR', REPORT_VEILLE As 'REPORT VEILLE', TOTAL_GENERAL As 'TOTAL GENERAL', A_REPORTER As 'A REPORTER' FROM main_Courante_autres WHERE DATE_MAIN_COURANTE <= '" & DateFin.ToString("yyyy-MM-dd") & "' AND DATE_MAIN_COURANTE >='" & DateDebut.ToString("yyyy-MM-dd") & "' ORDER BY main_courante_autres.NOM_CLIENT ASC"

            Dim command01 As New MySqlCommand(getUserQuery01, GlobalVariable.connect)

            'command1.Parameters.Add("@DATE_DU_JOUR", MySqlDbType.Date).Value = GlobalVariable.DateDeTravail
            'command1.Parameters.Add("@ETAT_MAIN_COURANTE", MySqlDbType.Int32).Value = 0
            'command1.Parameters.Add("@ETAT_MAIN_COURANTE", MySqlDbType.Int32).Value = 1
            command01.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.DocumentToGenerate

            Dim adapter01 As New MySqlDataAdapter(command01)

            Dim table0 As New DataTable()

            adapter01.Fill(table0)

            '--------------------------------------------------------------------------------------------------------------------

            If table.Rows.Count > 0 Then

                Dim enChambre As Boolean = False

                For i = 0 To table.Rows.Count - 1

                    enChambre = False

                    Dim NUMERO_RESERVATION As String = table.Rows(i)("NUM_RESERVATION")

                    '----------------------------------------------- TAXE DE SEJOURS ------------------------------------------------------

                    '-----------------------------------------------END TAXE DE SEJOURS ---------------------------------------------------

                    Dim RESTAURANT As Double = table.Rows(i)("PDJ") + table.Rows(i)("DEJEUNER") + table.Rows(i)("DINER")
                    Dim BAR As Double = table.Rows(i)("CAFE") + table.Rows(i)("CAVE") + table.Rows(i)("DIVERS")

                    'Dim RESTAURANT As Double = table.Rows(i)("CAVE") + table.Rows(i)("DIVERS") + table.Rows(i)("CAFE")

                    Dim AUTRES_VENTE As Double = table.Rows(i)("SERVICES") + table.Rows(i)("SALON DE BEAUTE") + table.Rows(i)("BOUTIQUE") + table.Rows(i)("BUSINESS CENTER") + table.Rows(i)("SPORTS") + table.Rows(i)("LOISIRS") + table.Rows(i)("JOURNAUX") + table.Rows(i)("AUTRES")

                    Dim TOTAL_RECETTE As Double = 0

                    Dim nuits As Integer = 0

                    Dim arrivee As Date = CDate(table.Rows(i)("DATE ARRIVEE")).ToShortDateString
                    Dim depart As Date = CDate(table.Rows(i)("DATE DEPART")).ToShortDateString

                    If dateMainCourante >= arrivee And dateMainCourante <= depart Then
                        enChambre = True
                    End If

                    Dim HEBERGEMENT As Double = table.Rows(i)("HEBERGEMENT")
                    Dim taxeDeSejours As Double = table.Rows(i)("TAXE DE SEJOUR")
                    Dim taxeDeSejourDansLigneFacture As Double = 0

                    Dim RETRANCHEMENTHEBERGEMENT As Double = 0
                    Dim RETRANCHEMENTTAXEDESEJOUR As Double = 0
                    Dim TAXE_DE_SEJOUR_REELLE As Double = 0

                    'CALCUL DU SEJOURS ECOULE

                    ' If dateTravail <= depart Then
                    'nuits = CType((dateTravail - arrivee).TotalDays, Int64)
                    'Else
                    'nuits = CType((depart - arrivee).TotalDays, Int64)
                    'End If

                    nuits = CType((depart - arrivee).TotalDays, Int64)

                    Dim PAX As Integer = table.Rows(i)("NBRE DE PAX")

                    If PAX <= 0 Then
                        PAX = 1
                    End If

                    Dim SERVICE As String = ""

                    'ON DOIT DETERMINER QUELLE EST LE VRAI MONTANT DE LA TAXE DE SEJOUR

                    If GlobalVariable.actualLanguageValue = 1 Then
                        SERVICE = "TAXE DE SEJOURS"
                    Else
                        SERVICE = "TOURIST TAX"
                    End If

                    'VA AIDER A RETIRER LES TAXES DE SEJOURS EN TROP
                    TAXE_DE_SEJOUR_REELLE = Functions.totalDunServiceUnCertainJourSpecifique(dateMainCourante, SERVICE, table.Rows(i)("NUM_RESERVATION"))

                    If depart.ToString("yyyy-MM-dd") = dateMainCourante.ToString("yyyy-MM-dd") Then

                        If table.Rows(i)("DAY_USE") = 0 Then

                            RETRANCHEMENTHEBERGEMENT = HEBERGEMENT
                            RETRANCHEMENTTAXEDESEJOUR = taxeDeSejours

                            HEBERGEMENT = 0
                            taxeDeSejours = 0

                        Else
                            'AUTRES_VENTE -= table.Rows(i)("HEBERGEMENT")
                        End If

                    Else

                    End If

                    If HEBERGEMENT < 0 Then
                        HEBERGEMENT = 0
                    End If

                    Dim TAXE_EN_TROP_NEGATIVE As Double = 0

                    'ON DOIT MULTIPLIER LE DAY USE PAR LE NOMBRE D'HEURE
                    If table.Rows(i)("DAY_USE") = 1 Then

                        Dim DEBUT As Date = CDate(table.Rows(i)("HEURE_ENTREE")).ToShortTimeString
                        Dim FIN As Date = CDate(table.Rows(i)("HEURE_SORTIE")).ToShortTimeString

                        Dim NombreHeure As Integer = 0

                        NombreHeure = CType((FIN - DEBUT).TotalHours, Int32)

                    End If

                    If AUTRES_VENTE < 0 Then
                        AUTRES_VENTE = 0
                    End If

                    Dim TOTAL_ENCAISSEMENT As Double = table.Rows(i)("ESPECES") + table.Rows(i)("CARTE CREDIT") + table.Rows(i)("MOBILE MONEY") + table.Rows(i)("CHEQUE")

                    If (RESTAURANT + BAR) = table.Rows(i)("BAR/RESTAURANT") Then
                        TOTAL_RECETTE = AUTRES_VENTE + HEBERGEMENT + table.Rows(i)("BAR/RESTAURANT") + table.Rows(i)("BLANCHISSERIE")
                    ElseIf RESTAURANT + BAR = table.Rows(i)("BAR/RESTAURANT") Then
                        TOTAL_RECETTE = AUTRES_VENTE + HEBERGEMENT + RESTAURANT + BAR + table.Rows(i)("BLANCHISSERIE")
                    Else
                        TOTAL_RECETTE = table.Rows(i)("BAR/RESTAURANT") + AUTRES_VENTE + HEBERGEMENT + table.Rows(i)("BLANCHISSERIE")
                    End If

                    Dim A_REPORTER_SOLDE As Double = 0
                    Dim TOTAL_GENERAL_DU_JOUR As Double = 0
                    Dim TOTAL_CARTE As Double = 0
                    Dim RECETTE_TOTAL_DU_JOUR As Double = 0

                    'DataGridViewMainCouranteReception.Rows.Add(table.Rows(i)("CHAMBRE"), table.Rows(i)("NOM & PRENOM"), CDate(table.Rows(i)("DATE ARRIVEE")).ToShortDateString, CDate(table.Rows(i)("DATE DEPART")).ToShortDateString, nuits, PAX, HEBERGEMENT, taxeDeSejours, table.Rows(i)("PDJ"), table.Rows(i)("DEJEUNER"), table.Rows(i)("DINER"), table.Rows(i)("BAR"), table.Rows(i)("BLANCHISSERIE"), AUTRES_VENTE, (table.Rows(i)("RECETTE DU JOUR") - RETRANCHEMENTHEBERGEMENT - RETRANCHEMENTTAXEDESEJOUR), table.Rows(i)("REPORT VEILLE") * changerSigne, (table.Rows(i)("TOTAL GENERAL") - RETRANCHEMENTHEBERGEMENT - RETRANCHEMENTTAXEDESEJOUR) * changerSigne, table.Rows(i)("ESPECES"), table.Rows(i)("CARTE CREDIT") + table.Rows(i)("CHEQUE"), table.Rows(i)("MOBILE MONEY"), (table.Rows(i)("A REPORTER") - RETRANCHEMENTHEBERGEMENT - RETRANCHEMENTTAXEDESEJOUR - table.Rows(i)("ARRHES")) * changerSigne, table.Rows(i)("NUM_RESERVATION"))
                    'TOTAL_GENERAL_DU_JOUR = (table.Rows(i)("TOTAL GENERAL") - RETRANCHEMENTHEBERGEMENT - RETRANCHEMENTTAXEDESEJOUR) * changerSigne

                    TOTAL_GENERAL_DU_JOUR = (table.Rows(i)("TOTAL GENERAL") - RETRANCHEMENTHEBERGEMENT - RETRANCHEMENTTAXEDESEJOUR) * changerSigne
                    TOTAL_CARTE = table.Rows(i)("CARTE CREDIT") + table.Rows(i)("CHEQUE")
                    RECETTE_TOTAL_DU_JOUR = (table.Rows(i)("RECETTE DU JOUR") - RETRANCHEMENTHEBERGEMENT - RETRANCHEMENTTAXEDESEJOUR)
                    A_REPORTER_SOLDE = (table.Rows(i)("A REPORTER") - RETRANCHEMENTHEBERGEMENT - RETRANCHEMENTTAXEDESEJOUR - table.Rows(i)("ARRHES")) * changerSigne

                    Dim TAXE_EN_TROP As Double = 0

                    If taxeDeSejours >= TAXE_DE_SEJOUR_REELLE Then
                        TAXE_EN_TROP = taxeDeSejours - TAXE_DE_SEJOUR_REELLE
                    Else

                    End If

                    If arrivee.ToString("yyyy-MM-dd") = dateMainCourante.ToString("yyyy-MM-dd") Then
                        If TAXE_EN_TROP > 0 Then
                            TAXE_EN_TROP_NEGATIVE = TAXE_EN_TROP
                        End If
                    End If

                    If table.Rows(i)("ANTICIPE") = 1 Then 'BEFORE FACTURATION EN AVANCE

                        TAXE_EN_TROP = 0

                        A_REPORTER_SOLDE = table.Rows(i)("A REPORTER")

                        If dateMainCourante >= dateTravail Then
                            'LES DONNEES N'ETANT PAS ENCORE ARRETER ON PEUT LIRE LA SOURCE VARIABLE

                            If GlobalVariable.actualLanguageValue = 1 Then
                                SERVICE = "HEBERGEMENT"
                            Else
                                SERVICE = "ACCOMMODATION"
                            End If

                            HEBERGEMENT = Functions.totalDunServiceUnCertainJourSpecifique(dateMainCourante, SERVICE, table.Rows(i)("NUM_RESERVATION"))

                            If GlobalVariable.actualLanguageValue = 1 Then
                                SERVICE = "TAXE DE SEJOURS"
                            Else
                                SERVICE = "TOURIST TAX"
                            End If

                            taxeDeSejours = Functions.totalDunServiceUnCertainJourSpecifique(dateMainCourante, SERVICE, table.Rows(i)("NUM_RESERVATION"))

                            If dateMainCourante = depart Then
                                RECETTE_TOTAL_DU_JOUR += (HEBERGEMENT + taxeDeSejours)
                                TOTAL_GENERAL_DU_JOUR += (HEBERGEMENT + taxeDeSejours) * changerSigne
                            End If

                            'TOTAL_GENERAL_DU_JOUR += taxeDeSejours + HEBERGEMENT

                        End If

                    End If

                    If enChambre Then
                        'DataGridViewMainCouranteReception.Rows.Add(table.Rows(i)("CHAMBRE"), table.Rows(i)("NOM & PRENOM"), CDate(table.Rows(i)("DATE ARRIVEE")).ToShortDateString, CDate(table.Rows(i)("DATE DEPART")).ToShortDateString, nuits, PAX, HEBERGEMENT, TAXE_DE_SEJOUR_REELLE, table.Rows(i)("PDJ"), table.Rows(i)("DEJEUNER"), table.Rows(i)("DINER"), table.Rows(i)("BAR"), table.Rows(i)("BLANCHISSERIE"), AUTRES_VENTE, RECETTE_TOTAL_DU_JOUR - TAXE_EN_TROP, (table.Rows(i)("REPORT VEILLE")) * changerSigne + TAXE_EN_TROP - TAXE_EN_TROP_NEGATIVE, TOTAL_GENERAL_DU_JOUR + TAXE_EN_TROP, table.Rows(i)("ESPECES"), TOTAL_CARTE, table.Rows(i)("MOBILE MONEY"), A_REPORTER_SOLDE + TAXE_EN_TROP, table.Rows(i)("NUM_RESERVATION"))

                        HEBERGEMENT_TOTAL += HEBERGEMENT
                    End If

                    RETRANCHEMENTHEBERGEMENT = 0
                    RETRANCHEMENTTAXEDESEJOUR = 0

                Next

                'MAINcourantes comptoires
                For i = 0 To table0.Rows.Count - 1

                    Dim RESTAURANT As Double = table0.Rows(i)("PDJ") + table0.Rows(i)("DEJEUNER") + table0.Rows(i)("DINER")
                    Dim BAR As Double = table0.Rows(i)("CAFE") + table0.Rows(i)("CAVE") + table0.Rows(i)("DIVERS")

                    'Dim RESTAURANT As Double = table0.Rows(i)("CAVE") + table0.Rows(i)("DIVERS") + table0.Rows(i)("CAFE")

                    Dim AUTRES_VENTE As Double = table0.Rows(i)("SERVICES") + table0.Rows(i)("SALON DE BEAUTE") + table0.Rows(i)("BOUTIQUE") + table0.Rows(i)("BUSINESS CENTER") + table0.Rows(i)("SPORTS") + table0.Rows(i)("LOISIRS") + table0.Rows(i)("JOURNAUX") + table0.Rows(i)("AUTRES")

                    Dim TOTAL_RECETTE As Double = 0

                    Dim TOTAL_ENCAISSEMENT As Double = table0.Rows(i)("ESPECES") + table0.Rows(i)("CARTE CREDIT") + table0.Rows(i)("MOBILE MONEY") + table0.Rows(i)("CHEQUE")

                    'TOTAL_RECETTE = AUTRES_VENTE + table0.Rows(i)("BAR/RESTAURANT") + table0.Rows(i)("BLANCHISSERIE")

                    If (RESTAURANT + BAR) = table0.Rows(i)("BAR/RESTAURANT") And (RESTAURANT + table0.Rows(i)("BAR")) = table0.Rows(i)("BAR/RESTAURANT") Then
                        TOTAL_RECETTE = AUTRES_VENTE + table0.Rows(i)("BAR/RESTAURANT") + table0.Rows(i)("BLANCHISSERIE")
                    Else
                        TOTAL_RECETTE = AUTRES_VENTE + RESTAURANT + BAR + table0.Rows(i)("BLANCHISSERIE")
                    End If

                Next

            End If


        Return HEBERGEMENT_TOTAL

    End Function

    Public Shared Function RetablissementDesResteAPayerNegatifEnPositif()

        Dim getUserQuery_ = "UPDATE facture SET RESTE_A_PAYER = RESTE_A_PAYER * -1 WHERE RESTE_A_PAYER < 0"
        Dim command_ As New MySqlCommand(getUserQuery_, GlobalVariable.connect)
        command_.ExecuteNonQuery()

    End Function

    Public Shared Function ensembleDesDepotsDeGaranties(ByVal date_1 As Date, ByVal date_2 As Date, ByVal CODE_CAISSIER As String) As DataTable

        Dim query As String = ""

        If Not Trim(CODE_CAISSIER).Equals("") Then

            query = "SELECT * FROM caution 
            WHERE DATE_CREATION >= '" & date_1.ToString("yyyy-MM-dd") & "' AND DATE_CREATION <= '" & date_2.ToString("yyyy-MM-dd") & "' AND 
            CODE_UTILISATEUR_CREA=@CODE_UTILISATEUR_CREA AND TYPE=@TYPE"

        Else

            query = "SELECT * FROM caution 
            WHERE DATE_CREATION >= '" & date_1.ToString("yyyy-MM-dd") & "' AND DATE_CREATION <= '" & date_2.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE"

        End If


        Dim command As New MySqlCommand(query, GlobalVariable.connect)
        command.Parameters.Add("@TYPE", MySqlDbType.Int16).Value = 1
        command.Parameters.Add("@CODE_UTILISATEUR_CREA", MySqlDbType.VarChar).Value = CODE_CAISSIER
        Dim table As New DataTable()
        Dim adapter As New MySqlDataAdapter(command)

        adapter.Fill(table)

        Return table

    End Function

    Public Shared Sub retranchementDesGratuiteeDeLaMainCourante(ByVal NUMERO_BLOC_NOTE As String)

        Dim dt As DataTable = Functions.getElementByCode(NUMERO_BLOC_NOTE, "ligne_facture", "NUMERO_BLOC_NOTE")

        Dim mainsCourante As New MainCourantes()

        Dim CODE_ARTICLE As String = ""
        Dim NATURE As String = ""

        Dim PRIX_VENTE As Double = 0

        If dt.Rows.Count > 0 Then

            Dim TABLE As String = "main_courante_autres"
            Dim CODE_MAIN_COURANTE_JOURNALIERE As String = ""

            For i = 0 To dt.Rows.Count - 1

                Dim CODE_FACTURE As String = dt.Rows(i)("CODE_FACTURE")
                Dim CODE_RESERVATION As String = dt.Rows(i)("CODE_RESERVATION")
                Dim CODE_MOUVEMENT As String = dt.Rows(i)("CODE_MOUVEMENT")
                Dim CODE_CHAMBRE As String = dt.Rows(i)("CODE_CHAMBRE")
                Dim CODE_MODE_PAIEMENT As String = dt.Rows(i)("CODE_MODE_PAIEMENT")
                Dim NUMERO_PIECE As String = dt.Rows(i)("NUMERO_PIECE")
                Dim POINT_DE_VENTE As String = dt.Rows(i)("TYPE_LIGNE_FACTURE")
                CODE_ARTICLE = dt.Rows(i)("CODE_ARTICLE")
                NATURE = dt.Rows(i)("FUSIONNEE")
                Dim LIBELLE_FACTURE As String = dt.Rows(i)("LIBELLE_FACTURE")

                Dim QUANTITE_AVANT_MOVEMENT As Double = 0
                Dim CMUP As Double = 0

                Dim NOMBRE_DE_PORTION As Double = 0

                '-------------------------

                Dim CONTENANCE As Double = 0

                Dim articleInfo As DataTable = Functions.getElementByCode(CODE_ARTICLE, "article", "CODE_ARTICLE")

                Dim reduction As Boolean = False

                'ON DETERMINE SI LA LIGNE EST REDUCTION OU PAS

                If Not articleInfo.Rows.Count > 0 Then

                    CODE_ARTICLE = dt.Rows(i)("NUMERO_SERIE_DEBUT")
                    articleInfo = Functions.getElementByCode(CODE_ARTICLE, "article", "CODE_ARTICLE")

                    reduction = True

                End If

                Dim unite As DataTable
                '-----------------------
                Dim ficheTechnique As DataTable

                Dim NOM_ARTICLE As String = ""

                Dim FUSIONNEE As String = dt.Rows(i)("FUSIONNEE")
                Dim PRIX_UNITAIRE_TTC As Double = dt.Rows(i)("PRIX_UNITAIRE_TTC")
                PRIX_VENTE = dt.Rows(i)("PRIX_UNITAIRE_TTC")
                Dim MONTANT_TTC As Double = dt.Rows(i)("MONTANT_TTC") * -1
                Dim HEURE_FACTURE As DateTime = dt.Rows(i)("HEURE_FACTURE")

                Dim FAMILLE_ARTICLE As String = ""

                If articleInfo.Rows.Count > 0 Then

                    '----------------------- END GESTION DU REMPLISSAGE DE LA MAIN COURANTE JOURNALIERE -------------------------------

                    CODE_MAIN_COURANTE_JOURNALIERE = ""

                    Dim ETAT_MAIN_COURANTE As Integer = 0

                    Dim main_courante_autres As DataTable = Functions.getElementByOnCodeAndDate(ETAT_MAIN_COURANTE, "main_courante_autres", "ETAT_MAIN_COURANTE", GlobalVariable.DateDeTravail, "main_courante_autres")

                    If main_courante_autres.Rows.Count > 0 Then
                        CODE_MAIN_COURANTE_JOURNALIERE = main_courante_autres.Rows(0)("CODE_MAIN_COURANTE_JOURNALIERE")
                    End If

                    FAMILLE_ARTICLE = articleInfo.Rows(0)("CODE_FAMILLE")

                    Dim FIELDVALUE As Double = MONTANT_TTC
                    Dim FIELD As String = ""

                    If Trim(FAMILLE_ARTICLE) = "BOISSONS" Then
                        'TRAITEMENT DES BOISSONS
                        FIELD = "BAR"

                        mainsCourante.updateMainCouranteJournaliereConsommationBarRestau(CODE_MAIN_COURANTE_JOURNALIERE, TABLE, FIELD, FIELDVALUE)

                        If FUSIONNEE = "EAU MINERAL" Then
                            FIELD = "CAFE"
                            mainsCourante.updateMainCouranteJournaliereConsommationBarRestau(CODE_MAIN_COURANTE_JOURNALIERE, TABLE, FIELD, FIELDVALUE)
                        Else
                            If dt.Rows(i)("VALEUR_CONSO") > 0 Then
                                FIELD = "DIVERS" 'CONSOMMATION
                                mainsCourante.updateMainCouranteJournaliereConsommationBarRestau(CODE_MAIN_COURANTE_JOURNALIERE, TABLE, FIELD, FIELDVALUE)
                            Else
                                FIELD = "CAVE"
                                mainsCourante.updateMainCouranteJournaliereConsommationBarRestau(CODE_MAIN_COURANTE_JOURNALIERE, TABLE, FIELD, FIELDVALUE)
                            End If
                        End If

                    ElseIf Trim(FAMILLE_ARTICLE) = "ALIMENTS(REPAS)" Then

                        'ON EXCLU LES REPAS DE TYPE PETIT DEJEUENER DU CONTROLE DU TEMPS
                        'If FUSIONNEE = "PETIT DEJEUNER" Then
                        If FUSIONNEE = "PETIT DEJEUNER" Then
                            FIELD = "PDJ"
                            mainsCourante.updateMainCouranteJournaliereConsommationBarRestau(CODE_MAIN_COURANTE_JOURNALIERE, TABLE, FIELD, FIELDVALUE)
                        Else

                            'TRAITEMENTS DES ALIMENTS DE TYPE DEJEUENER/DINER

                            If Trim(NATURE).Equals("DEJEUNER") Then
                                FIELD = "DEJEUNER"
                            ElseIf Trim(NATURE).Equals("DINER") Then
                                FIELD = "DINER"
                            Else
                                FIELD = "DEJEUNER"
                            End If

                            mainsCourante.updateMainCouranteJournaliereConsommationBarRestau(CODE_MAIN_COURANTE_JOURNALIERE, TABLE, FIELD, FIELDVALUE)

                        End If

                    Else
                        FUSIONNEE = dt.Rows(i)("FUSIONNEE")
                    End If

                    'Dim PDJ As Double = 0 'PETITE DEJEUNER
                    'Dim DEJEUNER As Double = 0 'DEJEUNER
                    'Dim DINER As Double = 0 'DINER
                    'Dim CAFE As Double = 0 'EAU MINERAL
                    'Dim BAR As Double = 0 'FAMILLE ARTICLE = BOISSONS
                    'Dim CAVE As Double = 0 '
                    'Dim DIVERS As Double = 0 'CONSOMMATION

                    '--------------------------------------------------------------------------------------------------------------

                    NOM_ARTICLE = articleInfo.Rows(0)("DESIGNATION_FR")

                End If

                Dim ANNULATION As Integer = 0
                'MISE A JOURS DE LA MAINCOURANTE PAR APPORT A CHAQUE POINT DE VENTE
                miseAjourDeLaMainCouranteParApportAPlusieursPointDeVente(NOM_ARTICLE, POINT_DE_VENTE, MONTANT_TTC, ANNULATION)

                mainsCourante.updateMainCouranteAutresEnRetranchant(CODE_MAIN_COURANTE_JOURNALIERE, TABLE, "A_REPORTER", MONTANT_TTC)

            Next

        Else

        End If

    End Sub

    Public Shared Sub miseAjourDeLaMainCouranteParApportAPlusieursPointDeVente(ByVal nomArticle As String, ByVal pointDeVente As String, ByVal montantPointDeVente As Double, ByVal Optional ANNULATION As Integer = 0)

        Dim BAR_RESTAURANT As Double
        Dim SERVICES As Double
        Dim SALON_DE_BEAUTE As Double
        Dim BOUTIQE As Double
        Dim BUSINESS_CENTER As Double
        Dim AUTRES As Double
        Dim SPORTS As Double
        Dim KIOSQUE_A_JOURNAUX As Double
        Dim LOISIRS As Double
        Dim BLANCHISSERIE As Double

        'GunaTextBoxMontantTTCGeneral.Text = OLD_MONTANT_TTC

        If pointDeVente = "BAR" Or pointDeVente = "RESTAURANT" Then

            If ANNULATION = 1 Then
                BAR_RESTAURANT = montantPointDeVente * -1
            Else
                BAR_RESTAURANT = montantPointDeVente
            End If

            SERVICES = 0
            SALON_DE_BEAUTE = 0
            BOUTIQE = 0
            BUSINESS_CENTER = 0
            AUTRES = 0
            SPORTS = 0
            LOISIRS = 0
            KIOSQUE_A_JOURNAUX = 0
            BLANCHISSERIE = 0

        ElseIf pointDeVente = "SERVICES" Then

            BAR_RESTAURANT = 0

            'AU CAS OU LE SERVICE EST DE TYPE LOCATION SALLE OU HEBERGEMENT ALORS ON NE MET PAS AJOUR LE CHAMP DU SERVICE DANS LA MAINCOURANTE JOURNALIERE

            If ANNULATION = 1 Then
                SERVICES = montantPointDeVente * -1
            Else
                SERVICES = montantPointDeVente
            End If

            SALON_DE_BEAUTE = 0
            BOUTIQE = 0
            BUSINESS_CENTER = 0
            AUTRES = 0
            SPORTS = 0
            LOISIRS = 0
            KIOSQUE_A_JOURNAUX = 0
            BLANCHISSERIE = 0

        ElseIf pointDeVente = "SALON DE BEAUTE" Then

            BAR_RESTAURANT = 0
            SERVICES = 0

            If ANNULATION = 1 Then
                SALON_DE_BEAUTE = montantPointDeVente * -1
            Else
                SALON_DE_BEAUTE = montantPointDeVente
            End If

            BOUTIQE = 0
            BUSINESS_CENTER = 0
            AUTRES = 0
            SPORTS = 0
            LOISIRS = 0
            KIOSQUE_A_JOURNAUX = 0
            BLANCHISSERIE = 0

        ElseIf pointDeVente = "BOUTIQUE" Then

            BAR_RESTAURANT = 0
            SERVICES = 0
            SALON_DE_BEAUTE = 0

            If ANNULATION = 1 Then
                BOUTIQE = montantPointDeVente * -1
            Else
                BOUTIQE = montantPointDeVente
            End If

            BUSINESS_CENTER = 0
            AUTRES = 0
            SPORTS = 0
            LOISIRS = 0
            KIOSQUE_A_JOURNAUX = 0
            BLANCHISSERIE = 0

        ElseIf pointDeVente = "BUSINESS CENTER" Then

            BAR_RESTAURANT = 0
            SERVICES = 0
            SALON_DE_BEAUTE = 0
            BOUTIQE = 0

            If ANNULATION = 1 Then
                BUSINESS_CENTER = montantPointDeVente * -1
            Else
                BUSINESS_CENTER = montantPointDeVente
            End If

            AUTRES = 0
            SPORTS = 0
            LOISIRS = 0
            KIOSQUE_A_JOURNAUX = 0
            BLANCHISSERIE = 0

        ElseIf pointDeVente = "AUTRES" Then

            BAR_RESTAURANT = 0
            SERVICES = 0
            SALON_DE_BEAUTE = 0
            BOUTIQE = 0
            BUSINESS_CENTER = 0

            If ANNULATION = 1 Then
                AUTRES = montantPointDeVente * -1
            Else
                AUTRES = montantPointDeVente
            End If

            SPORTS = 0
            LOISIRS = 0
            KIOSQUE_A_JOURNAUX = 0
            BLANCHISSERIE = 0

        ElseIf pointDeVente = "SPORTS" Then

            BAR_RESTAURANT = 0
            SERVICES = 0
            SALON_DE_BEAUTE = 0
            BOUTIQE = 0
            BUSINESS_CENTER = 0
            AUTRES = 0
            If ANNULATION = 1 Then
                SPORTS = montantPointDeVente * -1
            Else
                SPORTS = montantPointDeVente
            End If
            LOISIRS = 0
            KIOSQUE_A_JOURNAUX = 0
            BLANCHISSERIE = 0

        ElseIf pointDeVente = "LOISIRS" Then

            BAR_RESTAURANT = 0
            SERVICES = 0
            SALON_DE_BEAUTE = 0
            BOUTIQE = 0
            BUSINESS_CENTER = 0
            AUTRES = 0
            SPORTS = 0
            If ANNULATION = 1 Then
                LOISIRS = montantPointDeVente * -1

            Else
                LOISIRS = montantPointDeVente

            End If
            KIOSQUE_A_JOURNAUX = 0
            BLANCHISSERIE = 0

        ElseIf pointDeVente = "KIOSQUE A JOURNAUX" Then

            BAR_RESTAURANT = 0
            SERVICES = 0
            SALON_DE_BEAUTE = 0
            BOUTIQE = 0
            BUSINESS_CENTER = 0
            AUTRES = 0
            SPORTS = 0
            LOISIRS = 0
            If ANNULATION = 1 Then
                KIOSQUE_A_JOURNAUX = montantPointDeVente * -1
            Else
                KIOSQUE_A_JOURNAUX = montantPointDeVente
            End If
            BLANCHISSERIE = 0

        ElseIf pointDeVente = "BLANCHISSERIE" Then

            BAR_RESTAURANT = 0
            SERVICES = 0
            SALON_DE_BEAUTE = 0
            BOUTIQE = 0
            BUSINESS_CENTER = 0
            AUTRES = 0
            SPORTS = 0
            LOISIRS = 0
            KIOSQUE_A_JOURNAUX = 0
            If ANNULATION = 1 Then
                BLANCHISSERIE = montantPointDeVente * -1
            Else
                BLANCHISSERIE = montantPointDeVente
            End If

        Else

            BAR_RESTAURANT = 0
            SERVICES = 0
            SALON_DE_BEAUTE = 0
            BOUTIQE = 0
            BUSINESS_CENTER = 0
            If ANNULATION = 1 Then
                AUTRES = montantPointDeVente * -1

            Else
                AUTRES = montantPointDeVente

            End If
            SPORTS = 0
            LOISIRS = 0
            KIOSQUE_A_JOURNAUX = 0
            BLANCHISSERIE = 0

        End If

        Dim mainCourantes As New MainCourantes()
        Dim CODE_AGENCE As String = GlobalVariable.codeAgence

        Dim CODE_MAIN_COURANTE_AUTRES As String = ""
        'TRAITEMENT DE LA MAIN COURANTE_AUTRE

        '1- VERIFICATION DE L'EXISTENCE D'UNE LIGNE DE MAIN_COURANTE_AUTRE EN DATE DU JOURS AVEC COMME ETAT = 0
        Dim ETAT_MAIN_COURANTE As Integer = 0

        Dim main_courante_autres As DataTable = Functions.getElementByOnCodeAndDate(ETAT_MAIN_COURANTE, "main_courante_autres", "ETAT_MAIN_COURANTE", GlobalVariable.DateDeTravail, "main_courante_autres")

        If main_courante_autres.Rows.Count > 0 Then

            '-SI OUI MISE AJOURS
            CODE_MAIN_COURANTE_AUTRES = main_courante_autres.Rows(0)("CODE_MAIN_COURANTE_JOURNALIERE")

            MainCourantes.updateMainCouranteAfterFacturation("main_courante_autres", CODE_MAIN_COURANTE_AUTRES, BAR_RESTAURANT, SERVICES, SALON_DE_BEAUTE, BOUTIQE, BUSINESS_CENTER, AUTRES, SPORTS, LOISIRS, KIOSQUE_A_JOURNAUX, BLANCHISSERIE)

        End If

    End Sub

    Public Shared Function verificationExistenceCheminDesRapportsDuJours(ByVal date_travail As Date)

        Dim query7 As String = "SELECT * FROM rapport_auto WHERE DATE_TRAVAIL <= '" & date_travail.ToString("yyyy-MM-dd") & "' AND DATE_TRAVAIL >='" & date_travail.ToString("yyyy-MM-dd") & "'"

        Dim command7 As New MySqlCommand(query7, GlobalVariable.connect)
        command7.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle

        Dim adapter7 As New MySqlDataAdapter(command7)
        Dim dt As New DataTable()
        adapter7.Fill(dt)

        Return dt

    End Function


    Public Shared Sub docJournalDesVentesPeriodique(ByVal DateDebut As Date, ByVal DateFin As Date, ByVal Optional renvoie As Boolean = False)

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim dateMainCouranteDebut As Date = DateDebut
        Dim TotalCommande As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        If GlobalVariable.actualLanguageValue = 1 Then
            titreFichier = "JOURNAL DES VENTES"
            tireDocument = "Journal des ventes périodique du " & DateDebut.ToString("ddMMyy") & " "
        Else
            titreFichier = "SALES HISTORY"
            tireDocument = "Sales history of " & DateDebut.ToString("ddMMyy") & " "
        End If

        Dim ListeDesResumeDesVentes As DataTable

        Dim fichier As String = ""
        Dim nomDuDossierRapport As String = "RAPPORTS\JOURNAL_DES_VENTES"

        Dim filePathAndDirectory As String = ""

        filePathAndDirectory = GlobalVariable.AgenceActuelle.Rows(0)("CHEMIN_SAUVEGARDE_AUTO") & "\" & nomDuDossierRapport & "\" & dateMainCouranteDebut.ToString("ddMMyy")

        My.Computer.FileSystem.CreateDirectory(filePathAndDirectory)

        If Not renvoie Then

            If GlobalVariable.actualLanguageValue = 1 Then
                fichier = filePathAndDirectory & "\" & titreFichier & " DU " & GlobalVariable.DateDeTravail.AddDays(-1).ToString("ddMMyy") & ".pdf"
            Else
                fichier = filePathAndDirectory & "\" & titreFichier & " OF " & GlobalVariable.DateDeTravail.AddDays(-1).ToString("ddMMyy") & ".pdf"
            End If

        Else

            If GlobalVariable.actualLanguageValue = 1 Then
                fichier = filePathAndDirectory & "\" & titreFichier & " DU " & dateMainCouranteDebut.ToString("ddMMyy") & ".pdf"
            Else
                fichier = filePathAndDirectory & "\" & titreFichier & " OF " & dateMainCouranteDebut.ToString("ddMMyy") & ".pdf"
            End If

        End If

        If True Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            'Dim pdfDoc As New Document(PageSize.B7, 5, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(fichier, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow1 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p3 As Paragraph = New Paragraph(Chr(13) & Date.Now() & Chr(13), pColumn)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            If DateDebut = DateFin Then

                Dim p0 As Paragraph = New Paragraph(Chr(13) & " JOURNAL DES VENTES DU : " & DateDebut & Chr(13) & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            Else

                Dim p0 As Paragraph = New Paragraph(Chr(13) & " JOURNAL DES VENTES DU : " & DateDebut & " AU " & DateFin & Chr(13) & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            End If

            Dim totalDesDesVentesDeLaFamille As Double = 0
            Dim qteDeLaFamille As Double = 0
            Dim totalDesDesVentes As Double = 0

            Dim totalDesDesVentesDeLaFamille2 As Double = 0
            Dim totalDesDesVentes2 As Double = 0
            Dim qteDeLaFamille2 As Double = 0

            '1- ON SELECTION TOUS LES VENDEURS SI ON NE TRAITE PAS UN VENDEUR INDIVIDUEL
            '2- PUIS ON AFFICHE LES VENTES PAR FAMILLE

            Dim grandTotal As Double = 0

            If True Then 'FOR ALL THE CASHIER

                Dim ligne_facture As New LigneFacture()

                Dim listeDesVendeurs As DataTable = ligne_facture.ListeDesVendeurs(DateDebut, DateFin)

                Dim resumeDesVentes(listeDesVendeurs.Rows.Count) As resumeInfo

                If listeDesVendeurs.Rows.Count > 0 Then

                    For k = 0 To listeDesVendeurs.Rows.Count - 1

                        Dim CODE_CAISSIER As String = listeDesVendeurs.Rows(k)("CAISSIER")

                        Dim infoVendeur As DataTable = Functions.getElementByCode(CODE_CAISSIER, "utilisateurs", "CODE_UTILISATEUR")

                        Dim montantVenteResume As Double = 0

                        If infoVendeur.Rows.Count > 0 Then

                            Dim ligneFacture As New LigneFacture()
                            Dim dtCategoryParent As DataTable = ligneFacture.ListeDesCategoriesDArticleVendus(DateDebut, DateFin, CODE_CAISSIER)

                            If dtCategoryParent.Rows.Count > 0 Then

                                Dim p02 As Paragraph = New Paragraph("JOURNAL DES VENTES DE : " & infoVendeur.Rows(0)("NOM_UTILISATEUR") & Chr(13), pRow)
                                p02.Alignment = Element.ALIGN_RIGHT

                                pdfDoc.Add(p02)

                                For i = 0 To dtCategoryParent.Rows.Count - 1
                                    'VENTES
                                    Dim pdfTable As New PdfPTable(4) 'Number of columns
                                    pdfTable.TotalWidth = 520.0F
                                    pdfTable.LockedWidth = True
                                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                                    pdfTable.HeaderRows = 1

                                    Dim widths As Single() = New Single() {60.0F, 15.0F, 10.0F, 15.0F}

                                    pdfTable.SetWidths(widths)

                                    totalDesDesVentesDeLaFamille = 0
                                    qteDeLaFamille = 0

                                    Dim CategoriePArent As String = dtCategoryParent.Rows(i)("SOUS FAMILLE")

                                    Dim p2 As Paragraph = New Paragraph(i + 1 & "-" & CategoriePArent & Chr(13) & Chr(13), pRow)
                                    p2.Alignment = Element.ALIGN_LEFT

                                    pdfDoc.Add(p2)

                                    pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 15
                                    'pdfCell.PaddingLeft = 5.0F
                                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                    pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 15
                                    'pdfCell.PaddingLeft = 5.0F
                                    pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 15
                                    'pdfCell.PaddingLeft = 5.0F
                                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                    pdfTable.AddCell(pdfCell)

                                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                    'pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 15
                                    'pdfCell.PaddingLeft = 5.0F
                                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                    pdfTable.AddCell(pdfCell)

                                    'ARTICLE D'UNE FAMILLE QUELCONQUE

                                    Dim dt As DataTable

                                    dt = ligneFacture.ListeDesArticlesVendusParFamilleDunCaissier(CategoriePArent, DateDebut, DateFin, CODE_CAISSIER)

                                    If dt.Rows.Count > 0 Then

                                        For j = 0 To dt.Rows.Count - 1

                                            totalDesDesVentesDeLaFamille += dt.Rows(j)("MONTANT TOTAL")
                                            totalDesDesVentes += dt.Rows(j)("MONTANT TOTAL")
                                            qteDeLaFamille += dt.Rows(j)("QUANTITE")

                                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(j)("LIBELLE ARTICLE"), font1))
                                            pdfCell.MinimumHeight = 15
                                            pdfCell.PaddingLeft = 5.0F
                                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                            pdfTable.AddCell(pdfCell)

                                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j)("PRIX UNITAIRE"), "#,##0"), font1))
                                            pdfCell.MinimumHeight = 15
                                            pdfCell.PaddingLeft = 5.0F
                                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                            pdfTable.AddCell(pdfCell)

                                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j)("QUANTITE"), "#,##0"), font1))
                                            pdfCell.MinimumHeight = 15
                                            pdfCell.PaddingLeft = 5.0F
                                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                            pdfTable.AddCell(pdfCell)

                                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j)("MONTANT TOTAL"), "#,##0"), font1))
                                            pdfCell.MinimumHeight = 15
                                            pdfCell.PaddingLeft = 5.0F
                                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                            pdfTable.AddCell(pdfCell)

                                        Next

                                    End If

                                    pdfCell = New PdfPCell(New Paragraph("TOTAL", pRow))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.Colspan = 2
                                    pdfCell.Border = 0
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                    pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(qteDeLaFamille, "#,##0"), pRow))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.Border = 0
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(totalDesDesVentesDeLaFamille, "#,##0"), pRow))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.Border = 0
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                    pdfTable.AddCell(pdfCell)

                                    pdfDoc.Add(pdfTable)

                                    '---------------------GRATUITE----------------------------------

                                    Dim p7 As Paragraph = New Paragraph("GRATUITES ****: " & Chr(13) & Chr(13), pRow)
                                    p7.Alignment = Element.ALIGN_CENTER

                                    Dim pdfTable2 As New PdfPTable(4) 'Number of columns
                                    pdfTable2.TotalWidth = 520.0F
                                    pdfTable2.LockedWidth = True
                                    pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                                    pdfTable2.HeaderRows = 1

                                    Dim widths2 As Single() = New Single() {60.0F, 15.0F, 10.0F, 15.0F}

                                    pdfTable2.SetWidths(widths2)

                                    totalDesDesVentesDeLaFamille2 = 0

                                    Dim ligneFacture2 As New LigneFacture()
                                    'Dim CategoriePArent2 As String = dtCategoryParent.Rows(i)("SOUS FAMILLE")

                                    Dim p8 As Paragraph = New Paragraph("FAMILLE D'ARTICLE: " & CategoriePArent & Chr(13) & Chr(13), font1)
                                    p8.Alignment = Element.ALIGN_LEFT

                                    'pdfDoc.Add(p2)

                                    pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 15
                                    'pdfCell.PaddingLeft = 5.0F
                                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                    pdfTable2.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 15
                                    'pdfCell.PaddingLeft = 5.0F
                                    pdfTable2.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 15
                                    'pdfCell.PaddingLeft = 5.0F
                                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                    pdfTable2.AddCell(pdfCell)

                                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                    'pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 15
                                    'pdfCell.PaddingLeft = 5.0F
                                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                    pdfTable2.AddCell(pdfCell)

                                    'ARTICLE D'UNE FAMILLE QUELCONQUE
                                    'Dim dtGratuite As DataTable = ligneFacture.ListeDesArticlesVendusGratuitementParFamille(CategoriePArent, DateDebut, DateFin)
                                    Dim dtGratuite As DataTable = ligneFacture.ListeDesArticlesVendusGratuitementParFamilleCaissier(CategoriePArent, DateDebut, DateFin, CODE_CAISSIER)

                                    If dtGratuite.Rows.Count > 0 Then

                                        pdfDoc.Add(p7)

                                        totalDesDesVentesDeLaFamille2 = 0
                                        qteDeLaFamille2 = 0

                                        For j = 0 To dtGratuite.Rows.Count - 1

                                            totalDesDesVentesDeLaFamille2 += dtGratuite.Rows(j)("MONTANT TOTAL")
                                            totalDesDesVentes2 += dtGratuite.Rows(j)("MONTANT TOTAL")
                                            qteDeLaFamille2 += dtGratuite.Rows(j)("QUANTITE")

                                            pdfCell = New PdfPCell(New Paragraph(dtGratuite.Rows(j)("LIBELLE ARTICLE"), font1))
                                            pdfCell.MinimumHeight = 15
                                            pdfCell.PaddingLeft = 5.0F
                                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                            pdfTable2.AddCell(pdfCell)

                                            pdfCell = New PdfPCell(New Paragraph(Format(dtGratuite.Rows(j)("PRIX UNITAIRE"), "#,##0"), font1))
                                            pdfCell.MinimumHeight = 15
                                            pdfCell.PaddingLeft = 5.0F
                                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                            pdfTable2.AddCell(pdfCell)

                                            pdfCell = New PdfPCell(New Paragraph(Format(dtGratuite.Rows(j)("QUANTITE"), "#,##0"), font1))
                                            pdfCell.MinimumHeight = 15
                                            pdfCell.PaddingLeft = 5.0F
                                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                            pdfTable2.AddCell(pdfCell)

                                            pdfCell = New PdfPCell(New Paragraph(Format(dtGratuite.Rows(j)("MONTANT TOTAL"), "#,##0"), font1))
                                            pdfCell.MinimumHeight = 15
                                            pdfCell.PaddingLeft = 5.0F
                                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                            pdfTable2.AddCell(pdfCell)

                                        Next

                                    End If

                                    If Double.Parse(totalDesDesVentesDeLaFamille2) > 0 Then

                                        pdfCell = New PdfPCell(New Paragraph("TOTAL", pRow))
                                        pdfCell.MinimumHeight = 15
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.Border = 0
                                        pdfCell.Colspan = 2
                                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfTable2.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(Format(qteDeLaFamille2, "#,##0"), pRow))
                                        pdfCell.MinimumHeight = 15
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.Border = 0
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfTable2.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(Format(totalDesDesVentesDeLaFamille2, "#,##0"), pRow))
                                        pdfCell.MinimumHeight = 15
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.Border = 0
                                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfTable2.AddCell(pdfCell)

                                        'Dim p9 As Paragraph = New Paragraph(" TOTAL : " & Format(totalDesDesVentesDeLaFamille2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                                        'p9.Alignment = Element.ALIGN_CENTER

                                        'pdfDoc.Add(p9)

                                    End If

                                    pdfDoc.Add(pdfTable2)
                                    '----------------------------- END GRATUITE --------------------------

                                Next

                                '------------------------------------------------------------------------

                                Dim p9 As Paragraph = New Paragraph(Chr(13), pRow)
                                p9.Alignment = Element.ALIGN_CENTER

                                pdfDoc.Add(p9)

                                Dim pdfCell4 As PdfPCell = Nothing


                                grandTotal += totalDesDesVentes

                                Dim pdfTable04 As New PdfPTable(2) 'Number of columns

                                pdfTable04.TotalWidth = 520.0F
                                pdfTable04.LockedWidth = True
                                pdfTable04.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfTable04.HeaderRows = 1

                                Dim widths04 As Single() = New Single() {60.0F, 30.0}
                                pdfTable04.SetWidths(widths04)

                                pdfCell4 = New PdfPCell(New Paragraph("TOTAL RECETTES", pRow))
                                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell4.MinimumHeight = 18
                                pdfCell4.PaddingLeft = 15.0F
                                pdfCell4.Border = 0
                                pdfTable04.AddCell(pdfCell4)

                                pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesVentes, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell4.MinimumHeight = 18
                                pdfCell4.PaddingLeft = 15.0F
                                pdfCell4.Border = 0
                                pdfTable04.AddCell(pdfCell4)

                                pdfCell4 = New PdfPCell(New Paragraph("TOTAL GRATUITEES", pRow))
                                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell4.MinimumHeight = 18
                                pdfCell4.PaddingLeft = 15.0F
                                pdfCell4.Border = 0
                                pdfTable04.AddCell(pdfCell4)

                                pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesVentes2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell4.MinimumHeight = 18
                                pdfCell4.PaddingLeft = 15.0F
                                pdfCell4.Border = 0
                                pdfTable04.AddCell(pdfCell4)

                                pdfCell4 = New PdfPCell(New Paragraph("VENTE NET", pRow))
                                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell4.MinimumHeight = 18
                                pdfCell4.PaddingLeft = 15.0F
                                pdfCell4.Border = 0
                                pdfTable04.AddCell(pdfCell4)

                                pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesVentes - totalDesDesVentes2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell4.MinimumHeight = 18
                                pdfCell4.PaddingLeft = 15.0F
                                pdfCell4.Border = 0
                                pdfTable04.AddCell(pdfCell4)

                                pdfDoc.Add(pdfTable04)

                                '-----------------------------------
                                montantVenteResume = totalDesDesVentes

                                totalDesDesVentes = 0
                                totalDesDesVentes2 = 0
                                totalDesDesVentesDeLaFamille2 = 0
                                totalDesDesVentesDeLaFamille = 0

                            End If

                            resumeDesVentes(k).nomEmploye = infoVendeur.Rows(0)("NOM_UTILISATEUR")
                            resumeDesVentes(k).montant = montantVenteResume

                            '--------------------- RESUME DES VENTES GLOBAL ---------------------------

                            ListeDesResumeDesVentes = Impression.resumeDesVentesQuotidienne(DateDebut, DateFin, CODE_CAISSIER)

                            If ListeDesResumeDesVentes.Rows.Count > 0 Then

                                Dim compte_ As Double = 0
                                Dim gratuitee_ As Double = 0
                                Dim chambre_ As Double = 0
                                Dim comptoir_ As Double = 0
                                Dim offreEnChambre_ As Double = 0

                                For i = 0 To ListeDesResumeDesVentes.Rows.Count - 1
                                    compte_ += ListeDesResumeDesVentes(i)("COMPTE")
                                    gratuitee_ += ListeDesResumeDesVentes(i)("GRATUITEE")
                                    chambre_ += ListeDesResumeDesVentes(i)("EN_CHAMBRE")
                                    comptoir_ += ListeDesResumeDesVentes(i)("COMPTOIR")
                                    offreEnChambre_ += ListeDesResumeDesVentes(i)("GRATUITE_EN_CHAMBRE")
                                Next

                                Dim pdfTable04 As New PdfPTable(10) 'Number of columns

                                pdfTable04.TotalWidth = 520.0F
                                pdfTable04.LockedWidth = True
                                pdfTable04.HorizontalAlignment = Element.ALIGN_RIGHT
                                'pdfTable04.HeaderRows = 1

                                Dim widths04 As Single() = New Single() {15.0F, 15.0F, 16.0F, 16.0F, 17.0F, 17.0F, 17.0F, 17.0F, 14.0F, 14.0F}
                                pdfTable04.SetWidths(widths04)

                                Dim pdfCell04 As PdfPCell = Nothing

                                pdfCell04 = New PdfPCell(New Paragraph("VENTE COMPTOIR", pRow1))
                                pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell04.MinimumHeight = 10
                                pdfCell04.Colspan = 2
                                pdfCell04.PaddingLeft = 15.0F
                                pdfTable04.AddCell(pdfCell04)

                                pdfCell04 = New PdfPCell(New Paragraph("VENTE EN CHAMBRE", pRow1))
                                pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell04.MinimumHeight = 10
                                pdfCell04.Colspan = 2
                                pdfCell04.PaddingLeft = 15.0F
                                pdfTable04.AddCell(pdfCell04)

                                pdfCell04 = New PdfPCell(New Paragraph("OFFRES EN CHAMBRE", pRow1))
                                pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell04.MinimumHeight = 10
                                pdfCell04.Colspan = 2
                                pdfCell04.PaddingLeft = 15.0F
                                pdfTable04.AddCell(pdfCell04)

                                pdfCell04 = New PdfPCell(New Paragraph("AUTRES OFFRES", pRow1))
                                pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell04.MinimumHeight = 10
                                pdfCell04.Colspan = 2
                                pdfCell04.PaddingLeft = 15.0F
                                pdfTable04.AddCell(pdfCell04)

                                pdfCell04 = New PdfPCell(New Paragraph("VERS COMPTE", pRow1))
                                pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell04.MinimumHeight = 10
                                pdfCell04.Colspan = 2
                                pdfCell04.PaddingLeft = 15.0F
                                pdfTable04.AddCell(pdfCell04)

                                '-------------------------- HEADER END --------------------------

                                pdfCell04 = New PdfPCell(New Paragraph(Format(comptoir_, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                                pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell04.MinimumHeight = 10
                                pdfCell04.Colspan = 2
                                pdfCell04.PaddingLeft = 15.0F
                                pdfTable04.AddCell(pdfCell04)

                                pdfCell04 = New PdfPCell(New Paragraph(Format(chambre_, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                                pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell04.MinimumHeight = 10
                                pdfCell04.Colspan = 2
                                pdfCell04.PaddingLeft = 15.0F
                                pdfTable04.AddCell(pdfCell04)

                                pdfCell04 = New PdfPCell(New Paragraph(Format(offreEnChambre_, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                                pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell04.MinimumHeight = 10
                                pdfCell04.Colspan = 2
                                pdfCell04.PaddingLeft = 15.0F
                                pdfTable04.AddCell(pdfCell04)

                                pdfCell04 = New PdfPCell(New Paragraph(Format(gratuitee_ - offreEnChambre_, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                                pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell04.MinimumHeight = 10
                                pdfCell04.Colspan = 2
                                pdfCell04.PaddingLeft = 15.0F
                                pdfTable04.AddCell(pdfCell04)

                                pdfCell04 = New PdfPCell(New Paragraph(Format(compte_, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                                pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell04.MinimumHeight = 10
                                pdfCell04.Colspan = 2
                                pdfCell04.PaddingLeft = 15.0F
                                pdfTable04.AddCell(pdfCell04)

                                pdfDoc.Add(pdfTable04)

                            End If
                            '--------------------------------------------------------------------------
                        End If

                    Next

                    '------------------------------------------------------ RESUME DES VENTES DU CAISSIER ------------------------------------------------------------------------------

                    Dim p04 As Paragraph = New Paragraph(Chr(13) & " RESUME DES VENTES " & Chr(13) & Chr(13), pRow)
                    p04.Alignment = Element.ALIGN_CENTER
                    pdfDoc.Add(p04)

                    Dim pdfTable01 As New PdfPTable(2) 'Number of columns
                    pdfTable01.TotalWidth = 520.0F
                    pdfTable01.LockedWidth = True
                    pdfTable01.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable01.HeaderRows = 1

                    Dim widths01 As Single() = New Single() {50.0F, 20.0F}
                    pdfTable01.SetWidths(widths01)

                    For l = 0 To listeDesVendeurs.Rows.Count - 1

                        If resumeDesVentes(l).montant > 0 Then

                            pdfCell = New PdfPCell(New Paragraph(resumeDesVentes(l).nomEmploye, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 15.0F

                            pdfTable01.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(resumeDesVentes(l).montant, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 15.0F

                            pdfTable01.AddCell(pdfCell)

                        End If

                    Next

                    pdfCell = New PdfPCell(New Paragraph("GRAND TOTAL :", pRow))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    pdfCell.PaddingLeft = 15.0F
                    pdfTable01.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(grandTotal, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 5
                    pdfCell.PaddingLeft = 15.0F
                    pdfTable01.AddCell(pdfCell)

                    pdfDoc.Add(pdfTable01)

                    Dim p002 As Paragraph = New Paragraph(Chr(13) & "Arrêter la présente à la somme de : " & Functions.NBLT(grandTotal) & " " & societe.Rows(0)("CODE_MONNAIE") & Chr(13) & Chr(13), pRow)
                    p002.Alignment = Element.ALIGN_LEFT

                    pdfDoc.Add(p002)

                    '--------------------- RESUME DES VENTES GLOBAL ---------------------------

                    ListeDesResumeDesVentes = Impression.resumeDesVentesGlobal(DateDebut, DateFin)

                    If ListeDesResumeDesVentes.Rows.Count > 0 Then

                        Dim compte As Double = 0
                        Dim gratuitee As Double = 0
                        Dim chambre As Double = 0
                        Dim comptoir As Double = 0
                        Dim offreEnChambre As Double = 0

                        For i = 0 To ListeDesResumeDesVentes.Rows.Count - 1
                            compte += ListeDesResumeDesVentes(i)("COMPTE")
                            gratuitee += ListeDesResumeDesVentes(i)("GRATUITEE")
                            chambre += ListeDesResumeDesVentes(i)("EN_CHAMBRE")
                            comptoir += ListeDesResumeDesVentes(i)("COMPTOIR")
                            offreEnChambre += ListeDesResumeDesVentes(i)("GRATUITE_EN_CHAMBRE")
                        Next

                        Dim pdfTable04 As New PdfPTable(10) 'Number of columns

                        pdfTable04.TotalWidth = 520.0F
                        pdfTable04.LockedWidth = True
                        pdfTable04.HorizontalAlignment = Element.ALIGN_RIGHT
                        'pdfTable04.HeaderRows = 1

                        Dim widths04 As Single() = New Single() {15.0F, 15.0F, 16.0F, 16.0F, 17.0F, 17.0F, 17.0F, 17.0F, 14.0F, 14.0F}
                        pdfTable04.SetWidths(widths04)

                        Dim pdfCell04 As PdfPCell = Nothing

                        pdfCell04 = New PdfPCell(New Paragraph("VENTE COMPTOIR", pRow1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph("VENTE EN CHAMBRE", pRow1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph("OFFRES EN CHAMBRE", pRow1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph("AUTRES OFFRES", pRow1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph("VERS COMPTE", pRow1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        '-------------------------- HEADER END --------------------------

                        pdfCell04 = New PdfPCell(New Paragraph(Format(comptoir, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph(Format(chambre, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph(Format(offreEnChambre, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph(Format(gratuitee - offreEnChambre, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph(Format(compte, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfDoc.Add(pdfTable04)

                    End If
                    '--------------------------------------------------------------------------

                Else

                End If

            End If

            Dim dtRapport As DataTable = Functions.verificationExistenceCheminDesRapportsDuJours(dateMainCouranteDebut)

            If dtRapport.Rows.Count > 0 Then
                Dim ID_RAPPORT = dtRapport.Rows(0)("ID_RAPPORT")
                updateOfFields("rapport_auto", "CHEMIN_VENTES", fichier, "ID_RAPPORT", ID_RAPPORT, 2)
            End If

            pdfDoc.Close()

        End If

    End Sub


    Public Shared Sub docInventaireDesVentesParMagasin(ByVal DateDebut As Date, ByVal DateFin As Date, ByVal Optional renvoie As Boolean = False)

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim dateMainCouranteDebut As Date = DateDebut
        Dim titreFichier As String = "RAPPORT DES VENTES JOURNALIER PAR MAGASIN"
        Dim TotalCommande As Double = 0
        Dim tireDocument As String = ""

        tireDocument = titreFichier & " DU " & dateMainCouranteDebut.ToString("ddMMyy") & " "

        Dim fichier As String = ""
        Dim nomDuDossierRapport As String = "RAPPORTS\INVENTAIRES_DES_VENTES"

        Dim filePathAndDirectory As String = ""

        filePathAndDirectory = GlobalVariable.AgenceActuelle.Rows(0)("CHEMIN_SAUVEGARDE_AUTO") & "\" & nomDuDossierRapport & "\" & dateMainCouranteDebut.ToString("ddMMyy")

        My.Computer.FileSystem.CreateDirectory(filePathAndDirectory)

        If Not renvoie Then

            If GlobalVariable.actualLanguageValue = 1 Then
                fichier = filePathAndDirectory & "\" & titreFichier & " DU " & GlobalVariable.DateDeTravail.AddDays(-1).ToString("ddMMyy") & ".pdf"
            Else
                fichier = filePathAndDirectory & "\" & titreFichier & " OF " & GlobalVariable.DateDeTravail.AddDays(-1).ToString("ddMMyy") & ".pdf"
            End If

        Else

            If GlobalVariable.actualLanguageValue = 1 Then
                fichier = filePathAndDirectory & "\" & titreFichier & " DU " & dateMainCouranteDebut.ToString("ddMMyy") & ".pdf"
            Else
                fichier = filePathAndDirectory & "\" & titreFichier & " OF " & dateMainCouranteDebut.ToString("ddMMyy") & ".pdf"
            End If

        End If

        If True Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 40, 40)
            'Dim pdfDoc As New Document(PageSize.B7, 5, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(fichier, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            Dim pdfCell As PdfPCell = Nothing

            'pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & "***", pColumn)
            p1.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p1)

            'Dim p3 As Paragraph = New Paragraph(Date.Now() & Chr(13), pColumn)
            'p3.Alignment = Element.ALIGN_CENTER

            'pdfDoc.Add(p3)

            If DateDebut = DateFin Then

                Dim p0 As Paragraph = New Paragraph(Chr(13) & titreFichier & " DU " & DateDebut & Chr(13) & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            Else

                Dim p0 As Paragraph = New Paragraph(Chr(13) & titreFichier & " DU " & DateFin & Chr(13) & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            End If

            Dim dt As DataTable

            Dim totalDesDesVentes As Double = 0
            Dim totalDesDesVentes2 As Double = 0

            'VENTES

            'ARTICLE D'UNE FAMILLE QUELCONQUE

            Dim ligne_facture As New LigneFacture()
            Dim CODE_CAISSIER As String = ""
            'Dim diversCodeMagasin As DataTable = ligne_facture.ListeDesArticlesVendusInventaireParFamilleMagasin(DateDebut, DateFin, CODE_CAISSIER, CategoriePArent)
            Dim diversCodeMagasin As DataTable = ligne_facture.ListeDesPointsDeVente(DateDebut, DateFin, CODE_CAISSIER)

            Dim resumeDesVentes(diversCodeMagasin.Rows.Count) As resumeInfo

            If diversCodeMagasin.Rows.Count > 0 Then

                'ON TRAITE LES DIVERS POINT DE VENTE
                Dim infoSupDuMagasin As New DataTable()
                Dim CODE_MAGASIN As String = ""

                For m = 0 To diversCodeMagasin.Rows.Count - 1

                    '------------------------------------------------------------------------------------------------------------------------------
                    Dim pdfTable As New PdfPTable(6) 'Number of columns
                    pdfTable.TotalWidth = 520.0F
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.HeaderRows = 1

                    Dim widths As Single() = New Single() {65.0F, 10.0F, 15.0F, 18.0F, 20.0F, 20.0F}

                    pdfTable.SetWidths(widths)

                    pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("P. UNI", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    'pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("P. ACHAT", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("MARGE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)
                    '------------------------------------------------------------------------------------------------------------------------------

                    totalDesDesVentes = 0
                    totalDesDesVentes2 = 0

                    CODE_MAGASIN = diversCodeMagasin.Rows(m)("CODE_MAGASIN")
                    infoSupDuMagasin = Functions.getElementByCode(CODE_MAGASIN, "magasin", "CODE_MAGASIN")

                    If infoSupDuMagasin.Rows.Count > 0 Then

                        Dim nomDuMagasin As String = infoSupDuMagasin.Rows(0)("LIBELLE_MAGASIN")

                        Dim p02 As Paragraph = New Paragraph(Chr(13) & " -/ " & infoSupDuMagasin.Rows(0)("LIBELLE_MAGASIN") & Chr(13) & Chr(13), pRow)
                        p02.Alignment = Element.ALIGN_CENTER

                        Dim totalQuantite As Double = 0
                        Dim totalAchat As Double = 0
                        Dim totalMarge As Double = 0

                        dt = ligne_facture.ListeDesArticlesVendusInventaireMagasin(DateDebut, DateFin, CODE_CAISSIER, CODE_MAGASIN)

                        If dt.Rows.Count > 0 Then

                            pdfDoc.Add(p02)

                            Dim ordre As Integer = 0

                            '-----------------------------------------------------------------------

                            Dim articleIndividuel As New DataTable()

                            For i = 0 To dt.Rows.Count - 1

                                ordre += 1

                                Dim CODE_ARTICLE As String = dt.Rows(i)("CODE_ARTICLE")
                                'Dim LIBELLE_FACTURE As String = ListeDesVentes.Rows(i)("LIBELLE_FACTURE")

                                Dim LIBELLE_FACTURE As String = ""

                                Dim PA As Double = 0

                                Dim infoArticle As DataTable = Functions.getElementByCode(CODE_ARTICLE, "article", "CODE_ARTICLE")

                                If infoArticle.Rows.Count > 0 Then
                                    LIBELLE_FACTURE = infoArticle.Rows(0)("DESIGNATION_FR")
                                    PA = infoArticle.Rows(0)("COUT_U_MOYEN_PONDERE")
                                    totalAchat += PA
                                End If

                                Dim PRIXMOYENUNITAIRE As Double = 0
                                Dim QUANTITE As Double = 0
                                Dim MONTANT As Double = 0

                                articleIndividuel = ligne_facture.ListeDesArticlesVendusInventaireIndividuelMagasin(DateDebut, DateFin, CODE_CAISSIER, CODE_ARTICLE, CODE_MAGASIN)

                                For j = 0 To articleIndividuel.Rows.Count - 1

                                    QUANTITE += articleIndividuel.Rows(j)("QUANTITE")
                                    MONTANT += articleIndividuel.Rows(j)("MONTANT TOTAL")

                                    If QUANTITE > 0 Then
                                        PRIXMOYENUNITAIRE = MONTANT / QUANTITE
                                    End If

                                Next

                                Dim MARGE As Double = MONTANT - (QUANTITE * PA)

                                totalQuantite += QUANTITE
                                totalMarge += MARGE
                                totalDesDesVentes += MONTANT

                                pdfCell = New PdfPCell(New Paragraph(ordre & "- " & LIBELLE_FACTURE, font1))
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F

                                pdfTable.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(QUANTITE, "#,##0"), font1))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F

                                pdfTable.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(PRIXMOYENUNITAIRE, "#,##0"), font1))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F

                                pdfTable.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(PA, "#,##0"), font1))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F

                                pdfTable.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(MONTANT, "#,##0"), font1))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F

                                pdfTable.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(MARGE, "#,##0"), font1))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F

                                pdfTable.AddCell(pdfCell)

                                'DataGridViewFactures.Rows.Add(LIBELLE_FACTURE, QUANTITE, PRIXMOYENUNITAIRE, PA, MONTANT, MARGE)

                            Next

                            pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(totalQuantite, "#,##0"), pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.Border = 0
                            pdfTable.AddCell(pdfCell)

                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            'pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(totalDesDesVentes - totalMarge, "#,##0"), pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(totalDesDesVentes, "#,##0"), pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(totalMarge, "#,##0"), pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable.AddCell(pdfCell)

                            pdfDoc.Add(pdfTable)

                            Dim p4 As Paragraph = New Paragraph(Chr(13) & " TOTAL DES VENTES : " & Format(totalDesDesVentes, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                            p4.Alignment = Element.ALIGN_RIGHT
                            pdfDoc.Add(p4)

                        End If

                        resumeDesVentes(m).nomEmploye = nomDuMagasin
                        resumeDesVentes(m).montant = totalDesDesVentes

                    End If

                Next

                ''-------------------------------------- RESUME DES VENTES ---------------------------

                Dim p04 As Paragraph = New Paragraph(Chr(13) & " RESUME DES VENTES " & Chr(13) & Chr(13), pRow)
                p04.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p04)

                Dim pdfTable01 As New PdfPTable(2) 'Number of columns
                pdfTable01.TotalWidth = 520.0F
                pdfTable01.LockedWidth = True
                'pdfTable01.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.HeaderRows = 1

                Dim widths01 As Single() = New Single() {50.0F, 20.0F}
                pdfTable01.SetWidths(widths01)

                Dim grandTotal As Double = 0

                For l = 0 To diversCodeMagasin.Rows.Count - 1

                    If resumeDesVentes(l).montant > 0 Then

                        pdfCell = New PdfPCell(New Paragraph(resumeDesVentes(l).nomEmploye, pRow))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 15.0F

                        pdfTable01.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(resumeDesVentes(l).montant, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 15.0F

                        pdfTable01.AddCell(pdfCell)

                        grandTotal += resumeDesVentes(l).montant

                    End If

                Next

                pdfCell = New PdfPCell(New Paragraph("GRAND TOTAL :", pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                pdfCell.PaddingLeft = 15.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(grandTotal, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 5
                pdfCell.PaddingLeft = 15.0F
                pdfTable01.AddCell(pdfCell)

                pdfDoc.Add(pdfTable01)

                Dim p002 As Paragraph = New Paragraph(Chr(13) & "Arrêter la présente à la somme de : " & Functions.NBLT(grandTotal) & " " & societe.Rows(0)("CODE_MONNAIE") & Chr(13) & Chr(13), pRow)
                p002.Alignment = Element.ALIGN_LEFT

                pdfDoc.Add(p002)

                pdfDoc.Close()

                Dim dtRapport As DataTable = Functions.verificationExistenceCheminDesRapportsDuJours(dateMainCouranteDebut)

                If dtRapport.Rows.Count > 0 Then
                    Dim ID_RAPPORT = dtRapport.Rows(0)("ID_RAPPORT")
                    updateOfFields("rapport_auto", "INVENTAIRES_DES_VENTES", fichier, "ID_RAPPORT", ID_RAPPORT, 2)
                End If

            End If

        End If

    End Sub

    Public Shared Sub docInventaireDesDiversMagasin(ByVal DateDebut As Date, ByVal DateFin As Date, ByVal Optional renvoie As Boolean = False)

        Dim dateMainCouranteDebut As Date = DateDebut

        Dim titreFichier As String = "INVENTAIRE DES MAGASINS"

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0

        Dim tireDocument As String = titreFichier.ToUpper() & " DU " & (dateMainCouranteDebut.ToString("ddMMyy"))

        Dim sousTitreDocument As String = ""
        Dim totalVente As Double = 0
        sousTitreDocument = tireDocument

        Dim fichier As String = ""

        Dim pdfDoc As New Document(PageSize.A4, 40, 20, 80, 40)
        Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(fichier, FileMode.Create))
        Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 20, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
        Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
        Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
        Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

        pdfWrite.PageEvent = New HeaderFooter

        pdfDoc.Open()

        Dim nomDuDossierRapport As String = "RAPPORTS\INVENTAIRES_DES_MAGASINS"

        Dim filePathAndDirectory As String = ""

        filePathAndDirectory = GlobalVariable.AgenceActuelle.Rows(0)("CHEMIN_SAUVEGARDE_AUTO") & "\" & nomDuDossierRapport & "\" & dateMainCouranteDebut.ToString("ddMMyy")

        My.Computer.FileSystem.CreateDirectory(filePathAndDirectory)

        If Not renvoie Then

            If GlobalVariable.actualLanguageValue = 1 Then
                fichier = filePathAndDirectory & "\" & titreFichier & " DU " & GlobalVariable.DateDeTravail.AddDays(-1).ToString("ddMMyy") & ".pdf"
            Else
                fichier = filePathAndDirectory & "\" & titreFichier & " OF " & GlobalVariable.DateDeTravail.AddDays(-1).ToString("ddMMyy") & ".pdf"
            End If

        Else

            If GlobalVariable.actualLanguageValue = 1 Then
                fichier = filePathAndDirectory & "\" & titreFichier & " DU " & dateMainCouranteDebut.ToString("ddMMyy") & ".pdf"
            Else
                fichier = filePathAndDirectory & "\" & titreFichier & " OF " & dateMainCouranteDebut.ToString("ddMMyy") & ".pdf"
            End If

        End If

        Dim FillingListquery__ As String = "SELECT DISTINCT CODE_MAGASIN FROM magasin WHERE ETAT = @ETAT ORDER BY LIBELLE_MAGASIN ASC"
        Dim commandList__ As New MySqlCommand(FillingListquery__, GlobalVariable.connect)
        commandList__.Parameters.Add("@ETAT", MySqlDbType.Int32).Value = 1

        Dim adapterList__ As New MySqlDataAdapter(commandList__)
        Dim magasins As New DataTable()
        adapterList__.Fill(magasins)

        Dim CODE_MAGASIN As String = ""
        Dim p3 As Paragraph = New Paragraph(Chr(13) & titreFichier.ToUpper() & " DU " & " " & GlobalVariable.DateDeTravail & Chr(13) & Chr(13), pRow)
        p3.Alignment = Element.ALIGN_CENTER

        pdfDoc.Add(p3)

        If magasins.Rows.Count > 0 Then

            For m = 0 To magasins.Rows.Count - 1

                CODE_MAGASIN = magasins.Rows(m)("CODE_MAGASIN")

                Dim FillingListquery As String = "SELECT * FROM article WHERE CODE_FAMILLE = @CODE_FAMILLE AND TYPE=@TYPE AND VISIBLE=@VISIBLE ORDER BY DESIGNATION_FR ASC"
                Dim commandList As New MySqlCommand(FillingListquery, GlobalVariable.connect)
                Dim CODE_FAMILLE As String = "BOISSONS"
                commandList.Parameters.Add("@CODE_FAMILLE", MySqlDbType.VarChar).Value = CODE_FAMILLE
                commandList.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = "article"
                commandList.Parameters.Add("@VISIBLE", MySqlDbType.Int32).Value = 1

                Dim adapterList As New MySqlDataAdapter(commandList)
                Dim dt As New DataTable()
                adapterList.Fill(dt)

                Dim FillingListquery_ As String = "SELECT * FROM article WHERE CODE_FAMILLE = @CODE_FAMILLE AND TYPE=@TYPE AND VISIBLE=@VISIBLE ORDER BY DESIGNATION_FR ASC"
                Dim commandList_ As New MySqlCommand(FillingListquery_, GlobalVariable.connect)
                commandList_.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = "matiere"
                commandList_.Parameters.Add("@VISIBLE", MySqlDbType.Int32).Value = 1

                Dim adapterList_ As New MySqlDataAdapter(commandList_)
                Dim dt_2 As New DataTable()
                adapterList_.Fill(dt_2)

                dt.Merge(dt_2)

                If dt.Rows.Count > 0 Then

                    Dim LIBELLE_MAGASIN As String = ""
                    Dim infoSupMagasin As DataTable = Functions.getElementByCode(CODE_MAGASIN, "magasin", "CODE_MAGASIN")

                    If infoSupMagasin.Rows.Count > 0 Then
                        LIBELLE_MAGASIN = infoSupMagasin.Rows(0)("LIBELLE_MAGASIN")
                    End If

                    Dim p03 As Paragraph = New Paragraph("MAGASIN : " & LIBELLE_MAGASIN & Chr(13) & Chr(13), pRow)
                    p03.Alignment = Element.ALIGN_LEFT

                    pdfDoc.Add(p03)

                    Dim pdfTable As New PdfPTable(5) 'Number of columns
                    pdfTable.TotalWidth = 555.0F
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.HeaderRows = 1

                    'Dim widths As Single() = New Single() {25.0F, 25.0F, 25.0F, 25.0F, 25.0F, 25.0F, 25.0F, 25.0F}
                    Dim widths As Single() = New Single() {15.0F, 60.0F, 15.0F, 15.0F, 15.0F}

                    pdfTable.SetWidths(widths)

                    Dim pdfCell As PdfPCell = Nothing

                    pdfCell = New PdfPCell(New Paragraph("REF.", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.Border = 0

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("DESIGNATION", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.Border = 0

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("QTE EN STOCK", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.Border = 0

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("QTE PHYSIQUE", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.Border = 0

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("COUT DU STOCK", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.Border = 0

                    pdfTable.AddCell(pdfCell)

                    Dim qteAcorrigerAffichage As Double
                    Dim QTE As Double = 0
                    Dim CODE_ARTICLE As String = ""
                    Dim QUANTITE_EN_STOCK As Double = 0
                    Dim PRIX_DE_VENTE As Double = 0
                    Dim COUT_DU_STOCK As Double = 0
                    Dim LIBELLE_ARTICLE As String = ""

                    Dim econom As New Economat()

                    For j = 0 To dt.Rows.Count - 1

                        CODE_ARTICLE = dt.Rows(j)("CODE_ARTICLE") 'DES RANGEES DIFFERENTES MAIS TOUJOURS LA MEME COLONNE
                        QUANTITE_EN_STOCK = econom.QuantiteDunArticleQuelconqueDansUnMagasinQuelconque(CODE_MAGASIN, CODE_ARTICLE)
                        qteAcorrigerAffichage = Functions.affichageQteDansUnFormatCorrect(CODE_ARTICLE, QUANTITE_EN_STOCK)
                        PRIX_DE_VENTE = Functions.prixDeVenteDuMagasin(CODE_MAGASIN, dt, j)
                        COUT_DU_STOCK = QUANTITE_EN_STOCK * PRIX_DE_VENTE
                        LIBELLE_ARTICLE = dt.Rows(j)("DESIGNATION_FR")

                        pdfCell = New PdfPCell(New Paragraph(CODE_ARTICLE, font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(LIBELLE_ARTICLE, font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(qteAcorrigerAffichage, "#,##0"), font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("", font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(COUT_DU_STOCK, "#,##0"), font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.AddCell(pdfCell)

                        totalVente += COUT_DU_STOCK

                    Next

                    pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 4

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(totalVente, "#,##0"), fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0

                    pdfTable.AddCell(pdfCell)

                    pdfDoc.Add(pdfTable)


                End If

            Next

            pdfDoc.Close()

            Dim dtRapport As DataTable = Functions.verificationExistenceCheminDesRapportsDuJours(dateMainCouranteDebut)

            If dtRapport.Rows.Count > 0 Then
                Dim ID_RAPPORT = dtRapport.Rows(0)("ID_RAPPORT")
                updateOfFields("rapport_auto", "CHEMIN_INVENTAIRES", fichier, "ID_RAPPORT", ID_RAPPORT, 2)
            End If

        End If

    End Sub


    Public Shared Sub docInventaireDesVentes(ByVal DateDebut As Date, ByVal DateFin As Date, Optional renvoie As Boolean = False)

        Dim ventes As New LigneFacture()

        Dim CODE_UTILISATEUR As String = ""

        Dim ListeDesVentes As New DataTable()

        ListeDesVentes = ventes.ListeDesArticlesVendusInventaire(DateDebut, DateFin, CODE_UTILISATEUR)

        If ListeDesVentes.Rows.Count > 0 Then

            RapportFacturesForm.DataGridViewRapports.Columns.Clear()
            RapportFacturesForm.DataGridViewRapports.Rows.Clear()

            RapportFacturesForm.DataGridViewRapports.Columns.Add("ARTICLE", "ARTICLE")
            RapportFacturesForm.DataGridViewRapports.Columns.Add("QUANTITE", "QTE VENDU")
            RapportFacturesForm.DataGridViewRapports.Columns.Add("STOCK", "STOCK ACTUEL")
            RapportFacturesForm.DataGridViewRapports.Columns.Add("PU", "PRIX UNITAIRE")
            RapportFacturesForm.DataGridViewRapports.Columns.Add("PA", "PRIX ACHAT")
            RapportFacturesForm.DataGridViewRapports.Columns.Add("MONTANT", "MONTANT TOTAL")
            RapportFacturesForm.DataGridViewRapports.Columns.Add("MARGE", "MARGE")

            Dim articleIndividuel As New DataTable()

            For i = 0 To ListeDesVentes.Rows.Count - 1

                Dim CODE_ARTICLE As String = ListeDesVentes.Rows(i)("CODE_ARTICLE")
                'Dim LIBELLE_FACTURE As String = ListeDesVentes.Rows(i)("LIBELLE_FACTURE")

                Dim LIBELLE_FACTURE As String = ""
                Dim FAMILLE As String = ""
                Dim SUIVIE As String = ""

                Dim PA As Double = 0
                Dim STOCK As Double = 0

                Dim infoArticle As DataTable = Functions.getElementByCode(CODE_ARTICLE, "article", "CODE_ARTICLE")

                If infoArticle.Rows.Count > 0 Then

                    LIBELLE_FACTURE = infoArticle.Rows(0)("DESIGNATION_FR")
                    PA = infoArticle.Rows(0)("COUT_U_MOYEN_PONDERE")

                    SUIVIE = infoArticle.Rows(0)("METHODE_SUIVI_STOCK")

                    'If Trim(SUIVIE).Equals("Suivi simple") Then
                    STOCK = infoArticle.Rows(0)("QUANTITE")
                    'Else

                    'End If

                End If

                Dim PRIXMOYENUNITAIRE As Double = 0
                Dim QUANTITE As Double = 0
                Dim MONTANT As Double = 0

                Dim UNITE_DE_VENTE As String = ""

                articleIndividuel = ventes.ListeDesArticlesVendusInventaireIndividuel(DateDebut, DateFin, CODE_UTILISATEUR, CODE_ARTICLE)

                Dim QUANITE_CORRECTE_FORMAT = Functions.affichageQteDansUnFormatCorrect(CODE_ARTICLE, QUANTITE)

                For j = 0 To articleIndividuel.Rows.Count - 1

                    UNITE_DE_VENTE = articleIndividuel.Rows(j)("CODE_LOT")

                    QUANTITE += articleIndividuel.Rows(j)("QUANTITE")
                    MONTANT += articleIndividuel.Rows(j)("MONTANT TOTAL")

                    If QUANTITE > 0 Then
                        PRIXMOYENUNITAIRE = MONTANT / QUANTITE
                    End If

                    QUANITE_CORRECTE_FORMAT += Functions.conversionEnPlusPetiteUnite(CODE_ARTICLE, articleIndividuel.Rows(j)("QUANTITE"), UNITE_DE_VENTE)

                Next

                Dim MARGE As Double = MONTANT - (QUANTITE * PA)

                'RapportFacturesForm.DataGridViewRapports.Rows.Add(LIBELLE_FACTURE, QUANTITE, STOCK, PRIXMOYENUNITAIRE, PA, MONTANT, MARGE)

                QUANITE_CORRECTE_FORMAT = Functions.affichageQteDansUnFormatCorrect(CODE_ARTICLE, QUANITE_CORRECTE_FORMAT)
                Dim STOCK_CORRECTE_FORMAT = Functions.affichageQteDansUnFormatCorrect(CODE_ARTICLE, STOCK)

                If Not Trim(LIBELLE_FACTURE).Equals("LIBELLE_FACTURE") Then
                    RapportFacturesForm.DataGridViewRapports.Rows.Add(LIBELLE_FACTURE, QUANITE_CORRECTE_FORMAT, STOCK_CORRECTE_FORMAT, PRIXMOYENUNITAIRE, PA, MONTANT, MARGE)
                End If

            Next

            RapportFacturesForm.DataGridViewRapports.Columns("MONTANT").DefaultCellStyle.Format = "#,##0"
            RapportFacturesForm.DataGridViewRapports.Columns("MONTANT").DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight

            RapportFacturesForm.DataGridViewRapports.Columns("PU").DefaultCellStyle.Format = "#,##0"
            RapportFacturesForm.DataGridViewRapports.Columns("PU").DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight

            RapportFacturesForm.DataGridViewRapports.Columns("STOCK").DefaultCellStyle.Format = "#,##0.00"
            RapportFacturesForm.DataGridViewRapports.Columns("STOCK").DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleCenter

            RapportFacturesForm.DataGridViewRapports.Columns("PA").DefaultCellStyle.Format = "#,##0"
            RapportFacturesForm.DataGridViewRapports.Columns("PA").DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight

            RapportFacturesForm.DataGridViewRapports.Columns("MARGE").DefaultCellStyle.Format = "#,##0"
            RapportFacturesForm.DataGridViewRapports.Columns("MARGE").DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight

            RapportFacturesForm.DataGridViewRapports.Columns("QUANTITE").DefaultCellStyle.Format = "#,##0.00"
            RapportFacturesForm.DataGridViewRapports.Columns("QUANTITE").DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleCenter


        End If

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim dateMainCouranteDebut As Date = DateDebut

        Dim TotalCommande As Double = 0
        Dim tireDocument As String = ""
        Dim titreFichier As String = "INVENTAIRES DES VENTES"

        tireDocument = titreFichier & " DU " & DateDebut.ToString("ddMMyy")

        Dim fichier As String = ""
        Dim nomDuDossierRapport As String = "RAPPORTS\INVENTAIRES_DES_VENTES"

        Dim filePathAndDirectory As String = ""

        filePathAndDirectory = GlobalVariable.AgenceActuelle.Rows(0)("CHEMIN_SAUVEGARDE_AUTO") & "\" & nomDuDossierRapport & "\" & dateMainCouranteDebut.ToString("ddMMyy")

        My.Computer.FileSystem.CreateDirectory(filePathAndDirectory)

        If Not renvoie Then

            If GlobalVariable.actualLanguageValue = 1 Then
                fichier = filePathAndDirectory & "\" & titreFichier & " DU " & GlobalVariable.DateDeTravail.AddDays(-1).ToString("ddMMyy") & ".pdf"
            Else
                fichier = filePathAndDirectory & "\" & titreFichier & " OF " & GlobalVariable.DateDeTravail.AddDays(-1).ToString("ddMMyy") & ".pdf"
            End If

        Else

            If GlobalVariable.actualLanguageValue = 1 Then
                fichier = filePathAndDirectory & "\" & titreFichier & " DU " & dateMainCouranteDebut.ToString("ddMMyy") & ".pdf"
            Else
                fichier = filePathAndDirectory & "\" & titreFichier & " OF " & dateMainCouranteDebut.ToString("ddMMyy") & ".pdf"
            End If

        End If


        Dim pdfDoc As New Document(PageSize.A4, 40, 40, 40, 40)
        'Dim pdfDoc As New Document(PageSize.B7, 5, 5, 5, 5)
        Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(fichier, FileMode.Create))
        Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
        Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
        Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
        Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

        'pdfWrite.PageEvent = New HeaderFooter

        Dim pdfCell As PdfPCell = Nothing

        'pdfWrite.PageEvent = New HeaderFooter

        pdfDoc.Open()

        Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & "***", pColumn)
        p1.Alignment = Element.ALIGN_CENTER

        pdfDoc.Add(p1)

        Dim p0 As Paragraph = New Paragraph(Chr(13) & titreFichier & " DU " & DateDebut & Chr(13) & Chr(13), pRow)
        p0.Alignment = Element.ALIGN_CENTER

        pdfDoc.Add(p0)

        Dim totalDesDesVentes As Double = 0

        'VENTES
        Dim pdfTable As New PdfPTable(7) 'Number of columns
        pdfTable.TotalWidth = 520.0F
        pdfTable.LockedWidth = True
        pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
        pdfTable.HeaderRows = 1

        Dim widths As Single() = New Single() {60.0F, 15.0F, 15.0F, 15.0F, 15.0F, 18.0F, 18.0F}

        pdfTable.SetWidths(widths)

        pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
        pdfCell.MinimumHeight = 15
        'pdfCell.PaddingLeft = 5.0F
        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
        pdfTable.AddCell(pdfCell)

        pdfCell = New PdfPCell(New Paragraph("QTE VENDU", pColumn))
        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
        pdfCell.MinimumHeight = 15
        'pdfCell.PaddingLeft = 5.0F
        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
        pdfTable.AddCell(pdfCell)

        pdfCell = New PdfPCell(New Paragraph("STOCK", pColumn))
        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
        pdfCell.MinimumHeight = 15
        'pdfCell.PaddingLeft = 5.0F
        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
        pdfTable.AddCell(pdfCell)

        pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
        pdfCell.MinimumHeight = 15
        'pdfCell.PaddingLeft = 5.0F
        pdfTable.AddCell(pdfCell)

        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
        'pdfTable.AddCell(pdfCell)

        pdfCell = New PdfPCell(New Paragraph("P. ACHAT", pColumn))
        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
        pdfCell.MinimumHeight = 15
        'pdfCell.PaddingLeft = 5.0F
        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
        pdfTable.AddCell(pdfCell)

        pdfCell = New PdfPCell(New Paragraph("RECETTE", pColumn))
        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
        pdfCell.MinimumHeight = 15
        'pdfCell.PaddingLeft = 5.0F
        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
        pdfTable.AddCell(pdfCell)

        pdfCell = New PdfPCell(New Paragraph("PROFIT BRUT", pColumn))
        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
        pdfCell.MinimumHeight = 15
        'pdfCell.PaddingLeft = 5.0F
        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
        pdfTable.AddCell(pdfCell)

        'ARTICLE D'UNE FAMILLE QUELCONQUE

        Dim totalQuantite As Double = 0
        Dim totalAchat As Double = 0
        Dim totalMarge As Double = 0

        If RapportFacturesForm.DataGridViewRapports.Rows.Count > 0 Then

            Dim ordre As Integer = 0

            For j = 0 To RapportFacturesForm.DataGridViewRapports.Rows.Count - 1
                ordre += 1
                For k = 0 To RapportFacturesForm.DataGridViewRapports.Columns.Count - 1

                    If k = 0 Then
                        pdfCell = New PdfPCell(New Paragraph(ordre & "- " & RapportFacturesForm.DataGridViewRapports.Rows(j).Cells(k).Value.ToString, font1))
                        'pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells(k).Value.ToString, font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    ElseIf k = 1 Or k = 2 Then

                        pdfCell = New PdfPCell(New Paragraph(Format(RapportFacturesForm.DataGridViewRapports.Rows(j).Cells(k).Value, "#,##0.00"), font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                        If k = 1 Then
                            totalQuantite += RapportFacturesForm.DataGridViewRapports.Rows(j).Cells(k).Value
                        End If

                    Else
                        pdfCell = New PdfPCell(New Paragraph(Format(RapportFacturesForm.DataGridViewRapports.Rows(j).Cells(k).Value, "#,##0"), font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                        If k = 4 Then
                            totalAchat += RapportFacturesForm.DataGridViewRapports.Rows(j).Cells(k).Value
                        ElseIf k = 5 Then
                            totalDesDesVentes += RapportFacturesForm.DataGridViewRapports.Rows(j).Cells(k).Value
                        ElseIf k = 6 Then
                            totalMarge += RapportFacturesForm.DataGridViewRapports.Rows(j).Cells(k).Value
                        End If

                    End If

                    pdfCell.MinimumHeight = 5
                    pdfCell.PaddingLeft = 5.0F

                    pdfTable.AddCell(pdfCell)

                Next

            Next

            pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.Border = 0
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(totalQuantite, "#,##0"), pRow))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.Border = 0
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.Border = 0
            pdfCell.Border = 0
            pdfTable.AddCell(pdfCell)

            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            'pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("", pRow))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.Border = 0
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(totalDesDesVentes - totalMarge, "#,##0"), pRow))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.Border = 0
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(totalDesDesVentes, "#,##0"), pRow))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.Border = 0
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(totalMarge, "#,##0"), pRow))
            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell.MinimumHeight = 15
            pdfCell.Border = 0
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfDoc.Add(pdfTable)

            Dim p4 As Paragraph = New Paragraph(Chr(13) & " TOTAL DES VENTES : " & Format(totalDesDesVentes, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow)
            p4.Alignment = Element.ALIGN_CENTER

            pdfDoc.Close()

            Dim dtRapport As DataTable = Functions.verificationExistenceCheminDesRapportsDuJours(dateMainCouranteDebut)

            If dtRapport.Rows.Count > 0 Then
                Dim ID_RAPPORT = dtRapport.Rows(0)("ID_RAPPORT")
                updateOfFields("rapport_auto", "CHEMIN_INVENTAIRES_DES_VENTES", fichier, "ID_RAPPORT", ID_RAPPORT, 2)
            End If

        End If

    End Sub


End Class
