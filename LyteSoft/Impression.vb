Imports iTextSharp.text.pdf
Imports iTextSharp.text
Imports System.IO

Imports Excel = Microsoft.Office.Interop.Excel 'Before you add this reference to your project,
' you need to install Microsoft Office and find last version of this file.
Imports Microsoft.Office.Interop

Imports MySql.Data.MySqlClient
Imports System.Data.Odbc


Public Class Impression

    Public Shared Sub documentServiceTechnique(ByVal dt As DataTable)

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0

        Dim title As String = ""
        Dim CODE_DEMANDE As String = ""
        Dim CODE_DEMANDE_INTERVENTION As String = ""
        Dim CODE_INTERVENTION As String = ""

        Dim dt_ As DataTable

        If GlobalVariable.DocumentToGenerate = "demande intervention" Then

            title = "DEMANDE D'INTERVENTION"
            CODE_DEMANDE = dt.Rows(0)("CODE_DEMANDE_INTERVENTION")

        Else

            title = "BON D'INTERVENTION"
            CODE_DEMANDE_INTERVENTION = dt.Rows(0)("CODE_DEMANDE_INTERVENTION")
            CODE_DEMANDE = dt.Rows(0)("CODE_DEMANDE_INTERVENTION")

            dt_ = Functions.getElementByCode(CODE_DEMANDE_INTERVENTION, "intervention", "CODE_DEMANDE")

            If dt_.Rows.Count > 0 Then
                CODE_INTERVENTION = dt_.Rows(0)("CODE_INTERVENTION")
            Else
                dt = Functions.getElementByCode(CODE_DEMANDE_INTERVENTION, "demande_intervention", "CODE_DEMANDE_INTERVENTION")
            End If

        End If

        Dim tireDocument As String = title.ToUpper() & " DU " & GlobalVariable.DateDeTravail.ToString("ddMMyy") & "" & Now().ToString("HHmmss")

        Dim sousTitreDocument As String = ""

        sousTitreDocument = tireDocument

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 20, 80, 40)
            'Dim pdfDoc As New Document(PageSize.A4, 40, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 20, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p3 As Paragraph
            p3 = New Paragraph(Chr(13) & title.ToUpper() & Chr(13) & Chr(13), pRow)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            Dim NOM_INTERVENANT As String = ""

            If dt.Rows.Count > 0 Then

                Dim p03 As Paragraph

                If GlobalVariable.DocumentToGenerate = "demande intervention" Then
                    p03 = New Paragraph("DEMANDE D'INTERVENTION NUMERO : " & dt.Rows(0)("CODE_DEMANDE_INTERVENTION") & Chr(13) & "DATE : " & dt.Rows(0)("DATE_INTERVENTION") & " A " & dt.Rows(0)("HEURE_INTERVENTION") & Chr(13) & "ZONE : " & dt.Rows(0)("ZONE") & Chr(13) & "STATUT : " & dt.Rows(0)("STATUT") & Chr(13) & "ORIGINE DEMANDE : " & dt.Rows(0)("SERVICE_ORIGIN") & Chr(13) & "PAR : " & dt.Rows(0)("ORIGINE_DEMANDE") & Chr(13), pRow)
                Else



                    If dt_.Rows.Count > 0 Then

                        'DANS LE CAS LE BON D'INTERVENTION A DEJA ETET PROPREMENT CREE

                        Dim CODE_INTERVENANT As String = dt_.Rows(0)("CODE_INTERVENANT")

                        Dim infoSuppersonnel As DataTable = Functions.getElementByCode(CODE_INTERVENANT, "personnel", "CODE_PERSONNEL")

                        If infoSuppersonnel.Rows.Count > 0 Then
                            NOM_INTERVENANT = infoSuppersonnel.Rows(0)("NOM_PERSONNEL") & " " & infoSuppersonnel.Rows(0)("PRENOM_PERSONNEL")
                        End If

                        p03 = New Paragraph("BON D'INTERVENTION NUMERO : " & dt_.Rows(0)("CODE_INTERVENTION") & Chr(13) & "DATE : " & dt_.Rows(0)("DATE_INTERVENTION") & " A " & dt_.Rows(0)("HEURE_INTERVENTION") & Chr(13) & "ZONE : " & dt_.Rows(0)("ZONE") & Chr(13) & "STATUT : " & dt_.Rows(0)("STATUT") & Chr(13) & "ORIGINE DEMANDE : " & dt_.Rows(0)("ORIGINE_DEMANDE") & Chr(13) & "PAR : " & dt_.Rows(0)("ORIGINE_DEMANDE") & Chr(13) & "INTERVENANT : " & NOM_INTERVENANT, pRow)

                    Else

                        p03 = New Paragraph("BON D'INTERVENTION NUMERO : " & dt.Rows(0)("CODE_DEMANDE_INTERVENTION") & Chr(13) & "DATE : " & dt.Rows(0)("DATE_INTERVENTION") & " A " & dt.Rows(0)("HEURE_INTERVENTION") & Chr(13) & "ZONE : " & dt.Rows(0)("ZONE") & Chr(13) & "STATUT : " & dt.Rows(0)("STATUT") & Chr(13) & "ORIGINE DEMANDE : " & dt.Rows(0)("ORIGINE_DEMANDE") & Chr(13) & "PAR : " & dt.Rows(0)("ORIGINE_DEMANDE") & Chr(13) & "INTERVENANT : " & NOM_INTERVENANT, pRow)

                    End If

                End If

                p03.Alignment = Element.ALIGN_LEFT

                pdfDoc.Add(p03)

                '1- LISTE DES PROBLEMES DE LA DEMANDE
                Dim problemes As DataTable = Functions.getElementByCode(CODE_DEMANDE, "demande_intervention_probleme", "CODE_DEMANDE")

                If problemes.Rows.Count > 0 Then

                    '2- SELECTION DES DIFFERENTS PROBLEMES PARENTS

                    Dim parent As String = "SELECT DISTINCT LOCALISATION_PANNE FROM demande_intervention_probleme WHERE CODE_DEMANDE=@CODE_DEMANDE ORDER BY LOCALISATION_PANNE ASC"

                    Dim command As New MySqlCommand(parent, GlobalVariable.connect)
                    command.Parameters.Add("@CODE_DEMANDE", MySqlDbType.VarChar).Value = CODE_DEMANDE

                    Dim adapter As New MySqlDataAdapter

                    Dim dtParent As New DataTable()

                    adapter.SelectCommand = command
                    adapter.Fill(dtParent)

                    If dtParent.Rows.Count > 0 Then

                        For i = 0 To dtParent.Rows.Count - 1

                            p03 = New Paragraph(Chr(13) & i + 1 & " -/ " & dtParent.Rows(i)("LOCALISATION_PANNE").ToString.ToUpper() & Chr(13) & Chr(13), pRow)
                            pdfDoc.Add(p03)

                            Dim LOCALISATION_PANNE As String = dtParent.Rows(i)("LOCALISATION_PANNE")
                            Dim sousPannes As DataTable = Functions.getElementByCode(LOCALISATION_PANNE, "demande_intervention_probleme", "LOCALISATION_PANNE")

                            Dim pdfTable As New PdfPTable(3) 'Number of columns
                            pdfTable.TotalWidth = 560.0F
                            pdfTable.LockedWidth = True
                            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.HeaderRows = 1

                            Dim widths As Single() = New Single() {8.0F, 15.0F, 80.0F}

                            pdfTable.SetWidths(widths)

                            Dim pdfCell As PdfPCell = Nothing

                            Dim debit As Double = 0
                            Dim credit As Double = 0
                            Dim solde As Double = 0

                            pdfCell = New PdfPCell(New Paragraph("ORDRE", fontTotal))

                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            'pdfCell.Border = 0

                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("HABITATION", fontTotal))

                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            'pdfCell.Border = 0

                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("PANNES", fontTotal))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.Border = 0

                            pdfTable.AddCell(pdfCell)

                            If sousPannes.Rows.Count > 0 Then

                                For j = 0 To sousPannes.Rows.Count - 1

                                    pdfCell = New PdfPCell(New Paragraph(j + 1, font1))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 15
                                    pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(sousPannes.Rows(j)("HABITATION").ToString.ToUpper(), font1))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                                    pdfCell.MinimumHeight = 15
                                    pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(sousPannes.Rows(j)("PROBLEME").ToString.ToUpper(), font1))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                                    pdfCell.MinimumHeight = 15
                                    pdfTable.AddCell(pdfCell)

                                Next

                                pdfDoc.Add(pdfTable)

                            End If

                        Next

                    End If

                End If

                If GlobalVariable.DocumentToGenerate = "intervention" Then

                    p03 = New Paragraph(Chr(13) & " -/ " & "MATERIELS UTILISES".ToString.ToUpper() & Chr(13) & Chr(13), pRow)
                    pdfDoc.Add(p03)

                    'EQUIPEMENTS UTILISES
                    Dim equipement As String = "SELECT * FROM ligne_intervention WHERE CODE_DEMANDE=@CODE_DEMANDE ORDER BY EQUIPEMENT_UTILISE ASC"

                    Dim commandequipement As New MySqlCommand(equipement, GlobalVariable.connect)
                    commandequipement.Parameters.Add("@CODE_DEMANDE", MySqlDbType.VarChar).Value = CODE_DEMANDE

                    Dim adapterequipement As New MySqlDataAdapter

                    Dim dtequipement As New DataTable()

                    adapterequipement.SelectCommand = commandequipement
                    adapterequipement.Fill(dtequipement)

                    If dtequipement.Rows.Count > 0 Then

                        Dim pdfTable As New PdfPTable(6) 'Number of columns
                        pdfTable.TotalWidth = 560.0F
                        pdfTable.LockedWidth = True
                        pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.HeaderRows = 1

                        Dim widths As Single() = New Single() {10.0F, 45.0F, 15.0F, 12.0F, 7.0F, 15.0F}

                        pdfTable.SetWidths(widths)

                        Dim pdfCell As PdfPCell = Nothing

                        Dim total As Double = 0

                        pdfCell = New PdfPCell(New Paragraph("ORDRE", fontTotal))

                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.Border = 0

                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("MATERIELS", fontTotal))

                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        'pdfCell.Border = 0

                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("PRIX DE BASE", fontTotal))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        'pdfCell.Border = 0

                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("PRIX REEL", fontTotal))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        'pdfCell.Border = 0

                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("QTE", fontTotal))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        'pdfCell.Border = 0

                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("PRIX TOTAL", fontTotal))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        'pdfCell.Border = 0

                        pdfTable.AddCell(pdfCell)

                        For i = 0 To dtequipement.Rows.Count - 1

                            pdfCell = New PdfPCell(New Paragraph(i + 1, font1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(dtequipement.Rows(i)("EQUIPEMENT_UTILISE").ToString.ToUpper(), font1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfCell.MinimumHeight = 15
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(dtequipement.Rows(i)("PRIX_BASE"), "#,##0"), font1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(dtequipement.Rows(i)("PRIX_REEL"), "#,##0"), font1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(dtequipement.Rows(i)("QTE"), "#,##0"), font1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfTable.AddCell(pdfCell)

                            total += dtequipement.Rows(i)("PT")

                            pdfCell = New PdfPCell(New Paragraph(Format(dtequipement.Rows(i)("PT"), "#,##0"), font1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfTable.AddCell(pdfCell)

                        Next

                        pdfCell = New PdfPCell(New Paragraph("TOTAL : ", font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        pdfCell.Colspan = 5
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(total, "#,##0"), font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        pdfTable.AddCell(pdfCell)

                        pdfDoc.Add(pdfTable)

                    End If


                End If

                If GlobalVariable.DocumentToGenerate = "demande intervention" Then
                    p03 = New Paragraph(Chr(13) & "Commentaire :  " & dt.Rows(0)("COMMENTAIRE") & Chr(13) & Chr(13), pRow)
                    pdfDoc.Add(p03)
                End If

                If GlobalVariable.DocumentToGenerate = "intervention" Then

                    If dt_.Rows.Count > 0 Then

                        p03 = New Paragraph(Chr(13) & "Diagnostique :  " & dt_.Rows(0)("DIAGNOSTIQUE") & Chr(13) & Chr(13), pRow)
                        pdfDoc.Add(p03)

                        p03 = New Paragraph(Chr(13) & "Commentaire Bon d'intervention :  " & dt_.Rows(0)("COMMENTAIRE") & Chr(13) & Chr(13), pRow)
                        pdfDoc.Add(p03)

                    Else

                        p03 = New Paragraph(Chr(13) & "Diagnostique :  " & Chr(13) & Chr(13), pRow)
                        pdfDoc.Add(p03)

                        p03 = New Paragraph(Chr(13) & "Commentaire Bon d'intervention :  " & Chr(13) & Chr(13), pRow)
                        pdfDoc.Add(p03)

                    End If


                End If

                If GlobalVariable.DocumentToGenerate = "intervention" Then
                    p03 = New Paragraph(Chr(13) & "SIGNATURE INTERVENANT                                                                                           ETABLIE PAR" & Chr(13), pRow)
                    pdfDoc.Add(p03)
                    p03 = New Paragraph(NOM_INTERVENANT & Chr(13), pRow)
                    pdfDoc.Add(p03)
                Else
                    p03 = New Paragraph(Chr(13) & "                                                                                                                ETABLIE PAR" & Chr(13), pRow)
                    pdfDoc.Add(p03)
                End If

                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                Process.Start(sfd.FileName)

            End If

        End If

    End Sub

    Public Shared Sub listeDesComptesDebiteurs(ByVal dt As DataGridView)

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0

        Dim title As String = "LISTE DES COMPTES DEBITEURS"
        Dim tireDocument As String = title.ToUpper() & " DU " & GlobalVariable.DateDeTravail.ToString("ddMMyy") & "" & Now().ToString("HHmmss")

        Dim sousTitreDocument As String = ""

        sousTitreDocument = tireDocument

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 20, 80, 40)
            'Dim pdfDoc As New Document(PageSize.A4, 40, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 20, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p3 As Paragraph
            p3 = New Paragraph(Chr(13) & title.ToUpper() & " DU " & " " & GlobalVariable.DateDeTravail & Chr(13) & Chr(13), pRow)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)


            If dt.Rows.Count > 0 Then

                Dim pdfTable As New PdfPTable(6) 'Number of columns
                pdfTable.TotalWidth = 800.0F
                pdfTable.LockedWidth = True
                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable.HeaderRows = 1

                Dim widths As Single() = New Single() {12.0F, 30.0F, 20.0F, 15.0F, 15.0F, 15.0F}

                pdfTable.SetWidths(widths)

                Dim pdfCell As PdfPCell = Nothing

                Dim debit As Double = 0
                Dim credit As Double = 0
                Dim solde As Double = 0

                pdfCell = New PdfPCell(New Paragraph("NUMERO DE COMPTE", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("INTITULE", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TYPE DE COMPTE", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEBIT", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CREDIT", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("SOLDE", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                If dt.Rows.Count > 0 Then

                    For j = 0 To dt.Rows.Count - 1

                        For k = 0 To dt.Columns.Count - 1

                            If k <= 5 Then

                                If k = 3 Or k = 4 Or k = 5 Then

                                    pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j).Cells(k).Value, "#,##0"), font1))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                    If k = 3 Then
                                        debit += Double.Parse(dt.Rows(j).Cells(k).Value)
                                    ElseIf k = 4 Then
                                        credit += Double.Parse(dt.Rows(j).Cells(k).Value)
                                    ElseIf k = 5 Then
                                        solde += Double.Parse(dt.Rows(j).Cells(k).Value)
                                    End If
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                Else

                                    pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells(k).Value.ToString, font1))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                                End If

                                pdfCell.MinimumHeight = 15
                                pdfTable.AddCell(pdfCell)

                            End If

                        Next

                    Next

                    pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 3

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(debit, "#,##0"), fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    'pdfCell.Colspan = 3

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(credit, "#,##0"), fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    'pdfCell.Colspan = 3

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(solde,"#,##0"), fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0

                    pdfTable.AddCell(pdfCell)

                    pdfDoc.Add(pdfTable)

                    '------------------------------------------------------------------------

                    pdfDoc.Close()

                    MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                    Process.Start(sfd.FileName)


                End If

            End If

        End If

    End Sub

    Public Shared Sub journalPetiteCaisse(ByVal dateDebut As Date, ByVal dateFin As Date)

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0

        Dim title As String = "JOURNAL DE PETITE CAISSE"
        Dim tireDocument As String = title.ToUpper() & " DU " & dateDebut & "" & Now().ToString("HHmmss")

        Dim sousTitreDocument As String = ""

        sousTitreDocument = tireDocument

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 20, 80, 40)
            'Dim pdfDoc As New Document(PageSize.A4, 40, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 20, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p3 As Paragraph
            p3 = New Paragraph(Chr(13) & title.ToUpper() & " DU " & " " & dateDebut.ToShortDateString & " AU " & dateFin.ToShortDateString & Chr(13) & Chr(13), pRow)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            Dim getPetiteCaisse As String = "Select DISTINCT CODE_CAISSE FROM petite_caisse ORDER BY CODE_CAISSE DESC"

            Dim commandPetiteCaisse As New MySqlCommand(getPetiteCaisse, GlobalVariable.connect)

            Dim adapterPetiteCaisse As New MySqlDataAdapter

            Dim dtPetiteCaisseList As New DataTable()

            adapterPetiteCaisse.SelectCommand = commandPetiteCaisse
            adapterPetiteCaisse.Fill(dtPetiteCaisseList)

            If dtPetiteCaisseList.Rows.Count > 0 Then

                For i = 0 To dtPetiteCaisseList.Rows.Count - 1


                    Dim CODE_PETITE_CAISSE As String = ""

                    Dim infoPetiteCaisse As DataTable = Functions.getElementByCode(CODE_PETITE_CAISSE, "petite_caisse", "CODE_CAISSE")

                    If infoPetiteCaisse.Rows.Count > 0 Then

                        Dim p03 As Paragraph
                        p03 = New Paragraph(i + 1 & " /-CAISSE : " & infoPetiteCaisse.Rows(i)("LIBELLE_CAISSE"), pRow)
                        p03.Alignment = Element.ALIGN_RIGHT

                    End If

                    Dim pdfTable As New PdfPTable(8) 'Number of columns
                    pdfTable.TotalWidth = 800.0F
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.HeaderRows = 1

                    Dim widths As Single() = New Single() {10.0F, 7.0F, 32.0F, 8.0F, 8.0F, 15.0F, 15.0F, 15.0F}

                    pdfTable.SetWidths(widths)

                    Dim pdfCell As PdfPCell = Nothing

                    Dim debit As Double = 0
                    Dim credit As Double = 0

                    pdfCell = New PdfPCell(New Paragraph("DATE.", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.Border = 0

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("REF.", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.Border = 0

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("DESCRIPTION", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.Border = 0

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("MONTANT RETIRE", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.Border = 0
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("MONTANT DEPOSE", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.Border = 0

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("RECU PAR", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.Border = 0

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("APPROUVE PAR", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.Border = 0

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("EFFECTUE PAR", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.Border = 0
                    pdfTable.AddCell(pdfCell)

                    Dim query3 As String = "SELECT `DATE_REGLEMENT` AS Date, `NUM_REGLEMENT` AS REFERENCE, `REF_REGLEMENT` AS DESCRITION, `MONTANT_SORTIE` AS 'MONTANT RETIRE', `MONTANT_VERSE` As 'MONTANT DEPOSE', `NOM_DU_RECEVEUR` AS 'RECU PAR', `APPROUVE_PAR` AS 'APPROUVE PAR', `NOM_UTILISATEUR` AS 'EFFECTUE PAR' FROM petite_caisse_ligne, utilisateurs WHERE CODE_AGENCE = @CODE_AGENCE AND MONTANT_VERSE >= 0 AND petite_caisse_ligne.CODE_CAISSIER= utilisateurs.CODE_UTILISATEUR AND DATE_REGLEMENT >= '" & dateDebut.ToString("yyyy-MM-dd") & "' AND DATE_REGLEMENT <='" & dateFin.ToString("yyyy-MM-dd") & "' AND CODE_CAISSE=@CODE_CAISSE ORDER BY DATE_REGLEMENT DESC "

                    Dim command3 As New MySqlCommand(query3, GlobalVariable.connect)
                    command3.Parameters.Add("@CODE_AGENCE", MySqlDbType.VarChar).Value = GlobalVariable.codeAgence
                    command3.Parameters.Add("@CODE_CAISSE", MySqlDbType.VarChar).Value = dtPetiteCaisseList.Rows(i)("CODE_CAISSE")

                    Dim adapter3 As New MySqlDataAdapter(command3)
                    Dim dt As New DataTable()

                    adapter3.Fill(dt)

                    If dt.Rows.Count > 0 Then

                        For j = 0 To dt.Rows.Count - 1

                            For k = 0 To dt.Columns.Count - 1

                                If k = 3 Or k = 4 Then
                                    pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j)(k), "#,##0"), font1))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                    If k = 3 Then
                                        debit += Double.Parse(dt.Rows(j)(k))
                                    ElseIf k = 4 Then
                                        credit += Double.Parse(dt.Rows(j)(k))
                                    End If

                                Else

                                    If k = 0 Then
                                        pdfCell = New PdfPCell(New Paragraph(CDate(dt.Rows(j)(k)).ToShortDateString, font1))
                                    Else
                                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(j)(k).ToString, font1))
                                    End If

                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                End If


                                pdfCell.MinimumHeight = 15
                                pdfTable.AddCell(pdfCell)

                            Next

                        Next

                        pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 0
                        pdfCell.Colspan = 3

                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(debit, "#,##0"), fontTotal))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 0
                        'pdfCell.Colspan = 3

                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(credit, "#,##0"), fontTotal))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 0
                        'pdfCell.Colspan = 3

                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("", fontTotal))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 0

                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("", fontTotal))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 0

                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("", fontTotal))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 0

                        pdfTable.AddCell(pdfCell)

                        pdfDoc.Add(pdfTable)

                    End If

                Next

            End If

            '------------------------------------------------------------------------

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub listeDesOperations(ByVal dt As DataGridView, ByVal title As String, ByVal index As Integer, ByVal Optional BANQUE As String = "", Optional ByVal dateAfficher As String = "")

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0

        Dim tireDocument As String = title.ToUpper() & " DU " & (Date.Now().ToString("ddMMyyHHmmss"))

        Dim sousTitreDocument As String = ""

        sousTitreDocument = tireDocument

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 20, 80, 40)
            'Dim pdfDoc As New Document(PageSize.A4, 40, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 20, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            'Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & "***", pColumn)
            'p1.Alignment = Element.ALIGN_CENTER

            'pdfDoc.Add(p1)
            Dim p3 As Paragraph

            If Trim(dateAfficher).Equals("") Then

                p3 = New Paragraph(Chr(13) & title.ToUpper() & " DU " & " " & GlobalVariable.DateDeTravail & Chr(13) & Chr(13), pRow)
                p3.Alignment = Element.ALIGN_CENTER

            Else

                p3 = New Paragraph(Chr(13) & title.ToUpper() & dateAfficher & Chr(13) & Chr(13), pRow)
                p3.Alignment = Element.ALIGN_CENTER

            End If

            pdfDoc.Add(p3)

            If index = 0 Or index = 1 Then

                Dim pdfTable As New PdfPTable(4) 'Number of columns
                pdfTable.TotalWidth = 545.0F
                pdfTable.LockedWidth = True
                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable.HeaderRows = 1

                Dim widths As Single() = New Single() {10.0F, 12.0F, 70.0F, 12.0F}

                pdfTable.SetWidths(widths)

                Dim pdfCell As PdfPCell = Nothing

                Dim debit As Double = 0

                pdfCell = New PdfPCell(New Paragraph("REF.", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DATE", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("LIBELLE", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEBIT", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                For j = 0 To dt.Rows.Count - 1

                    For k = 0 To dt.Columns.Count - 1

                        If k = 3 Then

                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells(k).Value, font1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            debit += dt.Rows(j).Cells(k).Value
                        Else
                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells(k).Value.ToString, font1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        End If

                        pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        'pdfCell.Border = 0

                        pdfTable.AddCell(pdfCell)

                    Next

                Next

                pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0
                pdfCell.Colspan = 3

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(debit, "#,##0"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0
                pdfCell.Colspan = 3

                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

            ElseIf index = 6 Then

                Dim p1 As Paragraph = New Paragraph("BANQUE : " & BANQUE & Chr(13) & Chr(13), fontTotal)
                p1.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p1)

                Dim pdfTable As New PdfPTable(5) 'Number of columns
                pdfTable.TotalWidth = 555.0F
                pdfTable.LockedWidth = True
                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable.HeaderRows = 1

                Dim widths As Single() = New Single() {10.0F, 13.0F, 52.0F, 18.0F, 14.0F}

                pdfTable.SetWidths(widths)

                Dim pdfCell As PdfPCell = Nothing

                Dim debit As Double = 0

                pdfCell = New PdfPCell(New Paragraph("REF.", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DATE", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("LIBELLE", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("MODE", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEBIT", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                For j = 0 To dt.Rows.Count - 1

                    For k = 0 To dt.Columns.Count - 1

                        If k = 4 Then
                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells(k).Value, font1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            debit += dt.Rows(j).Cells(k).Value
                        Else
                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells(k).Value.ToString.ToUpper(), font1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        End If

                        pdfCell.MinimumHeight = 15

                        pdfTable.AddCell(pdfCell)

                    Next

                Next

                pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0
                pdfCell.Colspan = 3

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(debit, "#,##0"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0
                pdfCell.Colspan = 3

                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

            ElseIf index = 2 Or index = 3 Or index = 4 Or index = 5 Then

                Dim pdfTable As New PdfPTable(5) 'Number of columns
                pdfTable.TotalWidth = 555.0F
                pdfTable.LockedWidth = True
                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable.HeaderRows = 1

                Dim widths As Single() = New Single() {10.0F, 13.0F, 54.0F, 13.0F, 13.0F}

                pdfTable.SetWidths(widths)

                Dim pdfCell As PdfPCell = Nothing

                Dim debit As Double = 0
                Dim credit As Double = 0

                pdfCell = New PdfPCell(New Paragraph("REF.", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DATE", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("LIBELLE", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEBIT", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CREDIT", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                For j = 0 To dt.Rows.Count - 1

                    For k = 0 To dt.Columns.Count - 1

                        If k = 3 Or k = 4 Then

                            If Not Trim(dt.Rows(j).Cells(k).Value.ToString).Equals("") Then
                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells(k).Value, font1))

                                If k = 3 Then
                                    debit += dt.Rows(j).Cells(k).Value
                                ElseIf k = 4 Then
                                    credit += dt.Rows(j).Cells(k).Value
                                End If

                            Else
                                pdfCell = New PdfPCell(New Paragraph("", font1))
                            End If

                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                        Else
                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells(k).Value.ToString.ToUpper(), font1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        End If

                        pdfCell.MinimumHeight = 15

                        pdfTable.AddCell(pdfCell)

                    Next

                Next

                If index = 0 Or index = 1 Or index = 6 Then

                    pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 3

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(debit, "#,##0"), fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    'pdfCell.Colspan = 3

                    pdfTable.AddCell(pdfCell)

                ElseIf index = 2 Or index = 3 Or index = 4 Or index = 5 Then

                    pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 3

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(debit, "#,##0"), fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(credit, "#,##0"), fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("SOLDE ", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.Colspan = 3
                    pdfCell.Border = 0

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(credit - debit, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 15
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0

                    pdfTable.AddCell(pdfCell)

                End If

                pdfDoc.Add(pdfTable)

            End If

            '------------------------------------------------------------------------

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub PrintSituationDuClient(ByVal dt As DataGridView, ByVal CODE_RESERVATION As String)

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0
        'Dim totalNormal As Double = 0
        Dim totalTVA As Double = 0
        Dim TAxeSejour As Double = 0
        Dim SoldeNet As Double = 0
        Dim TotalVersement As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        tireDocument = "FACTURE N° : "
        titreFichier = "FACTURE DE "

        For i = 0 To dt.Rows.Count - 1

            Dim LIBELLE As String = dt.Rows(i).Cells("DataGridViewTextBoxColumn3").Value.ToString.ToUpper()

            If Not LIBELLE.Contains("TAXE DE SEJOUR") Then

                If Not Trim(dt.Rows(i).Cells("debit").Value).Equals("") Then
                    If dt.Rows(i).Cells("debit").Value > 0 Then
                        TotalFacture += dt.Rows(i).Cells("debit").Value 'calcul de la somme apres prelevement de la taxe
                        totalTVA += Functions.prelevementDeTaxeSurUnMontantPOurCalcul(dt.Rows(i).Cells("debit").Value) 'calcul de la somme des taxes prelevees
                    End If
                End If

            Else

                If LIBELLE.Contains("TAXE DE SEJOUR") Then
                    If Not Trim(dt.Rows(i).Cells("debit").Value).Equals("") Then
                        If dt.Rows(i).Cells("debit").Value > 0 Then
                            TAxeSejour += Functions.NonprelevementDeTaxeSurUnMontant(dt.Rows(i).Cells("debit").Value)
                        End If
                    End If
                End If

            End If

        Next

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        Dim nomClient As String = ""

        Dim termes As String = ""

        Dim reservationToPrint As DataTable = Functions.getElementByCode(CODE_RESERVATION, "reserve_conf", "CODE_RESERVATION")

        If reservationToPrint.Rows.Count > 0 Then

            If Not Trim(reservationToPrint(0)("CODE_ENTREPRISE")) = "" Then

                nomClient = reservationToPrint(0)("NOM_ENTREPRISE") & " (" & reservationToPrint(0)("NOM_CLIENT") & ")"

                termes = Chr(13) & "RAISON SOCIALE : " & nomClient & Chr(13) & reservationToPrint(0)("CHAMBRE_ID") & "" & Chr(13) & "RESERVATION NUMERO : " & CODE_RESERVATION & " CHAMBRE : " & Chr(13) & Chr(13) & Chr(13)

            Else

                nomClient = reservationToPrint.Rows(0)("NOM_CLIENT")

                termes = Chr(13) & "NOM & PRENOM : " & nomClient & Chr(13) & "CHAMBRE :  " & reservationToPrint(0)("CHAMBRE_ID") & "" & Chr(13) & "RESERVATION NUMERO : " & CODE_RESERVATION & Chr(13) & Chr(13) & Chr(13)

            End If

        End If

        sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim pdfTable As New PdfPTable(4) 'Number of columns
            pdfTable.TotalWidth = 530.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}

            pdfTable.SetWidths(widths)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim ElementToDuplicate As String = Functions.GeneratingRandomCodeWithSpecifications("facture", "")

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & ElementToDuplicate & Chr(13) & "DATE : " & GlobalVariable.DateDeTravail & Chr(13), pColumn)
            p10.Alignment = Element.ALIGN_LEFT

            pdfDoc.Add(p10)

            pdfDoc.Add(New Paragraph(termes, pRow))

            pdfCell = New PdfPCell(New Paragraph("DATE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            Dim MONTANT As Double = 0
            Dim QUANTITE As Double = 1

            For i = 0 To dt.Rows.Count - 1

                QUANTITE = 1

                pdfCell = New PdfPCell(New Paragraph(CDate(dt.Rows(i).Cells("DataGridViewTextBoxColumn2").Value).ToShortDateString, font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells("DataGridViewTextBoxColumn3").Value, font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfTable.AddCell(pdfCell)

                Dim infoSupLigneFacture As DataTable = Functions.GetAllElementsOnTwoConditions(dt.Rows(i).Cells("Id").Value, "ligne_facture", "ID_LIGNE_FACTURE", dt.Rows(i).Cells("code").Value, "CODE_FACTURE")

                'Dim infoSupLigneFacture As DataTable = Functions.getElementByCode(dt.Rows(i).Cells("Id").Value, "ligne_facture", "ID_LIGNE_FACTURE")

                If infoSupLigneFacture.Rows.Count > 0 Then
                    QUANTITE = infoSupLigneFacture.Rows(0)("QUANTITE")
                End If

                pdfCell = New PdfPCell(New Paragraph(Format(QUANTITE, "#,##0"), font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable.AddCell(pdfCell)

                'On ne preleve pas de taxe sur les taxes de sejours

                Dim LIBELLE_TAXE As String = "TAXE DE SEJOUR"
                Dim LIBELLE_FACTURE As String = dt.Rows(i).Cells("DataGridViewTextBoxColumn3").Value.ToString.ToUpper()

                If Not Trim(dt.Rows(i).Cells("debit").Value).Equals("") Then

                    If dt.Rows(i).Cells("debit").Value > 0 Then
                        MONTANT = dt.Rows(i).Cells("debit").Value * -1
                    Else
                        If Not Trim(dt.Rows(i).Cells("credit").Value).Equals("") Then
                            If dt.Rows(i).Cells("credit").Value > 0 Then
                                MONTANT = dt.Rows(i).Cells("credit").Value

                                'ON CALCUL LE TOTAL DES VERSEMENTS
                                TotalVersement += MONTANT

                            End If
                        End If
                    End If

                End If

                If Not LIBELLE_FACTURE.Contains(LIBELLE_TAXE) Then
                    pdfCell = New PdfPCell(New Paragraph(Format(Functions.NonprelevementDeTaxeSurUnMontant(MONTANT), "#,##0"), font1))
                Else
                    pdfCell = New PdfPCell(New Paragraph(Format(Functions.NonprelevementDeTaxeSurUnMontant(MONTANT), "#,##0"), font1))
                End If

                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable.AddCell(pdfCell)

            Next

            pdfDoc.Add(pdfTable)

            '------------------------------------------------------------------------

            Dim pdfTable2 As New PdfPTable(4) 'Number of columns

            pdfTable2.TotalWidth = 530.0F
            pdfTable2.LockedWidth = True
            pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
            'pdfTable2.HeaderRows = 1

            'Dim widths2 As Single() = New Single() {5.8F, 1.8F}
            Dim widths2 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
            pdfTable2.SetWidths(widths2)

            Dim pdfCell2 As PdfPCell = Nothing

            '-----------------------------------

            Dim TVA As Double = 0

            If Not societe.Rows(0)("TAUX_TVA") > 0 Then
                TVA = 0
            Else
                'TVA = (totalNormal * Double.Parse(societe.Rows(0)("TAUX_TVA") / 100))
                TVA = totalTVA
            End If

            '----------------------------- TOTAL HT -----------------------------------
            Dim pdfTable06 As New PdfPTable(4)

            pdfTable06.TotalWidth = 530.0F
            pdfTable06.LockedWidth = True
            pdfTable06.HorizontalAlignment = Element.ALIGN_RIGHT

            Dim widths06 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
            pdfTable06.SetWidths(widths06)

            Dim pdfCell06 As PdfPCell = Nothing

            pdfCell06 = New PdfPCell(New Paragraph("", fontTotal))
            pdfCell06.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell06.MinimumHeight = 18
            pdfCell06.PaddingLeft = 15.0F
            pdfCell06.Colspan = 4
            pdfCell06.Border = 0
            pdfTable06.AddCell(pdfCell06)

            pdfCell06 = New PdfPCell(New Paragraph("TOTAL HT : ", fontTotal))
            pdfCell06.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell06.MinimumHeight = 18
            pdfCell06.PaddingLeft = 15.0F
            pdfCell06.Colspan = 3
            pdfCell06.Border = 0
            pdfTable06.AddCell(pdfCell06)

            Dim TAXE_SEJOUR As Double = 0

            pdfCell06 = New PdfPCell(New Paragraph(Format(TotalFacture - TVA, "#,##0"), fontTotal))
            pdfCell06.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell06.MinimumHeight = 18
            pdfCell06.PaddingLeft = 5.0F
            pdfCell06.Border = 0
            pdfTable06.AddCell(pdfCell06)

            pdfDoc.Add(pdfTable06)

            '--------------------------------------------------------------------------

            Dim pdfTable4 As New PdfPTable(4) 'Number of columns

            pdfTable4.TotalWidth = 530.0F
            pdfTable4.LockedWidth = True
            pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
            'pdfTable4.HeaderRows = 1

            Dim widths4 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
            pdfTable4.SetWidths(widths4)

            Dim pdfCell4 As PdfPCell = Nothing

            If TVA > 0 Then

                pdfCell4 = New PdfPCell(New Paragraph("TVA : ", fontTotal))
            pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell4.MinimumHeight = 18
            pdfCell4.PaddingLeft = 15.0F
            pdfCell4.Border = 0
            pdfCell4.Colspan = 3
            pdfTable4.AddCell(pdfCell4)

            pdfCell4 = New PdfPCell(New Paragraph(Format(TVA, "#,##0"), fontTotal))
            pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell4.MinimumHeight = 18
            pdfCell4.PaddingLeft = 5.0F
            pdfCell4.Border = 0
            pdfTable4.AddCell(pdfCell4)

            pdfDoc.Add(pdfTable4)

            '-----------------------------------

            Dim pdfTable6 As New PdfPTable(4) 'Number of columns

            pdfTable6.TotalWidth = 530.0F
            pdfTable6.LockedWidth = True
            pdfTable6.HorizontalAlignment = Element.ALIGN_RIGHT
            'pdfTable4.HeaderRows = 1

            Dim widths6 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
            pdfTable6.SetWidths(widths6)

            Dim pdfCell6 As PdfPCell = Nothing

            pdfCell6 = New PdfPCell(New Paragraph("TAXE DE SEJOUR : ", fontTotal))
            pdfCell6.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell6.MinimumHeight = 18
            pdfCell6.PaddingLeft = 15.0F
            pdfCell6.Colspan = 3
            pdfCell6.Border = 0
            pdfTable6.AddCell(pdfCell6)

            'Dim TAXE_SEJOUR As Double = 0

            pdfCell6 = New PdfPCell(New Paragraph(Format(TAxeSejour, "#,##0"), fontTotal))
            pdfCell6.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell6.MinimumHeight = 18
            pdfCell6.PaddingLeft = 5.0F
            pdfCell6.Border = 0
            pdfTable6.AddCell(pdfCell6)

            pdfDoc.Add(pdfTable6)

            '-----------------------------------
            Dim pdfTable3 As New PdfPTable(4) 'Number of columns

            pdfTable3.TotalWidth = 530.0F
            pdfTable3.LockedWidth = True
            pdfTable3.HorizontalAlignment = Element.ALIGN_RIGHT
            'pdfTable3.HeaderRows = 1

            Dim widths3 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
            pdfTable3.SetWidths(widths3)

            Dim pdfCell3 As PdfPCell = Nothing

            pdfCell3 = New PdfPCell(New Paragraph("", fontTotal))
            pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell3.MinimumHeight = 18
            pdfCell3.PaddingLeft = 15.0F
            pdfCell3.Border = 0
            pdfCell3.Colspan = 3
            pdfTable3.AddCell(pdfCell3)

            pdfCell3 = New PdfPCell(New Paragraph("----------------", fontTotal))
            pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell3.MinimumHeight = 18
            pdfCell3.PaddingLeft = 15.0F
            pdfCell3.Border = 0
            'pdfCell3.Colspan = 3
            pdfTable3.AddCell(pdfCell3)

            pdfCell3 = New PdfPCell(New Paragraph("TOTAL TTC : ", fontTotal))
            pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell3.MinimumHeight = 18
            pdfCell3.PaddingLeft = 15.0F
            pdfCell3.Border = 0
            pdfCell3.Colspan = 3
            pdfTable3.AddCell(pdfCell3)

            'Dim TotalTTC As Double = (TotalFacture * 0.1925) + TotalFacture

            'pdfCell3 = New PdfPCell(New Paragraph(Format(TotalTTC, "#,##0"), fontTotal))
            pdfCell3 = New PdfPCell(New Paragraph(Format(TotalFacture + TAxeSejour, "#,##0"), fontTotal))
            pdfCell3.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell3.MinimumHeight = 18
            pdfCell3.PaddingLeft = 5.0F
            pdfCell3.Border = 0
            pdfTable3.AddCell(pdfCell3)


                pdfDoc.Add(pdfTable3)


            End If

            '---------------------------------------

            Dim pdfTable7 As New PdfPTable(4) 'Number of columns

            pdfTable7.TotalWidth = 530.0F
            pdfTable7.LockedWidth = True
            pdfTable7.HorizontalAlignment = Element.ALIGN_RIGHT
            'pdfTable7.HeaderRows = 1

            Dim widths7 As Single() = New Single() {1.3F, 6.5F, 0.6F, 1.5F}
            pdfTable7.SetWidths(widths7)

            Dim pdfCell7 As PdfPCell = Nothing

            SoldeNet = TotalVersement - (TotalFacture + TAxeSejour)

            Dim terme As String = ""

            If SoldeNet > 0 Then
                terme = "FAVEUR CLIENT : "
            ElseIf SoldeNet = 0 Then
                terme = "SOLDE NUL : "
            ElseIf 0 > SoldeNet Then
                terme = "A REGLER : "
            End If

            pdfCell7 = New PdfPCell(New Paragraph(terme, fontTotal))
            pdfCell7.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell7.MinimumHeight = 18
            pdfCell7.PaddingLeft = 15.0F
            pdfCell7.Colspan = 3
            pdfCell7.Border = 0
            pdfTable7.AddCell(pdfCell7)

            If SoldeNet < 0 Then
                'SoldeNet *= -1
            End If

            pdfCell7 = New PdfPCell(New Paragraph(Format(SoldeNet, "#,##0"), fontTotal))
            pdfCell7.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfCell7.MinimumHeight = 18
            pdfCell7.PaddingLeft = 5.0F
            pdfCell7.Border = 0
            pdfTable7.AddCell(pdfCell7)

            pdfDoc.Add(pdfTable7)

            '----------------------------------------

            Dim chiffreEnLettre = New Paragraph(Chr(13) & Chr(13) & "Arrêter la présente à la somme de: " & Functions.NBLT(TotalFacture + TAxeSejour) & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE"), pRow)

            pdfDoc.Add(chiffreEnLettre)

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub


    Public Shared Sub Bons(ByVal motif As String, ByVal nature As String, ByVal typeOperation As Integer, ByVal montant As Double)

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0

        Dim tireDocument As String = nature & " ETABLI PAR " & GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR") & (Date.Now().ToString("ddMMyyHHmmss"))

        Dim sousTitreDocument As String = ""

        sousTitreDocument = nature

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 20, 40)
            'Dim pdfDoc As New Document(PageSize.A4, 40, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 20, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 15, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            pdfDoc.Open()

            Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & "***", pColumn)
            p1.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p1)

            Dim p3 As Paragraph = New Paragraph(sousTitreDocument & Chr(13) & Chr(13), pRow)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            pdfWrite.PageEvent = New HeaderFooter

            Dim pdfTable As New PdfPTable(4) 'Number of columns
            pdfTable.TotalWidth = 530.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single() = New Single() {15.0F, 25.0F, 15.0F, 25.0F}

            pdfTable.SetWidths(widths)

            Dim pdfCell As PdfPCell = Nothing

            pdfCell = New PdfPCell(New Paragraph("DATE : ", fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            pdfCell.Border = 0
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(GlobalVariable.DateDeTravail & " " & Now().ToLongTimeString, fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.MinimumHeight = 15
            pdfCell.Colspan = 3
            pdfCell.Border = 0
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("MOTIF : ", fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            pdfCell.Border = 0
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(motif, fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.MinimumHeight = 15
            pdfCell.Colspan = 3
            pdfCell.Border = 0
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("MONTANT : ", fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            pdfCell.Border = 0
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(Format(montant, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.MinimumHeight = 15
            pdfCell.Colspan = 3
            pdfCell.Border = 0
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("ETABLI PAR : ", fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.MinimumHeight = 15
            'pdfCell.Colspan = 2
            pdfCell.Border = 0
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR") & Chr(13) & Chr(13), fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.MinimumHeight = 15
            pdfCell.Colspan = 3
            pdfCell.Border = 0
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("REMETTANT ", fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.Colspan = 2
            pdfCell.Border = 0
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("CAISSIER", fontTotal))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.Colspan = 2
            pdfCell.Border = 0

            pdfTable.AddCell(pdfCell)

            pdfDoc.Add(pdfTable)

            '------------------------------------------------------------------------

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

            Process.Start(sfd.FileName)

        End If

    End Sub


    Public Shared Sub mouchards(ByVal dt As DataGridView, ByVal DateDebut As Date, ByVal DateFin As Date)

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0
        Dim tireDocument As String = ""

        tireDocument = "Mouchards du " & GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR") & " " & Date.Now().ToString("ddMMyyHHmmss") & " "

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 40, 80, 40)
            'Dim pdfDoc As New Document(PageSize.B7, 5, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & "***", pColumn)
            p1.Alignment = Element.ALIGN_CENTER

            'pdfDoc.Add(p1)

            Dim p3 As Paragraph = New Paragraph(Date.Now() & Chr(13), pColumn)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            If DateDebut = DateFin Then

                Dim p0 As Paragraph = New Paragraph(Chr(13) & Chr(13) & " MOUCHARDS DU : " & DateDebut & Chr(13) & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            Else

                Dim p0 As Paragraph = New Paragraph(Chr(13) & Chr(13) & " MOUCHARDS DU : " & DateDebut & " AU " & DateFin & Chr(13) & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            End If

            'VENTES
            Dim pdfTable As New PdfPTable(4) 'Number of columns
            pdfTable.TotalWidth = 770.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single() = New Single() {5.0F, 80.0F, 17.0F, 25.0F}

            pdfTable.SetWidths(widths)

            pdfCell = New PdfPCell(New Paragraph("No", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("ACTIONS", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("DATE HEURE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("NOM UTILISATEUR", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfCell.PaddingLeft = 5.0F
            pdfTable.AddCell(pdfCell)

            'ARTICLE D'UNE FAMILLE QUELCONQUE

            If dt.Rows.Count > 0 Then

                Dim ordre As Integer = 0

                For j = 0 To dt.Rows.Count - 1

                    ordre += 1
                    pdfCell = New PdfPCell(New Paragraph(ordre & "- ", font1))
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                    pdfCell.MinimumHeight = 5
                    pdfCell.PaddingLeft = 5.0F

                    pdfTable.AddCell(pdfCell)

                    For k = 0 To dt.Columns.Count - 1

                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells(k).Value.ToString, font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable.AddCell(pdfCell)

                    Next

                Next

                pdfDoc.Add(pdfTable)

                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Process.Start(sfd.FileName)

            Else
                MessageBox.Show("Aucun Document à imprimer", "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            End If

        End If

    End Sub


    Public Shared Sub traces(ByVal dt As DataGridView, ByVal DateDebut As Date, ByVal DateFin As Date)

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0
        Dim tireDocument As String = ""

        tireDocument = "Traces du " & GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR") & " " & Date.Now().ToString("ddMMyyHHmmss") & " "

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 40, 80, 40)
            'Dim pdfDoc As New Document(PageSize.B7, 5, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 7, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 7, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 7, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 7, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & "***", pColumn)
            p1.Alignment = Element.ALIGN_CENTER

            'pdfDoc.Add(p1)

            Dim p3 As Paragraph = New Paragraph(Chr(13) & Chr(13) & Date.Now() & Chr(13), pColumn)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            If DateDebut = DateFin Then

                Dim p0 As Paragraph = New Paragraph(Chr(13) & Chr(13) & " TRACES DU : " & DateDebut & Chr(13) & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            Else

                Dim p0 As Paragraph = New Paragraph(Chr(13) & Chr(13) & " TRACES DU : " & DateDebut & " AU " & DateFin & Chr(13) & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            End If

            'Dim pdfTable As New PdfPTable(28) 'Number of columns
            Dim pdfTable As New PdfPTable(16) 'Number of columns
            pdfTable.TotalWidth = 790.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            'Dim widths As Single() = New Single() {8.0F, 20.0F, 30.0F, 17.0F, 18.0F, 10.0F, 30.0F, 15.0F, 10.0F, 15.0F, 10.0F, 15.0F, 5.0F, 5.0F, 5.0F, 5.0F, 5.0F, 5.0F, 5.0F, 5.0F, 5.0F, 5.0F, 5.0F, 5.0F, 5.0F, 5.0F, 5.0F, 5.0F}
            Dim widths As Single() = New Single() {8.0F, 18.0F, 30.0F, 20.0F, 18.0F, 10.0F, 30.0F, 18.0F, 10.0F, 18.0F, 10.0F, 15.0F, 10.0F, 15.0F, 20.0F, 10.0F}

            pdfTable.SetWidths(widths)

            pdfCell = New PdfPCell(New Paragraph("No", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("ACTION", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("PAR", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("A", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("UTILISATEUR", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("CHA.", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("CLIENT", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("DATE ENTREE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("HEURE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("DATE SORTIE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("HEURE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("MONTANT", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            pdfTable.AddCell(pdfCell)

            'pdfCell = New PdfPCell(New Paragraph("ADULTES", pColumn))
            'pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            'pdfCell.MinimumHeight = 5
            'pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("PAX", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            pdfTable.AddCell(pdfCell)

            'pdfCell = New PdfPCell(New Paragraph("ENFANTS", pColumn))
            'pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            'pdfCell.MinimumHeight = 5
            'pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("CAUTION", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("GROUPE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("SOLDE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("CHAMBRE ROUTAGE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("VENANT DE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("SE RENDANT A", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("ROUTAGE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("ETAT", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("CODE_ENTREPRISE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("NOM_ENTREPRISE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("BC_ENTREPRISE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("TYPE CHAMBRE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            pdfTable.AddCell(pdfCell)

            'pdfCell = New PdfPCell(New Paragraph("CODE RESERVATION", pColumn))
            'pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            'pdfCell.MinimumHeight = 5
            'pdfTable.AddCell(pdfCell)

            'For i = 0 To dt.Columns.Count - 1

            'pdfCell = New PdfPCell(New Paragraph(dt.Columns(i).HeaderText, pColumn))
            'pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            'pdfCell.MinimumHeight = 5
            'pdfTable.AddCell(pdfCell)

            'Next

            If dt.Rows.Count > 0 Then

                Dim ordre As Integer = 0

                For j = 0 To dt.Rows.Count - 1

                    ordre += 1
                        pdfCell = New PdfPCell(New Paragraph(ordre & "- ", font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells("ACTION").Value.ToString, font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells("PAR").Value.ToString, font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells("A").Value.ToString, font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells("UTILISATEUR_ID").Value.ToString, font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells("CHAMBRE_ID").Value.ToString, font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells("NOM_CLIENT").Value.ToString, font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(CDate(dt.Rows(j).Cells("DATE_ENTTRE").Value.ToString).ToShortDateString, font1))
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(CDate(dt.Rows(j).Cells("HEURE_ENTREE").Value.ToString).ToShortTimeString, font1))
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(CDate(dt.Rows(j).Cells("DATE_SORTIE").Value.ToString).ToShortDateString, font1))
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(CDate(dt.Rows(j).Cells("HEURE_SORTIE").Value.ToString).ToShortTimeString, font1))
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j).Cells("MONTANT_ACCORDE").Value, "#,##0"), font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j).Cells("PAX").Value, "#,##0"), font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j).Cells("SOLDE_RESERVATION").Value, "#,##0"), font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells("ETAT_NOTE_RESERVATION").Value.ToString, font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells("TYPE_CHAMBRE").Value.ToString, font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 5.0F
                        pdfTable.AddCell(pdfCell)

                Next

                pdfDoc.Add(pdfTable)

                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Process.Start(sfd.FileName)

            Else
                MessageBox.Show("Aucun Document à imprimer", "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            End If

        End If

    End Sub

    Public Shared Sub statistiquesJournaliere(ByVal dateState As Date)

        ' Dim DateDebutStat As Date = Functions.firstDayOfMonth(GlobalVariable.DateDeTravail)
        'Dim DateFinStat As Date = Functions.lastDayOfMonth(GlobalVariable.DateDeTravail)

        Dim DateDebutStat As Date = Functions.firstDayOfMonth(dateState)
        'Dim DateFinStat As Date = Functions.lastDayOfMonth(dateState)
        Dim DateFinStat As Date = CDate(dateState).ToShortDateString


        '--------------------------------------------------- SELECTION DES DONNEES ---------------------------------------------------------------------

        '------------------------------------ DONNEES DU JOURS ----------------------------------------------------------------------------

        '1- HEBERGEMENT

        Dim numeroDuMoiDuMoment As Integer = 0
        Dim numeroAnneeDuMoment As Integer = 0

        Dim numeroDuMoiDateDeTravail As Integer = 0
        Dim numeroAnneeDateDeTravail As Integer = 0

        Integer.TryParse(Month(CDate(dateState).ToShortDateString), numeroDuMoiDateDeTravail)

        '--------------------------------------------------------------MAINCOURANTE JOURNALIERE---------------------------------------------------------------
        Dim getUserQuery1 = "SELECT CHAMBRE_ID As 'CHAMBRE', DAY_USE, NUM_RESERVATION, main_courante_journaliere.NOM_CLIENT As 'NOM & PRENOM', DATE_ENTTRE As 'DATE ARRIVEE', DATE_SORTIE As 'DATE DEPART', NB_PERSONNES As 'NBRE DE PAX', PDJ, DEJEUNER, DINER,CAVE, CAFE, DIVERS, ENCAISSEMENT_ESPECE AS 'ESPECES', ENCAISSEMENT_CHEQUE AS 'CHEQUE', ENCAISSEMENT_CARTE_CREDIT As 'CARTE CREDIT', TELE AS 'MOBILE MONEY', main_Courante_journaliere.NUM_RESERVATION As 'RESERVATION', main_courante_journaliere.MONTANT_ACCORDE AS 'HEBERGEMENT', main_courante_journaliere.BAR_RESTAURANT AS 'BAR/RESTAURANT', BAR, main_courante_journaliere.SERVICES AS 'SERVICES', main_courante_journaliere.SALON_DE_BEAUTE AS 'SALON DE BEAUTE', main_courante_journaliere.BOUTIQE AS 'BOUTIQUE', main_courante_journaliere.CYBERCAFE As 'BUSINESS CENTER', main_courante_journaliere.SPORTS As 'SPORTS' , main_courante_journaliere.LOISIRS As 'LOISIRS', TOTAL_JOUR, main_courante_journaliere.KIOSQUE_A_JOURNAUX as 'JOURNAUX', main_courante_journaliere.BLANCHISSERIE As BLANCHISSERIE, main_courante_journaliere.AUTRES As 'AUTRES', TOTAL_JOUR As 'RECETTE DU JOUR', REPORT_VEILLE As 'REPORT VEILLE', TOTAL_GENERAL As 'TOTAL GENERAL', A_REPORTER As 'A REPORTER', HEURE_ENTREE, HEURE_SORTIE, TAUX_OCCUPATION_PCT As 'TAXE DE SEJOUR' FROM main_Courante_journaliere, reserve_conf WHERE DATE_MAIN_COURANTE <= '" & dateState.ToString("yyyy-MM-dd") & "' AND DATE_MAIN_COURANTE >='" & dateState.ToString("yyyy-MM-dd") & "' AND main_Courante_journaliere.NUM_RESERVATION = reserve_conf.CODE_RESERVATION AND reserve_conf.TYPE=@TYPE ORDER BY CODE_CHAMBRE ASC"

        Dim command1 As New MySqlCommand(getUserQuery1, GlobalVariable.connect)

        'command1.Parameters.Add("@DATE_DU_JOUR", MySqlDbType.Date).Value = GlobalVariable.DateDeTravail
        'command1.Parameters.Add("@ETAT_MAIN_COURANTE", MySqlDbType.Int32).Value = 0
        'command1.Parameters.Add("@ETAT_MAIN_COURANTE", MySqlDbType.Int32).Value = 1
        command1.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = "chambre"

        Dim adapter1 As New MySqlDataAdapter(command1)

        Dim table As New DataTable()

        adapter1.Fill(table)

        Dim getUserQuery01 = "SELECT CODE_CHAMBRE As 'CHAMBRE', NUM_RESERVATION, main_courante_autres.NOM_CLIENT As 'NOM & PRENOM', PDJ, DEJEUNER, DINER, CAVE, CAFE, DIVERS, ENCAISSEMENT_ESPECE AS 'ESPECES', ENCAISSEMENT_CHEQUE AS 'CHEQUE', ENCAISSEMENT_CARTE_CREDIT As 'CARTE CREDIT', TELE AS 'MOBILE MONEY', main_Courante_autres.NUM_RESERVATION As 'RESERVATION', main_courante_autres.MONTANT_ACCORDE AS 'HEBERGEMENT', main_courante_autres.BAR_RESTAURANT AS 'BAR/RESTAURANT', BAR, main_courante_autres.SERVICES AS 'SERVICES', main_courante_autres.SALON_DE_BEAUTE AS 'SALON DE BEAUTE', main_courante_autres.BOUTIQE AS 'BOUTIQUE', main_courante_autres.CYBERCAFE As 'BUSINESS CENTER', main_courante_autres.SPORTS As 'SPORTS' , main_courante_autres.LOISIRS As 'LOISIRS', TOTAL_JOUR, main_courante_autres.KIOSQUE_A_JOURNAUX as 'JOURNAUX', main_courante_autres.BLANCHISSERIE As BLANCHISSERIE, main_courante_autres.AUTRES As 'AUTRES', TOTAL_JOUR As 'RECETTE DU JOUR', REPORT_VEILLE As 'REPORT VEILLE', TOTAL_GENERAL As 'TOTAL GENERAL', A_REPORTER As 'A REPORTER' FROM main_Courante_autres WHERE DATE_MAIN_COURANTE <= '" & dateState.ToString("yyyy-MM-dd") & "' AND DATE_MAIN_COURANTE >='" & dateState.ToString("yyyy-MM-dd") & "' ORDER BY main_courante_autres.NOM_CLIENT ASC"

        Dim command01 As New MySqlCommand(getUserQuery01, GlobalVariable.connect)

        'command1.Parameters.Add("@DATE_DU_JOUR", MySqlDbType.Date).Value = GlobalVariable.DateDeTravail
        'command1.Parameters.Add("@ETAT_MAIN_COURANTE", MySqlDbType.Int32).Value = 0
        'command1.Parameters.Add("@ETAT_MAIN_COURANTE", MySqlDbType.Int32).Value = 1
        'command01.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = "chambre"

        Dim adapter01 As New MySqlDataAdapter(command01)

        Dim table001 As New DataTable()

        adapter01.Fill(table001)

        Dim hebergementDujours As Double = 0
        Dim barJour As Double = 0
        Dim restautantJour As Double = 0
        Dim autresJour As Double = 0
        Dim taxeDeSejour As Double = 0
        Dim blanchisserieJour As Double = 0

        Dim hebergementDuCumule As Double = 0
        Dim barCumule As Double = 0
        Dim RestaurantCumule As Double = 0
        Dim blanchisserrieDuCumule As Double = 0
        Dim taxeDeSejourCumule As Double = 0
        Dim autresCumule As Double = 0

        Dim pdjJour As Double = 0
        Dim dinerJour As Double = 0
        Dim dejeunerJour As Double = 0
        Dim pdjCumule As Double = 0
        Dim dinerCumule As Double = 0
        Dim dejeunerCumule As Double = 0

        Dim EauJour As Double = 0
        Dim caveJour As Double = 0
        Dim consoJour As Double = 0

        Dim EauCumule As Double = 0
        Dim caveCumule As Double = 0
        Dim consoCumule As Double = 0

        Dim totalSolideJour = 0
        Dim totalLiquideJour = 0

        Dim totalSolideCumul = 0
        Dim totalLiquideCumul = 0

        '----------------------------------------------- MAINCOURANTE JOURNALIERE ------------------------------------------------------------------------------
        Dim BAR As Double = 0

        For i = 0 To table.Rows.Count - 1

            BAR = 0

            pdjJour += table.Rows(i)("PDJ")
            dinerJour += table.Rows(i)("DINER")
            dejeunerJour += table.Rows(i)("DEJEUNER")

            EauJour += table.Rows(i)("CAFE")
            caveJour += table.Rows(i)("CAVE")
            consoJour += table.Rows(i)("DIVERS")

            Dim RESTAURANT As Double = table.Rows(i)("PDJ") + table.Rows(i)("DEJEUNER") + table.Rows(i)("DINER")
            BAR = table.Rows(i)("BAR")

            'Dim RESTAURANT As Double = table.Rows(i)("CAVE") + table.Rows(i)("DIVERS") + table.Rows(i)("CAFE")

            Dim AUTRES_VENTE As Double = table.Rows(i)("SERVICES") + table.Rows(i)("SALON DE BEAUTE") + table.Rows(i)("BOUTIQUE") + table.Rows(i)("BUSINESS CENTER") + table.Rows(i)("SPORTS") + table.Rows(i)("LOISIRS") + table.Rows(i)("JOURNAUX") + table.Rows(i)("AUTRES")

            Dim TOTAL_RECETTE As Double = 0

            Dim nuits As Integer = 0

            Dim arrivee As Date = CDate(table.Rows(i)("DATE ARRIVEE")).ToShortDateString
            Dim depart As Date = CDate(table.Rows(i)("DATE DEPART")).ToShortDateString

            'Dim dateTravail As Date = CDate(GlobalVariable.DateDeTravail).ToShortDateString
            Dim dateMainCourante As Date = dateState

            Dim HEBERGEMENT As Double = table.Rows(i)("HEBERGEMENT")
            Dim RETRANCHEMENTHEBERGEMENT As Double = 0
            Dim RETRANCHEMENTTAXEDESEJOUR As Double = 0
            Dim TAXE_DE_SEJOUR As Double = 0

            TAXE_DE_SEJOUR = table.Rows(i)("TAXE DE SEJOUR")

            If depart.ToString("yyyy-MM-dd") = dateMainCourante.ToString("yyyy-MM-dd") Then

                If table.Rows(i)("DAY_USE") = 0 Then

                    RETRANCHEMENTHEBERGEMENT = HEBERGEMENT
                    RETRANCHEMENTTAXEDESEJOUR = TAXE_DE_SEJOUR

                    HEBERGEMENT = 0
                    TAXE_DE_SEJOUR = 0

                Else
                    'AUTRES_VENTE -= table.Rows(i)("HEBERGEMENT")
                End If

            Else

            End If

            If HEBERGEMENT < 0 Then
                HEBERGEMENT = 0
            End If

            If AUTRES_VENTE < 0 Then
                AUTRES_VENTE = 0
            End If

            hebergementDujours += HEBERGEMENT
            barJour += BAR
            restautantJour += RESTAURANT
            autresJour += AUTRES_VENTE

            taxeDeSejour += TAXE_DE_SEJOUR
            blanchisserieJour += table.Rows(i)("BLANCHISSERIE")

            RETRANCHEMENTHEBERGEMENT = 0
            RETRANCHEMENTTAXEDESEJOUR = 0

        Next

        If Double.Parse(barJour) > Double.Parse((EauJour + caveJour + consoJour)) Then
            caveJour += Math.Abs(barJour - (EauJour + caveJour + consoJour))
        End If

        '----------------------------------------------- MAINCOURANTE AUTRES ------------------------------------------------------------------------------

        For i = 0 To table001.Rows.Count - 1

            BAR = 0

            pdjJour += table001.Rows(i)("PDJ")
            dinerJour += table001.Rows(i)("DINER")
            dejeunerJour += table001.Rows(i)("DEJEUNER")

            EauJour += table001.Rows(i)("CAFE")
            caveJour += table001.Rows(i)("CAVE")
            consoJour += table001.Rows(i)("DIVERS")

            Dim RESTAURANT As Double = table001.Rows(i)("PDJ") + table001.Rows(i)("DEJEUNER") + table001.Rows(i)("DINER")
            BAR = table001.Rows(i)("BAR")

            'Dim RESTAURANT As Double = table001.Rows(i)("CAVE") + table001.Rows(i)("DIVERS") + table001.Rows(i)("CAFE")

            Dim AUTRES_VENTE As Double = table001.Rows(i)("SERVICES") + table001.Rows(i)("SALON DE BEAUTE") + table001.Rows(i)("BOUTIQUE") + table001.Rows(i)("BUSINESS CENTER") + table001.Rows(i)("SPORTS") + table001.Rows(i)("LOISIRS") + table001.Rows(i)("JOURNAUX") + table001.Rows(i)("AUTRES")

            If AUTRES_VENTE < 0 Then
                AUTRES_VENTE = 0
            End If

            barJour += BAR
            restautantJour += RESTAURANT
            autresJour += AUTRES_VENTE
            'taxeDeSejour += 0
            blanchisserieJour += table001.Rows(i)("BLANCHISSERIE")

        Next

        totalSolideJour = restautantJour

        totalLiquideJour = barJour

        Dim totalGeneral As Double = 0
        Dim totalGeneralCumule As Double = 0

        totalGeneral = hebergementDujours + barJour + autresJour + taxeDeSejour + restautantJour

        '---------------------------------------------------------------------------------------------------------------------

        'CUMULE DES HEBERGEMENTS

        'PARTANT DES FACTURATIONS DEJA FAITE
        Dim query13 As String = "SELECT MONTANT_HT, FUSIONNEE FROM `ligne_facture` WHERE `LIBELLE_FACTURE` LIKE '%HEBERGEMENT%' AND `DATE_FACTURE` BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & DateFinStat.ToString("yyyy-MM-dd") & "'"

        Dim command13 As New MySqlCommand(query13, GlobalVariable.connect)

        Dim adapter13 As New MySqlDataAdapter(command13)
        Dim dtHebergement As New DataTable()
        adapter13.Fill(dtHebergement)

        If dtHebergement.Rows.Count > 0 Then

            For j = 0 To dtHebergement.Rows.Count - 1
                hebergementDuCumule += dtHebergement.Rows(j)("MONTANT_HT")
            Next

        End If

        'CUMULE DE TOUS CE QUI NETRAITE PAS L'HEBERGEMENT
        '2- RESTAURANTION

        Dim CODE_ARTICLE As String = ""
        Dim FUSIONNEE As String = ""
        Dim NOM_ARTICLE As String = ""

        Dim query14 As String = "SELECT * FROM ligne_facture WHERE `DATE_FACTURE` BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & DateFinStat.ToString("yyyy-MM-dd") & "' AND `LIBELLE_FACTURE` NOT LIKE '%HEBERGEMENT%'"
        ' AND `FUSIONNEE` NOT IN ('TAXE DE SEJOURS')

        Dim command14 As New MySqlCommand(query14, GlobalVariable.connect)

        Dim adapter14 As New MySqlDataAdapter(command14)
        Dim dtBarRestaurant As New DataTable()
        adapter14.Fill(dtBarRestaurant)

        Dim infoArticle As New DataTable()

        If dtBarRestaurant.Rows.Count > 0 Then

            For k = 0 To dtBarRestaurant.Rows.Count - 1

                CODE_ARTICLE = Trim(dtBarRestaurant.Rows(k)("CODE_ARTICLE"))
                FUSIONNEE = dtBarRestaurant.Rows(k)("FUSIONNEE")
                NOM_ARTICLE = dtBarRestaurant.Rows(k)("LIBELLE_FACTURE")

                infoArticle = Functions.getElementByCode(CODE_ARTICLE, "article", "CODE_ARTICLE")

                If infoArticle.Rows.Count > 0 Then

                    Dim FAMILLE_ARTICLE As String = infoArticle.Rows(0)("CODE_FAMILLE")

                    If Trim(FAMILLE_ARTICLE).Equals("BOISSONS") Then
                        barCumule += dtBarRestaurant.Rows(k)("MONTANT_HT")
                    ElseIf Trim(FAMILLE_ARTICLE).Equals("PRESSING") Then
                        blanchisserrieDuCumule += dtBarRestaurant.Rows(k)("MONTANT_HT")
                    ElseIf Trim(FAMILLE_ARTICLE).Equals("ALIMENTS(REPAS)") Then
                        RestaurantCumule += dtBarRestaurant.Rows(k)("MONTANT_HT")
                    Else
                        autresCumule += dtBarRestaurant.Rows(k)("MONTANT_HT")
                    End If

                Else

                    'ARTICLE N'ETANT ASSOCIE A AUCUNE FAMILLE EXEMPLE PETIT DEJEUNER DU ROUTAGE OU LA TAXE DE SEJOURS
                    If Trim(FUSIONNEE).Equals("TAXE DE SEJOURS") Then
                        taxeDeSejourCumule += dtBarRestaurant.Rows(k)("MONTANT_HT")
                    ElseIf Trim(FUSIONNEE).Equals("PETIT DEJEUNER") Then
                        RestaurantCumule += dtBarRestaurant.Rows(k)("MONTANT_HT")
                    Else
                        RestaurantCumule += dtBarRestaurant.Rows(k)("MONTANT_HT")
                    End If

                End If

            Next

        End If

        totalGeneralCumule = hebergementDuCumule + barCumule + RestaurantCumule + blanchisserrieDuCumule + taxeDeSejourCumule + autresCumule

        '---------------------------------- CALCUL DES CUMUL INDIVIDUELS -----------------------------------------------------

        Dim query15 As String = "SELECT * FROM ligne_facture WHERE `DATE_FACTURE` BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & DateFinStat.ToString("yyyy-MM-dd") & "' AND `LIBELLE_FACTURE` NOT LIKE '%HEBERGEMENT%' OR `DATE_FACTURE` BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & DateFinStat.ToString("yyyy-MM-dd") & "' AND `LIBELLE_FACTURE` NOT LIKE '%LOCATION SALLE%'"
        ' AND `FUSIONNEE` NOT IN ('TAXE DE SEJOURS')

        Dim command15 As New MySqlCommand(query15, GlobalVariable.connect)

        Dim adapter15 As New MySqlDataAdapter(command15)
        Dim dtBarRestaurantCumul As New DataTable()
        adapter15.Fill(dtBarRestaurantCumul)

        Dim ligneFacture As New LigneFacture()

        If dtBarRestaurantCumul.Rows.Count > 0 Then

            Dim FAMILLE_ARTICLE As String = ""
            Dim NATURE As String = ""
            Dim HEURE_FACTURE As DateTime

            For m = 0 To dtBarRestaurantCumul.Rows.Count - 1

                CODE_ARTICLE = Trim(dtBarRestaurantCumul.Rows(m)("CODE_ARTICLE"))
                FUSIONNEE = dtBarRestaurantCumul.Rows(m)("FUSIONNEE")
                NOM_ARTICLE = dtBarRestaurantCumul.Rows(m)("LIBELLE_FACTURE").ToString.ToUpper

                HEURE_FACTURE = dtBarRestaurantCumul.Rows(m)("HEURE_FACTURE")

                infoArticle = Functions.getElementByCode(CODE_ARTICLE, "article", "CODE_ARTICLE")

                If infoArticle.Rows.Count > 0 Then

                    FAMILLE_ARTICLE = infoArticle.Rows(0)("CODE_FAMILLE")

                    If Trim(FAMILLE_ARTICLE) = "BOISSONS" Then

                        If FUSIONNEE = "EAU MINERAL" Then
                            EauCumule += dtBarRestaurantCumul.Rows(m)("MONTANT_HT")
                        Else
                            If dtBarRestaurantCumul.Rows(m)("VALEUR_CONSO") > 0 Then
                                consoCumule += dtBarRestaurantCumul.Rows(m)("MONTANT_HT")
                            Else
                                caveCumule += dtBarRestaurantCumul.Rows(m)("MONTANT_HT")
                            End If
                        End If

                    ElseIf Trim(FAMILLE_ARTICLE) = "ALIMENTS(REPAS)" Then

                        'TRAITEMENTS DES ALIMENTS DE TYPE DEJEUENER/DINER

                        '1- ON DOIT DETERMINER LA NATURE EN PASSANT L'HEURE DE VENTE DE L'ARTICLE
                        Dim momentDeVente As Date = CDate(HEURE_FACTURE).ToLongTimeString

                        NATURE = ligneFacture.determintationDeLaNatureDuRePas(momentDeVente)

                        If FUSIONNEE = "PETIT DEJEUNER" Then
                            pdjCumule += dtBarRestaurantCumul.Rows(m)("MONTANT_HT")
                        ElseIf Trim(NATURE).Equals("DEJEUNER") Then
                            dejeunerCumule += dtBarRestaurantCumul.Rows(m)("MONTANT_HT")
                        ElseIf Trim(NATURE).Equals("DINER") Then
                            dinerCumule += dtBarRestaurantCumul.Rows(m)("MONTANT_HT")
                        Else
                            dinerCumule += dtBarRestaurantCumul.Rows(m)("MONTANT_HT")
                        End If

                    End If

                Else

                    'ARTICLE N'ETANT ASSOCIE A AUCUNE FAMILLE EXEMPLE PETIT DEJEUNER DU ROUTAGE OU LA TAXE DE SEJOURS
                    If Trim(FUSIONNEE).Equals("DINER") Then
                        dinerCumule += dtBarRestaurantCumul.Rows(m)("MONTANT_HT")
                    Else
                        If NOM_ARTICLE.Contains("PETIT DEJEUNER") Then
                            pdjCumule += dtBarRestaurantCumul.Rows(m)("MONTANT_HT")
                        Else
                            If Trim(FUSIONNEE).Equals("DEJEUNER") Then
                                dejeunerCumule += dtBarRestaurantCumul.Rows(m)("MONTANT_HT")
                            End If
                        End If
                    End If

                End If

            Next

            totalSolideCumul = pdjCumule + dejeunerCumule + dinerCumule

            totalLiquideCumul = EauCumule + caveCumule + consoCumule

        End If

        '---------------------------------------------------------------------------------------------------------------------

        Dim grandTotalJournalier As Double = 0
        Dim grandTotalCumule As Double = 0

        grandTotalJournalier += grandTotalJournalier
        grandTotalCumule += grandTotalCumule

        '------------------------------------ END DONNEES DU JOURS ----------------------------------------------------------------------------
        Dim dt As New DataTable()

        If True Then

            '-------------------------------- GENERATION DU RAPPORT DE STATISTIQUES JOURNALIERE ------------------------------------------------

            Dim societe As DataTable = Functions.allTableFields("societe")
            Dim TotalFacture As Double = 0

            Dim tireDocument As String = ""
            Dim titreFichier As String = ""

            If GlobalVariable.AncienneMainCourante Then
                titreFichier = "FEUILLE DE SITUATION JOURNALIERE "
            Else
                titreFichier = "FEUILLE DE SITUATION JOURNALIERE "
            End If

            tireDocument = titreFichier & " du " & dateState & " " & Now().ToLongTimeString & Chr(13)

            Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

            sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

            If sfd.ShowDialog = 1 Then
                'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
                Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
                Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
                Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
                Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

                pdfWrite.PageEvent = New HeaderFooter

                pdfDoc.Open()

                ' ----------------------------------------- TWO TABLES INTO A MAIN TABLE --------------------------------------------------
                Dim mtable As PdfPTable = New PdfPTable(2)
                mtable.WidthPercentage = 100
                mtable.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

                Dim tableRight As PdfPTable = New PdfPTable(1)
                tableRight.WidthPercentage = 100
                tableRight.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

                '------------------------------------------------  LEFT TABLE--------------------------------------------------------------------------
                Dim pdfTable As New PdfPTable(3) 'Number of columns
                pdfTable.TotalWidth = 260.0F
                pdfTable.LockedWidth = True
                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable.HeaderRows = 1

                pdfTable.WidthPercentage = 100
                Dim widths As Single() = New Single() {30.0F, 18.0F, 18.0F}
                pdfTable.SetWidths(widths)

                Dim pdfCell As PdfPCell = Nothing

                Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & Chr(13))
                p10.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p10)

                '----------------------------------------  -----------------------------------------------------------
                pdfCell = New PdfPCell(New Paragraph("DEPARTEMENTS", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                'pdfCell.Rowspan = 1

                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CA. T.T.C", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                pdfCell.Colspan = 2

                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("JOURNEE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CUMULE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("HEBERGEMENT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                pdfCell.Colspan = 2
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY

                '----------------------------------HEBERGEMENT  DATA 1 ----------------------------------------
                pdfCell = New PdfPCell(New Paragraph("CHAMBRES / SUITES ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(hebergementDujours, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(hebergementDuCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY

                pdfCell = New PdfPCell(New Paragraph("TAXE DE SEJOUR ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(taxeDeSejour, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(taxeDeSejourCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BUANDERIE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(blanchisserieJour, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(blanchisserrieDuCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                '---------------------------------- DATA 1 ----------------------------------
                pdfCell = New PdfPCell(New Paragraph("DIVERS ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(autresJour, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(autresCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("S/TOTAL 1 ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(taxeDeSejour + hebergementDujours + autresJour + blanchisserieJour, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(taxeDeSejourCumule + hebergementDuCumule + autresCumule + blanchisserrieDuCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                '------------------------------------------
                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("RESTAURATION", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                pdfCell.Colspan = 2
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                ' RESTAURATION
                pdfCell = New PdfPCell(New Paragraph("PETIT DEJEUNER ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(pdjJour, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(pdjCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                'pdfTable.AddCell(pdfCell)

                '---------------------------------- DATA 1 ----------------------------------

                pdfCell = New PdfPCell(New Paragraph("DEJEUNER", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(dejeunerJour, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(dejeunerCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DINER ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(dinerJour, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                'pdfCell = New PdfPCell(New Paragraph(Format(CumuleDinner, "#,##0"), pRow))
                pdfCell = New PdfPCell(New Paragraph(Format(dinerCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                '-------------------- DATA 1 -------------------------------------------


                pdfCell = New PdfPCell(New Paragraph("S/TOTAL 2 ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(pdjJour + dejeunerJour + dinerJour, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(pdjCumule + dejeunerCumule + dinerCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BAR", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                pdfCell.Colspan = 2
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CAVES", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(caveJour, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(caveCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                '---------------------------------- DATA 1 ----------------------------------
                pdfCell = New PdfPCell(New Paragraph("EAU MINERALE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(EauJour, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(EauCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CONSOMMATIONS ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(consoJour, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(consoCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("S/TOTAL 3 ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(caveJour + EauJour + consoJour, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(caveCumule + EauCumule + consoCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                '---------------------------------- GESTION DES EVENEMENTIELS -------------------------------------------------------**************************-----------

                '1- SELECTION DES TOUTES LES RESERVATIONS DE TYPE SALLE

                Dim querySalle As String = "SELECT CHAMBRE_ID AS 'CHAMBRE', NOM_CLIENT As 'NOM CLIENT', DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION', NB_PERSONNES As 'PERSONNE(S)' FROM `reserve_conf` WHERE `DATE_ENTTRE` BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & DateFinStat.ToString("yyyy-MM-dd") & "' AND `TYPE` LIKE 'salle' ORDER BY CHAMBRE_ID ASC"

                Dim commandSalle As New MySqlCommand(querySalle, GlobalVariable.connect)
                'commandSalle.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = "salle"

                Dim adapterSalle As New MySqlDataAdapter(commandSalle)
                Dim Salle As New DataTable()
                adapterSalle.Fill(Salle)

                Dim montantSalle As Double = 0
                Dim montantSalleCumule As Double = 0

                Dim locatioMateriel As Double = 0
                Dim locatioMaterielCumule As Double = 0

                Dim eauMinerale As Double = 0
                Dim eauMineraleCumule As Double = 0

                Dim pauseCafe As Double = 0
                Dim pauseCafeCumule As Double = 0

                Dim pauseDej As Double = 0
                Dim pauseDejeCumule As Double = 0

                Dim pauseDiner As Double = 0
                Dim pauseDinerCumule As Double = 0

                Dim pauseGoute As Double = 0
                Dim pauseGouteCumule As Double = 0

                Dim pauseCockTails As Double = 0
                Dim pauseCockTailsCumule As Double = 0

                Dim Boissons As Double = 0
                Dim BoissonsCumule As Double = 0

                Dim totalSalleJour As Double = 0
                Dim totalSalleCumul As Double = 0

                If Salle.Rows.Count > 0 Then

                    Dim CODE_RESERVATION As String = ""

                    For m = 0 To Salle.Rows.Count - 1

                        CODE_RESERVATION = Salle.Rows(m)("RESERVATION")

                        Dim arrivee As Date = CDate(Salle.Rows(m)("DATE ENTREE")).ToShortDateString
                        Dim depart As Date = CDate(Salle.Rows(m)("DATE SORTIE")).ToShortDateString

                        If dateState.ToString("yyyy-MM-dd") >= arrivee.ToString("yyyy-MM-dd") And dateState.ToString("yyyy-MM-dd") <= depart.ToString("yyyy-MM-dd") Then
                            montantSalle += Salle.Rows(m)("PRIX/NUITEE")
                        End If

                        montantSalleCumule += Salle.Rows(m)("PRIX/NUITEE")
                        'montantSalleCumule = Salle.Rows.Count

                        '2- SELECTION DES LIGNES DE CHARGES LIEES ACHAQUE RESERVATION DE TYPE SALLE

                        Dim querySalleConsommation As String = "SELECT * FROM `ligne_facture` WHERE CODE_RESERVATION=@CODE_RESERVATION "

                        Dim commandSalleConsommation As New MySqlCommand(querySalleConsommation, GlobalVariable.connect)
                        commandSalleConsommation.Parameters.Add("@CODE_RESERVATION", MySqlDbType.VarChar).Value = CODE_RESERVATION

                        Dim adapterSalleConsommation As New MySqlDataAdapter(commandSalleConsommation)
                        Dim SalleConsommation As New DataTable()
                        adapterSalleConsommation.Fill(SalleConsommation)

                        If SalleConsommation.Rows.Count > 0 Then

                            Dim chaine As String = ""

                            For n = 0 To SalleConsommation.Rows.Count - 1

                                chaine = SalleConsommation.Rows(n)("LIBELLE_FACTURE")

                                Dim DATE_FACTURE As Date = CDate(SalleConsommation.Rows(n)("DATE_FACTURE")).ToShortDateString

                                If dateState.ToString("yyyy-MM-dd") = DATE_FACTURE.ToString("yyyy-MM-dd") Then
                                    'VENTE JOURNALIERE

                                    If chaine.Contains("PAUSE CAFE") Then
                                        pauseCafe += SalleConsommation.Rows(n)("MONTANT_TTC")
                                    ElseIf chaine.Contains("PAUSE DEJEUNER") Then
                                        pauseDej += SalleConsommation.Rows(n)("MONTANT_TTC")
                                    ElseIf chaine.Contains("PAUSE DINER") Then
                                        pauseDiner += SalleConsommation.Rows(n)("MONTANT_TTC")
                                    ElseIf chaine.Contains("PAUSE GOUTE") Then
                                        pauseGoute += SalleConsommation.Rows(n)("MONTANT_TTC")
                                    ElseIf chaine.Contains("PAUSE COCKTAILS") Then
                                        pauseCockTails += SalleConsommation.Rows(n)("MONTANT_TTC")
                                    End If

                                End If

                                'CUMUL
                                If chaine.Contains("PAUSE CAFE") Then
                                    pauseCafeCumule += SalleConsommation.Rows(n)("MONTANT_TTC")
                                ElseIf chaine.Contains("PAUSE DEJEUNER") Then
                                    pauseDej += SalleConsommation.Rows(n)("MONTANT_TTC")
                                ElseIf chaine.Contains("PAUSE DINER") Then
                                    pauseDinerCumule += SalleConsommation.Rows(n)("MONTANT_TTC")
                                ElseIf chaine.Contains("PAUSE GOUTE") Then
                                    pauseGouteCumule += SalleConsommation.Rows(n)("MONTANT_TTC")
                                ElseIf chaine.Contains("PAUSE COCKTAILS") Then
                                    pauseCockTailsCumule += SalleConsommation.Rows(n)("MONTANT_TTC")
                                End If

                            Next

                        End If

                    Next

                End If

                Dim totalEvenementiel As Double = montantSalle + pauseCafe + pauseDej + pauseDiner + pauseGoute + pauseCockTails
                Dim totalEvenementielCumul As Double = montantSalleCumule + pauseCafeCumule + pauseDejeCumule + pauseGouteCumule + pauseCockTailsCumule + pauseDinerCumule

                totalSalleJour += totalEvenementiel
                totalSalleCumul += totalEvenementielCumul

                totalGeneral += totalSalleJour
                totalGeneralCumule += totalSalleCumul

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("EVENEMENTIEL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                pdfCell.Colspan = 2
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("LOCATION SALLE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(montantSalle, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(montantSalleCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                'pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("LOCATION MATERIEL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(locatioMateriel, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(locatioMaterielCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                '---------------------------------- DATA 1 ----------------------------------


                pdfCell = New PdfPCell(New Paragraph("EAU MINERALE ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(eauMinerale, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(eauMineraleCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAUSE CAFE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(pauseCafe, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(pauseCafeCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAUSE DEJEUNER", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(pauseDej, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(pauseDejeCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAUSE DINER", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(pauseDiner, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(pauseDinerCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                '--------------------------------------------------------------------------

                pdfCell = New PdfPCell(New Paragraph("PAUSE COCKTAILS", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(pauseCockTails, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(pauseCockTailsCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)
                '--------------------------------------------------------------------------

                pdfCell = New PdfPCell(New Paragraph("PAUSE GOUTE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(pauseGoute, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(pauseGouteCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)
                '--------------------------------------------------------------------------

                pdfCell = New PdfPCell(New Paragraph("BOISSONS", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(Boissons, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(BoissonsCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("S/TOTAL 4", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(montantSalle, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(montantSalleCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TOTAL GENERAL ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(totalGeneral, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(totalGeneralCumule, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 14
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                '------------------------------------ MODE DE REGLEMENT -------------------------------------------------------- 
                pdfCell = New PdfPCell(New Paragraph("-", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                pdfCell.Colspan = 3
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DIVERS MODES DE REGLEMENTS", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                pdfCell.Colspan = 3
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                Dim getModeReglement = "SELECT DISTINCT MODE_REGLEMENT FROM reglement WHERE DATE_REGLEMENT BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & dateState.ToString("yyyy-MM-dd") & "' ORDER BY DATE_REGLEMENT DESC"

                Dim commandModeReg As New MySqlCommand(getModeReglement, GlobalVariable.connect)

                Dim adapterModeReg As New MySqlDataAdapter

                Dim dtModeReg As New DataTable()

                adapterModeReg.SelectCommand = commandModeReg
                adapterModeReg.Fill(dtModeReg)

                If dtModeReg.Rows.Count > 0 Then

                    Dim totalEncaissementJournalier As Double = 0
                    Dim totalEncaissementCumule As Double = 0

                    For i = 0 To dtModeReg.Rows.Count - 1

                        Dim getReglement = "SELECT * FROM reglement WHERE MODE_REGLEMENT =@MODE_REGLEMENT AND DATE_REGLEMENT BETWEEN '" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND '" & dateState.ToString("yyyy-MM-dd") & "' ORDER BY DATE_REGLEMENT DESC"

                        Dim commandReg As New MySqlCommand(getReglement, GlobalVariable.connect)
                        commandReg.Parameters.Add("@MODE_REGLEMENT", MySqlDbType.VarChar).Value = dtModeReg.Rows(i)("MODE_REGLEMENT")

                        Dim adapterReg As New MySqlDataAdapter

                        Dim dtReg As New DataTable()
                        'Dim command As New MySqlCommand(query, GlobalVariable.connect)

                        adapterReg.SelectCommand = commandReg
                        adapterReg.Fill(dtReg)

                        If dtReg.Rows.Count > 0 Then

                            Dim montantModeReglemtJour As Double = 0
                            Dim montantModeReglemtCumule As Double = 0

                            For j = 0 To dtReg.Rows.Count - 1

                                If dtReg.Rows(j)("DATE_REGLEMENT") = dateState.ToString("yyyy-MM-dd") Then
                                    montantModeReglemtJour += dtReg.Rows(j)("MONTANT_VERSE")
                                    totalEncaissementJournalier += dtReg.Rows(j)("MONTANT_VERSE")
                                End If

                                montantModeReglemtCumule += dtReg.Rows(j)("MONTANT_VERSE")
                                totalEncaissementCumule += dtReg.Rows(j)("MONTANT_VERSE")

                            Next

                            pdfCell = New PdfPCell(New Paragraph(dtModeReg.Rows(i)("MODE_REGLEMENT").ToString.ToUpper, pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfCell.MinimumHeight = 14
                            'pdfCell.Border = 0
                            'pdfCell.Rotation = 270
                            pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(montantModeReglemtJour, "#,##0"), pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell.MinimumHeight = 14
                            'pdfCell.Rotation = 270
                            'pdfCell.Border = 0
                            pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(montantModeReglemtCumule, "#,##0"), pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell.MinimumHeight = 14
                            'pdfCell.Border = 0
                            'pdfCell.Rotation = 270
                            pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable.AddCell(pdfCell)

                        End If

                    Next

                    Dim nombreDeNuiteeDesArrivees As DataTable = Functions.getElementByCode(0, "reservation", "ETAT_RESERVATION")

                    '-------------------- DEPOSITS ----------------------------------
                    Dim depositsJournalier As Double = 0
                    Dim depositsCumule As Double = 0

                    Dim nombreDeNuiteeDesEnChambres As DataTable = Functions.getElementByCode(1, "reserve_conf", "ETAT_RESERVATION")

                    Dim nombreDeNuiteeDesEnChambresAnnuler As DataTable = Functions.getElementByCode(0, "reserve_conf", "ETAT_RESERVATION")

                    For i = 0 To nombreDeNuiteeDesEnChambres.Rows.Count - 1
                        depositsJournalier += nombreDeNuiteeDesEnChambres.Rows(i)("DEPOT_DE_GARANTIE")
                    Next

                    For i = 0 To nombreDeNuiteeDesEnChambresAnnuler.Rows.Count - 1
                        depositsCumule += nombreDeNuiteeDesEnChambresAnnuler.Rows(i)("DEPOT_DE_GARANTIE")
                    Next

                    depositsCumule += depositsJournalier

                    pdfCell = New PdfPCell(New Paragraph("DEPOSITS", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(depositsJournalier, "#,##0"), pRow))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(depositsCumule, "#,##0"), pRow))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F

                    pdfTable.AddCell(pdfCell)

                    '-------------------- DEBITEURS ----------------------------------

                    Dim totalDebiteurJournalier As Double = 0
                    Dim totalDebiteurCumule As Double = 0

                    Dim facture As New Facture()

                    Dim listeDesFactures As DataTable = facture.lettreDeRelance(GlobalVariable.DateDeTravail.AddDays(-1))

                    If listeDesFactures.Rows.Count > 0 Then

                        For i = 0 To listeDesFactures.Rows.Count - 1

                            'If listeDesFactures.Rows(i)("DATE_FACTURE") = GlobalVariable.DateDeTravail Then
                            If listeDesFactures.Rows(i)("Date") = GlobalVariable.DateDeTravail.AddDays(-1) Then
                                'totalDebiteurJournalier = listeDesFactures.Rows(i)("MONTANT_HT")
                                totalDebiteurJournalier = listeDesFactures.Rows(i)("MONTANT")
                            End If

                            'totalDebiteurCumule = listeDesFactures.Rows(i)("MONTANT")

                            If Not IsDBNull(listeDesFactures.Rows(i)("RESTE_A_PAYER")) Then
                                totalDebiteurCumule = listeDesFactures.Rows(i)("RESTE_A_PAYER")
                            End If

                        Next

                    End If

                    'totalDebiteurCumule += totalDebiteurJournalier

                    pdfCell = New PdfPCell(New Paragraph("DEBITEURS", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(totalDebiteurJournalier, "#,##0"), pRow))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(totalDebiteurCumule, "#,##0"), pRow))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F

                    pdfTable.AddCell(pdfCell)

                    '----------------------------------- BALANCE ----------------------------------

                    Dim balanceJournalier As Double = (totalEncaissementJournalier - totalDebiteurJournalier)
                    Dim balanceCumule As Double = (totalEncaissementCumule - totalDebiteurCumule)

                    pdfCell = New PdfPCell(New Paragraph("BALANCE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(balanceJournalier, "#,##0"), pRow))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 14
                    pdfCell.Border = 0
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(balanceCumule, "#,##0"), pRow))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 14
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfTable.AddCell(pdfCell)

                End If

                '------------------------------------------------ RIGHT TABLE ------------------------------------------

                '-------------------------------------------- RIGHT TABLE -------------------------------------------------

                'mtable.AddCell(tableRight)

                Dim rooms As New Room()

                'NOMBRE DE CHAMBRE HS
                Dim HSRooms As Integer = rooms.HSRoomsOnly().Rows.Count

                'NOMBRE DE CHAMBRE TOTAL
                Dim roomsOnly As Integer = rooms.roomsOnly().Rows.Count

                Dim EnChambre As Double = 0
                Dim nombreChambreLibreJour As Integer = 0
                Dim totalChambreDujour As Integer = 0

                Dim totalChambreDujourCumule As Integer = 0

                Dim nombreChambreLibreCumule As Integer = 0
                Dim totalChambreLibreCumule As Integer = 0

                Dim nombreCumule As Integer = 0

                Dim tauxDispo As Double = 0
                Dim tauxCumule As Double = 0

                'EN DEPART 
                Dim nombreDepart As Double = 0
                'Dim query1 As String = "Select NOM_CLIENT As 'NOM CLIENT', CHAMBRE_ID AS 'CHAMBRE',DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',ETAT_NOTE_RESERVATION AS 'STATUT',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_SORTIE >= '" & dateState.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE <='" & dateState.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND DAY_USE = @DAY_USE ORDER BY CHAMBRE_ID ASC"

                'Dim commandDepart As New MySqlCommand(query1, GlobalVariable.connect)
                'commandDepart.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle
                'commandDepart.Parameters.Add("@DAY_USE", MySqlDbType.Int64).Value = 0

                ''Dim adapterDepart As New MySqlDataAdapter(commandDepart)
                'Dim tableDepart As New DataTable()
                'adapterDepart.Fill(tableDepart)

                'If (tableDepart.Rows.Count > 0) Then
                'nombreDepart = tableDepart.Rows.Count
                'End If

                'EN CHAMBRE
                ' Dim queryEnChambre As String = "SELECT CHAMBRE_ID AS 'CHAMBRE', NOM_CLIENT As 'NOM CLIENT', DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_ENTTRE <= '" & dateState.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >= '" & dateState.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND DAY_USE = @DAY_USE ORDER BY CHAMBRE_ID ASC"

                ''Dim commandEnChambre As New MySqlCommand(queryEnChambre, GlobalVariable.connect)
                'commandEnChambre.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = "chambre"
                'commandEnChambre.Parameters.Add("@DAY_USE", MySqlDbType.Int64).Value = 0

                'Dim adapterEnChambre As New MySqlDataAdapter(commandEnChambre)
                ''Dim tableEnChambre As New DataTable()
                'adapterEnChambre.Fill(tableEnChambre)

                'If (tableEnChambre.Rows.Count > 0) Then
                'CHAMBRE DISPO = # CHAMBRE TOTAL - # CHAMBRE HS - # CHAMBRE OCCUPEE - DEPART

                'TRAITEMENT DU MOIS EN COURS

                'For i = 0 To tableEnChambre.Rows.Count - 1

                'Dim dateArrivee As Date = tableEnChambre.Rows(i)("DATE ENTREE")
                'Depart As Date = tableEnChambre.Rows(i)("DATE SORTIE")

                'If dateArrivee.ToString("yyyy-MM-dd") <= dateState.ToString("yyyy-MM-dd") And dateDepart.ToString("yyyy-MM-dd") >= dateState.ToString("yyyy-MM-dd") Then

                'ON COMPTE LE NOMBRE DES EN CHAMBRES
                'EnChambre += 1

                'End If

                'Next

                'totalChambreDujour = roomsOnly - HSRooms
                'nombreChambreLibreJour = totalChambreDujour - EnChambre + nombreDepart

                'End If

                'CALCUL DES CUMUL PAR TYPE DE CHAMBRE ET POUR LES DISPONIBILITES 

                '*/---------------------------------------------------------------------------

                Dim table1 As PdfPTable = New PdfPTable(5)
                table1.WidthPercentage = 100
                Dim cell1 As PdfPCell

                Dim table01 As PdfPTable = New PdfPTable(5)
                table01.WidthPercentage = 100
                Dim cell As PdfPCell

                '1- SELCTION DES DIFFERENTS TYPES DE CHAMBRES

                Dim queryTypeChambre As String = "SELECT DISTINCT CODE_TYPE_CHAMBRE From type_chambre WHERE CODE_AGENCE=@CODE_AGENCE AND TYPE=@TYPE "
                'Dim commandType As New MySqlCommand(queryType, GlobalVariable.connect)
                Dim commandTypeChambre As New MySqlCommand(queryTypeChambre, GlobalVariable.connect)

                commandTypeChambre.Parameters.Add("@CODE_AGENCE", MySqlDbType.VarChar).Value = GlobalVariable.codeAgence
                commandTypeChambre.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = "chambre"

                Dim adapterTypeChambre As New MySqlDataAdapter(commandTypeChambre)
                Dim tableTypeChambre As New DataTable()

                adapterTypeChambre.Fill(tableTypeChambre)

                Dim TotalDeceType As Double = 0

                Dim nomreResaJour As Integer = 0
                Dim montantJour As Double = 0
                Dim nomreResaCumule As Integer = 0
                Dim montantCumule As Double = 0

                Dim nombreChambreVenduJour As Integer = 0
                Dim totalChambreVenduCumule As Integer = 0
                Dim nombreChambreVenduCumule As Integer = 0
                Dim totalNombreDeCeTYpe As Integer = 0

                Dim grandTotalVenteDuJOur As Integer = 0
                Dim grandTotalVenteDuCumule As Integer = 0
                Dim grandTotalTOJour As Integer = 0
                Dim grandTotalTOCumule As Integer = 0

                Dim TOJG As Double = 0
                Dim TOCG As Double = 0

                Dim nombreDepartCumule As Double = 0

                Dim totalEnChambrejourApresJour As Integer = 0


                cell1 = New PdfPCell(New Paragraph("", pColumn))
                cell1.Border = 0
                'cell.Colspan = 5
                cell1.HorizontalAlignment = 1
                table1.AddCell(cell1)

                cell1 = New PdfPCell(New Paragraph("Nombre de Chambre et Suites vendues", pColumn))
                cell1.Border = 0
                cell1.HorizontalAlignment = Element.ALIGN_LEFT
                cell1.Colspan = 4
                cell1.HorizontalAlignment = 1
                table1.AddCell(cell1)

                cell1 = New PdfPCell(New Paragraph("", pColumn))
                cell1.Border = 0
                'cell.Colspan = 2
                cell1.HorizontalAlignment = 1
                table1.AddCell(cell1)

                cell1 = New PdfPCell(New Paragraph("JOURNEE", pColumn))
                cell1.Colspan = 2
                cell1.HorizontalAlignment = 1
                table1.AddCell(cell1)

                cell1 = New PdfPCell(New Paragraph("CUMUL", pColumn))
                cell1.Colspan = 2
                cell1.HorizontalAlignment = 1
                table1.AddCell(cell1)

                cell1 = New PdfPCell(New Paragraph("", pColumn))
                'cell.Colspan = 2
                cell1.Border = 0
                cell1.HorizontalAlignment = 1
                table1.AddCell(cell1)

                cell1 = New PdfPCell(New Paragraph("NBRE", pColumn))
                'cell.Colspan = 2
                cell1.HorizontalAlignment = 1
                table1.AddCell(cell1)

                cell1 = New PdfPCell(New Paragraph("% OCCUP", pColumn))
                'cell.Colspan = 2
                cell1.HorizontalAlignment = 1
                table1.AddCell(cell1)

                cell1 = New PdfPCell(New Paragraph("NBRE", pColumn))
                'cell.Colspan = 2
                cell1.HorizontalAlignment = 1
                table1.AddCell(cell1)

                cell1 = New PdfPCell(New Paragraph("% OCCUP", pColumn))
                'cell.Colspan = 2
                cell1.HorizontalAlignment = 1
                table1.AddCell(cell1)

                '-------------------- SELECTION DES TYPES DE CHAMBRES -----------------------


                If (tableTypeChambre.Rows.Count > 0) Then

                    For i = 0 To tableTypeChambre.Rows.Count - 1

                        nombreChambreVenduJour = 0 'POUR UN CERTAIN TYPE
                        nombreChambreVenduCumule = 0 'POUR UN CERTAIN TYPE
                        TotalDeceType = 0

                        '2- POUR CHAQUE TYPE ON DETERMINE SON NOMBRE

                        Dim nombreDeChambreDUnCertainType As DataTable = Functions.getElementByCode(tableTypeChambre.Rows(i)("CODE_TYPE_CHAMBRE"), "chambre", "CODE_TYPE_CHAMBRE")

                        Dim TYPE_CHAMBRE_ACTUEL As String = ""

                        If nombreDeChambreDUnCertainType.Rows.Count > 0 Then
                            TotalDeceType = nombreDeChambreDUnCertainType.Rows.Count
                            TYPE_CHAMBRE_ACTUEL = tableTypeChambre.Rows(i)("CODE_TYPE_CHAMBRE")
                        End If

                        '3- PUIS ON DETERMINE TOUTES LES RESERVATIONS CONFIRMEES ASSOCIES AU TYPE EN COURS

                        '3.1- SELECTION DES RESERVATION (EN CHAMBRES : EN DERTEMINANT CEUX QUI SONT EN DEPARTS) PAR INCREMENTATION DES DATES 
                        'ON PARCOURS CHAQUE DATE DU PREMIER AU DERNIER JOUR DU MOI

                        Dim ActualDate As Date

                        ActualDate = CDate(DateDebutStat).ToShortDateString
                        Dim totalCunulOnlyRooms

                        Dim nombreChambreLibreJourApresJour As Integer = 0
                        Dim nombreDepartJourApresJour As Integer = 0

                        Do

                            Dim queryDispo As String = "SELECT CHAMBRE_ID AS 'CHAMBRE', NOM_CLIENT As 'NOM CLIENT', DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION', NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_ENTTRE <= '" & ActualDate.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >= '" & ActualDate.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND DAY_USE = @DAY_USE AND TYPE_CHAMBRE = @TYPE_CHAMBRE ORDER BY CHAMBRE_ID ASC"

                            Dim commandqueryDispo As New MySqlCommand(queryDispo, GlobalVariable.connect)
                            commandqueryDispo.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = "chambre"
                            commandqueryDispo.Parameters.Add("@TYPE_CHAMBRE", MySqlDbType.VarChar).Value = TYPE_CHAMBRE_ACTUEL
                            commandqueryDispo.Parameters.Add("@DAY_USE", MySqlDbType.Int64).Value = 0

                            Dim adapterqueryDispo As New MySqlDataAdapter(commandqueryDispo)
                            Dim tablequeryDispo As New DataTable()
                            adapterqueryDispo.Fill(tablequeryDispo)

                            If (tablequeryDispo.Rows.Count > 0) Then

                                'ON DETERMINE LES EN CHAMBRES DU JOUR D'ETABLISSEMENT DES STATS ET CEUX POUR CHAQUE TYPE DE CHAMBRE

                                If ActualDate.ToString("yyyy-MM-dd") = dateState.ToString("yyyy-MM-dd") Then
                                    EnChambre += tablequeryDispo.Rows.Count 'NOMBRE D'EN CHAMBRE DU JOUR DE LA STATISTIQUE
                                End If

                                totalEnChambrejourApresJour += tablequeryDispo.Rows.Count

                                '3.2- ON BOUCLES SUR LES EN CHAMBRE D'UN JOUR PARTICULIER

                                For m = 0 To tablequeryDispo.Rows.Count - 1

                                    'ON DETERMINE LES RESERVATIONS EN DEPART PAR APPORT A LA DATE ACTUEL

                                    Dim dateDepart As Date = CDate(tablequeryDispo.Rows(m)("DATE SORTIE"))

                                    If ActualDate.ToString("yyyy-MM-dd") = dateDepart.ToString("yyyy-MM-dd") Then

                                        If ActualDate.ToString("yyyy-MM-dd") = dateState.ToString("yyyy-MM-dd") Then
                                            nombreDepart += 1
                                        End If

                                        nombreDepartCumule += 1

                                    End If

                                    If ActualDate.ToString("yyyy-MM-dd") = dateState.ToString("yyyy-MM-dd") Then

                                        nombreChambreVenduJour += 1
                                        nomreResaJour += 1
                                        montantJour += tablequeryDispo.Rows(m)("PRIX/NUITEE")

                                    End If

                                    nombreChambreVenduCumule += 1
                                    nomreResaCumule += 1
                                    montantCumule += tablequeryDispo.Rows(m)("PRIX/NUITEE")

                                Next

                            End If

                            ActualDate = ActualDate.AddDays(1)

                            totalChambreDujourCumule += roomsOnly - HSRooms

                        Loop While (ActualDate <= CDate(DateFinStat).ToShortDateString)

                        '*/---------------------------------------------------------------------------


                        cell1 = New PdfPCell(New Paragraph(tableTypeChambre.Rows(i)("CODE_TYPE_CHAMBRE"), pColumn))
                        'cell.Colspan = 2
                        cell1.HorizontalAlignment = 1
                        table1.AddCell(cell1)

                        grandTotalVenteDuJOur += nombreChambreVenduJour

                        cell1 = New PdfPCell(New Paragraph(Format(nombreChambreVenduJour, "#,##0"), pColumn))
                        'cell.Colspan = 2
                        cell1.HorizontalAlignment = 1
                        table1.AddCell(cell1)

                        Dim TOparType As Double = 0

                        If TotalDeceType > 0 Then
                            TOparType = (nombreChambreVenduJour * 100) / TotalDeceType
                        End If

                        grandTotalTOJour += TOparType

                        cell1 = New PdfPCell(New Paragraph(Format(TOparType, "#,##0.0"), pColumn))
                        'cell.Colspan = 2
                        cell1.HorizontalAlignment = 1
                        table1.AddCell(cell1)

                        grandTotalVenteDuCumule += nombreChambreVenduCumule

                        cell1 = New PdfPCell(New Paragraph(Format(nombreChambreVenduCumule, "#,##0"), pColumn))
                        'cell.Colspan = 2
                        cell1.HorizontalAlignment = 1
                        table1.AddCell(cell1)

                        Dim TOparTypeCumule As Double = 0

                        If TotalDeceType > 0 Then
                            If totalEnChambrejourApresJour > 0 Then
                                TOparTypeCumule = (nombreChambreVenduCumule * 100) / (totalEnChambrejourApresJour)
                            End If
                        End If

                        grandTotalTOCumule += TOparTypeCumule

                        cell1 = New PdfPCell(New Paragraph(Format(TOparTypeCumule, "#,##0.0"), pColumn))
                        'cell.Colspan = 2
                        cell1.HorizontalAlignment = 1
                        table1.AddCell(cell1)

                    Next

                    totalChambreDujour = roomsOnly - HSRooms

                    nombreChambreLibreJour = totalChambreDujour - EnChambre + nombreDepart

                    nombreChambreLibreCumule = totalChambreDujourCumule - totalEnChambrejourApresJour + nombreDepartCumule

                End If

                '----------------------------------------------------------------------------------------------------------------------------------------------


                '---------------------------------------------- AFFICHAGE DES DIFFERENTS TYPES ET LEURS DONNEES STATISTIQUES -----------------------------------

                cell = New PdfPCell(New Paragraph("STATISTIQUES", pColumn))
                cell.Border = 0
                cell.Colspan = 5
                cell.HorizontalAlignment = 1
                table01.AddCell(cell)

                cell = New PdfPCell(New Paragraph("", pColumn))
                cell.Border = 0
                cell.Colspan = 5
                cell.HorizontalAlignment = 1
                table01.AddCell(cell)

                cell = New PdfPCell(New Paragraph("HEBERGEMENT" & Chr(13), pColumn))
                cell.Border = 0
                cell.HorizontalAlignment = Element.ALIGN_LEFT
                cell.Colspan = 5
                cell.HorizontalAlignment = 1
                table01.AddCell(cell)

                cell = New PdfPCell(New Paragraph("", pColumn))
                cell.Border = 0
                'cell.Colspan = 5
                cell.HorizontalAlignment = 1
                table01.AddCell(cell)

                cell = New PdfPCell(New Paragraph("Nombre de Chambre et Suites vendables", pColumn))
                    cell.Border = 0
                    cell.HorizontalAlignment = Element.ALIGN_LEFT
                    cell.Colspan = 4
                    cell.HorizontalAlignment = 1
                    table01.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("", pColumn))
                    cell.Border = 0
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table01.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("JOURNEE", pColumn))
                    cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table01.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("CUMUL", pColumn))
                    cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table01.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("", pColumn))
                    'cell.Colspan = 2
                    cell.Border = 0
                    cell.HorizontalAlignment = 1
                    table01.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("NBRE", pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table01.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("% DISPO", pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table01.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("NBRE", pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table01.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("% DISPO", pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table01.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table01.AddCell(cell)

                    cell = New PdfPCell(New Paragraph(Format(nombreChambreLibreJour, "#,##0"), pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table01.AddCell(cell)

                    cell = New PdfPCell(New Paragraph(Format((nombreChambreLibreJour * 100) / totalChambreDujour, "#,##0.0"), pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table01.AddCell(cell)

                    cell = New PdfPCell(New Paragraph(Format(nombreChambreLibreCumule, "#,##0"), pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table01.AddCell(cell)

                cell = New PdfPCell(New Paragraph(Format((nombreChambreLibreCumule * 100) / totalChambreDujourCumule, "#,##0.0"), pColumn))
                'cell.Colspan = 2
                cell.HorizontalAlignment = 1
                    table01.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("", pColumn))
                    cell.Border = 0
                    cell.Colspan = 5
                    cell.HorizontalAlignment = 1
                    table01.AddCell(cell)

                    tableRight.AddCell(table01)

                '-------------------------------- RESUME STAT POUR CHAQUE TYPE DE CHAMBRE  --------------------------------------

                cell1 = New PdfPCell(New Paragraph("TOTAL", pColumn))
                'cell.Colspan = 2
                cell1.HorizontalAlignment = 1
                table1.AddCell(cell1)

                cell1 = New PdfPCell(New Paragraph(Format(grandTotalVenteDuJOur, "#,##0"), pColumn))
                'cell.Colspan = 2
                cell1.HorizontalAlignment = 1
                table1.AddCell(cell1)

                TOJG = grandTotalTOJour / tableTypeChambre.Rows.Count

                cell1 = New PdfPCell(New Paragraph(Format(TOJG, "#,##0.00"), pColumn))
                'cell.Colspan = 2
                cell1.HorizontalAlignment = 1
                table1.AddCell(cell1)

                cell1 = New PdfPCell(New Paragraph(Format(grandTotalVenteDuCumule, "#,##0"), pColumn))
                'cell.Colspan = 2
                cell1.HorizontalAlignment = 1
                table1.AddCell(cell1)

                TOCG = grandTotalTOCumule / tableTypeChambre.Rows.Count

                cell1 = New PdfPCell(New Paragraph(Format(TOCG, "#,##0.00"), pColumn))
                'cell.Colspan = 2
                cell1.HorizontalAlignment = 1
                table1.AddCell(cell1)

                cell1 = New PdfPCell(New Paragraph("PRIX M", pColumn))
                cell1.Colspan = 1
                cell1.Border = 0
                cell1.HorizontalAlignment = 1
                table1.AddCell(cell1)

                Dim prixMoyenJour As Double = 0

                If nomreResaJour > 0 Then
                    prixMoyenJour = montantJour / nomreResaJour
                End If

                cell1 = New PdfPCell(New Paragraph(Format(prixMoyenJour, "#,##0"), pColumn))
                cell1.Colspan = 2
                cell1.HorizontalAlignment = 1
                table1.AddCell(cell1)

                Dim prixMoyenCumule As Double = 0

                If nomreResaCumule > 0 Then
                    prixMoyenCumule = montantCumule / nomreResaCumule
                End If

                cell1 = New PdfPCell(New Paragraph(Format(prixMoyenCumule, "#,##0"), pColumn))
                cell1.Colspan = 2
                cell1.HorizontalAlignment = 1
                table1.AddCell(cell1)

                tableRight.AddCell(table1)

                '----------------------------------------------------- GESTION DES COUVERTS --------------------------------------------------

                Dim Query02 As String = "SELECT CODE_ARTICLE AS ARTICLE, LIBELLE_FACTURE AS 'LIBELLE ARTICLE', QUANTITE, PRIX_UNITAIRE_TTC AS 'PRIX UNITAIRE', MONTANT_HT AS'MONTANT TOTAL', FUSIONNEE, DATE_FACTURE  FROM ligne_facture WHERE CODE_AGENCE=@CODE_AGENCE AND  DATE_FACTURE >='" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND DATE_FACTURE <='" & DateFinStat.ToString("yyyy-MM-dd") & "' AND LIBELLE_FACTURE NOT LIKE '%HEBERGEMENT%' Or CODE_AGENCE=@CODE_AGENCE AND  DATE_FACTURE >='" & DateDebutStat.ToString("yyyy-MM-dd") & "' AND DATE_FACTURE <='" & DateFinStat.ToString("yyyy-MM-dd") & "' AND LIBELLE_FACTURE NOT LIKE '%LOCATION SALLE%'"

                    Dim command02 As New MySqlCommand(Query02, GlobalVariable.connect)

                    command02.Parameters.Add("@CODE_AGENCE", MySqlDbType.VarChar).Value = GlobalVariable.codeAgence

                    Dim adapterList02 As New MySqlDataAdapter(command02)
                    Dim table02 As New DataTable()

                    adapterList02.Fill(table02)

                    Dim TDEJ As Double = 0
                    Dim TPDJ As Double = 0
                    Dim TDINE As Double = 0

                    Dim PDJ As Double = 0
                    Dim DEJ As Double = 0
                    Dim DINE As Double = 0

                    If table02.Rows.Count > 0 Then

                        PDJ = 0
                        DEJ = 0
                        DINE = 0

                        For k = 0 To table02.Rows.Count - 1

                            Integer.TryParse(Month(table02.Rows(k)("DATE_FACTURE")), numeroDuMoiDuMoment)

                            'ON FAIT LA DIFFERENCE ENTRE LE TOTAL JOUR ET LE TOTAL MENSUEL

                            If CDate(table02.Rows(k)("DATE_FACTURE")).ToString("yyyy-MM-dd") = dateState.ToString("yyyy-MM-dd") Then

                                If Trim(table02.Rows(k)("FUSIONNEE")) = "PETIT DEJEUNER" Then
                                    PDJ += table02.Rows(k)("QUANTITE")
                                ElseIf Trim(table02.Rows(k)("FUSIONNEE")) = "DEJEUNER" Then
                                    DEJ += table02.Rows(k)("QUANTITE")
                                ElseIf Trim(table02.Rows(k)("FUSIONNEE")) = "DINER" Then
                                    DINE += table02.Rows(k)("QUANTITE")
                                End If

                            End If

                            If Trim(table02.Rows(k)("FUSIONNEE")) = "PETIT DEJEUNER" Then
                                TPDJ += table02.Rows(k)("QUANTITE")
                            ElseIf Trim(table02.Rows(k)("FUSIONNEE")) = "DEJEUNER" Then
                                TDEJ += table02.Rows(k)("QUANTITE")
                            ElseIf Trim(table02.Rows(k)("FUSIONNEE")) = "DINER" Then
                                TDINE += table02.Rows(k)("QUANTITE")
                            End If

                        Next

                    End If

                    Dim table2 As PdfPTable = New PdfPTable(3)
                    table2.WidthPercentage = 10

                    cell = New PdfPCell(New Paragraph("" & Chr(13), pColumn))
                    cell.Border = 0
                    cell.HorizontalAlignment = Element.ALIGN_LEFT
                    cell.Colspan = 5
                    cell.HorizontalAlignment = 1
                    table2.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("RESTAURATION" & Chr(13), pColumn))
                    cell.Border = 0
                    cell.HorizontalAlignment = Element.ALIGN_LEFT
                    cell.Colspan = 5
                    cell.HorizontalAlignment = 1
                    table2.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("REPAS", pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table2.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("COUVERTS JOUR", pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table2.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("CUMUL COUVERTS", pColumn))
                    'cell.Colspan = 2
                    'cell.Border = 0
                    cell.HorizontalAlignment = 1
                    table2.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("PETIT-DEJEUNER", pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table2.AddCell(cell)

                    cell = New PdfPCell(New Paragraph(PDJ, pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table2.AddCell(cell)

                    cell = New PdfPCell(New Paragraph(TPDJ, pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table2.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("DEJEUNER", pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table2.AddCell(cell)

                    cell = New PdfPCell(New Paragraph(DEJ, pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table2.AddCell(cell)

                    cell = New PdfPCell(New Paragraph(TDEJ, pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table2.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("DINER", pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table2.AddCell(cell)

                    cell = New PdfPCell(New Paragraph(DINE, pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table2.AddCell(cell)

                    cell = New PdfPCell(New Paragraph(TDINE, pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table2.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table2.AddCell(cell)

                    cell = New PdfPCell(New Paragraph(Format(DINE + PDJ + DEJ, "#,##0"), pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table2.AddCell(cell)

                    cell = New PdfPCell(New Paragraph(Format(TDINE + TPDJ + TDEJ, "#,##0"), pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table2.AddCell(cell)

                    tableRight.AddCell(table2)

                    '-----------------------------------------------------------------

                    'RECAPITULATIF SOLIDE / LIQUIDE
                    Dim table002 As PdfPTable = New PdfPTable(3)
                    table002.WidthPercentage = 10

                    cell = New PdfPCell(New Paragraph("" & Chr(13), pColumn))
                    cell.Border = 0
                    cell.HorizontalAlignment = Element.ALIGN_LEFT
                    cell.Colspan = 5
                    cell.HorizontalAlignment = 1
                    table002.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("RECAPITULATIF SOLIDE / LIQUIDE" & Chr(13), pColumn))
                    cell.Border = 0
                    cell.HorizontalAlignment = Element.ALIGN_LEFT
                    cell.Colspan = 5
                    cell.HorizontalAlignment = 1
                    table002.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("ALIMENT", pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table002.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("TOTAL JOUR", pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table002.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("TOTAL CUMUL", pColumn))
                    'cell.Colspan = 2
                    'cell.Border = 0
                    cell.HorizontalAlignment = 1
                    table002.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("LIQUIDE", pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table002.AddCell(cell)

                    cell = New PdfPCell(New Paragraph(Format(totalLiquideJour, "#,##0"), pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    'cell.HorizontalAlignment = Element.ALIGN_RIGHT
                    table002.AddCell(cell)


                    cell = New PdfPCell(New Paragraph(Format(totalLiquideCumul, "#,##0"), pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    'cell.HorizontalAlignment = Element.ALIGN_RIGHT
                    table002.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("SOLIDE", pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table002.AddCell(cell)

                    cell = New PdfPCell(New Paragraph(Format(totalSolideJour, "#,##0"), pColumn))
                    'cell.Colspan = 2
                    'cell.HorizontalAlignment = Element.ALIGN_RIGHT
                    cell.HorizontalAlignment = 1
                    table002.AddCell(cell)

                    cell = New PdfPCell(New Paragraph(Format(totalSolideCumul, "#,##0"), pColumn))
                    'cell.Colspan = 2
                    'cell.HorizontalAlignment = Element.ALIGN_RIGHT
                    cell.HorizontalAlignment = 1
                    table002.AddCell(cell)


                    'CALCUL DES TAUX (CUMUL ET JOUR DES SOLIDES ET LIQUIDES)

                    Dim totalSolideLiquideJour = totalLiquideJour + totalSolideJour
                    Dim totalSolideLiquideCumul = totalSolideCumul + totalLiquideCumul

                    Dim tauxLiquideJour As Double = 0
                    Dim tauxSolideJour As Double = 0

                    Dim tauxLiquideCumul As Double = 0
                    Dim tauxSolideCumul As Double = 0

                    If totalSolideLiquideJour > 0 Then
                        tauxLiquideJour = (totalLiquideJour / totalSolideLiquideJour) * 100
                        tauxSolideJour = 100 - tauxLiquideJour
                    End If

                    If totalSolideLiquideCumul > 0 Then
                        tauxLiquideCumul = (totalLiquideCumul / totalSolideLiquideCumul) * 100
                        tauxSolideCumul = 100 - tauxLiquideCumul
                    End If

                    cell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table002.AddCell(cell)

                    cell = New PdfPCell(New Paragraph(Format(totalSolideLiquideJour, "#,##0"), pColumn))
                    'cell.Colspan = 2
                    'cell.HorizontalAlignment = Element.ALIGN_RIGHT
                    cell.HorizontalAlignment = 1
                    table002.AddCell(cell)

                    cell = New PdfPCell(New Paragraph(Format(totalSolideLiquideCumul, "#,##0"), pColumn))
                    'cell.Colspan = 2
                    'cell.HorizontalAlignment = Element.ALIGN_RIGHT
                    cell.HorizontalAlignment = 1
                    table002.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("TAUX LIQUIDE", pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table002.AddCell(cell)

                    cell = New PdfPCell(New Paragraph(Format(tauxLiquideJour, "#,##0.00") & " %", pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table002.AddCell(cell)

                    cell = New PdfPCell(New Paragraph(Format(tauxLiquideCumul, "#,##0.00") & " %", pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table002.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("TAUX SOLIDE", pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table002.AddCell(cell)

                    cell = New PdfPCell(New Paragraph(Format(tauxSolideJour, "#,##0.00") & " %", pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table002.AddCell(cell)

                    cell = New PdfPCell(New Paragraph(Format(tauxSolideCumul, "#,##0.00") & " %", pColumn))
                    'cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table002.AddCell(cell)

                    tableRight.AddCell(table002)

                    '-----------------------------------------------------------------

                    Dim table0 As PdfPTable = New PdfPTable(4)
                    table0.WidthPercentage = 100

                    cell = New PdfPCell(New Paragraph("-", pColumn))
                    cell.Border = 0
                    cell.Colspan = 4
                    cell.HorizontalAlignment = 1
                    table0.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("AMPLIATIONS", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_MIDDLE
                    cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table0.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("VISAS", pColumn))
                    cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table0.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("GERANCE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_MIDDLE
                    cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table0.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("", pColumn))
                    cell.Colspan = 2
                    cell.MinimumHeight = 25
                    cell.HorizontalAlignment = 1
                    table0.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("D.G", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_MIDDLE
                    cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table0.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("", pColumn))
                    cell.Colspan = 2
                    cell.MinimumHeight = 25
                    cell.HorizontalAlignment = 1
                    table0.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("COMPTABLITE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_MIDDLE
                    cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table0.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("", pColumn))
                    cell.Colspan = 2
                    cell.MinimumHeight = 25
                    cell.HorizontalAlignment = 1
                    table0.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("CONTROLE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_MIDDLE
                    cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    table0.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("", pColumn))
                    cell.Colspan = 2
                    cell.HorizontalAlignment = 1
                    cell.MinimumHeight = 25
                    table0.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("REDACTEUR : " & GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR"), pRow))
                    cell.Colspan = 4
                    cell.Border = 0
                    cell.HorizontalAlignment = Element.ALIGN_LEFT
                    cell.HorizontalAlignment = 1
                    table0.AddCell(cell)

                    cell = New PdfPCell(New Paragraph(Chr(13) & "SIGNATURE : ", pColumn))
                    cell.Colspan = 4
                    cell.Border = 0
                    cell.MinimumHeight = 25
                    cell.HorizontalAlignment = Element.ALIGN_LEFT
                    cell.HorizontalAlignment = 1
                    table0.AddCell(cell)

                    cell = New PdfPCell(New Paragraph("", pColumn))
                    cell.Colspan = 3
                    cell.Border = 0
                    cell.MinimumHeight = 25
                    cell.HorizontalAlignment = Element.ALIGN_LEFT
                    cell.HorizontalAlignment = 1
                    table0.AddCell(cell)

                    tableRight.AddCell(table0)

                    'mtable.AddCell(tableRight)
                    '------------------------------------------------------------------------------------------------------
                    mtable.AddCell(pdfTable)

                    mtable.AddCell(tableRight)

                    pdfDoc.Add(mtable)

                    pdfDoc.Close()

                    MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                    Process.Start(sfd.FileName)

                End If

            Else

            MessageBox.Show("Aucune élément à imprimer !!", "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            '-----------------------------------------------------------------------------------------------------------------------------------------
        End If
        '-----------------------------------------------------------------------------------------------------------------------------------------------


    End Sub


    Class HeaderFooter

        Inherits PdfPageEventHelper

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim CODE_AGENCE As String = GlobalVariable.codeAgence

        Dim UTILISE As Integer = 1

        Public Overrides Sub OnEndPage(writer As PdfWriter, document As Document)

            Dim papierEnTete As DataTable = Functions.getElementByCode(CODE_AGENCE, "papier_entete", "CODE_AGENCE")

            Dim HeaderFont As New Font(Font.FontFamily.COURIER, 22, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(Font.FontFamily.TIMES_ROMAN, 11, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font2 As New Font(Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim font4 As New Font(Font.FontFamily.COURIER, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font3 As New Font(Font.FontFamily.TIMES_ROMAN, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pdfCell As PdfPCell = Nothing

            If papierEnTete.Rows.Count > 0 Then

                Dim img() As Byte
                img = societe.Rows(0)("LOGO")

                Dim img2() As Byte
                img2 = papierEnTete.Rows(0)("IMAGE_2")

                Dim img1() As Byte
                img1 = papierEnTete.Rows(0)("IMAGE_1")

                Dim mStream As New MemoryStream(img)
                Dim mStream2 As New MemoryStream(img2)
                Dim mStream1 As New MemoryStream(img1)

                Dim logo As Image
                logo = Image.GetInstance(img)
                logo.ScalePercent(60.0F)

                Dim IMAGE_2 As Image
                IMAGE_2 = Image.GetInstance(img2)
                IMAGE_2.ScalePercent(18.0F)

                Dim IMAGE_1 As Image
                IMAGE_1 = Image.GetInstance(img1)
                IMAGE_1.ScalePercent(18.0F)

                '------------------------------------------------------------------ START HEADER ----------------------------------------------------------------------------------
                Dim EN_TETE_L1 = papierEnTete.Rows(0)("EN_TETE_L1")
                Dim EN_TETE_L2 = papierEnTete.Rows(0)("EN_TETE_L2")
                Dim EN_TETE_L3 = papierEnTete.Rows(0)("EN_TETE_L3")
                Dim EN_TETE_L4 = papierEnTete.Rows(0)("EN_TETE_L4")
                Dim PIEDS_L1 = papierEnTete.Rows(0)("PIEDS_L1")
                Dim PIEDS_L2 = papierEnTete.Rows(0)("PIEDS_L2")
                Dim PIEDS_L3 = papierEnTete.Rows(0)("PIEDS_L3")

                If papierEnTete.Rows(0)("UTILISE") = 1 Then 'LOGO SUR LE COIN GAUCHE

                    Dim pdfTable As New PdfPTable(3) 'Number of columns

                    pdfTable.TotalWidth = document.PageSize.Width
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                    'pdfTable.HeaderRows = 1

                    Dim widths As Single() = New Single() {2.4F, 10.0F, 2.4F}
                    pdfTable.SetWidths(widths)

                    pdfCell = New PdfPCell(logo)
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.Border = 0
                    pdfCell.PaddingLeft = 15.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    Dim mtable As PdfPTable = New PdfPTable(1)
                    mtable.WidthPercentage = 100
                    mtable.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

                    pdfCell = New PdfPCell(New Paragraph(societe.Rows(0)("RAISON_SOCIALE"), HeaderFont))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0 'used to remove borders on the cells

                    mtable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(EN_TETE_L1 & Chr(13), font1))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0 'used to remove borders on the cells

                    mtable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(EN_TETE_L2, font3))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0 'used to remove borders on the cells

                    mtable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(EN_TETE_L3, font3))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0 'used to remove borders on the cells

                    mtable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(EN_TETE_L4, font3))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0 'used to remove borders on the cells

                    mtable.DefaultCell.BorderWidth = 0
                    pdfTable.DefaultCell.BorderWidth = 0

                    mtable.AddCell(pdfCell)

                    pdfTable.AddCell(mtable)

                    pdfCell = New PdfPCell(IMAGE_2)
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.Border = 0
                    pdfCell.PaddingRight = 15.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    If document.PageNumber = 1 Then
                        pdfTable.AddCell(pdfCell)
                        pdfTable.WriteSelectedRows(0, -1, 0, document.GetTop(document.TopMargin) + 155, writer.DirectContent)
                    Else
                        pdfTable.AddCell(pdfCell)
                    End If
                    '----------------------------------------------------------------------------------------------------------------------------------------------------------------

                    If GlobalVariable.DocumentToGenerate = "situation caisse" Then
                        pdfCell = New PdfPCell(New Paragraph("               SIGNATURE DU CAISSIER                                               SIGNATURE DU COMPTABLE"))
                    ElseIf GlobalVariable.DocumentToGenerate = "DST" Then
                        pdfCell = New PdfPCell(New Paragraph(""))
                    ElseIf GlobalVariable.DocumentToGenerate = "reglement" Or GlobalVariable.DocumentToGenerate = "facture" Then
                        pdfCell = New PdfPCell(New Paragraph("               SIGNATURE DU CLIENT                                                    SIGNATURE DE L'HOTEL"))
                    End If

                    'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    'pdfCell.PaddingLeft = 15.0F
                    'pdfCell.Border = 0

                    'pFooterSign.AddCell(pdfCell)
                    'pFooterSign.WriteSelectedRows(0, -1, 0, document.GetBottom(document.BottomMargin) + 45, writer.DirectContent)

                    Dim pFooter As New PdfPTable(1)
                    pFooter.TotalWidth = document.PageSize.Width
                    pdfCell.PaddingLeft = 15.0F
                    pFooter.DefaultCell.Border = 0

                    pdfCell = New PdfPCell(New Paragraph(PIEDS_L1, font4))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 15.0F
                    pdfCell.Border = 0
                    pFooter.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(PIEDS_L2 & Chr(13) & PIEDS_L3 & Chr(13) & " TECHFLECTION LYTE " & GlobalVariable.DateDeTravail & "-" & Now().ToLongTimeString, font2))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 15.0F
                    pdfCell.Border = 0
                    pFooter.AddCell(pdfCell)

                    pFooter.WriteSelectedRows(0, -1, 0, 55, writer.DirectContent)

                    Dim pFooterLeft As New PdfPTable(1)
                    pFooterLeft.TotalWidth = document.PageSize.Width
                    pdfCell.PaddingLeft = 15.0F
                    pFooterLeft.DefaultCell.Border = 0

                    pdfCell = New PdfPCell(IMAGE_1)

                    If Not pdfCell Is Nothing Then

                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.PaddingLeft = 15.0F
                        pdfCell.Border = 0
                        pFooterLeft.AddCell(pdfCell)

                    End If

                ElseIf papierEnTete.Rows(0)("UTILISE") = 0 Then 'LOGO AU MILIEU

                    Dim mtable As PdfPTable = New PdfPTable(1)
                    mtable.WidthPercentage = 100
                    mtable.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

                    '--------------------------------------------------------------

                    Dim pdfTable As New PdfPTable(2) 'Number of columns

                    pdfTable.TotalWidth = document.PageSize.Width
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT

                    Dim widths As Single() = New Single() {30.0F, 70.0F}
                    pdfTable.SetWidths(widths)

                    pdfCell = New PdfPCell(logo)
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 15
                    pdfCell.Border = 0
                    pdfCell.PaddingLeft = 15.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(societe.Rows(0)("RAISON_SOCIALE"), HeaderFont))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0 'used to remove borders on the cells
                    mtable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Chr(13) & EN_TETE_L1 & Chr(13) & EN_TETE_L2 & Chr(13) & EN_TETE_L3 & Chr(13) & EN_TETE_L4, font1))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.MinimumHeight = 15
                    pdfCell.Border = 0 'used to remove borders on the cells
                    mtable.AddCell(pdfCell)

                    mtable.DefaultCell.BorderWidth = 0
                    pdfTable.DefaultCell.BorderWidth = 0

                    If document.PageNumber = 1 Then
                        pdfTable.AddCell(mtable)
                        pdfTable.WriteSelectedRows(0, -1, 0, document.GetTop(document.TopMargin) + 155, writer.DirectContent)
                    End If
                    '----------------------------------------------------------------------------------------------------------------------------------------------------------------

                    Dim pFooter As New PdfPTable(1)
                    pFooter.TotalWidth = document.PageSize.Width
                    pdfCell.PaddingLeft = 15.0F
                    pdfCell.MinimumHeight = 15
                    pFooter.DefaultCell.Border = 0

                    pdfCell = New PdfPCell(New Paragraph(PIEDS_L1, font4))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 15.0F
                    pdfCell.MinimumHeight = 15
                    pdfCell.Border = 0
                    pFooter.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(PIEDS_L2 & Chr(13) & PIEDS_L3 & Chr(13) & " TECHFLECTION LYTE " & GlobalVariable.DateDeTravail & "-" & Now().ToLongTimeString, font2))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.PaddingLeft = 15.0F
                    pdfCell.MinimumHeight = 15
                    pdfCell.Border = 0
                    pFooter.AddCell(pdfCell)

                    pFooter.WriteSelectedRows(0, -1, 0, 55, writer.DirectContent)

                End If

            End If

        End Sub

    End Class

    Public Shared Sub lettreDeRelance(ByVal ENTREPRISE As String, ByVal NUMERO_FACTURE As String, ByVal LIBELLE_FACTURE As String, ByVal DATE_FACTURE As Date, ByVal SOLDE As Double)

        If True Then

            Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}
            sfd.FileName = "Lettre de Relance de " & ENTREPRISE & Now().ToString("ddMMyyHms")

            Dim societe As DataTable = Functions.allTableFields("societe")

            Dim CODE_MONNAIE As String = ""

            If societe.Rows.Count > 0 Then
                CODE_MONNAIE = societe.Rows(0)("CODE_MONNAIE")
            End If

            If sfd.ShowDialog = 1 Then
                'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
                Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
                Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
                Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim font1 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
                Dim font2 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)

                pdfWrite.PageEvent = New HeaderFooter

                pdfDoc.Open()

                Dim p1 As Paragraph = New Paragraph(Chr(13) & Chr(13) & "Date: " & GlobalVariable.DateDeTravail)
                p1.Alignment = Element.ALIGN_RIGHT
                pdfDoc.Add(p1)

                Dim p0 As Paragraph = New Paragraph(Chr(13) & ENTREPRISE & Chr(13))
                p0.Alignment = Element.ALIGN_RIGHT
                pdfDoc.Add(p0)

                Dim p4 As Paragraph = New Paragraph(Chr(13) & "LETTRE DE RELANCE " & Chr(13), font2)
                p4.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p4)

                Dim p5 As Paragraph = New Paragraph(Chr(13) & "Numéro facture : " & NUMERO_FACTURE & Chr(13) & "Libellé facture : " & LIBELLE_FACTURE & Chr(13) & "Date : " & DATE_FACTURE & Chr(13) & Chr(13), font2)
                p5.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p5)

                Dim info1Header As String = "OBJET : RETARD DE PAIEMENT" & Chr(13) & Chr(13)
                Dim p2 As Paragraph = New Paragraph(info1Header, font2)
                p2.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p2)

                Dim info1 As String = "Madame, Monsieur, " & Chr(13) & Chr(13)
                pdfDoc.Add(New Paragraph(info1, font1))

                Dim info2 As String = "         Sauf erreur ou omission de notre part, nous constatons que votre compte client présente à ce jour un solde débiteur de " & Format(SOLDE, "#,##0") & "  " & CODE_MONNAIE & ". Ce montant correspond à nos factures restées impayées, ci-joint en annexe. L’échéance étant dépassée, nous vous demandons de bien vouloir régulariser cette situation par retour de courrier. Nous vous invitons à nous faire parvenir les paiements en instance au plus le tard le " & GlobalVariable.DateDeTravail.AddDays(7) & ". " & Chr(13) & Chr(13) & "         Dans le cas où votre règlement aurait été adressé entre temps, nous vous prions de ne pas tenir compte de la présente. Vous remerciant par avance, nous vous prions d'agréer, Madame, Monsieur, l’expression de nos salutations distinguées." & Chr(13) & Chr(13)

                Dim info2Para As New Paragraph(info2, font1)
                info2Para.Alignment = Element.ALIGN_JUSTIFIED
                pdfDoc.Add(info2Para)

                pdfDoc.Close()

                MessageBox.Show("PDF has been exported" & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                Process.Start(sfd.FileName)

            End If

        End If

    End Sub


    Public Shared Sub ficheDeStock(ByVal dt As DataTable, ByVal DateDebut As Date, ByVal DateFin As Date)

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0

        Dim tireDocument As String = ""

        Dim sousTitreDocument As String = ""

        If GlobalVariable.typeRapportEconmat = "FS" Then

            sousTitreDocument = "SUIVIE DE STOCKS"

        ElseIf GlobalVariable.typeRapportEconmat = "" Then

        End If

        tireDocument = sousTitreDocument & " " & GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR") & " le " & Date.Now().ToString("ddMMyyHHmmss") & " "

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 40, 20, 40)
            'Dim pdfDoc As New Document(PageSize.A4, 40, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & "***", pColumn)
            p1.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p1)

            Dim p3 As Paragraph = New Paragraph(sousTitreDocument & " " & GlobalVariable.DateDeTravail & Chr(13), pColumn)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            Dim k As Integer = 0

            If dt.Rows.Count > 0 Then

                For i = 0 To dt.Rows.Count - 1

                    Dim nature As String = ""

                    If dt.Rows(i)("TYPE") = "article" Then
                        nature = "ARTICLE"
                    Else
                        nature = "MATIERE"
                    End If

                    Dim p0 As Paragraph

                    'ENSEMBLE D'ARTICLE
                    p0 = New Paragraph(Chr(13) & nature & " : " & dt.Rows(i)("DESIGNATION_FR") & Chr(13) & "STOCK ACTUEL: " & dt.Rows(i)("QUANTITE") & Chr(13) & Chr(13), pRow)
                    p0.Alignment = Element.ALIGN_LEFT

                    pdfDoc.Add(p0)

                    'pdfWrite.PageEvent = New HeaderFooter

                    Dim pdfTable As New PdfPTable(9) 'Number of columns
                    pdfTable.TotalWidth = 760.0F
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.HeaderRows = 1

                    Dim widths As Single() = New Single() {20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F}

                    pdfTable.SetWidths(widths)

                    Dim pdfCell As PdfPCell = Nothing

                    pdfCell = New PdfPCell(New Paragraph("DATE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("STOCK FIN DU MOIS", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("QUANTITE ENTREE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("QUANTITE SORTIE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("ANCIEN STOCK", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("NOUVEAU STOCK", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY

                    pdfTable.AddCell(pdfCell)
                    pdfCell = New PdfPCell(New Paragraph("QUANTITE SEUIL", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("PRIX ACHAT", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("CUMP", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)


                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    'pdfTable.AddCell(pdfCell)

                    '-------------------------------- GESTION DES REGLEMENTS DE LA FACTURE ---------------

                    Dim ligneMovementArticle As New DataTable()

                    'Dim selectArticleEnMovement2 As String = "SELECT DESIGNATION_FR,`DATE_MOUVEMENT`,`STOCK_FIN_DU_MOIS`, `TYPE`, `QUANTITE_ENTREE`, `QUANTITE_SORTIE`, article.QUANTITE, `SEUIL_REAPPROVISIONNEMENT`, PRIX_ACHAT_HT 
                    'FROM mouvement_stock, article WHERE article.CODE_ARTICLE=mouvement_stock.CODE_ARTICLE 
                    'AND article.CODE_ARTICLE=@CODE_ARTICLE
                    'AND DATE_MOUVEMENT <= '" & DateFin.ToString("yyyy-MM-dd") & "' 
                    'AND DATE_MOUVEMENT >='" & DateDebut.ToString("yyyy-MM-dd") & "' ORDER BY DATE_MOUVEMENT DESC"

                    Dim selectArticleEnMovement As String = "SELECT `DATE_MOUVEMENT`,`LIBELLE_MOUVEMENT` , `QUANTITE_ENTREE`, `QUANTITE_SORTIE`, QUANTITE_AVANT_MOVEMENT , CMUP FROM mouvement_stock WHERE CODE_ARTICLE = @CODE_ARTICLE AND DATE_MOUVEMENT <= '" & DateFin.ToString("yyyy-MM-dd") & "' AND DATE_MOUVEMENT >='" & DateDebut.ToString("yyyy-MM-dd") & "' ORDER BY ID_MOUVEMENT_STOCK ASC"

                    Dim command As New MySqlCommand(selectArticleEnMovement, GlobalVariable.connect)
                    command.Parameters.Add("@CODE_ARTICLE", MySqlDbType.VarChar).Value = dt.Rows(i)("CODE_ARTICLE")
                    'command.Parameters.Add("@CODE_AGENCE", MySqlDbType.VarChar).Value = GlobalVariable.AgenceActuelle

                    Dim adapter As New MySqlDataAdapter(command)

                    adapter.Fill(ligneMovementArticle)

                    If ligneMovementArticle.Rows.Count > 0 Then

                        For j = 0 To ligneMovementArticle.Rows.Count - 1

                            pdfCell = New PdfPCell(New Paragraph(ligneMovementArticle.Rows(j)("DATE_MOUVEMENT"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i)("STOCK_FIN_DU_MOIS"), "#,##0.00"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(ligneMovementArticle.Rows(j)("QUANTITE_ENTREE"), "#,##0.00"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(ligneMovementArticle.Rows(j)("QUANTITE_SORTIE"), "#,##0.00"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(ligneMovementArticle.Rows(j)("QUANTITE_AVANT_MOVEMENT"), "#,##0.00"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            Dim NOUVEAU_STOCK As Double = Double.Parse(ligneMovementArticle.Rows(j)("QUANTITE_ENTREE")) - Double.Parse(ligneMovementArticle.Rows(j)("QUANTITE_SORTIE")) + Double.Parse(ligneMovementArticle.Rows(j)("QUANTITE_AVANT_MOVEMENT"))

                            pdfCell = New PdfPCell(New Paragraph(Format(NOUVEAU_STOCK, "#,##0.00"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i)("SEUIL_REAPPROVISIONNEMENT"), "#,##0"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            'PRIX ACHAT
                            'pdfCell = New PdfPCell(New Paragraph(Format(ligneMovementArticle.Rows(j)("CMUP"), "#,##0"), font1))
                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i)("COUT_U_MOYEN_PONDERE"), "#,##0"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.AddCell(pdfCell)

                            'COUT MOYEN UNITAIRE PONDERE
                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i)("PRIX_ACHAT_HT"), "#,##0"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.AddCell(pdfCell)

                        Next

                        pdfDoc.Add(pdfTable)

                    End If

                Next

            End If


            '------------------------------------------------------------------------

            'Dim p01 As Paragraph = New Paragraph(Chr(13) & "OBSERVATIONS: " & OBSERVATIONS, font1)
            'p01.Alignment = Element.ALIGN_JUSTIFIED

            'pdfDoc.Add(p01)

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        Else

            MessageBox.Show("Aucune Ligne à imprimer!")

        End If

        ' ------------------------------------------------------------------------------------------------       End If

    End Sub


    Public Shared Sub devisEstimatifDeSalleDeFete(ByVal NumConfirmation As String, ByVal client As String, ByVal DateDebut As Date, ByVal DateFin As Date, ByVal NbreNuitee As Integer, ByVal hebergement As String, ByVal Codehebergement As String, ByVal tarif As Double, ByVal HeureEntree As DateTime, ByVal heureDepart As DateTime, ByVal TypeRea As String)

        If Not NumConfirmation = "num" Then

            'Dim dlg As New PrintDialog
            'dlg.ShowDialog()

            Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}
            sfd.FileName = "Devis estimatif de location de Salle " & client & (Date.Now().ToString("ddMMyyHHmmss"))

            Dim societe As DataTable = Functions.allTableFields("societe")
            Dim clientInformation As DataTable = Functions.getElementByCode(client, "client", "NOM_PRENOM")
            Dim Reservation As DataTable

            Reservation = Functions.getElementByCode(NumConfirmation, "reservation", "CODE_RESERVATION")

            If Not Reservation.Rows.Count > 0 Then
                Reservation = Functions.getElementByCode(NumConfirmation, "reserve_conf", "CODE_RESERVATION")
            End If

            Dim salle As DataTable = Functions.getElementByCode(Codehebergement, "chambre", "CODE_CHAMBRE")

            Dim HEURE_ENTREE As String = ""
            Dim HEURE_DEPART As String = ""

            If Reservation.Rows.Count > 0 Then
                HEURE_ENTREE = CDate(Reservation.Rows(0)("HEURE_ENTREE")).ToLongTimeString
                HEURE_DEPART = CDate(Reservation.Rows(0)("HEURE_SORTIE")).ToLongTimeString
            End If

            Dim forfaitSalle As DataTable = Functions.getElementByCode(NumConfirmation, "forfait_salle", "CODE_RESERVATION")

            Dim EVENEMENT As String = ""
            Dim CODE_EVENEMENT As String = ""

            Dim VIDEO_PROJ As String = "NON"
            Dim SONO As String = "NON"
            Dim COUVERTS As String = "NON"
            Dim TABLE_CHAISE As String = "NON"
            Dim DECORATION As String = "NON"
            Dim LOCATION_MATERIEL As String = "NON"
            Dim MISE_EN_PLACE As Integer = 0 ' U
            Dim DISPOSITION As String = "U"

            If forfaitSalle.Rows.Count > 0 Then

                CODE_EVENEMENT = forfaitSalle.Rows(0)("CODE_EVENEMENT")

                Dim infoSupEvent As DataTable = Functions.getElementByCode(CODE_EVENEMENT, "evenement", "CODE_EVENEMENT")

                If infoSupEvent.Rows.Count > 0 Then

                    EVENEMENT = infoSupEvent.Rows(0)("LIBELLE")

                End If

                If forfaitSalle.Rows(0)("VIDEO_PROJ") = 1 Then
                    VIDEO_PROJ = "OUI"
                End If

                If forfaitSalle.Rows(0)("SONO") = 1 Then
                    SONO = "OUI"
                End If

                If forfaitSalle.Rows(0)("COUVERTS") = 1 Then
                    COUVERTS = "OUI"
                End If

                If forfaitSalle.Rows(0)("TABLE_CHAISE") = 1 Then
                    TABLE_CHAISE = "OUI"
                End If

                If forfaitSalle.Rows(0)("DECORATION") > 0 Then
                    DECORATION = "OUI"
                End If

                If forfaitSalle.Rows(0)("LOCATION_MATERIEL") > 0 Then
                    LOCATION_MATERIEL = "OUI"
                End If

                If MISE_EN_PLACE = 1 Then
                    DISPOSITION = "U"
                ElseIf MISE_EN_PLACE = 2 Then
                    DISPOSITION = "Ecole"
                ElseIf MISE_EN_PLACE = 3 Then
                    DISPOSITION = "Theatre"
                ElseIf MISE_EN_PLACE = 4 Then
                    DISPOSITION = "Rectangle"
                ElseIf MISE_EN_PLACE = 5 Then
                    DISPOSITION = "Cocktail"
                ElseIf MISE_EN_PLACE = 6 Then
                    DISPOSITION = "Banquet"
                End If

            End If

            Dim LIBELLE_CHAMBRE As String = ""
            Dim DEPOT_DE_GARANTIE As Double = 0

            If salle.Rows.Count > 0 Then
                LIBELLE_CHAMBRE = salle.Rows(0)("LIBELLE_CHAMBRE")
            End If

            If sfd.ShowDialog = 1 Then
                'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
                Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
                Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
                Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim font1 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
                Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim font2 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim font3 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
                Dim HeaderFont As New Font(Font.FontFamily.COURIER, 18, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim fontInfoSup As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

                Dim Libelle As String
                Dim LibelleJour As String
                Dim LibelleReservation As String
                Dim TitreDuDocument As String

                If GlobalVariable.typeChambreOuSalle = "salle" Then

                    Libelle = "Location de Salle"
                    LibelleJour = "Jour"
                    LibelleReservation = "DEVIS ESTIMATIF DE LOCATION DE SALLE"
                    TitreDuDocument = "DEVIS ESTIMATIF DE LOCATION DE SALLE"

                End If

                pdfWrite.PageEvent = New HeaderFooter()

                pdfDoc.Open()

                '------------------------------------------------------------------------
                Dim pdfCell As PdfPCell = Nothing

                Dim p0 As Paragraph = New Paragraph(Chr(13) & Chr(13) & societe.Rows(0)("VILLE") & ", " & GlobalVariable.DateDeTravail, font1)
                p0.Alignment = Element.ALIGN_RIGHT
                pdfDoc.Add(p0)

                Dim p1 As Paragraph = New Paragraph(TitreDuDocument & Chr(13) & Chr(13), font2)
                p1.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p1)

                Dim intro As String = "Nom du client : " & client & Chr(13) & Chr(13)

                pdfDoc.Add(New Paragraph(intro, pColumn))

                Dim p03 As String = "Désignation des locaux à louer : "
                pdfDoc.Add(New Paragraph(p03, pColumn))

                Dim p3 As String = LIBELLE_CHAMBRE & " dont la disposition sera en " & DISPOSITION & " et située à / au " & societe.Rows(0)("RUE") & " - " & societe.Rows(0)("VILLE") & Chr(13) & Chr(13)
                '& " ainsi que ses dépendances qui sont désignées ci-dessous " & Chr(13) & "• Chambre," & Chr(13) & "• Parking, " & Chr(13) & "• Cave, " & Chr(13) & "• Cambuse, " & Chr(13) & "•	 Cuisine, " & Chr(13) & "• Vestiaires, " & Chr(13) & "• Jardin." & Chr(13) & Chr(13)
                pdfDoc.Add(New Paragraph(p3, font1))

                Dim p8 As String = "Durée : "
                pdfDoc.Add(New Paragraph(p8, font2))

                Dim p9 As String = "Du " & DateDebut & " à " & HEURE_ENTREE & " jusqu’au " & DateFin & " à " & HEURE_DEPART & Chr(13) & Chr(13)
                pdfDoc.Add(New Paragraph(p9, font1))

                Dim p4 As String = "Equipements mis à disposition du preneur" & Chr(13) & Chr(13)
                pdfDoc.Add(New Paragraph(p4, font2))

                '----------------------------------------

                Dim pdfTable As New PdfPTable(6) 'Number of columns
                pdfTable.TotalWidth = 530.0F
                pdfTable.LockedWidth = True
                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable.HeaderRows = 1

                Dim widths As Single() = New Single() {30.0F, 10.0F, 30.0F, 10.0F, 30.0F, 10.0F}

                pdfTable.SetWidths(widths)

                pdfCell = New PdfPCell(New Paragraph("EQUIPEMENT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("EQUIPEMENT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("EQUIPEMENT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DECORATION", font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(DECORATION, font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("LOCATION MATERIEL", font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(LOCATION_MATERIEL, font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph("VIDEO PROJECTEUR", font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(VIDEO_PROJ, font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable.AddCell(pdfCell)

                '-----------------------

                pdfCell = New PdfPCell(New Paragraph("SONORISATION", font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(SONO, font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("COUVERTS", font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(COUVERTS, font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TABLES + CHAISES", font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(TABLE_CHAISE, font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

                '----------------------------------------

                Dim p12 As String = "Dévis" & Chr(13) & Chr(13)
                pdfDoc.Add(New Paragraph(p12, font2))

                'PERIODE DU SEJOURS : COUT TOTAL DE LA RESA
                Dim periodeDeLaResa As Integer = DateDiff(DateInterval.Day, Reservation.Rows(0)("DATE_ENTTRE"), Reservation.Rows(0)("DATE_SORTIE"))

                DEPOT_DE_GARANTIE = Reservation.Rows(0)("DEPOT_DE_GARANTIE")
                Dim CODE_RESERVATION = Reservation.Rows(0)("CODE_RESERVATION")
                Dim CAUTION As Double = Reservation.Rows(0)("MONTANT_TOTAL_CAUTION")

                Dim encaissement As Double = 0
                Dim solde As Double = 0

                Dim reglement As DataTable = Functions.getElementByCode(CODE_RESERVATION, "reglement", "CODE_RESERVATION")

                For i = 0 To reglement.Rows.Count - 1
                    encaissement += reglement.Rows(i)("MONTANT_VERSE")
                Next

                If periodeDeLaResa = 0 Then
                    periodeDeLaResa = 1
                End If

                Dim MONTANT_ACCORDE As Double = Reservation.Rows(0)("MONTANT_ACCORDE")

                solde = MONTANT_ACCORDE * periodeDeLaResa

                solde -= encaissement + DEPOT_DE_GARANTIE

                'Dim p013 As String = "Le preneur à : " & Chr(13) & "• Payer les arrhes, soit " & Format(CAUTION, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE") & " et le dépôt de garantie, soit " & Format(DEPOT_DE_GARANTIE, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE") & " lors de la signature du présent contrat; " & Chr(13)
                '& "• Payer le solde du, soit " & Format(solde, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE") & " au plus tard le " & DateDebut & " ;" & Chr(13) & Chr(13)
                ' pdfDoc.Add(New Paragraph(p013, font1))

                ' Dim p13 As String = "• Le preneur s’engage à Payer : " & Chr(13) & Chr(13)
                ' pdfDoc.Add(New Paragraph(p13, font1))

                '---------------------------------------------------------------------------------------------------------------------------

                Dim pdfTable01 As New PdfPTable(5) 'Number of columns
                pdfTable01.TotalWidth = 530.0F
                pdfTable01.LockedWidth = True
                pdfTable01.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.HeaderRows = 1

                Dim widths01 As Single() = New Single() {10.0F, 70.0F, 15.0F, 20.0F, 20.0F}

                pdfTable01.SetWidths(widths01)

                Dim montantTotal As Double = 0

                pdfCell = New PdfPCell(New Paragraph("No", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                '------------------------1----------------------------

                pdfCell = New PdfPCell(New Paragraph("1-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("LOCATION SALLE", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa, "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(MONTANT_ACCORDE, "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * MONTANT_ACCORDE, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += periodeDeLaResa * MONTANT_ACCORDE

                '----------------------------------------------------

                '------------------------2----------------------------

                pdfCell = New PdfPCell(New Paragraph("2-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DECORATION", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(1, "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("DECORATION"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("DECORATION"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += forfaitSalle.Rows(0)("DECORATION")

                '----------------------------------------------------

                '------------------------3----------------------------

                pdfCell = New PdfPCell(New Paragraph("3-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("LOCATION MATERIEL", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(1, "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("LOCATION_MATERIEL"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("LOCATION_MATERIEL"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += forfaitSalle.Rows(0)("LOCATION_MATERIEL")

                '----------------------------------------------------

                '------------------------4----------------------------

                pdfCell = New PdfPCell(New Paragraph("4-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DIVERS", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(1, "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("AUTRES"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("AUTRES"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += forfaitSalle.Rows(0)("AUTRES")

                '----------------------------------------------------

                '------------------------5----------------------------

                pdfCell = New PdfPCell(New Paragraph("5-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAUSE CAFE", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("NBRE__CAFE"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("PU_CAFE"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("PU_CAFE") * forfaitSalle.Rows(0)("NBRE__CAFE"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += periodeDeLaResa * forfaitSalle.Rows(0)("NBRE__CAFE") * forfaitSalle.Rows(0)("PU_CAFE")

                '----------------------------------------------------

                '------------------------6----------------------------

                pdfCell = New PdfPCell(New Paragraph("6-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAUSE DEJEUNER", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_DEJEUNER"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("PU_DEJEUNER"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_DEJEUNER") * forfaitSalle.Rows(0)("PU_DEJEUNER"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_DEJEUNER") * forfaitSalle.Rows(0)("PU_DEJEUNER")

                '----------------------------------------------------

                '------------------------7----------------------------

                pdfCell = New PdfPCell(New Paragraph("7-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAUSE DINER", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_DINER"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("PU_DINER"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_DINER") * forfaitSalle.Rows(0)("PU_DINER"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_DINER") * forfaitSalle.Rows(0)("PU_DINER")

                '----------------------------------------------------

                '------------------------8----------------------------

                pdfCell = New PdfPCell(New Paragraph("8-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TRAITEURS", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_TRAITEUR"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("PU_TRAITEUR"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_TRAITEUR") * forfaitSalle.Rows(0)("PU_TRAITEUR"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_TRAITEUR") * forfaitSalle.Rows(0)("PU_TRAITEUR")

                '----------------------------------------------------

                '------------------------9----------------------------

                pdfCell = New PdfPCell(New Paragraph("9-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("GOUTER", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_GOUTER"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("PU_GOUTER"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_GOUTER") * forfaitSalle.Rows(0)("PU_GOUTER"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_GOUTER") * forfaitSalle.Rows(0)("PU_GOUTER")

                '----------------------------------------------------

                '------------------------10----------------------------

                pdfCell = New PdfPCell(New Paragraph("10-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("COCKTAILS", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_COCKTAIL"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("PU_COCKTAIL"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_COCKTAIL") * forfaitSalle.Rows(0)("PU_COCKTAIL"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_COCKTAIL") * forfaitSalle.Rows(0)("PU_COCKTAIL")

                '----------------------------------------------------

                '------------------------11----------------------------

                pdfCell = New PdfPCell(New Paragraph("11-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("EAU PETITE BOUTEILLE", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("EAU_PTE_QTE"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                If forfaitSalle.Rows(0)("EAU_PTE_QTE") > 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(forfaitSalle.Rows(0)("EAU_PTE_MONTANT") / forfaitSalle.Rows(0)("EAU_PTE_QTE")), "#,##0"), font1))
                Else
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(0), "#,##0"), font1))
                End If

                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("EAU_PTE_MONTANT"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += forfaitSalle.Rows(0)("EAU_PTE_MONTANT")

                '----------------------------------------------------

                '------------------------12----------------------------

                pdfCell = New PdfPCell(New Paragraph("12-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("EAU GRANDE BOUTEILLE", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("EAU_GRDE_QTE"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                If forfaitSalle.Rows(0)("EAU_GRDE_QTE") > 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(forfaitSalle.Rows(0)("EAU_GRDE_MONTANT") / forfaitSalle.Rows(0)("EAU_GRDE_QTE")), "#,##0"), font1))
                Else
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(0), "#,##0"), font1))
                End If

                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("EAU_GRDE_MONTANT"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += forfaitSalle.Rows(0)("EAU_GRDE_MONTANT")

                '----------------------------------------------------

                '------------------------13----------------------------

                pdfCell = New PdfPCell(New Paragraph("13-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BOISSONS GAZEUSES", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("BOISSONS_GAZEUSES_QTE"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                If forfaitSalle.Rows(0)("BOISSONS_GAZEUSES_QTE") > 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(forfaitSalle.Rows(0)("BOISSONS_GAZEUSES_MONTANT") / forfaitSalle.Rows(0)("BOISSONS_GAZEUSES_QTE")), "#,##0"), font1))
                Else
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(0), "#,##0"), font1))
                End If

                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("BOISSONS_GAZEUSES_MONTANT"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += forfaitSalle.Rows(0)("BOISSONS_GAZEUSES_MONTANT")

                '----------------------------------------------------

                '------------------------14----------------------------

                pdfCell = New PdfPCell(New Paragraph("14-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BIERES", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("BIERES_QTE"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                If forfaitSalle.Rows(0)("BIERES_QTE") > 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(forfaitSalle.Rows(0)("BIERES_MONTANT") / forfaitSalle.Rows(0)("BIERES_QTE")), "#,##0"), font1))
                Else
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(0), "#,##0"), font1))
                End If

                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("BIERES_MONTANT"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += forfaitSalle.Rows(0)("BIERES_MONTANT")

                '----------------------------------------------------

                '------------------------15----------------------------

                pdfCell = New PdfPCell(New Paragraph("15-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("VIN ROUGE", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("VIN_ROUGE_QTE"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                If forfaitSalle.Rows(0)("VIN_ROUGE_QTE") > 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(forfaitSalle.Rows(0)("VIN_ROUGE_MONTANT") / forfaitSalle.Rows(0)("VIN_ROUGE_QTE")), "#,##0"), font1))
                Else
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(0), "#,##0"), font1))
                End If

                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("VIN_ROUGE_MONTANT"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += forfaitSalle.Rows(0)("VIN_ROUGE_MONTANT")

                '----------------------------------------------------
                '------------------------16----------------------------

                pdfCell = New PdfPCell(New Paragraph("16-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("VIN ROSE", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("VIN_ROSE_QTE"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                If forfaitSalle.Rows(0)("VIN_ROSE_QTE") > 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(forfaitSalle.Rows(0)("BOISSONS_EXT_MONTANT") / forfaitSalle.Rows(0)("VIN_ROSE_QTE")), "#,##0"), font1))
                Else
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(0), "#,##0"), font1))
                End If

                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("BOISSONS_EXT_MONTANT"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += forfaitSalle.Rows(0)("BOISSONS_EXT_MONTANT")

                '----------------------------------------------------
                '------------------------17----------------------------

                pdfCell = New PdfPCell(New Paragraph("17-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BOISSONS EXTERIEURES", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("BOISSONS_EXT_QTE"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                If forfaitSalle.Rows(0)("BOISSONS_EXT_QTE") > 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(forfaitSalle.Rows(0)("VIN_ROSE_MONTANT") / forfaitSalle.Rows(0)("BOISSONS_EXT_QTE")), "#,##0"), font1))
                Else
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(0), "#,##0"), font1))
                End If

                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("VIN_ROSE_MONTANT"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += forfaitSalle.Rows(0)("VIN_ROSE_MONTANT")

                '----------------------------------------------------
                '------------------------18----------------------------

                pdfCell = New PdfPCell(New Paragraph("18-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DROIT DE BOUCHON", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(1, "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("DROIT_DE_BOUCHON"), "#,##0"), font1))

                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("DROIT_DE_BOUCHON"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += forfaitSalle.Rows(0)("DROIT_DE_BOUCHON")

                '----------------------------------------------------

                '------------------------19----------------------------
                Dim forfaitSalle_hebergement As DataTable = Functions.getElementByCode(NumConfirmation, "forfait_salle_hebergement", "CODE_RESERVATION")

                Dim HEBERGEMENT_PRIS_EN_CHARGE As Double = 0
                Dim NBRE_NUITEE As Double = 0
                Dim ENCAISSEMENT_PRIS_EN_CHARGE As Double = 0

                If forfaitSalle_hebergement.Rows.Count > 0 Then

                    HEBERGEMENT_PRIS_EN_CHARGE = forfaitSalle_hebergement.Rows(0)("HEBERGEMENT")
                    NBRE_NUITEE = forfaitSalle_hebergement.Rows(0)("NBRE_NUITEE")
                    ENCAISSEMENT_PRIS_EN_CHARGE = forfaitSalle_hebergement.Rows(0)("ENCAISSEMENT")

                    If HEBERGEMENT_PRIS_EN_CHARGE > 0 Then

                        pdfCell = New PdfPCell(New Paragraph("19-", font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable01.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("HEBERGEMENT", font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        pdfTable01.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(NBRE_NUITEE, "#,##0"), font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable01.AddCell(pdfCell)

                        Dim MONTANT_ACCORDE_PRIS_EN_CHARGE As Double = 0

                        If NBRE_NUITEE > 0 Then
                            MONTANT_ACCORDE_PRIS_EN_CHARGE = HEBERGEMENT_PRIS_EN_CHARGE / NBRE_NUITEE
                        End If

                        pdfCell = New PdfPCell(New Paragraph(Format(MONTANT_ACCORDE_PRIS_EN_CHARGE, "#,##0"), font1))

                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable01.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(HEBERGEMENT_PRIS_EN_CHARGE, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable01.AddCell(pdfCell)

                    End If

                    If ENCAISSEMENT_PRIS_EN_CHARGE > 0 Then

                        pdfCell = New PdfPCell(New Paragraph("20-", font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable01.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("ENCAISSEMENT", font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        pdfTable01.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(1, "#,##0"), font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable01.AddCell(pdfCell)


                        pdfCell = New PdfPCell(New Paragraph(Format(ENCAISSEMENT_PRIS_EN_CHARGE, "#,##0"), font1))

                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable01.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(ENCAISSEMENT_PRIS_EN_CHARGE, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 15
                        'pdfCell.PaddingLeft = 5.0F
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable01.AddCell(pdfCell)

                    End If

                    montantTotal += HEBERGEMENT_PRIS_EN_CHARGE - ENCAISSEMENT_PRIS_EN_CHARGE

                End If
                '----------------------------------------------------


                '----------------------------------------------------
                pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = 4
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(montantTotal, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)
                pdfDoc.Add(pdfTable01)

                Dim p007 As String = Chr(13) & "Arrêter à la somme de : " & Functions.NBLT(montantTotal).ToUpper & " " & societe.Rows(0)("CODE_MONNAIE")
                pdfDoc.Add(New Paragraph(p007, pColumn))

                pdfDoc.Add(pdfCell)

                Dim p07 As String = Chr(13) & "           SIGNATURE DU CLIENT                                                            SIGNATURE DE L'HOTEL          "
                pdfDoc.Add(New Paragraph(p07, pColumn))
                pdfDoc.Add(pdfCell)

                '---------------------------------------------------------------------------------------------------------------------------
                pdfDoc.Close()

                MessageBox.Show("PDF has been exported" & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                Process.Start(sfd.FileName)

            Else

                MessageBox.Show("Bien vouloir enregistrer la réservation", "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

            End If

        End If

    End Sub

    Public Shared Sub contratDeLocationDeSalleDeFete(ByVal NumConfirmation As String, ByVal client As String, ByVal DateDebut As Date, ByVal DateFin As Date, ByVal NbreNuitee As Integer, ByVal hebergement As String, ByVal Codehebergement As String, ByVal tarif As Double, ByVal HeureEntree As DateTime, ByVal heureDepart As DateTime, ByVal TypeRea As String)

        If Not NumConfirmation = "num" Then

            'Dim dlg As New PrintDialog
            'dlg.ShowDialog()

            Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}
            sfd.FileName = "Contrat de location de Salle " & client & (Date.Now().ToString("ddMMyyHHmmss"))

            Dim societe As DataTable = Functions.allTableFields("societe")
            Dim clientInformation As DataTable = Functions.getElementByCode(client, "client", "NOM_PRENOM")
            Dim Reservation As DataTable

            Reservation = Functions.getElementByCode(NumConfirmation, "reservation", "CODE_RESERVATION")

            If Not Reservation.Rows.Count > 0 Then
                Reservation = Functions.getElementByCode(NumConfirmation, "reserve_conf", "CODE_RESERVATION")
            End If

            Dim salle As DataTable = Functions.getElementByCode(Codehebergement, "chambre", "CODE_CHAMBRE")

            Dim HEURE_ENTREE As String = ""
            Dim HEURE_DEPART As String = ""

            If Reservation.Rows.Count > 0 Then
                HEURE_ENTREE = CDate(Reservation.Rows(0)("HEURE_ENTREE")).ToLongTimeString
                HEURE_DEPART = CDate(Reservation.Rows(0)("HEURE_SORTIE")).ToLongTimeString
            End If

            Dim forfaitSalle As DataTable = Functions.getElementByCode(NumConfirmation, "forfait_salle", "CODE_RESERVATION")

            Dim EVENEMENT As String = ""
            Dim CODE_EVENEMENT As String = ""

            Dim VIDEO_PROJ As String = "NON"
            Dim SONO As String = "NON"
            Dim COUVERTS As String = "NON"
            Dim TABLE_CHAISE As String = "NON"
            Dim DECORATION As String = "NON"
            Dim LOCATION_MATERIEL As String = "NON"
            Dim MISE_EN_PLACE As Integer = 0 ' U
            Dim DISPOSITION As String = "U"

            If forfaitSalle.Rows.Count > 0 Then

                CODE_EVENEMENT = forfaitSalle.Rows(0)("CODE_EVENEMENT")

                Dim infoSupEvent As DataTable = Functions.getElementByCode(CODE_EVENEMENT, "evenement", "CODE_EVENEMENT")

                If infoSupEvent.Rows.Count > 0 Then

                    EVENEMENT = infoSupEvent.Rows(0)("LIBELLE")

                End If

                If forfaitSalle.Rows(0)("VIDEO_PROJ") = 1 Then
                    VIDEO_PROJ = "OUI"
                End If

                If forfaitSalle.Rows(0)("SONO") = 1 Then
                    SONO = "OUI"
                End If

                If forfaitSalle.Rows(0)("COUVERTS") = 1 Then
                    COUVERTS = "OUI"
                End If

                If forfaitSalle.Rows(0)("TABLE_CHAISE") = 1 Then
                    TABLE_CHAISE = "OUI"
                End If

                If forfaitSalle.Rows(0)("DECORATION") > 0 Then
                    DECORATION = "OUI"
                End If

                If forfaitSalle.Rows(0)("LOCATION_MATERIEL") > 0 Then
                    LOCATION_MATERIEL = "OUI"
                End If

                If MISE_EN_PLACE = 1 Then
                    DISPOSITION = "U"
                ElseIf MISE_EN_PLACE = 2 Then
                    DISPOSITION = "Ecole"
                ElseIf MISE_EN_PLACE = 3 Then
                    DISPOSITION = "Theatre"
                ElseIf MISE_EN_PLACE = 4 Then
                    DISPOSITION = "Rectangle"
                ElseIf MISE_EN_PLACE = 5 Then
                    DISPOSITION = "Cocktail"
                ElseIf MISE_EN_PLACE = 6 Then
                    DISPOSITION = "Banquet"
                End If

            End If

            Dim LIBELLE_CHAMBRE As String = ""
            Dim DEPOT_DE_GARANTIE As Double = 0

            If salle.Rows.Count > 0 Then
                LIBELLE_CHAMBRE = salle.Rows(0)("LIBELLE_CHAMBRE")
            End If

            If sfd.ShowDialog = 1 Then
                'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
                Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
                Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
                Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim font1 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
                Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim font2 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim font3 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
                Dim HeaderFont As New Font(Font.FontFamily.COURIER, 18, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim fontInfoSup As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

                Dim Libelle As String
                Dim LibelleJour As String
                Dim LibelleReservation As String
                Dim TitreDuDocument As String

                If GlobalVariable.typeChambreOuSalle = "salle" Then

                    Libelle = "Location de Salle"
                    LibelleJour = "Jour"
                    LibelleReservation = "CONTRAT DE LOCATION DE SALLE"
                    TitreDuDocument = "CONTRAT DE LOCATION DE SALLE"

                End If

                pdfWrite.PageEvent = New HeaderFooter()

                pdfDoc.Open()

                '------------------------------------------------------------------------
                Dim pdfCell As PdfPCell = Nothing

                Dim p0 As Paragraph = New Paragraph(Chr(13) & Chr(13) & societe.Rows(0)("VILLE") & ", " & GlobalVariable.DateDeTravail, font1)
                p0.Alignment = Element.ALIGN_RIGHT
                pdfDoc.Add(p0)

                Dim p1 As Paragraph = New Paragraph(Chr(13) & TitreDuDocument & Chr(13) & Chr(13), font2)
                p1.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p1)

                Dim intro As String = "Entre les soussignés : " & Chr(13) & societe.Rows(0)("RAISON_SOCIALE") & ". Ci-après désigné « le bailleur » " & Chr(13) & " ET " & Chr(13) & client & ". Ci-après désigné « Le preneur » ; " & Chr(13) & " Il a été arrêté et convenu ce qui suit : " & Chr(13) & Chr(13)

                pdfDoc.Add(New Paragraph(intro, font1))

                Dim p2 As String = "Article 1 : Désignation des locaux loués"
                pdfDoc.Add(New Paragraph(p2, font2))

                Dim p3 As String = "Le présent contrat concerne la salle dénommée " & LIBELLE_CHAMBRE & " dont la disposition sera en " & DISPOSITION & " et située à / au " & societe.Rows(0)("RUE") & " - " & societe.Rows(0)("VILLE") & Chr(13) & Chr(13)
                '& " ainsi que ses dépendances qui sont désignées ci-dessous " & Chr(13) & "• Chambre," & Chr(13) & "• Parking, " & Chr(13) & "• Cave, " & Chr(13) & "• Cambuse, " & Chr(13) & "•	 Cuisine, " & Chr(13) & "• Vestiaires, " & Chr(13) & "• Jardin." & Chr(13) & Chr(13)
                pdfDoc.Add(New Paragraph(p3, font1))

                Dim p4 As String = "Article 2 : Equipements mis à disposition du preneur" & Chr(13) & Chr(13)
                pdfDoc.Add(New Paragraph(p4, font2))

                '----------------------------------------

                Dim pdfTable As New PdfPTable(6) 'Number of columns
                pdfTable.TotalWidth = 530.0F
                pdfTable.LockedWidth = True
                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable.HeaderRows = 1

                Dim widths As Single() = New Single() {30.0F, 10.0F, 30.0F, 10.0F, 30.0F, 10.0F}

                pdfTable.SetWidths(widths)

                pdfCell = New PdfPCell(New Paragraph("EQUIPEMENT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("EQUIPEMENT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("EQUIPEMENT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DECORATION", font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(DECORATION, font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("LOCATION MATERIEL", font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(LOCATION_MATERIEL, font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph("VIDEO PROJECTEUR", font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(VIDEO_PROJ, font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable.AddCell(pdfCell)

                '-----------------------

                pdfCell = New PdfPCell(New Paragraph("SONORISATION", font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(SONO, font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("COUVERTS", font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(COUVERTS, font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TABLES + CHAISES", font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(TABLE_CHAISE, font1))
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

                '----------------------------------------

                'Dim p5 As String = "L’équipement de base mis à disposition se compose de : " & Chr(13) & "• Tables ," & Chr(13) & "• Parking, " & Chr(13) & "• Nappes, " & Chr(13) & "• Couverts, " & Chr(13) & "•	 Serviettes de tables , " & Chr(13) & "•  Chaises, " & Chr(13) & "• Vidéo-projecteur," & Chr(13) & "• 	  Sonorisation, " & Chr(13) & "•  DJ" & Chr(13) & "Ce matériel devra être restitué en parfait état de propreté et de fonctionnement. Un inventaire de ce matériel sera effectué lors des états des lieux qui seront dressés à l’entrée et à la sortie de la salle. " & Chr(13) & " Toutes autres fournitures sont à la charge du preneur." & Chr(13) & Chr(13)
                'pdfDoc.Add(New Paragraph(p5, font1))

                Dim p6 As String = Chr(13) & "Article 3 : Utilisation de la salle louée"
                pdfDoc.Add(New Paragraph(p6, font2))

                Dim p7 As String = "Le preneur loue la salle pour organiser : " & EVENEMENT & Chr(13) & Chr(13)
                pdfDoc.Add(New Paragraph(p7, font1))

                Dim p8 As String = "Article 4 : Début et fin du contrat de location"
                pdfDoc.Add(New Paragraph(p8, font2))

                Dim p9 As String = "Le preneur loue la salle à partir du " & DateDebut & " à " & HEURE_ENTREE & " jusqu’au " & DateFin & " à " & HEURE_DEPART & " Afin que l’état des lieux d’entrée puisse être dressé, il s’engage à se présenter le jour du début de la location. " & Chr(13) & " À la fin de location, le preneur devra restituer la salle à l’heure prévue. Il devra rester le temps nécessaire pour permettre l’établissement de l’état des lieux de sortie. " & Chr(13) & Chr(13)
                pdfDoc.Add(New Paragraph(p9, font1))

                Dim p10 As String = "Article 5 : Obligations du bailleur"
                pdfDoc.Add(New Paragraph(p10, font2))

                Dim p11 As String = "Le bailleur est tenu de mettre le local à la disposition du preneur à la date et à l’heure convenues pour le début de la location. Il est précisé qu’en cas d’accident ou d’incendie, sa responsabilité ne sera engagée que s’il n’y a pas plus de " & Reservation.Rows(0)("NB_PERSONNES") & " personnes présentes lors de l’événement organisé par le preneur."
                pdfDoc.Add(New Paragraph(p11, font1))

                pdfDoc.NewPage()

                Dim p12 As String = "Article 6 : Obligations du preneur"
                pdfDoc.Add(New Paragraph(p12, font2))

                'PERIODE DU SEJOURS : COUT TOTAL DE LA RESA
                Dim periodeDeLaResa As Integer = DateDiff(DateInterval.Day, Reservation.Rows(0)("DATE_ENTTRE"), Reservation.Rows(0)("DATE_SORTIE"))

                DEPOT_DE_GARANTIE = Reservation.Rows(0)("DEPOT_DE_GARANTIE")
                Dim CODE_RESERVATION = Reservation.Rows(0)("CODE_RESERVATION")
                Dim CAUTION As Double = Reservation.Rows(0)("MONTANT_TOTAL_CAUTION")

                Dim encaissement As Double = 0
                Dim solde As Double = 0

                Dim reglement As DataTable = Functions.getElementByCode(CODE_RESERVATION, "reglement", "CODE_RESERVATION")

                For i = 0 To reglement.Rows.Count - 1
                    encaissement += reglement.Rows(i)("MONTANT_VERSE")
                Next

                If periodeDeLaResa = 0 Then
                    periodeDeLaResa = 1
                End If

                Dim MONTANT_ACCORDE As Double = Reservation.Rows(0)("MONTANT_ACCORDE")

                solde = MONTANT_ACCORDE * periodeDeLaResa

                solde -= encaissement + DEPOT_DE_GARANTIE

                Dim p013 As String = "Le preneur à : " & Chr(13) & "• Payer les arrhes, soit " & Format(CAUTION, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE") & " et le dépôt de garantie, soit " & Format(DEPOT_DE_GARANTIE, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE") & " lors de la signature du présent contrat; " & Chr(13)
                '& "• Payer le solde du, soit " & Format(solde, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE") & " au plus tard le " & DateDebut & " ;" & Chr(13) & Chr(13)
                pdfDoc.Add(New Paragraph(p013, font1))

                Dim p13 As String = "• Le preneur s’engage à Payer : " & Chr(13) & Chr(13)
                pdfDoc.Add(New Paragraph(p13, font1))

                '---------------------------------------------------------------------------------------------------------------------------

                Dim pdfTable01 As New PdfPTable(5) 'Number of columns
                pdfTable01.TotalWidth = 530.0F
                pdfTable01.LockedWidth = True
                pdfTable01.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.HeaderRows = 1

                Dim widths01 As Single() = New Single() {10.0F, 70.0F, 15.0F, 20.0F, 20.0F}

                pdfTable01.SetWidths(widths01)

                Dim montantTotal As Double = 0

                pdfCell = New PdfPCell(New Paragraph("No", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                '------------------------1----------------------------

                pdfCell = New PdfPCell(New Paragraph("1-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("LOCATION SALLE", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa, "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(MONTANT_ACCORDE, "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * MONTANT_ACCORDE, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += periodeDeLaResa * MONTANT_ACCORDE

                '----------------------------------------------------

                '------------------------2----------------------------

                pdfCell = New PdfPCell(New Paragraph("2-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DECORATION", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(1, "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("DECORATION"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("DECORATION"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += forfaitSalle.Rows(0)("DECORATION")

                '----------------------------------------------------

                '------------------------3----------------------------

                pdfCell = New PdfPCell(New Paragraph("3-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("LOCATION MATERIEL", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(1, "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("LOCATION_MATERIEL"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("LOCATION_MATERIEL"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += forfaitSalle.Rows(0)("LOCATION_MATERIEL")

                '----------------------------------------------------

                '------------------------4----------------------------

                pdfCell = New PdfPCell(New Paragraph("4-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DIVERS", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(1, "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("AUTRES"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("AUTRES"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += forfaitSalle.Rows(0)("AUTRES")

                '----------------------------------------------------

                '------------------------5----------------------------

                pdfCell = New PdfPCell(New Paragraph("5-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAUSE CAFE", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("NBRE__CAFE"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("PU_CAFE"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("PU_CAFE") * forfaitSalle.Rows(0)("NBRE__CAFE"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += periodeDeLaResa * forfaitSalle.Rows(0)("NBRE__CAFE") * forfaitSalle.Rows(0)("PU_CAFE")

                '----------------------------------------------------

                '------------------------6----------------------------

                pdfCell = New PdfPCell(New Paragraph("6-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAUSE DEJEUNER", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_DEJEUNER"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("PU_DEJEUNER"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_DEJEUNER") * forfaitSalle.Rows(0)("PU_DEJEUNER"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_DEJEUNER") * forfaitSalle.Rows(0)("PU_DEJEUNER")

                '----------------------------------------------------

                '------------------------7----------------------------

                pdfCell = New PdfPCell(New Paragraph("7-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAUSE DINER", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_DINER"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("PU_DINER"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_DINER") * forfaitSalle.Rows(0)("PU_DINER"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_DINER") * forfaitSalle.Rows(0)("PU_DINER")

                '----------------------------------------------------

                '------------------------8----------------------------

                pdfCell = New PdfPCell(New Paragraph("8-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TRAITEURS", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_TRAITEUR"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("PU_TRAITEUR"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_TRAITEUR") * forfaitSalle.Rows(0)("PU_TRAITEUR"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_TRAITEUR") * forfaitSalle.Rows(0)("PU_TRAITEUR")

                '----------------------------------------------------

                '------------------------9----------------------------

                pdfCell = New PdfPCell(New Paragraph("9-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("GOUTER", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_GOUTER"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("PU_GOUTER"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_GOUTER") * forfaitSalle.Rows(0)("PU_GOUTER"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_GOUTER") * forfaitSalle.Rows(0)("PU_GOUTER")

                '----------------------------------------------------

                '------------------------10----------------------------

                pdfCell = New PdfPCell(New Paragraph("10-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("COCKTAILS", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_COCKTAIL"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("PU_COCKTAIL"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_COCKTAIL") * forfaitSalle.Rows(0)("PU_COCKTAIL"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += periodeDeLaResa * forfaitSalle.Rows(0)("NBRE_COCKTAIL") * forfaitSalle.Rows(0)("PU_COCKTAIL")

                '----------------------------------------------------

                '------------------------11----------------------------

                pdfCell = New PdfPCell(New Paragraph("11-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("EAU PETITE BOUTEILLE", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("EAU_PTE_QTE"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                If forfaitSalle.Rows(0)("EAU_PTE_QTE") > 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(forfaitSalle.Rows(0)("EAU_PTE_MONTANT") / forfaitSalle.Rows(0)("EAU_PTE_QTE")), "#,##0"), font1))
                Else
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(0), "#,##0"), font1))
                End If

                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("EAU_PTE_MONTANT"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += forfaitSalle.Rows(0)("EAU_PTE_MONTANT")

                '----------------------------------------------------

                '------------------------12----------------------------

                pdfCell = New PdfPCell(New Paragraph("12-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("EAU GRANDE BOUTEILLE", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("EAU_GRDE_QTE"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                If forfaitSalle.Rows(0)("EAU_GRDE_QTE") > 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(forfaitSalle.Rows(0)("EAU_GRDE_MONTANT") / forfaitSalle.Rows(0)("EAU_GRDE_QTE")), "#,##0"), font1))
                Else
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(0), "#,##0"), font1))
                End If

                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("EAU_GRDE_MONTANT"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += forfaitSalle.Rows(0)("EAU_GRDE_MONTANT")

                '----------------------------------------------------

                '------------------------13----------------------------

                pdfCell = New PdfPCell(New Paragraph("13-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BOISSONS GAZEUSES", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("BOISSONS_GAZEUSES_QTE"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                If forfaitSalle.Rows(0)("BOISSONS_GAZEUSES_QTE") > 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(forfaitSalle.Rows(0)("BOISSONS_GAZEUSES_MONTANT") / forfaitSalle.Rows(0)("BOISSONS_GAZEUSES_QTE")), "#,##0"), font1))
                Else
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(0), "#,##0"), font1))
                End If

                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("BOISSONS_GAZEUSES_MONTANT"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += forfaitSalle.Rows(0)("BOISSONS_GAZEUSES_MONTANT")

                '----------------------------------------------------

                '------------------------14----------------------------

                pdfCell = New PdfPCell(New Paragraph("14-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BIERES", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("BIERES_QTE"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                If forfaitSalle.Rows(0)("BIERES_QTE") > 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(forfaitSalle.Rows(0)("BIERES_MONTANT") / forfaitSalle.Rows(0)("BIERES_QTE")), "#,##0"), font1))
                Else
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(0), "#,##0"), font1))
                End If

                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("BIERES_MONTANT"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += forfaitSalle.Rows(0)("BIERES_MONTANT")

                '----------------------------------------------------

                '------------------------15----------------------------

                pdfCell = New PdfPCell(New Paragraph("15-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("VIN ROUGE", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("VIN_ROUGE_QTE"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                If forfaitSalle.Rows(0)("VIN_ROUGE_QTE") > 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(forfaitSalle.Rows(0)("VIN_ROUGE_MONTANT") / forfaitSalle.Rows(0)("VIN_ROUGE_QTE")), "#,##0"), font1))
                Else
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(0), "#,##0"), font1))
                End If

                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("VIN_ROUGE_MONTANT"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += forfaitSalle.Rows(0)("VIN_ROUGE_MONTANT")

                '----------------------------------------------------
                '------------------------16----------------------------

                pdfCell = New PdfPCell(New Paragraph("16-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("VIN ROSE", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("VIN_ROSE_QTE"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                If forfaitSalle.Rows(0)("VIN_ROSE_QTE") > 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(forfaitSalle.Rows(0)("BOISSONS_EXT_MONTANT") / forfaitSalle.Rows(0)("VIN_ROSE_QTE")), "#,##0"), font1))
                Else
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(0), "#,##0"), font1))
                End If

                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("BOISSONS_EXT_MONTANT"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += forfaitSalle.Rows(0)("BOISSONS_EXT_MONTANT")

                '----------------------------------------------------
                '------------------------17----------------------------

                pdfCell = New PdfPCell(New Paragraph("17-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BOISSONS EXTERIEURES", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("BOISSONS_EXT_QTE"), "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                If forfaitSalle.Rows(0)("BOISSONS_EXT_QTE") > 0 Then
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(forfaitSalle.Rows(0)("VIN_ROSE_MONTANT") / forfaitSalle.Rows(0)("BOISSONS_EXT_QTE")), "#,##0"), font1))
                Else
                    pdfCell = New PdfPCell(New Paragraph(Format(Math.Round(0), "#,##0"), font1))
                End If

                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("VIN_ROSE_MONTANT"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += forfaitSalle.Rows(0)("VIN_ROSE_MONTANT")

                '----------------------------------------------------
                '------------------------18----------------------------

                pdfCell = New PdfPCell(New Paragraph("18-", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DROIT DE BOUCHON", font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(1, "#,##0"), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("DROIT_DE_BOUCHON"), "#,##0"), font1))

                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(forfaitSalle.Rows(0)("DROIT_DE_BOUCHON"), "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)

                montantTotal += forfaitSalle.Rows(0)("DROIT_DE_BOUCHON")

                '----------------------------------------------------

                pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Colspan = 4
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(montantTotal, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable01.AddCell(pdfCell)
                pdfDoc.Add(pdfTable01)

                Dim p007 As String = Chr(13) & Chr(13) & "Arrêter à la somme de : " & Functions.NBLT(montantTotal).ToUpper & " " & societe.Rows(0)("CODE_MONNAIE")
                pdfDoc.Add(New Paragraph(p007, pColumn))

                pdfDoc.Add(pdfCell)

                Dim p07 As String = Chr(13) & Chr(13) & "           SIGNATURE DU CLIENT                                              SIGNATURE DE L'HOTEL"
                pdfDoc.Add(New Paragraph(p07, pColumn))
                pdfDoc.Add(pdfCell)

                '---------------------------------------------------------------------------------------------------------------------------
                pdfDoc.Close()

                MessageBox.Show("PDF has been exported" & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                Process.Start(sfd.FileName)

            Else

                MessageBox.Show("Bien vouloir enregistrer la réservation", "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

            End If

        End If

    End Sub

    Public Shared Sub rapportEconomat(ByVal dt As DataTable, ByVal codeArticle As String)

    End Sub

    Public Shared Sub ficheProduitArticleOuMatiere(ByVal dt As DataTable)

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0

        Dim tireDocument As String = ""

        Dim sousTitreDocument As String = ""

        If GlobalVariable.typeRapportEconmat = "FPAM" Then
            sousTitreDocument = "FICHE DE RESEIGNEMENT"
        ElseIf GlobalVariable.typeRapportEconmat = "FPT" Then
            sousTitreDocument = "FICHE TECHNIQUE DE PLAT"
        End If

        tireDocument = sousTitreDocument & " " & GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR") & " le " & Date.Now().ToString("ddMMyyHHmmss") & " "

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 40, 40)
            'Dim pdfDoc As New Document(PageSize.A4, 40, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & "***", pColumn)
            p1.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p1)

            Dim p0 As Paragraph = New Paragraph(Chr(13) & sousTitreDocument.ToUpper() & " " & dt.Rows(0)("TYPE").ToUpper() & " : " & dt.Rows(0)("DESIGNATION_FR") & Chr(13) & Chr(13), pRow)
            p0.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p0)

            'pdfWrite.PageEvent = New HeaderFooter

            For i = 0 To dt.Rows.Count - 1

                Dim infoSup As DataTable = Functions.getElementByCode(dt.Rows(i)("UNITE_COMPTAGE"), "unite_comptage", "CODE_UNITE_DE_COMPTAGE")

                Dim GRANDE_UNITE As String = ""
                Dim PETITE_UNITE As String = ""

                If infoSup.Rows.Count > 0 Then
                    GRANDE_UNITE = infoSup.Rows(0)("GRANDE_UNITE")
                    PETITE_UNITE = infoSup.Rows(0)("PETITE_UNITE")
                End If

                Dim pdfTable As New PdfPTable(2) 'Number of columns
                pdfTable.TotalWidth = 510.0F
                pdfTable.LockedWidth = True
                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfTable.HeaderRows = 1

                Dim widths As Single() = New Single() {60.0F, 120.0F}

                pdfTable.SetWidths(widths)

                Dim pdfCell As PdfPCell = Nothing

                pdfCell = New PdfPCell(New Paragraph("DESIGNATION : " & Chr(13) & Chr(13) & "CODE ARTICLE : " & Chr(13) & Chr(13) & "CODE BARRE : " & Chr(13) & Chr(13) & "DESCRIPTION : " & Chr(13) & Chr(13) & "POINT DE SORTIE : " & Chr(13) & Chr(13) & "FAMILLE : " & Chr(13) & Chr(13) & "METHODE SUIVI STOCK : " & Chr(13) & Chr(13) & "PRIX D'ACHAT : " & Chr(13) & Chr(13) & "PRIX DE VENTE : " & Chr(13) & Chr(13) & "SEUIL REAPPROVISIONNEMENT : " & Chr(13) & Chr(13) & "UNITE DE STOCKAGE : " & Chr(13) & Chr(13) & "UNITE DE DESTOCKAGE : " & Chr(13) & Chr(13) & "NUMERO SERIE : ", pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                pdfCell.Border = 0
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(dt.Rows(i)("DESIGNATION_FR") & Chr(13) & Chr(13) & dt.Rows(i)("CODE_ARTICLE") & Chr(13) & Chr(13) & dt.Rows(i)("CODE_BARRE") & Chr(13) & Chr(13) & dt.Rows(i)("DESCRIPTION") & Chr(13) & Chr(13) & dt.Rows(i)("TYPE_ARTICLE") & Chr(13) & Chr(13) & dt.Rows(i)("CODE_SOUS_FAMILLE") & Chr(13) & Chr(13) & dt.Rows(i)("METHODE_SUIVI_STOCK") & Chr(13) & Chr(13) & Format(dt.Rows(i)("PRIX_ACHAT_HT"), "#,##0") & Chr(13) & Chr(13) & Format(dt.Rows(i)("PRIX_VENTE_HT"), "#,##0") & Chr(13) & Chr(13) & Format(dt.Rows(i)("SEUIL_REAPPROVISIONNEMENT"), "#,##0") & Chr(13) & Chr(13) & GRANDE_UNITE & Chr(13) & Chr(13) & PETITE_UNITE & Chr(13) & Chr(13) & dt.Rows(i)("NUMERO_SERIE"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 15
                pdfCell.Border = 0
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                Process.Start(sfd.FileName)

            Next



            ' ------------------------------------------------------------------------------------------------

        End If

    End Sub

    Public Shared Sub Inventaire(ByVal dt As DataTable)

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0

        Dim tireDocument As String = ""

        Dim sousTitreDocument As String = "INVENTAIRE"

        tireDocument = sousTitreDocument & " " & GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR") & " le " & Date.Now().ToString("ddMMyyHHmmss") & " "

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 40, 20, 40)
            'Dim pdfDoc As New Document(PageSize.A4, 40, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & "***", pColumn)
            p1.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p1)

            Dim p3 As Paragraph = New Paragraph(sousTitreDocument & " " & GlobalVariable.DateDeTravail & Chr(13) & Chr(13), pColumn)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            'pdfWrite.PageEvent = New HeaderFooter

            Dim pdfTable As New PdfPTable(7) 'Number of columns
            pdfTable.TotalWidth = 740.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single() = New Single() {10.0F, 15.0F, 70.0F, 20.0F, 25.0F, 15.0F, 15.0F}

            pdfTable.SetWidths(widths)

            Dim pdfCell As PdfPCell = Nothing

            pdfCell = New PdfPCell(New Paragraph("ORDRE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("ARTICLES", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("PRIX UNITAIRE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("COUT MOYEN UNITAIRE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("STOCK VIRTUEL", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("STOCK PHYSIQUE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            'pdfTable.AddCell(pdfCell)

            If dt.Rows.Count > 0 Then

                For i = 0 To dt.Rows.Count - 1
                    '-------------------------------- GESTION DES REGLEMENTS DE LA FACTURE ---------------

                    pdfCell = New PdfPCell(New Paragraph(i + 1, font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(dt.Rows(i)("CODE ARTICLE"), font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(dt.Rows(i)("DESIGNATION"), font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i)("PRIX UNITAIRE"), "#,##0"), font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i)("COUT MOYEN UNITAIRE"), "#,##0"), font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i)("STOCK"), "#,##0"), font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfTable.AddCell(pdfCell)

                Next

                pdfDoc.Add(pdfTable)

                '------------------------------------------------------------------------

                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Process.Start(sfd.FileName)

            Else

                MessageBox.Show("Aucune Ligne à imprimer!")

            End If

            ' ------------------------------------------------------------------------------------------------

        End If

    End Sub

    Public Shared Sub Bon(ByVal dt As DataTable)

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0

        Dim tireDocument As String = ""

        Dim sousTitreDocument As String = ""

        If GlobalVariable.typeRapportEconmat = "BC" Then
            sousTitreDocument = "BON DE COMMANDE"
        ElseIf GlobalVariable.typeRapportEconmat = "BS" Then
            sousTitreDocument = "BON DE SORTIE"
        ElseIf GlobalVariable.typeRapportEconmat = "BR" Then
            sousTitreDocument = "BON DE RECEPTION"
        ElseIf GlobalVariable.typeRapportEconmat = "BRQ" Then
            sousTitreDocument = "BON DE REQUISITION"
        ElseIf GlobalVariable.typeRapportEconmat = "TIM" Then
            sousTitreDocument = "TRANSFERT INTER MAGASIN"
        End If

        tireDocument = sousTitreDocument & " " & GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR") & " le " & Date.Now().ToString("ddMMyyHHmmss") & " "

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If dt.Rows.Count > 0 Then

            If sfd.ShowDialog = 1 Then

                Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
                'Dim pdfDoc As New Document(PageSize.A4, 40, 5, 5, 5)
                Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
                Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

                'pdfWrite.PageEvent = New HeaderFooter

                pdfDoc.Open()

                Dim p3 As Paragraph = New Paragraph(Chr(13) & Chr(13) & sousTitreDocument & " " & dt.Rows(0)("DATE_BORDEREAU") & Chr(13), pColumn)
                p3.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p3)

                Dim p0 As Paragraph = New Paragraph(Chr(13) & sousTitreDocument & " NUMERO :  " & dt.Rows(0)("CODE_BORDEREAUX") & Chr(13) & "LIBELLE: " & dt.Rows(0)("LIBELLE_BORDEREAUX") & Chr(13) & "REFERENCE: " & dt.Rows(0)("REF_BORDEREAUX") & Chr(13) & "TIERS: " & dt.Rows(0)("NON_TIERS") & Chr(13) & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_LEFT

                pdfDoc.Add(p0)

                pdfWrite.PageEvent = New HeaderFooter

                Dim pdfTable As New PdfPTable(5) 'Number of columns
                pdfTable.TotalWidth = 540.0F
                pdfTable.LockedWidth = True
                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable.HeaderRows = 1

                Dim widths As Single() = New Single() {15.0F, 70.0F, 20.0F, 25.0F, 25.0F}

                pdfTable.SetWidths(widths)

                Dim pdfCell As PdfPCell = Nothing

                pdfCell = New PdfPCell(New Paragraph("ORDRE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ARTICLES", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("QUANTITE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PRIX UNITAIRE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                'pdfTable.AddCell(pdfCell)

                If dt.Rows.Count > 0 Then

                    Dim OBSERVATIONS As String = ""
                    Dim GRAND_TOTAL As Double = 0

                    For i = 0 To dt.Rows.Count - 1

                        OBSERVATIONS = dt.Rows(i)("OBSERVATIONS")
                        GRAND_TOTAL = dt.Rows(i)("MONTANT_HT")
                        '-------------------------------- GESTION DES REGLEMENTS DE LA FACTURE ---------------

                        pdfCell = New PdfPCell(New Paragraph(i + 1, font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(i)("DESIGNATION_FR"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i)("QUANTITE_ENTREE_STOCK"), "#,##0"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i)("PRIX_UNITAIRE_HT"), "#,##0"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i)("PRIX_TOTAL_HT"), "#,##0"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.AddCell(pdfCell)

                    Next

                    pdfDoc.Add(pdfTable)

                    '------------------------------------------------------------------------

                    Dim pdfTable2 As New PdfPTable(2) 'Number of columns

                    pdfTable2.TotalWidth = 520.0F
                    pdfTable2.LockedWidth = True
                    pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                    'pdfTable2.HeaderRows = 1

                    Dim widths2 As Single() = New Single() {6.0F, 1.2F}
                    pdfTable2.SetWidths(widths2)

                    Dim pdfCell2 As PdfPCell = Nothing

                    pdfCell2 = New PdfPCell(New Paragraph("TOTAL: ", fontTotal))
                    pdfCell2.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell2.MinimumHeight = 18
                    pdfCell2.PaddingLeft = 15.0F
                    pdfCell2.Border = 0
                    pdfTable2.AddCell(pdfCell2)

                    pdfCell2 = New PdfPCell(New Paragraph(Format(GRAND_TOTAL, "#,##0"), fontTotal))
                    pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell2.MinimumHeight = 18
                    pdfCell2.PaddingLeft = 5.0F
                    'pdfCell2.Border = 0
                    pdfTable2.AddCell(pdfCell2)

                    pdfDoc.Add(pdfTable2)

                    Dim p01 As Paragraph = New Paragraph(Chr(13) & "OBSERVATIONS: " & OBSERVATIONS, font1)
                    p01.Alignment = Element.ALIGN_JUSTIFIED

                    pdfDoc.Add(p01)

                    pdfDoc.Close()

                    MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                    Process.Start(sfd.FileName)

                Else

                    MessageBox.Show("Aucune Ligne à imprimer!")

                End If

                ' ------------------------------------------------------------------------------------------------

            End If

        End If

    End Sub


    'IMPRESSION DU NETTOYAGE AU NIVEAU DE L'ATTRIBUTION DES CHAMBRES 
    Public Shared Sub planningDeNettoyagePerso(ByVal dt As DataGridView, ByVal Personnel As String, ByVal nombreDeChambre As Integer)

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalCommande As Double = 0

        Dim tireDocument As String = ""

        tireDocument = "Planning de nettoyage par " & GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR") & " le " & Date.Now().ToString("ddMMyyHHmmss") & " "

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4.Rotate, 10, 10, 10, 10)
            'Dim pdfDoc As New Document(PageSize.A4, 40, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pColumnHeader As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 14, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & "***", pColumnHeader)
            p1.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p1)

            Dim p3 As Paragraph = New Paragraph("CHAMBRES A NETTOYER DU " & Date.Now() & Chr(13), pColumn)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)


            Dim p0 As Paragraph = New Paragraph(Chr(13) & "NOM DU PERSONNEL: " & Personnel & Chr(13) & " Nombre de Chambre : " & nombreDeChambre & Chr(13) & Chr(13), pRow)
            p0.Alignment = Element.ALIGN_LEFT

            pdfDoc.Add(p0)

            'pdfWrite.PageEvent = New HeaderFooter

            Dim pdfTable As New PdfPTable(7) 'Number of columns
            pdfTable.TotalWidth = 790.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single() = New Single() {10.0F, 40.0F, 17.0F, 17.0F, 10.0F, 26.0F, 20.0F}

            pdfTable.SetWidths(widths)

            Dim pdfCell As PdfPCell = Nothing

            pdfCell = New PdfPCell(New Paragraph("CHAMBRE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("NBRE PAX", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("COMMENTAIRE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("NETTOYAGE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            'pdfTable.AddCell(pdfCell)

            If dt.Rows.Count > 0 Then

                For i = 0 To dt.Rows.Count - 1

                    '-------------------------------- GESTION DES REGLEMENTS DE LA FACTURE ---------------

                    pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(0).Value.ToString, font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfTable.AddCell(pdfCell)

                    '--------------------------------------------------------------------------------------
                    'DETERMINONS SI LA CHAMBRE EST OCCUPEE OU PAS
                    Dim CHAMBRE_ID As String = dt.Rows(i).Cells(0).Value.ToString
                    Dim resa As DataTable = Functions.GetAllElementsOnTwoConditions(CHAMBRE_ID, "reserve_conf", "CHAMBRE_ID", 1, "ETAT_RESERVATION")

                    If resa.Rows.Count > 0 Then
                        pdfCell = New PdfPCell(New Paragraph(resa.Rows(0)("NOM_CLIENT"), font1))
                    Else
                        pdfCell = New PdfPCell(New Paragraph("-", font1))
                    End If

                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfTable.AddCell(pdfCell)

                    If resa.Rows.Count > 0 Then
                        pdfCell = New PdfPCell(New Paragraph(resa.Rows(0)("DATE_ENTTRE"), font1))
                    Else
                        pdfCell = New PdfPCell(New Paragraph("-", font1))
                    End If

                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfTable.AddCell(pdfCell)

                    '--------------------------------------------------------------------------------------

                    If resa.Rows.Count > 0 Then
                        pdfCell = New PdfPCell(New Paragraph(resa.Rows(0)("DATE_SORTIE"), font1))
                    Else
                        pdfCell = New PdfPCell(New Paragraph("-", font1))
                    End If
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                    pdfTable.AddCell(pdfCell)

                    If resa.Rows.Count > 0 Then
                        pdfCell = New PdfPCell(New Paragraph(resa.Rows(0)("NB_PERSONNES"), font1))
                    Else
                        pdfCell = New PdfPCell(New Paragraph("-", font1))
                    End If
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(1).Value.ToString, font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.AddCell(pdfCell)

                    If resa.Rows.Count > 0 Then
                        pdfCell = New PdfPCell(New Paragraph("EN RECOUCHE", font1))
                    Else
                        pdfCell = New PdfPCell(New Paragraph("A BLANC", font1))
                    End If
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfTable.AddCell(pdfCell)

                Next

                pdfDoc.Add(pdfTable)

                '------------------------------------------------------------------------
                Dim pSpace As New PdfPCell(New Paragraph(Chr(13) & Chr(13) & Chr(13)))
                'pdfDoc.Add(pdfTable)


                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Process.Start(sfd.FileName)

            Else

                MessageBox.Show("Aucune Ligne à imprimer!")

            End If

        End If

    End Sub

    Structure resumeInfo

        Dim nomEmploye As String
        Dim montant As Double

    End Structure

    Public Shared Sub journalDesVentesPeriodique(ByVal DateDebut As Date, ByVal DateFin As Date, ByVal CODE_UTILISATEUR As String)

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0

        Dim tireDocument As String = ""
        tireDocument = "Journal des ventes périodique du " & Date.Now().ToString("ddMMyyHHmmss") & " "

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        Dim ListeDesResumeDesVentes As DataTable

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            'Dim pdfDoc As New Document(PageSize.B7, 5, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow1 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p3 As Paragraph = New Paragraph(Chr(13) & Date.Now() & Chr(13), pColumn)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            If DateDebut = DateFin Then

                Dim p0 As Paragraph = New Paragraph(Chr(13) & " JOURNAL DES VENTES PERIODIQUE DU : " & DateDebut & Chr(13) & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            Else

                Dim p0 As Paragraph = New Paragraph(Chr(13) & " JOURNAL DES VENTES PERIODIQUE DU : " & DateDebut & " AU " & DateFin & Chr(13) & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            End If

            Dim totalDesDesVentesDeLaFamille As Double = 0
            Dim qteDeLaFamille As Double = 0
            Dim totalDesDesVentes As Double = 0

            Dim totalDesDesVentesDeLaFamille2 As Double = 0
            Dim totalDesDesVentes2 As Double = 0
            Dim qteDeLaFamille2 As Double = 0

            '1- ON SELECTION TOUS LES VENDEURS SI ON NE TRAITE PAS UN VENDEUR INDIVIDUEL
            '2- PUIS ON AFFICHE LES VENTES PAR FAMILLE

            Dim grandTotal As Double = 0

            If Trim(CODE_UTILISATEUR) = "" Then 'FOR ALL THE CASHIER

                Dim ligne_facture As New LigneFacture()

                Dim listeDesVendeurs As DataTable = ligne_facture.ListeDesVendeurs(DateDebut, DateFin)

                Dim resumeDesVentes(listeDesVendeurs.Rows.Count) As resumeInfo

                If listeDesVendeurs.Rows.Count > 0 Then

                    For k = 0 To listeDesVendeurs.Rows.Count - 1

                        Dim CODE_CAISSIER As String = listeDesVendeurs.Rows(k)("CAISSIER")

                        Dim infoVendeur As DataTable = Functions.getElementByCode(CODE_CAISSIER, "utilisateurs", "CODE_UTILISATEUR")

                        Dim montantVenteResume As Double = 0

                        If infoVendeur.Rows.Count > 0 Then

                            Dim ligneFacture As New LigneFacture()
                            Dim dtCategoryParent As DataTable = ligneFacture.ListeDesCategoriesDArticleVendus(DateDebut, DateFin, CODE_CAISSIER)

                            If dtCategoryParent.Rows.Count > 0 Then

                                Dim p02 As Paragraph = New Paragraph("JOURNAL DES VENTES DE : " & infoVendeur.Rows(0)("NOM_UTILISATEUR") & Chr(13), pRow)
                                p02.Alignment = Element.ALIGN_RIGHT

                                pdfDoc.Add(p02)

                                For i = 0 To dtCategoryParent.Rows.Count - 1
                                    'VENTES
                                    Dim pdfTable As New PdfPTable(4) 'Number of columns
                                    pdfTable.TotalWidth = 520.0F
                                    pdfTable.LockedWidth = True
                                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                                    pdfTable.HeaderRows = 1

                                    Dim widths As Single() = New Single() {60.0F, 15.0F, 10.0F, 15.0F}

                                    pdfTable.SetWidths(widths)

                                    totalDesDesVentesDeLaFamille = 0
                                    qteDeLaFamille = 0

                                    Dim CategoriePArent As String = dtCategoryParent.Rows(i)("SOUS FAMILLE")

                                    Dim p2 As Paragraph = New Paragraph(i + 1 & "-" & CategoriePArent & Chr(13) & Chr(13), pRow)
                                    p2.Alignment = Element.ALIGN_LEFT

                                    pdfDoc.Add(p2)

                                    pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 15
                                    'pdfCell.PaddingLeft = 5.0F
                                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                    pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 15
                                    'pdfCell.PaddingLeft = 5.0F
                                    pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 15
                                    'pdfCell.PaddingLeft = 5.0F
                                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                    pdfTable.AddCell(pdfCell)

                                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                    'pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 15
                                    'pdfCell.PaddingLeft = 5.0F
                                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                    pdfTable.AddCell(pdfCell)

                                    'ARTICLE D'UNE FAMILLE QUELCONQUE

                                    Dim dt As DataTable

                                    dt = ligneFacture.ListeDesArticlesVendusParFamilleDunCaissier(CategoriePArent, DateDebut, DateFin, CODE_CAISSIER)

                                    If dt.Rows.Count > 0 Then

                                        For j = 0 To dt.Rows.Count - 1

                                            totalDesDesVentesDeLaFamille += dt.Rows(j)("MONTANT TOTAL")
                                            totalDesDesVentes += dt.Rows(j)("MONTANT TOTAL")
                                            qteDeLaFamille += dt.Rows(j)("QUANTITE")

                                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(j)("LIBELLE ARTICLE"), font1))
                                            pdfCell.MinimumHeight = 15
                                            pdfCell.PaddingLeft = 5.0F
                                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                            pdfTable.AddCell(pdfCell)

                                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j)("PRIX UNITAIRE"), "#,##0"), font1))
                                            pdfCell.MinimumHeight = 15
                                            pdfCell.PaddingLeft = 5.0F
                                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                            pdfTable.AddCell(pdfCell)

                                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j)("QUANTITE"), "#,##0"), font1))
                                            pdfCell.MinimumHeight = 15
                                            pdfCell.PaddingLeft = 5.0F
                                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                            pdfTable.AddCell(pdfCell)

                                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j)("MONTANT TOTAL"), "#,##0"), font1))
                                            pdfCell.MinimumHeight = 15
                                            pdfCell.PaddingLeft = 5.0F
                                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                            pdfTable.AddCell(pdfCell)

                                        Next

                                    End If

                                    pdfCell = New PdfPCell(New Paragraph("TOTAL", pRow))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.Colspan = 2
                                    pdfCell.Border = 0
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                    pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(qteDeLaFamille, "#,##0"), pRow))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.Border = 0
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(totalDesDesVentesDeLaFamille, "#,##0"), pRow))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.Border = 0
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                    pdfTable.AddCell(pdfCell)

                                    pdfDoc.Add(pdfTable)

                                    '---------------------GRATUITE----------------------------------

                                    Dim p7 As Paragraph = New Paragraph("GRATUITES ****: " & Chr(13) & Chr(13), pRow)
                                    p7.Alignment = Element.ALIGN_CENTER

                                    Dim pdfTable2 As New PdfPTable(4) 'Number of columns
                                    pdfTable2.TotalWidth = 520.0F
                                    pdfTable2.LockedWidth = True
                                    pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                                    pdfTable2.HeaderRows = 1

                                    Dim widths2 As Single() = New Single() {60.0F, 15.0F, 10.0F, 15.0F}

                                    pdfTable2.SetWidths(widths2)

                                    totalDesDesVentesDeLaFamille2 = 0

                                    Dim ligneFacture2 As New LigneFacture()
                                    'Dim CategoriePArent2 As String = dtCategoryParent.Rows(i)("SOUS FAMILLE")

                                    Dim p8 As Paragraph = New Paragraph("FAMILLE D'ARTICLE: " & CategoriePArent & Chr(13) & Chr(13), font1)
                                    p8.Alignment = Element.ALIGN_LEFT

                                    'pdfDoc.Add(p2)

                                    pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 15
                                    'pdfCell.PaddingLeft = 5.0F
                                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                    pdfTable2.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 15
                                    'pdfCell.PaddingLeft = 5.0F
                                    pdfTable2.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 15
                                    'pdfCell.PaddingLeft = 5.0F
                                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                    pdfTable2.AddCell(pdfCell)

                                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                    'pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 15
                                    'pdfCell.PaddingLeft = 5.0F
                                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                    pdfTable2.AddCell(pdfCell)

                                    'ARTICLE D'UNE FAMILLE QUELCONQUE
                                    'Dim dtGratuite As DataTable = ligneFacture.ListeDesArticlesVendusGratuitementParFamille(CategoriePArent, DateDebut, DateFin)
                                    Dim dtGratuite As DataTable = ligneFacture.ListeDesArticlesVendusGratuitementParFamilleCaissier(CategoriePArent, DateDebut, DateFin, CODE_CAISSIER)

                                    If dtGratuite.Rows.Count > 0 Then

                                        pdfDoc.Add(p7)

                                        totalDesDesVentesDeLaFamille2 = 0
                                        qteDeLaFamille2 = 0

                                        For j = 0 To dtGratuite.Rows.Count - 1

                                            totalDesDesVentesDeLaFamille2 += dtGratuite.Rows(j)("MONTANT TOTAL")
                                            totalDesDesVentes2 += dtGratuite.Rows(j)("MONTANT TOTAL")
                                            qteDeLaFamille2 += dtGratuite.Rows(j)("QUANTITE")

                                            pdfCell = New PdfPCell(New Paragraph(dtGratuite.Rows(j)("LIBELLE ARTICLE"), font1))
                                            pdfCell.MinimumHeight = 15
                                            pdfCell.PaddingLeft = 5.0F
                                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                            pdfTable2.AddCell(pdfCell)

                                            pdfCell = New PdfPCell(New Paragraph(Format(dtGratuite.Rows(j)("PRIX UNITAIRE"), "#,##0"), font1))
                                            pdfCell.MinimumHeight = 15
                                            pdfCell.PaddingLeft = 5.0F
                                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                            pdfTable2.AddCell(pdfCell)

                                            pdfCell = New PdfPCell(New Paragraph(Format(dtGratuite.Rows(j)("QUANTITE"), "#,##0"), font1))
                                            pdfCell.MinimumHeight = 15
                                            pdfCell.PaddingLeft = 5.0F
                                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                            pdfTable2.AddCell(pdfCell)

                                            pdfCell = New PdfPCell(New Paragraph(Format(dtGratuite.Rows(j)("MONTANT TOTAL"), "#,##0"), font1))
                                            pdfCell.MinimumHeight = 15
                                            pdfCell.PaddingLeft = 5.0F
                                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                            pdfTable2.AddCell(pdfCell)

                                        Next

                                    End If

                                    If Double.Parse(totalDesDesVentesDeLaFamille2) > 0 Then

                                        pdfCell = New PdfPCell(New Paragraph("TOTAL", pRow))
                                        pdfCell.MinimumHeight = 15
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.Border = 0
                                        pdfCell.Colspan = 2
                                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfTable2.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(Format(qteDeLaFamille2, "#,##0"), pRow))
                                        pdfCell.MinimumHeight = 15
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.Border = 0
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfTable2.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(Format(totalDesDesVentesDeLaFamille2, "#,##0"), pRow))
                                        pdfCell.MinimumHeight = 15
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.Border = 0
                                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfTable2.AddCell(pdfCell)

                                        'Dim p9 As Paragraph = New Paragraph(" TOTAL : " & Format(totalDesDesVentesDeLaFamille2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                                        'p9.Alignment = Element.ALIGN_CENTER

                                        'pdfDoc.Add(p9)

                                    End If

                                    pdfDoc.Add(pdfTable2)
                                    '----------------------------- END GRATUITE --------------------------

                                Next

                                '------------------------------------------------------------------------

                                Dim p9 As Paragraph = New Paragraph(Chr(13), pRow)
                                p9.Alignment = Element.ALIGN_CENTER

                                pdfDoc.Add(p9)

                                Dim pdfCell4 As PdfPCell = Nothing


                                grandTotal += totalDesDesVentes

                                Dim pdfTable04 As New PdfPTable(2) 'Number of columns

                                pdfTable04.TotalWidth = 520.0F
                                pdfTable04.LockedWidth = True
                                pdfTable04.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfTable04.HeaderRows = 1

                                Dim widths04 As Single() = New Single() {60.0F, 30.0}
                                pdfTable04.SetWidths(widths04)

                                pdfCell4 = New PdfPCell(New Paragraph("TOTAL RECETTES", pRow))
                                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell4.MinimumHeight = 18
                                pdfCell4.PaddingLeft = 15.0F
                                pdfCell4.Border = 0
                                pdfTable04.AddCell(pdfCell4)

                                pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesVentes, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell4.MinimumHeight = 18
                                pdfCell4.PaddingLeft = 15.0F
                                pdfCell4.Border = 0
                                pdfTable04.AddCell(pdfCell4)

                                pdfCell4 = New PdfPCell(New Paragraph("TOTAL GRATUITEES", pRow))
                                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell4.MinimumHeight = 18
                                pdfCell4.PaddingLeft = 15.0F
                                pdfCell4.Border = 0
                                pdfTable04.AddCell(pdfCell4)

                                pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesVentes2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell4.MinimumHeight = 18
                                pdfCell4.PaddingLeft = 15.0F
                                pdfCell4.Border = 0
                                pdfTable04.AddCell(pdfCell4)

                                pdfCell4 = New PdfPCell(New Paragraph("VENTE NET", pRow))
                                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell4.MinimumHeight = 18
                                pdfCell4.PaddingLeft = 15.0F
                                pdfCell4.Border = 0
                                pdfTable04.AddCell(pdfCell4)

                                pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesVentes - totalDesDesVentes2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell4.MinimumHeight = 18
                                pdfCell4.PaddingLeft = 15.0F
                                pdfCell4.Border = 0
                                pdfTable04.AddCell(pdfCell4)

                                pdfDoc.Add(pdfTable04)

                                '-----------------------------------
                                montantVenteResume = totalDesDesVentes

                                totalDesDesVentes = 0
                                totalDesDesVentes2 = 0
                                totalDesDesVentesDeLaFamille2 = 0
                                totalDesDesVentesDeLaFamille = 0

                            End If

                            resumeDesVentes(k).nomEmploye = infoVendeur.Rows(0)("NOM_UTILISATEUR")
                            resumeDesVentes(k).montant = montantVenteResume

                            '--------------------- RESUME DES VENTES GLOBAL ---------------------------

                            ListeDesResumeDesVentes = resumeDesVentesQuotidienne(DateDebut, DateFin, CODE_CAISSIER)

                            If ListeDesResumeDesVentes.Rows.Count > 0 Then

                                Dim compte_ As Double = 0
                                Dim gratuitee_ As Double = 0
                                Dim chambre_ As Double = 0
                                Dim comptoir_ As Double = 0
                                Dim offreEnChambre_ As Double = 0

                                For i = 0 To ListeDesResumeDesVentes.Rows.Count - 1
                                    compte_ += ListeDesResumeDesVentes(i)("COMPTE")
                                    gratuitee_ += ListeDesResumeDesVentes(i)("GRATUITEE")
                                    chambre_ += ListeDesResumeDesVentes(i)("EN_CHAMBRE")
                                    comptoir_ += ListeDesResumeDesVentes(i)("COMPTOIR")
                                    offreEnChambre_ += ListeDesResumeDesVentes(i)("GRATUITE_EN_CHAMBRE")
                                Next

                                Dim pdfTable04 As New PdfPTable(10) 'Number of columns

                                pdfTable04.TotalWidth = 520.0F
                                pdfTable04.LockedWidth = True
                                pdfTable04.HorizontalAlignment = Element.ALIGN_RIGHT
                                'pdfTable04.HeaderRows = 1

                                Dim widths04 As Single() = New Single() {15.0F, 15.0F, 16.0F, 16.0F, 17.0F, 17.0F, 17.0F, 17.0F, 14.0F, 14.0F}
                                pdfTable04.SetWidths(widths04)

                                Dim pdfCell04 As PdfPCell = Nothing

                                pdfCell04 = New PdfPCell(New Paragraph("VENTE COMPTOIR", pRow1))
                                pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell04.MinimumHeight = 10
                                pdfCell04.Colspan = 2
                                pdfCell04.PaddingLeft = 15.0F
                                pdfTable04.AddCell(pdfCell04)

                                pdfCell04 = New PdfPCell(New Paragraph("VENTE EN CHAMBRE", pRow1))
                                pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell04.MinimumHeight = 10
                                pdfCell04.Colspan = 2
                                pdfCell04.PaddingLeft = 15.0F
                                pdfTable04.AddCell(pdfCell04)

                                pdfCell04 = New PdfPCell(New Paragraph("OFFRES EN CHAMBRE", pRow1))
                                pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell04.MinimumHeight = 10
                                pdfCell04.Colspan = 2
                                pdfCell04.PaddingLeft = 15.0F
                                pdfTable04.AddCell(pdfCell04)

                                pdfCell04 = New PdfPCell(New Paragraph("AUTRES OFFRES", pRow1))
                                pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell04.MinimumHeight = 10
                                pdfCell04.Colspan = 2
                                pdfCell04.PaddingLeft = 15.0F
                                pdfTable04.AddCell(pdfCell04)

                                pdfCell04 = New PdfPCell(New Paragraph("VERS COMPTE", pRow1))
                                pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell04.MinimumHeight = 10
                                pdfCell04.Colspan = 2
                                pdfCell04.PaddingLeft = 15.0F
                                pdfTable04.AddCell(pdfCell04)

                                '-------------------------- HEADER END --------------------------

                                pdfCell04 = New PdfPCell(New Paragraph(Format(comptoir_, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                                pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell04.MinimumHeight = 10
                                pdfCell04.Colspan = 2
                                pdfCell04.PaddingLeft = 15.0F
                                pdfTable04.AddCell(pdfCell04)

                                pdfCell04 = New PdfPCell(New Paragraph(Format(chambre_, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                                pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell04.MinimumHeight = 10
                                pdfCell04.Colspan = 2
                                pdfCell04.PaddingLeft = 15.0F
                                pdfTable04.AddCell(pdfCell04)

                                pdfCell04 = New PdfPCell(New Paragraph(Format(offreEnChambre_, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                                pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell04.MinimumHeight = 10
                                pdfCell04.Colspan = 2
                                pdfCell04.PaddingLeft = 15.0F
                                pdfTable04.AddCell(pdfCell04)

                                pdfCell04 = New PdfPCell(New Paragraph(Format(gratuitee_ - offreEnChambre_, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                                pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell04.MinimumHeight = 10
                                pdfCell04.Colspan = 2
                                pdfCell04.PaddingLeft = 15.0F
                                pdfTable04.AddCell(pdfCell04)

                                pdfCell04 = New PdfPCell(New Paragraph(Format(compte_, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                                pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell04.MinimumHeight = 10
                                pdfCell04.Colspan = 2
                                pdfCell04.PaddingLeft = 15.0F
                                pdfTable04.AddCell(pdfCell04)

                                pdfDoc.Add(pdfTable04)

                            End If
                            '--------------------------------------------------------------------------
                        End If

                    Next

                    '------------------------------------------------------ RESUME DES VENTES DU CAISSIER ------------------------------------------------------------------------------

                    Dim p04 As Paragraph = New Paragraph(Chr(13) & " RESUME DES VENTES " & Chr(13) & Chr(13), pRow)
                    p04.Alignment = Element.ALIGN_CENTER
                    pdfDoc.Add(p04)

                    Dim pdfTable01 As New PdfPTable(2) 'Number of columns
                    pdfTable01.TotalWidth = 520.0F
                    pdfTable01.LockedWidth = True
                    pdfTable01.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable01.HeaderRows = 1

                    Dim widths01 As Single() = New Single() {50.0F, 20.0F}
                    pdfTable01.SetWidths(widths01)

                    For l = 0 To listeDesVendeurs.Rows.Count - 1

                        If resumeDesVentes(l).montant > 0 Then

                            pdfCell = New PdfPCell(New Paragraph(resumeDesVentes(l).nomEmploye, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 15.0F

                            pdfTable01.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(resumeDesVentes(l).montant, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 15.0F

                            pdfTable01.AddCell(pdfCell)

                        End If

                    Next

                    pdfCell = New PdfPCell(New Paragraph("GRAND TOTAL :", pRow))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    pdfCell.PaddingLeft = 15.0F
                    pdfTable01.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(grandTotal, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 5
                    pdfCell.PaddingLeft = 15.0F
                    pdfTable01.AddCell(pdfCell)

                    pdfDoc.Add(pdfTable01)

                    Dim p002 As Paragraph = New Paragraph(Chr(13) & "Arrêter la présente à la somme de : " & Functions.NBLT(grandTotal) & " " & societe.Rows(0)("CODE_MONNAIE") & Chr(13) & Chr(13), pRow)
                    p002.Alignment = Element.ALIGN_LEFT

                    pdfDoc.Add(p002)

                    '--------------------- RESUME DES VENTES GLOBAL ---------------------------

                    ListeDesResumeDesVentes = resumeDesVentesGlobal(DateDebut, DateFin)

                    If ListeDesResumeDesVentes.Rows.Count > 0 Then

                        Dim compte As Double = 0
                        Dim gratuitee As Double = 0
                        Dim chambre As Double = 0
                        Dim comptoir As Double = 0
                        Dim offreEnChambre As Double = 0

                        For i = 0 To ListeDesResumeDesVentes.Rows.Count - 1
                            compte += ListeDesResumeDesVentes(i)("COMPTE")
                            gratuitee += ListeDesResumeDesVentes(i)("GRATUITEE")
                            chambre += ListeDesResumeDesVentes(i)("EN_CHAMBRE")
                            comptoir += ListeDesResumeDesVentes(i)("COMPTOIR")
                            offreEnChambre += ListeDesResumeDesVentes(i)("GRATUITE_EN_CHAMBRE")
                        Next

                        Dim pdfTable04 As New PdfPTable(10) 'Number of columns

                        pdfTable04.TotalWidth = 520.0F
                        pdfTable04.LockedWidth = True
                        pdfTable04.HorizontalAlignment = Element.ALIGN_RIGHT
                        'pdfTable04.HeaderRows = 1

                        Dim widths04 As Single() = New Single() {15.0F, 15.0F, 16.0F, 16.0F, 17.0F, 17.0F, 17.0F, 17.0F, 14.0F, 14.0F}
                        pdfTable04.SetWidths(widths04)

                        Dim pdfCell04 As PdfPCell = Nothing

                        pdfCell04 = New PdfPCell(New Paragraph("VENTE COMPTOIR", pRow1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph("VENTE EN CHAMBRE", pRow1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph("OFFRES EN CHAMBRE", pRow1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph("AUTRES OFFRES", pRow1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph("VERS COMPTE", pRow1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        '-------------------------- HEADER END --------------------------

                        pdfCell04 = New PdfPCell(New Paragraph(Format(comptoir, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph(Format(chambre, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph(Format(offreEnChambre, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph(Format(gratuitee - offreEnChambre, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph(Format(compte, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfDoc.Add(pdfTable04)

                    End If
                    '--------------------------------------------------------------------------

                Else

                End If

            ElseIf Not Trim(CODE_UTILISATEUR) = "" Then

                Dim CODE_CAISSIER As String = CODE_UTILISATEUR

                Dim infoVendeur As DataTable = Functions.getElementByCode(CODE_UTILISATEUR, "utilisateurs", "CODE_UTILISATEUR")

                If infoVendeur.Rows.Count > 0 Then

                    Dim p02 As Paragraph = New Paragraph("Journal des ventes de : " & infoVendeur.Rows(0)("NOM_UTILISATEUR") & Chr(13) & Chr(13), pRow)
                    p02.Alignment = Element.ALIGN_LEFT

                    pdfDoc.Add(p02)

                    Dim ligneFacture As New LigneFacture()
                    Dim dtCategoryParent As DataTable = ligneFacture.ListeDesCategoriesDArticleVendus(DateDebut, DateFin)

                    If dtCategoryParent.Rows.Count > 0 Then

                        For i = 0 To dtCategoryParent.Rows.Count - 1
                            'VENTES
                            Dim pdfTable As New PdfPTable(4) 'Number of columns
                            pdfTable.TotalWidth = 520.0F
                            pdfTable.LockedWidth = True
                            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.HeaderRows = 1

                            Dim widths As Single() = New Single() {60.0F, 15.0F, 10.0F, 15.0F}

                            pdfTable.SetWidths(widths)

                            totalDesDesVentesDeLaFamille = 0

                            Dim CategoriePArent As String = dtCategoryParent.Rows(i)("SOUS FAMILLE")

                            Dim p2 As Paragraph = New Paragraph(i + 1 & "-" & CategoriePArent & Chr(13) & Chr(13), pRow)
                            p2.Alignment = Element.ALIGN_LEFT

                            pdfDoc.Add(p2)

                            pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable.AddCell(pdfCell)

                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            'pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable.AddCell(pdfCell)

                            'ARTICLE D'UNE FAMILLE QUELCONQUE

                            Dim dt As DataTable

                            dt = ligneFacture.ListeDesArticlesVendusParFamilleDunCaissier(CategoriePArent, DateDebut, DateFin, CODE_CAISSIER)

                            If dt.Rows.Count > 0 Then

                                For j = 0 To dt.Rows.Count - 1

                                    totalDesDesVentesDeLaFamille += dt.Rows(j)("MONTANT TOTAL")
                                    totalDesDesVentes += dt.Rows(j)("MONTANT TOTAL")

                                    pdfCell = New PdfPCell(New Paragraph(dt.Rows(j)("LIBELLE ARTICLE"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j)("PRIX UNITAIRE"), "#,##0"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                    pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j)("QUANTITE"), "#,##0"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j)("MONTANT TOTAL"), "#,##0"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                    pdfTable.AddCell(pdfCell)

                                Next

                            End If

                            pdfDoc.Add(pdfTable)

                            Dim p5 As Paragraph = New Paragraph(" TOTAL : " & Format(totalDesDesVentesDeLaFamille, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                            p5.Alignment = Element.ALIGN_CENTER

                            pdfDoc.Add(p5)

                            '---------------------GRATUITE----------------------------------

                            Dim p7 As Paragraph = New Paragraph(Chr(13) & " GRATUITES : " & Chr(13) & Chr(13), pRow)
                            p7.Alignment = Element.ALIGN_CENTER

                            Dim pdfTable2 As New PdfPTable(4) 'Number of columns
                            pdfTable2.TotalWidth = 520.0F
                            pdfTable2.LockedWidth = True
                            pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable2.HeaderRows = 1

                            Dim widths2 As Single() = New Single() {60.0F, 15.0F, 10.0F, 15.0F}

                            pdfTable2.SetWidths(widths2)

                            totalDesDesVentesDeLaFamille2 = 0

                            Dim ligneFacture2 As New LigneFacture()
                            'Dim CategoriePArent2 As String = dtCategoryParent.Rows(i)("SOUS FAMILLE")

                            Dim p8 As Paragraph = New Paragraph("FAMILLE D'ARTICLE: " & CategoriePArent & Chr(13) & Chr(13), font1)
                            p8.Alignment = Element.ALIGN_LEFT

                            'pdfDoc.Add(p2)

                            pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable2.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            pdfTable2.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable2.AddCell(pdfCell)

                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            'pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable2.AddCell(pdfCell)

                            'ARTICLE D'UNE FAMILLE QUELCONQUE
                            Dim dtGratuite As DataTable = ligneFacture.ListeDesArticlesVendusGratuitementParFamilleCaissier(CategoriePArent, DateDebut, DateFin, CODE_CAISSIER)

                            If dtGratuite.Rows.Count > 0 Then

                                pdfDoc.Add(p7)

                                totalDesDesVentesDeLaFamille2 = 0

                                For j = 0 To dtGratuite.Rows.Count - 1

                                    totalDesDesVentesDeLaFamille2 += dtGratuite.Rows(j)("MONTANT TOTAL")
                                    totalDesDesVentes2 += dtGratuite.Rows(j)("MONTANT TOTAL")

                                    pdfCell = New PdfPCell(New Paragraph(dtGratuite.Rows(j)("LIBELLE ARTICLE"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfTable2.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(dtGratuite.Rows(j)("PRIX UNITAIRE"), "#,##0"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                    pdfTable2.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(dtGratuite.Rows(j)("QUANTITE"), "#,##0"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfTable2.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(dtGratuite.Rows(j)("MONTANT TOTAL"), "#,##0"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                    pdfTable2.AddCell(pdfCell)

                                Next

                            End If

                            pdfDoc.Add(pdfTable2)

                            If Double.Parse(totalDesDesVentesDeLaFamille2) > 0 Then

                                Dim p9 As Paragraph = New Paragraph(" TOTAL : " & Format(totalDesDesVentesDeLaFamille2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                                p9.Alignment = Element.ALIGN_CENTER

                                pdfDoc.Add(p9)

                            End If

                            '----------------------------- END GRATUITE --------------------------

                        Next

                        Dim p4 As Paragraph = New Paragraph(Chr(13) & " TOTAL DES VENTES : " & Format(totalDesDesVentes, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                        p4.Alignment = Element.ALIGN_CENTER

                        pdfDoc.Add(p4)

                        Dim p10 As Paragraph = New Paragraph(" TOTAL DES GRATUITEES : " & Format(totalDesDesVentes2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                        p10.Alignment = Element.ALIGN_CENTER

                        pdfDoc.Add(p10)

                        Dim p11 As Paragraph = New Paragraph(" NET PERCU : " & Format(totalDesDesVentes - totalDesDesVentes2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                        p11.Alignment = Element.ALIGN_CENTER

                        pdfDoc.Add(p11)

                        '-----------------------------------

                        Dim p002 As Paragraph = New Paragraph(Chr(13) & "Arrêter la présente à la somme de : " & Functions.NBLT(totalDesDesVentes) & " " & societe.Rows(0)("CODE_MONNAIE") & Chr(13) & Chr(13), pRow)
                        p002.Alignment = Element.ALIGN_LEFT

                        pdfDoc.Add(p002)

                        Dim pdfTable4 As New PdfPTable(1) 'Number of columns

                        pdfTable4.TotalWidth = 520.0F
                        pdfTable4.LockedWidth = True
                        pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
                        'pdfTable4.HeaderRows = 1

                        Dim widths4 As Single() = New Single() {30.0F}
                        pdfTable4.SetWidths(widths4)

                        Dim pdfCell4 As PdfPCell = Nothing

                        pdfCell4 = New PdfPCell(New Paragraph(Chr(13) & "Signature ", pRow))
                        pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell4.MinimumHeight = 18
                        pdfCell4.PaddingLeft = 15.0F
                        pdfCell4.Border = 0
                        pdfTable4.AddCell(pdfCell4)

                        'pdfDoc.Add(pdfTable4)

                    End If

                    '-------------------------- RESUME DES VENTES --------------------------------

                    ListeDesResumeDesVentes = resumeDesVentesQuotidienne(DateDebut, DateFin, CODE_UTILISATEUR)

                    If ListeDesResumeDesVentes.Rows.Count > 0 Then

                        Dim compte As Double = 0
                        Dim gratuitee As Double = 0
                        Dim chambre As Double = 0
                        Dim comptoir As Double = 0
                        Dim offreEnChambre As Double = 0

                        For i = 0 To ListeDesResumeDesVentes.Rows.Count - 1
                            compte += ListeDesResumeDesVentes(i)("COMPTE")
                            gratuitee += ListeDesResumeDesVentes(i)("GRATUITEE")
                            chambre += ListeDesResumeDesVentes(i)("EN_CHAMBRE")
                            comptoir += ListeDesResumeDesVentes(i)("COMPTOIR")
                            offreEnChambre += ListeDesResumeDesVentes(i)("GRATUITE_EN_CHAMBRE")
                        Next

                        Dim pdfTable04 As New PdfPTable(10) 'Number of columns

                        pdfTable04.TotalWidth = 520.0F
                        pdfTable04.LockedWidth = True
                        pdfTable04.HorizontalAlignment = Element.ALIGN_RIGHT
                        'pdfTable04.HeaderRows = 1

                        Dim widths04 As Single() = New Single() {15.0F, 15.0F, 16.0F, 16.0F, 17.0F, 17.0F, 17.0F, 17.0F, 14.0F, 14.0F}
                        pdfTable04.SetWidths(widths04)

                        Dim pdfCell04 As PdfPCell = Nothing

                        pdfCell04 = New PdfPCell(New Paragraph("VENTE COMPTOIR", pRow1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph("VENTE EN CHAMBRE", pRow1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph("OFFRES EN CHAMBRE", pRow1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph("AUTRES OFFRES", pRow1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph("VERS COMPTE", pRow1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        '-------------------------- HEADER END --------------------------

                        pdfCell04 = New PdfPCell(New Paragraph(Format(comptoir, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph(Format(chambre, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph(Format(offreEnChambre, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph(Format(gratuitee - offreEnChambre, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfCell04 = New PdfPCell(New Paragraph(Format(compte, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                        pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell04.MinimumHeight = 10
                        pdfCell04.Colspan = 2
                        pdfCell04.PaddingLeft = 15.0F
                        pdfTable04.AddCell(pdfCell04)

                        pdfDoc.Add(pdfTable04)

                    End If
                    '-----------------------------------------------------------------------------
                End If

            End If

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub ficheInventaireJournalierBar(ByVal dt As DataGridView, ByVal DateDebut As Date, ByVal DateFin As Date, Optional ByVal CODE_CAISSIER As String = "")

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0
        Dim tireDocument As String = ""

        If Not Trim(CODE_CAISSIER) = "" Then

            Dim infoUser As DataTable = Functions.getElementByCode(CODE_CAISSIER, "utilisateur", "CODE_UTILISATEUR")

            Dim UTILISATEUR As String = ""

            If infoUser.Rows.Count > 0 Then
                UTILISATEUR = infoUser.Rows(0)("NOM_UTILISATEUR")
            End If

            tireDocument = "Inventaire des ventes " & UTILISATEUR & " " & Date.Now().ToString("ddMMyyHHmmss") & " "
        Else
            tireDocument = "Fiche d'inventaire Journalier du Bar " & GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR") & " " & Date.Now().ToString("ddMMyyHHmmss") & " "
        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 40, 40)
            'Dim pdfDoc As New Document(PageSize.B7, 5, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            Dim pdfCell As PdfPCell = Nothing

            'pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & "***", pColumn)
            p1.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p1)

            Dim p3 As Paragraph = New Paragraph(Date.Now() & Chr(13), pColumn)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            If DateDebut = DateFin Then

                Dim p0 As Paragraph = New Paragraph(Chr(13) & " INVETAIRE JOURNALIER DU BAR : " & DateDebut & Chr(13) & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            End If

            'VENTES
            Dim pdfTable As New PdfPTable(9) 'Number of columns
            pdfTable.TotalWidth = 530.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single() = New Single() {70.0F, 15.0F, 15.0F, 15.0F, 15.0F, 15.0F, 15.0F, 15.0F, 15.0F}

            pdfTable.SetWidths(widths)

            pdfCell = New PdfPCell(New Paragraph("", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            pdfCell.Border = 0
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("STOCKS DU SHIFT DU MATIN", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            pdfCell.Colspan = 4
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("STOCKS DU SHIFT DU SOIR", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            pdfCell.Colspan = 4
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("INITIAL", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("ENTREE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfCell.PaddingLeft = 5.0F
            pdfTable.AddCell(pdfCell)

            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            'pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("SORTIE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("FINAL", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("INITIAL", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("ENTREE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfCell.PaddingLeft = 5.0F
            pdfTable.AddCell(pdfCell)

            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            'pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("SORTIE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("FINAL", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            'ARTICLE D'UNE FAMILLE QUELCONQUE

            If dt.Rows.Count > 0 Then

                Dim ordre As Integer = 0

                Dim qteAfficherCorrectement As Double = 0
                Dim CODE_ARTICLE As String = ""

                For j = 0 To dt.Rows.Count - 1
                    ordre += 1
                    For k = 0 To dt.Columns.Count - 2

                        CODE_ARTICLE = dt.Rows(j).Cells("CODE_ARTICLE").Value.ToString

                        If k = 0 Then

                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells(k).Value.ToString, font1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                        Else

                            qteAfficherCorrectement = Functions.affichageQteDansUnFormatCorrect(CODE_ARTICLE, dt.Rows(j).Cells(k).Value)

                            pdfCell = New PdfPCell(New Paragraph(qteAfficherCorrectement, font1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        End If

                        If k = 4 Then
                            'totalDesDesVentes += dt.Rows(j).Cells(k).Value
                        End If

                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable.AddCell(pdfCell)

                    Next

                Next

                pdfDoc.Add(pdfTable)

                'Dim p4 As Paragraph = New Paragraph(Chr(13) & " TOTAL DES VENTES : " & Format(totalDesDesVentes, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                ' p4.Alignment = Element.ALIGN_CENTER
                'pdfDoc.Add(p4)

                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Process.Start(sfd.FileName)

            Else
                MessageBox.Show("Aucun Document à imprimer", "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            End If

        End If

    End Sub


    Public Shared Sub inventaireDesVentesParMagasin(ByVal DateDebut As Date, ByVal DateFin As Date, ByVal CODE_CAISSIER As String, ByVal LIBELLE As String)

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0
        Dim tireDocument As String = ""

        If Not Trim(CODE_CAISSIER) = "" Then

            Dim infoUser As DataTable = Functions.getElementByCode(CODE_CAISSIER, "utilisateurs", "CODE_UTILISATEUR")

            Dim UTILISATEUR As String = ""

            If infoUser.Rows.Count > 0 Then
                UTILISATEUR = infoUser.Rows(0)("NOM_UTILISATEUR")
            End If

            tireDocument = LIBELLE & UTILISATEUR & " " & Date.Now().ToString("ddMMyyHHmmss") & " "
        Else
            tireDocument = LIBELLE & GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR") & " " & Date.Now().ToString("ddMMyyHHmmss") & " "
        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 40, 40)
            'Dim pdfDoc As New Document(PageSize.B7, 5, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            Dim pdfCell As PdfPCell = Nothing

            'pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & "***", pColumn)
            p1.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p1)

            'Dim p3 As Paragraph = New Paragraph(Date.Now() & Chr(13), pColumn)
            'p3.Alignment = Element.ALIGN_CENTER

            'pdfDoc.Add(p3)

            If DateDebut = DateFin Then

                Dim p0 As Paragraph = New Paragraph(Chr(13) & LIBELLE & DateDebut & Chr(13) & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            Else

                Dim p0 As Paragraph = New Paragraph(Chr(13) & LIBELLE & DateDebut & " AU " & DateFin & Chr(13) & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            End If

            Dim dt As DataTable

            Dim totalDesDesVentes As Double = 0
            Dim totalDesDesVentes2 As Double = 0

            'VENTES

            'ARTICLE D'UNE FAMILLE QUELCONQUE

            Dim ligne_facture As New LigneFacture()

            'Dim diversCodeMagasin As DataTable = ligne_facture.ListeDesArticlesVendusInventaireParFamilleMagasin(DateDebut, DateFin, CODE_CAISSIER, CategoriePArent)
            Dim diversCodeMagasin As DataTable = ligne_facture.ListeDesPointsDeVente(DateDebut, DateFin, CODE_CAISSIER)

            Dim resumeDesVentes(diversCodeMagasin.Rows.Count) As resumeInfo

            If diversCodeMagasin.Rows.Count > 0 Then

                'ON TRAITE LES DIVERS POINT DE VENTE
                Dim infoSupDuMagasin As New DataTable()
                Dim CODE_MAGASIN As String = ""

                For m = 0 To diversCodeMagasin.Rows.Count - 1

                    '------------------------------------------------------------------------------------------------------------------------------
                    Dim pdfTable As New PdfPTable(6) 'Number of columns
                    pdfTable.TotalWidth = 520.0F
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.HeaderRows = 1

                    Dim widths As Single() = New Single() {65.0F, 10.0F, 15.0F, 18.0F, 20.0F, 20.0F}

                    pdfTable.SetWidths(widths)

                    pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("P. UNI", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    'pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("P. ACHAT", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("MARGE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)
                    '------------------------------------------------------------------------------------------------------------------------------

                    totalDesDesVentes = 0
                    totalDesDesVentes2 = 0

                    CODE_MAGASIN = diversCodeMagasin.Rows(m)("CODE_MAGASIN")
                    infoSupDuMagasin = Functions.getElementByCode(CODE_MAGASIN, "magasin", "CODE_MAGASIN")

                    If infoSupDuMagasin.Rows.Count > 0 Then

                        Dim nomDuMagasin As String = infoSupDuMagasin.Rows(0)("LIBELLE_MAGASIN")

                        Dim p02 As Paragraph = New Paragraph(Chr(13) & " -/ " & infoSupDuMagasin.Rows(0)("LIBELLE_MAGASIN") & Chr(13) & Chr(13), pRow)
                        p02.Alignment = Element.ALIGN_CENTER

                        Dim totalQuantite As Double = 0
                        Dim totalAchat As Double = 0
                        Dim totalMarge As Double = 0

                        dt = ligne_facture.ListeDesArticlesVendusInventaireMagasin(DateDebut, DateFin, CODE_CAISSIER, CODE_MAGASIN)

                        If dt.Rows.Count > 0 Then

                            pdfDoc.Add(p02)

                            Dim ordre As Integer = 0

                            '-----------------------------------------------------------------------

                            Dim articleIndividuel As New DataTable()

                            For i = 0 To dt.Rows.Count - 1

                                ordre += 1

                                Dim CODE_ARTICLE As String = dt.Rows(i)("CODE_ARTICLE")
                                'Dim LIBELLE_FACTURE As String = ListeDesVentes.Rows(i)("LIBELLE_FACTURE")

                                Dim LIBELLE_FACTURE As String = ""

                                Dim PA As Double = 0

                                Dim infoArticle As DataTable = Functions.getElementByCode(CODE_ARTICLE, "article", "CODE_ARTICLE")

                                If infoArticle.Rows.Count > 0 Then
                                    LIBELLE_FACTURE = infoArticle.Rows(0)("DESIGNATION_FR")
                                    PA = infoArticle.Rows(0)("COUT_U_MOYEN_PONDERE")
                                    totalAchat += PA
                                End If

                                Dim PRIXMOYENUNITAIRE As Double = 0
                                Dim QUANTITE As Double = 0
                                Dim MONTANT As Double = 0

                                articleIndividuel = ligne_facture.ListeDesArticlesVendusInventaireIndividuelMagasin(DateDebut, DateFin, CODE_CAISSIER, CODE_ARTICLE, CODE_MAGASIN)

                                For j = 0 To articleIndividuel.Rows.Count - 1

                                    QUANTITE += articleIndividuel.Rows(j)("QUANTITE")
                                    MONTANT += articleIndividuel.Rows(j)("MONTANT TOTAL")

                                    If QUANTITE > 0 Then
                                        PRIXMOYENUNITAIRE = MONTANT / QUANTITE
                                    End If

                                Next

                                Dim MARGE As Double = MONTANT - (QUANTITE * PA)

                                totalQuantite += QUANTITE
                                totalMarge += MARGE
                                totalDesDesVentes += MONTANT

                                pdfCell = New PdfPCell(New Paragraph(ordre & "- " & LIBELLE_FACTURE, font1))
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F

                                pdfTable.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(QUANTITE, "#,##0"), font1))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F

                                pdfTable.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(PRIXMOYENUNITAIRE, "#,##0"), font1))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F

                                pdfTable.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(PA, "#,##0"), font1))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F

                                pdfTable.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(MONTANT, "#,##0"), font1))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F

                                pdfTable.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(MARGE, "#,##0"), font1))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F

                                pdfTable.AddCell(pdfCell)

                                'DataGridViewFactures.Rows.Add(LIBELLE_FACTURE, QUANTITE, PRIXMOYENUNITAIRE, PA, MONTANT, MARGE)

                            Next

                            pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(totalQuantite, "#,##0"), pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.Border = 0
                            pdfTable.AddCell(pdfCell)

                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            'pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(totalDesDesVentes - totalMarge, "#,##0"), pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(totalDesDesVentes, "#,##0"), pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(totalMarge, "#,##0"), pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable.AddCell(pdfCell)

                            pdfDoc.Add(pdfTable)

                            Dim p4 As Paragraph = New Paragraph(Chr(13) & " TOTAL DES VENTES : " & Format(totalDesDesVentes, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                            p4.Alignment = Element.ALIGN_RIGHT
                            pdfDoc.Add(p4)

                        End If

                        resumeDesVentes(m).nomEmploye = nomDuMagasin
                        resumeDesVentes(m).montant = totalDesDesVentes

                    End If

                Next

                ''-------------------------------------- RESUME DES VENTES ---------------------------

                Dim p04 As Paragraph = New Paragraph(Chr(13) & " RESUME DES VENTES " & Chr(13) & Chr(13), pRow)
                p04.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p04)

                Dim pdfTable01 As New PdfPTable(2) 'Number of columns
                pdfTable01.TotalWidth = 520.0F
                pdfTable01.LockedWidth = True
                'pdfTable01.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.HeaderRows = 1

                Dim widths01 As Single() = New Single() {50.0F, 20.0F}
                pdfTable01.SetWidths(widths01)

                Dim grandTotal As Double = 0

                For l = 0 To diversCodeMagasin.Rows.Count - 1

                    If resumeDesVentes(l).montant > 0 Then

                        pdfCell = New PdfPCell(New Paragraph(resumeDesVentes(l).nomEmploye, pRow))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 15.0F

                        pdfTable01.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(resumeDesVentes(l).montant, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 15.0F

                        pdfTable01.AddCell(pdfCell)

                        grandTotal += resumeDesVentes(l).montant

                    End If

                Next

                pdfCell = New PdfPCell(New Paragraph("GRAND TOTAL :", pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                pdfCell.PaddingLeft = 15.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(grandTotal, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 5
                pdfCell.PaddingLeft = 15.0F
                pdfTable01.AddCell(pdfCell)

                pdfDoc.Add(pdfTable01)

                Dim p002 As Paragraph = New Paragraph(Chr(13) & "Arrêter la présente à la somme de : " & Functions.NBLT(grandTotal) & " " & societe.Rows(0)("CODE_MONNAIE") & Chr(13) & Chr(13), pRow)
                p002.Alignment = Element.ALIGN_LEFT

                pdfDoc.Add(p002)

                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Process.Start(sfd.FileName)

            End If

        End If

    End Sub

    Public Shared Sub inventaireDesVentes(ByVal dt As DataGridView, ByVal DateDebut As Date, ByVal DateFin As Date, ByVal CODE_CAISSIER As String, ByVal LIBELLE As String)

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0
        Dim tireDocument As String = ""

        If Not Trim(CODE_CAISSIER) = "" Then

            Dim infoUser As DataTable = Functions.getElementByCode(CODE_CAISSIER, "utilisateurs", "CODE_UTILISATEUR")

            Dim UTILISATEUR As String = ""

            If infoUser.Rows.Count > 0 Then
                UTILISATEUR = infoUser.Rows(0)("NOM_UTILISATEUR")
            End If

            tireDocument = LIBELLE & UTILISATEUR & " " & Date.Now().ToString("ddMMyyHHmmss") & " "
        Else
            tireDocument = LIBELLE & GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR") & " " & Date.Now().ToString("ddMMyyHHmmss") & " "
        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 40, 40)
            'Dim pdfDoc As New Document(PageSize.B7, 5, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            Dim pdfCell As PdfPCell = Nothing

            'pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & "***", pColumn)
            p1.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p1)

            'Dim p3 As Paragraph = New Paragraph(Date.Now() & Chr(13), pColumn)
            'p3.Alignment = Element.ALIGN_CENTER

            'pdfDoc.Add(p3)

            If DateDebut = DateFin Then

                Dim p0 As Paragraph = New Paragraph(Chr(13) & LIBELLE & DateDebut & Chr(13) & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            Else

                Dim p0 As Paragraph = New Paragraph(Chr(13) & LIBELLE & DateDebut & " AU " & DateFin & Chr(13) & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            End If

            Dim totalDesDesVentes As Double = 0

            'VENTES
            Dim pdfTable As New PdfPTable(7) 'Number of columns
            pdfTable.TotalWidth = 520.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single() = New Single() {60.0F, 15.0F, 15.0F, 15.0F, 15.0F, 18.0F, 18.0F}

            pdfTable.SetWidths(widths)

            pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("QTE VENDU", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("STOCK", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            pdfTable.AddCell(pdfCell)

            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            'pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("P. ACHAT", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("RECETTE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("PROFIT BRUT", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            'ARTICLE D'UNE FAMILLE QUELCONQUE

            Dim totalQuantite As Double = 0
            Dim totalAchat As Double = 0
            Dim totalMarge As Double = 0

            If dt.Rows.Count > 0 Then

                Dim ordre As Integer = 0

                For j = 0 To dt.Rows.Count - 1
                    ordre += 1
                    For k = 0 To dt.Columns.Count - 1

                        If k = 0 Then
                            pdfCell = New PdfPCell(New Paragraph(ordre & "- " & dt.Rows(j).Cells(k).Value.ToString, font1))
                            'pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells(k).Value.ToString, font1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        ElseIf k = 1 Or k = 2 Then

                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j).Cells(k).Value, "#,##0.00"), font1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                            If k = 1 Then
                                totalQuantite += dt.Rows(j).Cells(k).Value
                            End If

                        Else
                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j).Cells(k).Value, "#,##0"), font1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                            If k = 4 Then
                                totalAchat += dt.Rows(j).Cells(k).Value
                            ElseIf k = 5 Then
                                totalDesDesVentes += dt.Rows(j).Cells(k).Value
                            ElseIf k = 6 Then
                                totalMarge += dt.Rows(j).Cells(k).Value
                            End If

                        End If

                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable.AddCell(pdfCell)

                    Next

                Next

                pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.Border = 0
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(totalQuantite, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Border = 0
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Border = 0
                pdfCell.Border = 0
                pdfTable.AddCell(pdfCell)

                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                'pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.Border = 0
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(totalDesDesVentes - totalMarge, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.Border = 0
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(totalDesDesVentes, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.Border = 0
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(totalMarge, "#,##0"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 15
                pdfCell.Border = 0
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

                Dim p4 As Paragraph = New Paragraph(Chr(13) & " TOTAL DES VENTES : " & Format(totalDesDesVentes, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                p4.Alignment = Element.ALIGN_CENTER
                'pdfDoc.Add(p4)

                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Process.Start(sfd.FileName)

            Else
                MessageBox.Show("Aucun Document à imprimer", "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            End If

        End If

    End Sub

    'INVENTAIRE DES VENTES PAR FAMILLE ET PAR MAGASIN
    Public Shared Sub inventaireDesVentesParFamilleMagasin(ByVal DateDebut As Date, ByVal DateFin As Date, ByVal CODE_CAISSIER As String, ByVal LIBELLE As String)

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0

        Dim tireDocument As String = ""

        If Not Trim(CODE_CAISSIER) = "" Then

            Dim infoUser As DataTable = Functions.getElementByCode(CODE_CAISSIER, "utilisateurs", "CODE_UTILISATEUR")

            Dim UTILISATEUR As String = ""

            If infoUser.Rows.Count > 0 Then
                UTILISATEUR = infoUser.Rows(0)("NOM_UTILISATEUR")
            End If

            tireDocument = LIBELLE & UTILISATEUR & " " & Date.Now().ToString("ddMMyyHHmmss") & " "
        Else
            tireDocument = LIBELLE & GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR") & " " & Date.Now().ToString("ddMMyyHHmmss") & " "
        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 40, 40)
            'Dim pdfDoc As New Document(PageSize.B7, 5, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            Dim pdfCell As PdfPCell = Nothing

            'pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & "***", pColumn)
            p1.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p1)

            Dim p3 As Paragraph = New Paragraph(DateDebut & " AU " & DateFin & Chr(13), pColumn)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            If DateDebut = DateFin Then

                Dim p0 As Paragraph = New Paragraph(Chr(13) & LIBELLE & DateDebut & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            Else

                Dim p0 As Paragraph = New Paragraph(Chr(13) & LIBELLE & DateDebut & Chr(13) & " AU " & DateFin, pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            End If

            Dim totalDesDesVentesDeLaFamille As Double = 0
            Dim totalDesDesVentes As Double = 0
            Dim totalQuantiteFamille As Integer = 0
            Dim profitBrut As Integer = 0
            Dim recette As Integer = 0
            Dim totalDesDesMargesDeLaFamille As Double = 0
            Dim totalDesDesMarges As Double = 0

            Dim totalQuantiteFamille2 As Integer = 0
            Dim recetteGratuitee As Integer = 0
            Dim margeGratuitee As Integer = 0
            Dim totalDesDesVentesDeLaFamille2 As Double = 0
            Dim totalDesDesVentes2 As Double = 0
            Dim totalDesDesMargesDeLaFamille2 As Double = 0
            Dim totalDesDesMarges2 As Double = 0

            'SELECTION DES DIVERS MAGASIN
            Dim ligne_facture As New LigneFacture()

            'Dim diversCodeMagasin As DataTable = ligne_facture.ListeDesArticlesVendusInventaireParFamilleMagasin(DateDebut, DateFin, CODE_CAISSIER, CategoriePArent)
            Dim diversCodeMagasin As DataTable = ligne_facture.ListeDesPointsDeVente(DateDebut, DateFin, CODE_CAISSIER)
            Dim resumeDesVentes(diversCodeMagasin.Rows.Count) As resumeInfo

            If diversCodeMagasin.Rows.Count > 0 Then

                'ON TRAITE LES DIVERS POINT DE VENTE
                Dim infoSupDuMagasin As New DataTable()
                Dim CODE_MAGASIN As String = ""

                For m = 0 To diversCodeMagasin.Rows.Count - 1

                    totalDesDesVentes = 0
                    totalDesDesVentes2 = 0

                    CODE_MAGASIN = diversCodeMagasin.Rows(m)("CODE_MAGASIN")
                    infoSupDuMagasin = Functions.getElementByCode(CODE_MAGASIN, "magasin", "CODE_MAGASIN")

                    If infoSupDuMagasin.Rows.Count > 0 Then

                        Dim nomDuMagasin As String = infoSupDuMagasin.Rows(0)("LIBELLE_MAGASIN")

                        Dim p02 As Paragraph = New Paragraph(Chr(13) & infoSupDuMagasin.Rows(0)("LIBELLE_MAGASIN") & Chr(13) & Chr(13), pRow)
                        p02.Alignment = Element.ALIGN_CENTER

                        'SELCTION DES DIVERS FAMILLE VENDU POUR LE MAGASIN EN QUESTION

                        Dim ligneFacture As New LigneFacture()
                        Dim dtCategoryParent As DataTable = ligneFacture.ListeDesCategoriesDArticleVendusMagasin(DateDebut, DateFin, CODE_CAISSIER, CODE_MAGASIN)

                        If dtCategoryParent.Rows.Count > 0 Then

                            pdfDoc.Add(p02)

                            For i = 0 To dtCategoryParent.Rows.Count - 1

                                totalDesDesVentesDeLaFamille = 0
                                totalDesDesVentesDeLaFamille2 = 0
                                totalDesDesMargesDeLaFamille = 0
                                totalDesDesMargesDeLaFamille2 = 0
                                totalQuantiteFamille = 0
                                totalQuantiteFamille2 = 0

                                'VENTES
                                Dim pdfTable As New PdfPTable(6) 'Number of columns
                                pdfTable.TotalWidth = 520.0F
                                pdfTable.LockedWidth = True
                                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfTable.HeaderRows = 1

                                Dim widths As Single() = New Single() {60.0F, 10.0F, 15.0F, 20.0F, 20.0F, 20.0F}

                                pdfTable.SetWidths(widths)

                                Dim CategoriePArent As String = dtCategoryParent.Rows(i)("SOUS FAMILLE")

                                Dim p2 As Paragraph = New Paragraph(i + 1 & " - " & CategoriePArent & Chr(13) & Chr(13), pRow)
                                p2.Alignment = Element.ALIGN_LEFT

                                pdfDoc.Add(p2)

                                pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 15
                                'pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 15
                                'pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 15
                                'pdfCell.PaddingLeft = 5.0F
                                pdfTable.AddCell(pdfCell)

                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                'pdfTable.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph("PRIX ACHAT", pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 15
                                'pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph("MONTANT", pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 15
                                'pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph("MARGE", pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 15
                                'pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable.AddCell(pdfCell)

                                'ARTICLE D'UNE FAMILLE QUELCONQUE

                                Dim dt As DataTable

                                'SELECTION DES ARTICLES VENDUES SOUS UNE FAMILE PRECISE ET DANS UN MAGASIN PRECIS
                                dt = ligneFacture.ListeDesArticlesVendusInventairePArFAmilleMagasin(DateDebut, DateFin, CODE_CAISSIER, CategoriePArent, CODE_MAGASIN)

                                If dt.Rows.Count > 0 Then

                                    For j = 0 To dt.Rows.Count - 1

                                        '--------------------------------------- NEW CODE --------------------------------------------------------
                                        Dim articleIndividuel As New DataTable()

                                        Dim CODE_ARTICLE As String = dt.Rows(j)("CODE_ARTICLE")
                                        Dim LIBELLE_FACTURE As String = ""
                                        Dim PA As Double = 0

                                        Dim infoArticle As DataTable = Functions.getElementByCode(CODE_ARTICLE, "article", "CODE_ARTICLE")

                                        If infoArticle.Rows.Count > 0 Then
                                            LIBELLE_FACTURE = infoArticle.Rows(0)("DESIGNATION_FR")
                                            PA = infoArticle.Rows(0)("COUT_U_MOYEN_PONDERE")
                                        End If

                                        Dim QUANTITE_ARTICLE As Double = 0
                                        Dim MONTANT_ARTICLE As Double = 0
                                        Dim PUMOYEN As Double = 0

                                        Dim CODE_UTILISATEUR As String = CODE_CAISSIER

                                        Dim CATEGORIE_PARENT As String = CategoriePArent

                                        articleIndividuel = ligneFacture.ListeDesArticlesVendusInventaireIndividuelParFamilleMagasin(DateDebut, DateFin, CODE_UTILISATEUR, CODE_ARTICLE, CATEGORIE_PARENT, CODE_MAGASIN)

                                        For l = 0 To articleIndividuel.Rows.Count - 1

                                            QUANTITE_ARTICLE += articleIndividuel.Rows(l)("QUANTITE")
                                            MONTANT_ARTICLE += articleIndividuel.Rows(l)("MONTANT TOTAL")

                                            If QUANTITE_ARTICLE > 0 Then
                                                PUMOYEN = MONTANT_ARTICLE / QUANTITE_ARTICLE
                                            End If

                                        Next

                                        Dim MARGE As Double = MONTANT_ARTICLE - (QUANTITE_ARTICLE * PA)

                                        pdfCell = New PdfPCell(New Paragraph(LIBELLE_FACTURE, font1))
                                        pdfCell.MinimumHeight = 5
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(Format(QUANTITE_ARTICLE, "#,##0"), font1))
                                        pdfCell.MinimumHeight = 5
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(Format(PUMOYEN, "#,##0"), font1))
                                        pdfCell.MinimumHeight = 5
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(Format(PA * QUANTITE_ARTICLE, "#,##0"), font1))
                                        pdfCell.MinimumHeight = 5
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(Format(MONTANT_ARTICLE, "#,##0"), font1))
                                        pdfCell.MinimumHeight = 5
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(Format(MARGE, "#,##0"), font1))
                                        pdfCell.MinimumHeight = 5
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfTable.AddCell(pdfCell)

                                        '---------------------------------------------------------------------------------------------------------
                                        totalDesDesVentesDeLaFamille += MONTANT_ARTICLE
                                        totalDesDesVentes += MONTANT_ARTICLE
                                        totalQuantiteFamille += QUANTITE_ARTICLE
                                        totalDesDesMarges += MARGE
                                        totalDesDesMargesDeLaFamille += MARGE

                                    Next

                                End If

                                '------------------------------------ RECAPITULATIF ------------------------------------------------------
                                pdfCell = New PdfPCell(New Paragraph("TOTAL", pRow))
                                pdfCell.MinimumHeight = 5
                                'pdfCell.Colspan = 4
                                pdfCell.Border = 0
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfTable.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(totalQuantiteFamille, "#,##0"), pRow))
                                pdfCell.MinimumHeight = 5
                                'pdfCell.Colspan = 4
                                pdfCell.Border = 0
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfTable.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(totalDesDesVentesDeLaFamille - totalDesDesMargesDeLaFamille, "#,##0"), pRow))
                                pdfCell.MinimumHeight = 5
                                pdfCell.Colspan = 2
                                pdfCell.Border = 0
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfTable.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(totalDesDesVentesDeLaFamille, "#,##0"), pRow))
                                pdfCell.MinimumHeight = 5
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.Border = 0
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfTable.AddCell(pdfCell)
                                pdfCell.Border = 0

                                pdfCell = New PdfPCell(New Paragraph(Format(totalDesDesMargesDeLaFamille, "#,##0"), pRow))
                                pdfCell.MinimumHeight = 5
                                pdfCell.Border = 0
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfTable.AddCell(pdfCell)

                                '---------------------------------------------------------------------------------------------------------

                                pdfDoc.Add(pdfTable)

                                Dim p5 As Paragraph = New Paragraph(" TOTAL : " & Format(totalDesDesVentesDeLaFamille, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                                p5.Alignment = Element.ALIGN_CENTER

                                'pdfDoc.Add(p5)

                                '---------------------GRATUITE----------------------------------

                                Dim p7 As Paragraph = New Paragraph(" GRATUITES : " & Chr(13), pRow)
                                p7.Alignment = Element.ALIGN_CENTER

                                Dim pdfTable2 As New PdfPTable(4) 'Number of columns
                                pdfTable2.TotalWidth = 520.0F
                                pdfTable2.LockedWidth = True
                                pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfTable2.HeaderRows = 1

                                Dim widths2 As Single() = New Single() {60.0F, 15.0F, 10.0F, 15.0F}

                                pdfTable2.SetWidths(widths2)

                                totalDesDesVentesDeLaFamille2 = 0

                                Dim ligneFacture2 As New LigneFacture()
                                'Dim CategoriePArent2 As String = dtCategoryParent.Rows(i)("SOUS FAMILLE")

                                Dim p8 As Paragraph = New Paragraph("FAMILLE D'ARTICLE: " & CategoriePArent & Chr(13) & Chr(13), font1)
                                p8.Alignment = Element.ALIGN_LEFT

                                'pdfDoc.Add(p2)

                                pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 5
                                'pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable2.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 5
                                'pdfCell.PaddingLeft = 5.0F
                                pdfTable2.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 5
                                'pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable2.AddCell(pdfCell)

                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                'pdfTable.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 5
                                'pdfCell.PaddingLeft = 5.0F
                                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                                pdfTable2.AddCell(pdfCell)

                                'ARTICLE D'UNE FAMILLE QUELCONQUE
                                Dim dtGratuite As DataTable = ligneFacture.ListeDesArticlesVendusGratuitementParFamilleMagasin(CategoriePArent, DateDebut, DateFin, CODE_MAGASIN, CODE_CAISSIER)

                                If dtGratuite.Rows.Count > 0 Then

                                    pdfDoc.Add(p7)

                                    totalDesDesVentesDeLaFamille2 = 0

                                    For j = 0 To dtGratuite.Rows.Count - 1

                                        totalDesDesVentesDeLaFamille2 += dtGratuite.Rows(j)("MONTANT TOTAL")
                                        totalDesDesVentes2 += dtGratuite.Rows(j)("MONTANT TOTAL")

                                        'totalDesDesMarges += MARGE

                                        pdfCell = New PdfPCell(New Paragraph(dtGratuite.Rows(j)("LIBELLE ARTICLE"), font1))
                                        pdfCell.MinimumHeight = 5
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                        pdfTable2.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(Format(dtGratuite.Rows(j)("PRIX UNITAIRE"), "#,##0"), font1))
                                        pdfCell.MinimumHeight = 5
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfTable2.AddCell(pdfCell)

                                        Dim QUANTITE As Double = dtGratuite.Rows(j)("QUANTITE")

                                        If QUANTITE = 0 Then
                                            QUANTITE = dtGratuite.Rows(j)("MONTANT TOTAL") / dtGratuite.Rows(j)("PRIX UNITAIRE")
                                        End If

                                        pdfCell = New PdfPCell(New Paragraph(Format(QUANTITE, "#,##0"), font1))
                                        pdfCell.MinimumHeight = 5
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfTable2.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(Format(dtGratuite.Rows(j)("MONTANT TOTAL"), "#,##0"), font1))
                                        pdfCell.MinimumHeight = 5
                                        pdfCell.PaddingLeft = 5.0F
                                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                        pdfTable2.AddCell(pdfCell)

                                    Next

                                End If

                                pdfDoc.Add(pdfTable2)

                                If Double.Parse(totalDesDesVentesDeLaFamille2) > 0 Then

                                    Dim p9 As Paragraph = New Paragraph(" TOTAL : " & Format(totalDesDesVentesDeLaFamille2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                                    p9.Alignment = Element.ALIGN_CENTER

                                    pdfDoc.Add(p9)

                                End If

                                '----------------------------- END GRATUITE --------------------------

                                resumeDesVentes(m).nomEmploye = nomDuMagasin
                                resumeDesVentes(m).montant = totalDesDesVentes

                            Next

                            '------------------------------------------------------------------------

                            Dim p11 As Paragraph = New Paragraph(Chr(13), pRow)
                            p11.Alignment = Element.ALIGN_CENTER

                            pdfDoc.Add(p11)

                            Dim pdfTable4 As New PdfPTable(6) 'Number of columns

                            pdfTable4.TotalWidth = 520.0F
                            pdfTable4.LockedWidth = True
                            pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
                            'pdfTable4.HeaderRows = 1

                            Dim widths4 As Single() = New Single() {60.0F, 10.0F, 15.0F, 20.0F, 20.0F, 20.0F}
                            pdfTable4.SetWidths(widths4)

                            Dim pdfCell4 As PdfPCell = Nothing

                            pdfCell4 = New PdfPCell(New Paragraph(" TOTAL DES RECETTES", pRow))
                            pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell4.MinimumHeight = 18
                            pdfCell4.PaddingLeft = 15.0F
                            pdfCell4.Border = 0
                            pdfCell4.Colspan = 4
                            pdfTable4.AddCell(pdfCell4)

                            pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesVentes, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                            pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell4.MinimumHeight = 18
                            pdfCell4.PaddingLeft = 15.0F
                            pdfCell4.Border = 0
                            pdfTable4.AddCell(pdfCell4)

                            pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesMarges, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                            pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell4.MinimumHeight = 18
                            pdfCell4.PaddingLeft = 15.0F
                            pdfCell4.Border = 0
                            pdfTable4.AddCell(pdfCell4)

                            If totalDesDesVentesDeLaFamille2 > 0 Then

                                pdfCell4 = New PdfPCell(New Paragraph(" TOTAL DES GRATUITEES", pRow))
                                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell4.MinimumHeight = 18
                                pdfCell4.PaddingLeft = 15.0F
                                pdfCell4.Border = 0
                                pdfCell4.Colspan = 4
                                pdfTable4.AddCell(pdfCell4)

                                pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesVentesDeLaFamille2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell4.MinimumHeight = 18
                                pdfCell4.PaddingLeft = 15.0F
                                pdfCell4.Border = 0
                                pdfTable4.AddCell(pdfCell4)

                                pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesMarges2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell4.MinimumHeight = 18
                                pdfCell4.PaddingLeft = 15.0F
                                pdfCell4.Border = 0
                                pdfTable4.AddCell(pdfCell4)

                                pdfCell4 = New PdfPCell(New Paragraph(" RECETTE NET ", pRow))
                                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell4.MinimumHeight = 18
                                pdfCell4.PaddingLeft = 15.0F
                                pdfCell4.Border = 0
                                pdfCell4.Colspan = 4
                                pdfTable4.AddCell(pdfCell4)

                                pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesVentes - totalDesDesVentesDeLaFamille2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell4.MinimumHeight = 18
                                pdfCell4.PaddingLeft = 15.0F
                                pdfCell4.Border = 0
                                pdfTable4.AddCell(pdfCell4)

                                pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesMarges - totalDesDesMarges2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell4.MinimumHeight = 18
                                pdfCell4.PaddingLeft = 15.0F
                                pdfCell4.Border = 0
                                pdfTable4.AddCell(pdfCell4)

                            End If

                            pdfDoc.Add(pdfTable4)
                            'Dim p4 As Paragraph = New Paragraph(Chr(13) & " TOTAL DES VENTES : " & Format(totalDesDesVentes, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                            'p4.Alignment = Element.ALIGN_CENTER

                            'pdfDoc.Add(p4)

                            'Dim p10 As Paragraph = New Paragraph(" TOTAL DES GRATUITEES : " & Format(totalDesDesVentes2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                            'p10.Alignment = Element.ALIGN_CENTER

                            'pdfDoc.Add(p10)


                        Else
                            'MessageBox.Show("Aucun Document à imprimer", "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                        End If

                    End If

                Next

                ''------------------------------------------------------ RESUME DES VENTES ------------------------------------------------------------------------------

                Dim p04 As Paragraph = New Paragraph(Chr(13) & " RESUME DES VENTES " & Chr(13) & Chr(13), pRow)
                p04.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p04)

                Dim pdfTable01 As New PdfPTable(2) 'Number of columns
                pdfTable01.TotalWidth = 520.0F
                pdfTable01.LockedWidth = True
                pdfTable01.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable01.HeaderRows = 1

                Dim widths01 As Single() = New Single() {50.0F, 20.0F}
                pdfTable01.SetWidths(widths01)

                Dim grandTotal As Double = 0

                For l = 0 To diversCodeMagasin.Rows.Count - 1

                    If resumeDesVentes(l).montant > 0 Then

                        pdfCell = New PdfPCell(New Paragraph(resumeDesVentes(l).nomEmploye, pRow))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 15.0F

                        pdfTable01.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(resumeDesVentes(l).montant, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 15.0F

                        pdfTable01.AddCell(pdfCell)

                        grandTotal += resumeDesVentes(l).montant

                    End If

                Next

                pdfCell = New PdfPCell(New Paragraph("GRAND TOTAL :", pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                pdfCell.PaddingLeft = 15.0F
                pdfTable01.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(grandTotal, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 5
                pdfCell.PaddingLeft = 15.0F
                pdfTable01.AddCell(pdfCell)

                pdfDoc.Add(pdfTable01)

                Dim p002 As Paragraph = New Paragraph(Chr(13) & "Arrêter la présente à la somme de : " & Functions.NBLT(grandTotal) & " " & societe.Rows(0)("CODE_MONNAIE") & Chr(13) & Chr(13), pRow)
                p002.Alignment = Element.ALIGN_LEFT

                pdfDoc.Add(p002)
                ' ------------------------------------------------------------------------------------------------

                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Process.Start(sfd.FileName)

            End If

        End If

    End Sub

    Public Shared Sub inventaireDesVentesParFamille(ByVal dtCategoryParent As DataTable, ByVal DateDebut As Date, ByVal DateFin As Date, ByVal CODE_CAISSIER As String, ByVal LIBELLE As String)

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0

        Dim tireDocument As String = ""

        If Not Trim(CODE_CAISSIER) = "" Then

            Dim infoUser As DataTable = Functions.getElementByCode(CODE_CAISSIER, "utilisateurs", "CODE_UTILISATEUR")

            Dim UTILISATEUR As String = ""

            If infoUser.Rows.Count > 0 Then
                UTILISATEUR = infoUser.Rows(0)("NOM_UTILISATEUR")
            End If

            tireDocument = LIBELLE & UTILISATEUR & " " & Date.Now().ToString("ddMMyyHHmmss") & " "
        Else
            tireDocument = LIBELLE & GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR") & " " & Date.Now().ToString("ddMMyyHHmmss") & " "
        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 40, 40)
            'Dim pdfDoc As New Document(PageSize.B7, 5, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            Dim pdfCell As PdfPCell = Nothing

            'pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & "***", pColumn)
            p1.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p1)

            Dim p3 As Paragraph = New Paragraph(DateDebut & " AU " & DateFin & Chr(13), pColumn)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            If DateDebut = DateFin Then

                Dim p0 As Paragraph = New Paragraph(Chr(13) & LIBELLE & DateDebut & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            Else

                Dim p0 As Paragraph = New Paragraph(Chr(13) & LIBELLE & DateDebut & Chr(13) & " AU " & DateFin, pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            End If

            Dim totalDesDesVentesDeLaFamille As Double = 0
            Dim totalDesDesMargesDeLaFamille As Double = 0
            Dim totalDesDesVentes As Double = 0
            Dim totalDesDesAchats As Double = 0
            Dim totalDesDesMarges As Double = 0
            Dim totalQuantiteFamille As Double = 0

            Dim totalDesDesMarges2 As Double = 0
            Dim totalDesDesVentesDeLaFamille2 As Double = 0
            Dim totalDesDesMargesDeLaFamille2 As Double = 0
            Dim totalDesDesVentes2 As Double = 0
            Dim totalDesDesAchats2 As Double = 0
            Dim totalQuantiteFamille2 As Double = 0

            If dtCategoryParent.Rows.Count > 0 Then

                For i = 0 To dtCategoryParent.Rows.Count - 1

                    totalDesDesVentesDeLaFamille = 0
                    totalDesDesVentesDeLaFamille2 = 0
                    totalDesDesMargesDeLaFamille = 0
                    totalDesDesMargesDeLaFamille2 = 0
                    totalQuantiteFamille = 0

                    'VENTES
                    Dim pdfTable As New PdfPTable(6) 'Number of columns
                    pdfTable.TotalWidth = 520.0F
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.HeaderRows = 1

                    Dim widths As Single() = New Single() {60.0F, 10.0F, 15.0F, 20.0F, 20.0F, 20.0F}

                    pdfTable.SetWidths(widths)

                    Dim ligneFacture As New LigneFacture()
                    Dim CategoriePArent As String = dtCategoryParent.Rows(i)("SOUS FAMILLE")

                    Dim p2 As Paragraph = New Paragraph(i + 1 & " - " & CategoriePArent & Chr(13) & Chr(13), pRow)
                    p2.Alignment = Element.ALIGN_LEFT

                    pdfDoc.Add(p2)

                    pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    'pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("PRIX ACHAT", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("RECETTE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("PROFIT BRUT", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    'ARTICLE D'UNE FAMILLE QUELCONQUE

                    Dim dt As DataTable

                    'SELECTION DES ARTICLES VENDUES SOUS UNE FAMILE PRECISE
                    dt = ligneFacture.ListeDesArticlesVendusInventairePArFAmille(DateDebut, DateFin, CODE_CAISSIER, CategoriePArent)

                    If dt.Rows.Count > 0 Then

                        For j = 0 To dt.Rows.Count - 1

                            '--------------------------------------- NEW CODE --------------------------------------------------------

                            Dim articleIndividuel As New DataTable()

                            Dim CODE_ARTICLE As String = dt.Rows(j)("CODE_ARTICLE")
                            Dim LIBELLE_FACTURE As String = ""
                            Dim PA As Double = 0

                            Dim infoArticle As DataTable = Functions.getElementByCode(CODE_ARTICLE, "article", "CODE_ARTICLE")

                            If infoArticle.Rows.Count > 0 Then
                                LIBELLE_FACTURE = infoArticle.Rows(0)("DESIGNATION_FR")
                                PA = infoArticle.Rows(0)("COUT_U_MOYEN_PONDERE")
                            End If

                            Dim QUANTITE_ARTICLE As Double = 0
                            Dim MONTANT_ARTICLE As Double = 0
                            Dim PUMOYEN As Double = 0

                            Dim CODE_UTILISATEUR As String = CODE_CAISSIER

                            Dim CATEGORIE_PARENT As String = CategoriePArent

                            articleIndividuel = ligneFacture.ListeDesArticlesVendusInventaireIndividuelParFamille(DateDebut, DateFin, CODE_UTILISATEUR, CODE_ARTICLE, CATEGORIE_PARENT)

                            For l = 0 To articleIndividuel.Rows.Count - 1

                                QUANTITE_ARTICLE += articleIndividuel.Rows(l)("QUANTITE")
                                MONTANT_ARTICLE += articleIndividuel.Rows(l)("MONTANT TOTAL")

                                If QUANTITE_ARTICLE > 0 Then
                                    PUMOYEN = MONTANT_ARTICLE / QUANTITE_ARTICLE
                                End If

                            Next

                            Dim MARGE As Double = MONTANT_ARTICLE - (QUANTITE_ARTICLE * PA)

                            pdfCell = New PdfPCell(New Paragraph(LIBELLE_FACTURE, font1))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(QUANTITE_ARTICLE, "#,##0"), font1))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(PUMOYEN, "#,##0"), font1))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(PA * QUANTITE_ARTICLE, "#,##0"), font1))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(MONTANT_ARTICLE, "#,##0"), font1))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(MARGE, "#,##0"), font1))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.AddCell(pdfCell)

                            '---------------------------------------------------------------------------------------------------------
                            totalDesDesVentesDeLaFamille += MONTANT_ARTICLE
                            totalDesDesVentes += MONTANT_ARTICLE
                            totalQuantiteFamille += QUANTITE_ARTICLE
                            totalDesDesMarges += MARGE
                            totalDesDesMargesDeLaFamille += MARGE

                        Next

                        '------------------------------------ RECAPITULATIF ------------------------------------------------------
                        pdfCell = New PdfPCell(New Paragraph("TOTAL", pRow))
                        pdfCell.MinimumHeight = 5
                        'pdfCell.Colspan = 4
                        pdfCell.Border = 0
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalQuantiteFamille, "#,##0"), pRow))
                        pdfCell.MinimumHeight = 5
                        'pdfCell.Colspan = 4
                        pdfCell.Border = 0
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalDesDesVentesDeLaFamille - totalDesDesMargesDeLaFamille, "#,##0"), pRow))
                        pdfCell.MinimumHeight = 5
                        pdfCell.Colspan = 2
                        pdfCell.Border = 0
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalDesDesVentesDeLaFamille, "#,##0"), pRow))
                        pdfCell.MinimumHeight = 5
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.Border = 0
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.AddCell(pdfCell)
                        pdfCell.Border = 0

                        pdfCell = New PdfPCell(New Paragraph(Format(totalDesDesMargesDeLaFamille, "#,##0"), pRow))
                        pdfCell.MinimumHeight = 5
                        pdfCell.Border = 0
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.AddCell(pdfCell)

                        '---------------------------------------------------------------------------------------------------------

                    End If

                    pdfDoc.Add(pdfTable)

                    Dim p5 As Paragraph = New Paragraph(" TOTAL : " & Format(totalDesDesVentesDeLaFamille, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                    p5.Alignment = Element.ALIGN_CENTER

                    'pdfDoc.Add(p5)

                    '---------------------GRATUITE----------------------------------

                    Dim p7 As Paragraph = New Paragraph(" GRATUITES : " & Chr(13), pRow)
                    p7.Alignment = Element.ALIGN_CENTER

                    Dim pdfTable2 As New PdfPTable(4) 'Number of columns
                    pdfTable2.TotalWidth = 520.0F
                    pdfTable2.LockedWidth = True
                    pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable2.HeaderRows = 1

                    Dim widths2 As Single() = New Single() {60.0F, 15.0F, 10.0F, 15.0F}

                    pdfTable2.SetWidths(widths2)

                    totalDesDesVentesDeLaFamille2 = 0

                    Dim ligneFacture2 As New LigneFacture()
                    'Dim CategoriePArent2 As String = dtCategoryParent.Rows(i)("SOUS FAMILLE")

                    Dim p8 As Paragraph = New Paragraph("FAMILLE D'ARTICLE: " & CategoriePArent & Chr(13) & Chr(13), font1)
                    p8.Alignment = Element.ALIGN_LEFT

                    'pdfDoc.Add(p2)

                    pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable2.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    pdfTable2.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable2.AddCell(pdfCell)

                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    'pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable2.AddCell(pdfCell)

                    'ARTICLE D'UNE FAMILLE QUELCONQUE
                    Dim dtGratuite As DataTable = ligneFacture.ListeDesArticlesVendusGratuitementParFamille(CategoriePArent, DateDebut, DateFin)

                    If dtGratuite.Rows.Count > 0 Then

                        pdfDoc.Add(p7)

                        totalDesDesVentesDeLaFamille2 = 0

                        For j = 0 To dtGratuite.Rows.Count - 1

                            totalDesDesVentesDeLaFamille2 += dtGratuite.Rows(j)("MONTANT TOTAL")
                            totalDesDesVentes2 += dtGratuite.Rows(j)("MONTANT TOTAL")

                            pdfCell = New PdfPCell(New Paragraph(dtGratuite.Rows(j)("LIBELLE ARTICLE"), font1))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfTable2.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(dtGratuite.Rows(j)("PRIX UNITAIRE"), "#,##0"), font1))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable2.AddCell(pdfCell)

                            Dim QUANTITE As Double = dtGratuite.Rows(j)("QUANTITE")

                            If QUANTITE = 0 Then
                                QUANTITE = dtGratuite.Rows(j)("MONTANT TOTAL") / dtGratuite.Rows(j)("PRIX UNITAIRE")
                            End If

                            pdfCell = New PdfPCell(New Paragraph(Format(QUANTITE, "#,##0"), font1))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable2.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(dtGratuite.Rows(j)("MONTANT TOTAL"), "#,##0"), font1))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                            pdfTable2.AddCell(pdfCell)

                        Next

                    End If

                    pdfDoc.Add(pdfTable2)

                    '----------------------------- END GRATUITE --------------------------

                Next

                '------------------------------------------------------------------------

                If totalDesDesVentes > 0 Then

                    Dim p4 As Paragraph = New Paragraph(Chr(13) & " TOTAL DES VENTES : " & Format(totalDesDesVentes, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                    p4.Alignment = Element.ALIGN_CENTER

                    'pdfDoc.Add(p4)

                End If

                If totalDesDesVentes2 > 0 Then

                    Dim p10 As Paragraph = New Paragraph(" GRAND TOTAL DES GRATUITEES : " & Format(totalDesDesVentes2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                    p10.Alignment = Element.ALIGN_CENTER

                    'pdfDoc.Add(p10)

                End If

                'Dim p11 As Paragraph = New Paragraph(" NET PERCU : " & Format(totalDesDesVentes - totalDesDesVentes2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow)
                'p11.Alignment = Element.ALIGN_CENTER

                'pdfDoc.Add(p11)

                '-----------------------------------

                Dim p11 As Paragraph = New Paragraph(Chr(13), pRow)
                p11.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p11)

                Dim pdfTable4 As New PdfPTable(6) 'Number of columns

                pdfTable4.TotalWidth = 520.0F
                pdfTable4.LockedWidth = True
                pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfTable4.HeaderRows = 1

                Dim widths4 As Single() = New Single() {60.0F, 10.0F, 15.0F, 20.0F, 20.0F, 20.0F}
                pdfTable4.SetWidths(widths4)

                Dim pdfCell4 As PdfPCell = Nothing

                pdfCell4 = New PdfPCell(New Paragraph(" TOTAL DES RECETTES", pRow))
                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell4.MinimumHeight = 18
                pdfCell4.PaddingLeft = 15.0F
                pdfCell4.Border = 0
                pdfCell4.Colspan = 4
                pdfTable4.AddCell(pdfCell4)

                pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesVentes, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell4.MinimumHeight = 18
                pdfCell4.PaddingLeft = 15.0F
                pdfCell4.Border = 0
                pdfTable4.AddCell(pdfCell4)

                pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesMarges, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell4.MinimumHeight = 18
                pdfCell4.PaddingLeft = 15.0F
                pdfCell4.Border = 0
                pdfTable4.AddCell(pdfCell4)

                If totalDesDesVentes2 > 0 Then

                    pdfCell4 = New PdfPCell(New Paragraph(" TOTAL DES GRATUITEES", pRow))
                    pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell4.MinimumHeight = 18
                    pdfCell4.PaddingLeft = 15.0F
                    pdfCell4.Border = 0
                    pdfCell4.Colspan = 4
                    pdfTable4.AddCell(pdfCell4)

                    pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesVentes2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                    pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell4.MinimumHeight = 18
                    pdfCell4.PaddingLeft = 15.0F
                    pdfCell4.Border = 0
                    pdfTable4.AddCell(pdfCell4)

                    pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesMarges2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                    pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell4.MinimumHeight = 18
                    pdfCell4.PaddingLeft = 15.0F
                    pdfCell4.Border = 0
                    pdfTable4.AddCell(pdfCell4)

                    pdfCell4 = New PdfPCell(New Paragraph(" RECETTE NET ", pRow))
                    pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell4.MinimumHeight = 18
                    pdfCell4.PaddingLeft = 15.0F
                    pdfCell4.Border = 0
                    pdfCell4.Colspan = 4
                    pdfTable4.AddCell(pdfCell4)

                    pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesVentes - totalDesDesVentes2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                    pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell4.MinimumHeight = 18
                    pdfCell4.PaddingLeft = 15.0F
                    pdfCell4.Border = 0
                    pdfTable4.AddCell(pdfCell4)

                    pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesMarges - totalDesDesMarges2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                    pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell4.MinimumHeight = 18
                    pdfCell4.PaddingLeft = 15.0F
                    pdfCell4.Border = 0
                    pdfTable4.AddCell(pdfCell4)

                End If

                pdfDoc.Add(pdfTable4)

                ' ------------------------------------------------------------------------------------------------

                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Process.Start(sfd.FileName)

            Else
                MessageBox.Show("Aucun Document à imprimer", "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            End If

        End If

    End Sub

    Public Shared Sub journalDesVentes(ByVal dtCategoryParent As DataTable, ByVal DateDebut As Date, ByVal DateFin As Date)

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0

        Dim tireDocument As String = ""
        tireDocument = "Journal des ventes " & GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR") & " " & Date.Now().ToString("ddMMyyHHmmss") & " "

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            'Dim pdfDoc As New Document(PageSize.B7, 5, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow1 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & "***", pColumn)
            p1.Alignment = Element.ALIGN_CENTER

            'pdfDoc.Add(p1)

            Dim p3 As Paragraph = New Paragraph(Chr(13) & Date.Now() & Chr(13), pColumn)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            If DateDebut = DateFin Then

                Dim p0 As Paragraph = New Paragraph(Chr(13) & " JOURNAL DES VENTES DU : " & DateDebut & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            Else

                Dim p0 As Paragraph = New Paragraph(Chr(13) & " JOURNAL DES VENTES DU : " & DateDebut & Chr(13) & " AU " & DateFin, pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            End If

            Dim totalDesDesVentesDeLaFamille As Double = 0
            Dim totalDesDesVentes As Double = 0

            Dim totalDesDesVentesDeLaFamille2 As Double = 0
            Dim totalDesDesVentes2 As Double = 0

            Dim ListeDesResumeDesVentes As DataTable

            If dtCategoryParent.Rows.Count > 0 Then

                For i = 0 To dtCategoryParent.Rows.Count - 1
                    'VENTES
                    Dim pdfTable As New PdfPTable(4) 'Number of columns
                    pdfTable.TotalWidth = 520.0F
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.HeaderRows = 1

                    Dim widths As Single() = New Single() {67.0F, 10.0F, 8.0F, 15.0F}

                    pdfTable.SetWidths(widths)

                    totalDesDesVentesDeLaFamille = 0

                    Dim ligneFacture As New LigneFacture()
                    Dim CategoriePArent As String = dtCategoryParent.Rows(i)("SOUS FAMILLE")

                    Dim p2 As Paragraph = New Paragraph(i + 1 & "-" & CategoriePArent & Chr(13) & Chr(13), pRow)
                    p2.Alignment = Element.ALIGN_LEFT

                    pdfDoc.Add(p2)

                    pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    'pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    'ARTICLE D'UNE FAMILLE QUELCONQUE

                    Dim dt As DataTable

                    Dim CODE_CAISSIER As String = GlobalVariable.ConnectedUser.Rows(0)("CODE_UTILISATEUR")

                    If GlobalVariable.DocumentToGenerate = "JOURNAL DES VENTES" Then
                        dt = ligneFacture.ListeDesArticlesVendusParFamille(CategoriePArent, DateDebut, DateFin)
                        ListeDesResumeDesVentes = resumeDesVentesGlobal(DateDebut, DateFin)
                    ElseIf GlobalVariable.DocumentToGenerate = "JOURNAL DES VENTES SHIFT" Then
                        ListeDesResumeDesVentes = resumeDesVentesQuotidienne(DateDebut, DateFin, CODE_CAISSIER)
                        dt = ligneFacture.ListeDesArticlesVendusParFamilleDunCaissier(CategoriePArent, DateDebut, DateFin, CODE_CAISSIER)
                    End If

                    Dim totalQte As Integer = 0
                    Dim totalQte2 As Integer = 0

                    If dt.Rows.Count > 0 Then

                        For j = 0 To dt.Rows.Count - 1

                            totalDesDesVentesDeLaFamille += dt.Rows(j)("MONTANT TOTAL")
                            totalDesDesVentes += dt.Rows(j)("MONTANT TOTAL")

                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(j)("LIBELLE ARTICLE"), font1))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j)("PRIX UNITAIRE"), "#,##0"), font1))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.AddCell(pdfCell)

                            Dim QUANTITE As Double = dt.Rows(j)("QUANTITE")

                            If QUANTITE = 0 Then
                                QUANTITE = dt.Rows(j)("MONTANT TOTAL") / dt.Rows(j)("PRIX UNITAIRE")
                            End If

                            pdfCell = New PdfPCell(New Paragraph(Format(QUANTITE, "#,##0"), font1))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j)("MONTANT TOTAL"), "#,##0"), font1))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                            totalQte += QUANTITE

                            pdfTable.AddCell(pdfCell)

                        Next

                    End If

                    pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(totalQte, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.Border = 0
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY

                    pdfCell = New PdfPCell(New Paragraph(Format(totalDesDesVentesDeLaFamille, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 15
                    pdfCell.Border = 0
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfDoc.Add(pdfTable)

                    '---------------------GRATUITE----------------------------------

                    Dim p7 As Paragraph = New Paragraph(" GRATUITES : " & Chr(13) & Chr(13), pRow)
                    p7.Alignment = Element.ALIGN_CENTER

                    Dim pdfTable2 As New PdfPTable(4) 'Number of columns
                    pdfTable2.TotalWidth = 520.0F
                    pdfTable2.LockedWidth = True
                    pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable2.HeaderRows = 1

                    Dim widths2 As Single() = New Single() {67.0F, 10.0F, 8.0F, 15.0F}

                    pdfTable2.SetWidths(widths2)

                    totalDesDesVentesDeLaFamille2 = 0

                    Dim ligneFacture2 As New LigneFacture()
                    'Dim CategoriePArent2 As String = dtCategoryParent.Rows(i)("SOUS FAMILLE")

                    Dim p8 As Paragraph = New Paragraph("FAMILLE D'ARTICLE: " & CategoriePArent & Chr(13) & Chr(13), font1)
                    p8.Alignment = Element.ALIGN_LEFT

                    'pdfDoc.Add(p2)

                    pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable2.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    pdfTable2.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable2.AddCell(pdfCell)

                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    'pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable2.AddCell(pdfCell)

                    'ARTICLE D'UNE FAMILLE QUELCONQUE
                    Dim dtGratuite As DataTable = ligneFacture.ListeDesArticlesVendusGratuitementParFamille(CategoriePArent, DateDebut, DateFin)

                    If GlobalVariable.DocumentToGenerate = "JOURNAL DES VENTES" Then
                        dtGratuite = ligneFacture.ListeDesArticlesVendusGratuitementParFamille(CategoriePArent, DateDebut, DateFin)
                    ElseIf GlobalVariable.DocumentToGenerate = "JOURNAL DES VENTES SHIFT" Then
                        dtGratuite = ligneFacture.ListeDesArticlesVendusGratuitementParFamilleCaissier(CategoriePArent, DateDebut, DateFin, CODE_CAISSIER)
                    End If

                    If dtGratuite.Rows.Count > 0 Then

                        pdfDoc.Add(p7)

                        totalDesDesVentesDeLaFamille2 = 0

                        For j = 0 To dtGratuite.Rows.Count - 1

                            totalDesDesVentesDeLaFamille2 += dtGratuite.Rows(j)("MONTANT TOTAL")
                            totalDesDesVentes2 += dtGratuite.Rows(j)("MONTANT TOTAL")

                            pdfCell = New PdfPCell(New Paragraph(dtGratuite.Rows(j)("LIBELLE ARTICLE"), font1))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfTable2.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(dtGratuite.Rows(j)("PRIX UNITAIRE"), "#,##0"), font1))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable2.AddCell(pdfCell)

                            Dim QUANTITE As Double = dtGratuite.Rows(j)("QUANTITE")

                            If QUANTITE = 0 Then
                                QUANTITE = dtGratuite.Rows(j)("MONTANT TOTAL") / dtGratuite.Rows(j)("PRIX UNITAIRE")
                            End If

                            totalQte2 += QUANTITE

                            pdfCell = New PdfPCell(New Paragraph(Format(QUANTITE, "#,##0"), font1))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable2.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(dtGratuite.Rows(j)("MONTANT TOTAL"), "#,##0"), font1))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                            pdfTable2.AddCell(pdfCell)

                        Next

                    End If

                    If Double.Parse(totalDesDesVentesDeLaFamille2) > 0 Then

                        pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        pdfCell.Colspan = 2
                        pdfCell.Border = 0
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable2.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalQte2, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        pdfCell.Border = 0
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable2.AddCell(pdfCell)

                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        'pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalDesDesVentesDeLaFamille2, "#,##0"), pColumn))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 15
                        pdfCell.Border = 0
                        'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                        pdfTable2.AddCell(pdfCell)

                    End If

                    pdfDoc.Add(pdfTable2)

                    '----------------------------- END GRATUITE --------------------------

                Next

                '------------------------------------------------------------------------

                Dim p11 As Paragraph = New Paragraph(Chr(13), pRow)
                p11.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p11)

                Dim pdfTable4 As New PdfPTable(2) 'Number of columns

                pdfTable4.TotalWidth = 520.0F
                pdfTable4.LockedWidth = True
                pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfTable4.HeaderRows = 1

                Dim widths4 As Single() = New Single() {60.0F, 20.0F}
                pdfTable4.SetWidths(widths4)

                Dim pdfCell4 As PdfPCell = Nothing

                pdfCell4 = New PdfPCell(New Paragraph("TOTAL DES VENTES : ", pRow))
                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell4.MinimumHeight = 18
                pdfCell4.PaddingLeft = 15.0F
                pdfCell4.Border = 0
                pdfTable4.AddCell(pdfCell4)

                pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesVentes, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell4.MinimumHeight = 18
                pdfCell4.PaddingLeft = 15.0F
                pdfCell4.Border = 0
                pdfTable4.AddCell(pdfCell4)

                pdfCell4 = New PdfPCell(New Paragraph("TOTAL DES GRATUITEES : ", pRow))
                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell4.MinimumHeight = 18
                pdfCell4.PaddingLeft = 15.0F
                pdfCell4.Border = 0
                pdfTable4.AddCell(pdfCell4)

                pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesVentes2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell4.MinimumHeight = 18
                pdfCell4.PaddingLeft = 15.0F
                pdfCell4.Border = 0
                pdfTable4.AddCell(pdfCell4)

                pdfCell4 = New PdfPCell(New Paragraph("VENTE NET : ", pRow))
                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell4.MinimumHeight = 18
                pdfCell4.PaddingLeft = 15.0F
                pdfCell4.Border = 0
                pdfTable4.AddCell(pdfCell4)

                pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesVentes - totalDesDesVentes2, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell4.MinimumHeight = 18
                pdfCell4.PaddingLeft = 15.0F
                pdfCell4.Border = 0
                pdfTable4.AddCell(pdfCell4)

                pdfDoc.Add(pdfTable4)


                '--------------------- RESUMES DES VENTES -------------------------------

                If ListeDesResumeDesVentes.Rows.Count > 0 Then

                    Dim compte As Double = 0
                    Dim gratuitee As Double = 0
                    Dim chambre As Double = 0
                    Dim comptoir As Double = 0
                    Dim offreEnChambre As Double = 0

                    For i = 0 To ListeDesResumeDesVentes.Rows.Count - 1
                        compte += ListeDesResumeDesVentes(i)("COMPTE")
                        gratuitee += ListeDesResumeDesVentes(i)("GRATUITEE")
                        chambre += ListeDesResumeDesVentes(i)("EN_CHAMBRE")
                        comptoir += ListeDesResumeDesVentes(i)("COMPTOIR")
                        offreEnChambre += ListeDesResumeDesVentes(i)("GRATUITE_EN_CHAMBRE")
                    Next

                    Dim pdfTable04 As New PdfPTable(10) 'Number of columns

                    pdfTable04.TotalWidth = 520.0F
                    pdfTable04.LockedWidth = True
                    pdfTable04.HorizontalAlignment = Element.ALIGN_RIGHT
                    'pdfTable04.HeaderRows = 1

                    Dim widths04 As Single() = New Single() {15.0F, 15.0F, 16.0F, 16.0F, 17.0F, 17.0F, 17.0F, 17.0F, 14.0F, 14.0F}
                    pdfTable04.SetWidths(widths04)

                    Dim pdfCell04 As PdfPCell = Nothing

                    pdfCell04 = New PdfPCell(New Paragraph("VENTE COMPTOIR", pRow1))
                    pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell04.MinimumHeight = 10
                    pdfCell04.Colspan = 2
                    pdfCell04.PaddingLeft = 15.0F
                    pdfTable04.AddCell(pdfCell04)

                    pdfCell04 = New PdfPCell(New Paragraph("VENTE EN CHAMBRE", pRow1))
                    pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell04.MinimumHeight = 10
                    pdfCell04.Colspan = 2
                    pdfCell04.PaddingLeft = 15.0F
                    pdfTable04.AddCell(pdfCell04)

                    pdfCell04 = New PdfPCell(New Paragraph("OFFRES EN CHAMBRE", pRow1))
                    pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell04.MinimumHeight = 10
                    pdfCell04.Colspan = 2
                    pdfCell04.PaddingLeft = 15.0F
                    pdfTable04.AddCell(pdfCell04)

                    pdfCell04 = New PdfPCell(New Paragraph("AUTRES OFFRES", pRow1))
                    pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell04.MinimumHeight = 10
                    pdfCell04.Colspan = 2
                    pdfCell04.PaddingLeft = 15.0F
                    pdfTable04.AddCell(pdfCell04)

                    pdfCell04 = New PdfPCell(New Paragraph("VERS COMPTE", pRow1))
                    pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell04.MinimumHeight = 10
                    pdfCell04.Colspan = 2
                    pdfCell04.PaddingLeft = 15.0F
                    pdfTable04.AddCell(pdfCell04)

                    '-------------------------- HEADER END --------------------------

                    pdfCell04 = New PdfPCell(New Paragraph(Format(comptoir, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                    pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell04.MinimumHeight = 10
                    pdfCell04.Colspan = 2
                    pdfCell04.PaddingLeft = 15.0F
                    pdfTable04.AddCell(pdfCell04)

                    pdfCell04 = New PdfPCell(New Paragraph(Format(chambre, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                    pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell04.MinimumHeight = 10
                    pdfCell04.Colspan = 2
                    pdfCell04.PaddingLeft = 15.0F
                    pdfTable04.AddCell(pdfCell04)

                    pdfCell04 = New PdfPCell(New Paragraph(Format(offreEnChambre, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                    pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell04.MinimumHeight = 10
                    pdfCell04.Colspan = 2
                    pdfCell04.PaddingLeft = 15.0F
                    pdfTable04.AddCell(pdfCell04)

                    pdfCell04 = New PdfPCell(New Paragraph(Format(gratuitee - offreEnChambre, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                    pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell04.MinimumHeight = 10
                    pdfCell04.Colspan = 2
                    pdfCell04.PaddingLeft = 15.0F
                    pdfTable04.AddCell(pdfCell04)

                    pdfCell04 = New PdfPCell(New Paragraph(Format(compte, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                    pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell04.MinimumHeight = 10
                    pdfCell04.Colspan = 2
                    pdfCell04.PaddingLeft = 15.0F
                    pdfTable04.AddCell(pdfCell04)

                    pdfDoc.Add(pdfTable04)

                End If


                ' ------------------------------------------------------------------------------------------------
                Dim p002 As Paragraph = New Paragraph(Chr(13) & "Arrêter la présente à la somme de : " & Functions.NBLT(totalDesDesVentes - totalDesDesVentes2) & " " & societe.Rows(0)("CODE_MONNAIE") & Chr(13) & Chr(13), pRow)
                p002.Alignment = Element.ALIGN_LEFT

                pdfDoc.Add(p002)

                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Process.Start(sfd.FileName)

            Else

                MessageBox.Show("Aucun Document à imprimer", "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            End If

        End If

    End Sub

    Public Shared Sub journalDesVentesDuShiftParRubrique(ByVal dtCategoryParent As DataTable, ByVal DateDebut As Date, ByVal DateFin As Date, ByVal titre As String, ByVal ETAT_FACTURE As Integer)

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0

        Dim tireDocument As String = ""
        tireDocument = titre & " " & GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR") & " " & Date.Now().ToString("ddMMyyHHmmss") & " "

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            'Dim pdfDoc As New Document(PageSize.B7, 5, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow1 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & "***", pColumn)
            p1.Alignment = Element.ALIGN_CENTER

            'pdfDoc.Add(p1)

            Dim p3 As Paragraph = New Paragraph(Chr(13) & Date.Now() & Chr(13), pColumn)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            If DateDebut = DateFin Then

                Dim p0 As Paragraph = New Paragraph(Chr(13) & " " & titre & " : " & DateDebut & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            Else

                Dim p0 As Paragraph = New Paragraph(Chr(13) & " " & titre & " : " & DateDebut & Chr(13) & " AU " & DateFin, pRow)
                p0.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p0)

            End If

            Dim totalDesDesVentesDeLaFamille As Double = 0
            Dim totalDesDesVentes As Double = 0

            Dim totalDesDesVentesDeLaFamille2 As Double = 0
            Dim totalDesDesVentes2 As Double = 0

            Dim ListeDesResumeDesVentes As DataTable

            If dtCategoryParent.Rows.Count > 0 Then

                For i = 0 To dtCategoryParent.Rows.Count - 1
                    'VENTES
                    Dim pdfTable As New PdfPTable(4) 'Number of columns
                    pdfTable.TotalWidth = 520.0F
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.HeaderRows = 1

                    Dim widths As Single() = New Single() {67.0F, 10.0F, 8.0F, 15.0F}

                    pdfTable.SetWidths(widths)

                    totalDesDesVentesDeLaFamille = 0

                    Dim ligneFacture As New LigneFacture()
                    Dim CategoriePArent As String = dtCategoryParent.Rows(i)("SOUS FAMILLE")

                    Dim p2 As Paragraph = New Paragraph(i + 1 & "-" & CategoriePArent & Chr(13) & Chr(13), pRow)
                    p2.Alignment = Element.ALIGN_LEFT

                    pdfDoc.Add(p2)

                    pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    'pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    'ARTICLE D'UNE FAMILLE QUELCONQUE

                    Dim dt As DataTable

                    Dim CODE_CAISSIER As String = GlobalVariable.ConnectedUser.Rows(0)("CODE_UTILISATEUR")

                    If GlobalVariable.DocumentToGenerate = "JOURNAL DES VENTES" Then
                        dt = ligneFacture.ListeDesArticlesVendusParFamille(CategoriePArent, DateDebut, DateFin)
                        ListeDesResumeDesVentes = resumeDesVentesGlobal(DateDebut, DateFin)
                    ElseIf GlobalVariable.DocumentToGenerate = "JOURNAL DES VENTES SHIFT" Then

                        ListeDesResumeDesVentes = resumeDesVentesQuotidienne(DateDebut, DateFin, CODE_CAISSIER)
                        dt = ligneFacture.ListeDesArticlesVendusParFamilleDunCaissierParRubrique(CategoriePArent, DateDebut, DateFin, CODE_CAISSIER, ETAT_FACTURE)
                    End If

                    Dim totalQte As Integer = 0
                    Dim totalQte2 As Integer = 0

                    If dt.Rows.Count > 0 Then

                        For j = 0 To dt.Rows.Count - 1

                            totalDesDesVentesDeLaFamille += dt.Rows(j)("MONTANT TOTAL")
                            totalDesDesVentes += dt.Rows(j)("MONTANT TOTAL")

                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(j)("LIBELLE ARTICLE"), font1))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j)("PRIX UNITAIRE"), "#,##0"), font1))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.AddCell(pdfCell)

                            Dim QUANTITE As Double = dt.Rows(j)("QUANTITE")

                            If QUANTITE = 0 Then
                                QUANTITE = dt.Rows(j)("MONTANT TOTAL") / dt.Rows(j)("PRIX UNITAIRE")
                            End If

                            pdfCell = New PdfPCell(New Paragraph(Format(QUANTITE, "#,##0"), font1))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j)("MONTANT TOTAL"), "#,##0"), font1))
                            pdfCell.MinimumHeight = 5
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                            totalQte += QUANTITE

                            pdfTable.AddCell(pdfCell)

                        Next

                    End If

                    pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(totalQte, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.Border = 0
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY

                    pdfCell = New PdfPCell(New Paragraph(Format(totalDesDesVentesDeLaFamille, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 15
                    pdfCell.Border = 0
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfDoc.Add(pdfTable)

                Next

                '------------------------------------------------------------------------

                Dim p11 As Paragraph = New Paragraph(Chr(13), pRow)
                p11.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p11)

                Dim pdfTable4 As New PdfPTable(2) 'Number of columns

                pdfTable4.TotalWidth = 520.0F
                pdfTable4.LockedWidth = True
                pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfTable4.HeaderRows = 1

                Dim widths4 As Single() = New Single() {60.0F, 20.0F}
                pdfTable4.SetWidths(widths4)

                Dim pdfCell4 As PdfPCell = Nothing

                pdfCell4 = New PdfPCell(New Paragraph("TOTAL DES VENTES : ", pRow))
                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell4.MinimumHeight = 18
                pdfCell4.PaddingLeft = 15.0F
                pdfCell4.Border = 0
                pdfTable4.AddCell(pdfCell4)

                pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesVentes, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell4.MinimumHeight = 18
                pdfCell4.PaddingLeft = 15.0F
                pdfCell4.Border = 0
                pdfTable4.AddCell(pdfCell4)

                pdfCell4 = New PdfPCell(New Paragraph("VENTE NET : ", pRow))
                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell4.MinimumHeight = 18
                pdfCell4.PaddingLeft = 15.0F
                pdfCell4.Border = 0
                pdfTable4.AddCell(pdfCell4)

                pdfCell4 = New PdfPCell(New Paragraph(Format(totalDesDesVentes, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), pRow))
                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell4.MinimumHeight = 18
                pdfCell4.PaddingLeft = 15.0F
                pdfCell4.Border = 0
                pdfTable4.AddCell(pdfCell4)

                pdfDoc.Add(pdfTable4)

                '--------------------- RESUMES DES VENTES -------------------------------

                If ListeDesResumeDesVentes.Rows.Count > 0 Then

                    Dim compte As Double = 0
                    Dim gratuitee As Double = 0
                    Dim chambre As Double = 0
                    Dim comptoir As Double = 0
                    Dim offreEnChambre As Double = 0

                    For i = 0 To ListeDesResumeDesVentes.Rows.Count - 1
                        compte += ListeDesResumeDesVentes(i)("COMPTE")
                        gratuitee += ListeDesResumeDesVentes(i)("GRATUITEE")
                        chambre += ListeDesResumeDesVentes(i)("EN_CHAMBRE")
                        comptoir += ListeDesResumeDesVentes(i)("COMPTOIR")
                        offreEnChambre += ListeDesResumeDesVentes(i)("GRATUITE_EN_CHAMBRE")
                    Next

                    Dim pdfTable04 As New PdfPTable(10) 'Number of columns

                    pdfTable04.TotalWidth = 520.0F
                    pdfTable04.LockedWidth = True
                    pdfTable04.HorizontalAlignment = Element.ALIGN_RIGHT
                    'pdfTable04.HeaderRows = 1

                    Dim widths04 As Single() = New Single() {15.0F, 15.0F, 16.0F, 16.0F, 17.0F, 17.0F, 17.0F, 17.0F, 14.0F, 14.0F}
                    pdfTable04.SetWidths(widths04)

                    Dim pdfCell04 As PdfPCell = Nothing

                    pdfCell04 = New PdfPCell(New Paragraph("VENTE COMPTOIR", pRow1))
                    pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell04.MinimumHeight = 10
                    pdfCell04.Colspan = 2
                    pdfCell04.PaddingLeft = 15.0F
                    pdfTable04.AddCell(pdfCell04)

                    pdfCell04 = New PdfPCell(New Paragraph("VENTE EN CHAMBRE", pRow1))
                    pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell04.MinimumHeight = 10
                    pdfCell04.Colspan = 2
                    pdfCell04.PaddingLeft = 15.0F
                    pdfTable04.AddCell(pdfCell04)

                    pdfCell04 = New PdfPCell(New Paragraph("OFFRES EN CHAMBRE", pRow1))
                    pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell04.MinimumHeight = 10
                    pdfCell04.Colspan = 2
                    pdfCell04.PaddingLeft = 15.0F
                    pdfTable04.AddCell(pdfCell04)

                    pdfCell04 = New PdfPCell(New Paragraph("AUTRES OFFRES", pRow1))
                    pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell04.MinimumHeight = 10
                    pdfCell04.Colspan = 2
                    pdfCell04.PaddingLeft = 15.0F
                    pdfTable04.AddCell(pdfCell04)

                    pdfCell04 = New PdfPCell(New Paragraph("VERS COMPTE", pRow1))
                    pdfCell04.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell04.MinimumHeight = 10
                    pdfCell04.Colspan = 2
                    pdfCell04.PaddingLeft = 15.0F
                    pdfTable04.AddCell(pdfCell04)

                    '-------------------------- HEADER END --------------------------

                    pdfCell04 = New PdfPCell(New Paragraph(Format(comptoir, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                    pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell04.MinimumHeight = 10
                    pdfCell04.Colspan = 2
                    pdfCell04.PaddingLeft = 15.0F
                    pdfTable04.AddCell(pdfCell04)

                    pdfCell04 = New PdfPCell(New Paragraph(Format(chambre, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                    pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell04.MinimumHeight = 10
                    pdfCell04.Colspan = 2
                    pdfCell04.PaddingLeft = 15.0F
                    pdfTable04.AddCell(pdfCell04)

                    pdfCell04 = New PdfPCell(New Paragraph(Format(offreEnChambre, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                    pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell04.MinimumHeight = 10
                    pdfCell04.Colspan = 2
                    pdfCell04.PaddingLeft = 15.0F
                    pdfTable04.AddCell(pdfCell04)

                    pdfCell04 = New PdfPCell(New Paragraph(Format(gratuitee - offreEnChambre, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                    pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell04.MinimumHeight = 10
                    pdfCell04.Colspan = 2
                    pdfCell04.PaddingLeft = 15.0F
                    pdfTable04.AddCell(pdfCell04)

                    pdfCell04 = New PdfPCell(New Paragraph(Format(compte, "#,##0") & " " & societe.Rows(0)("CODE_MONNAIE"), font1))
                    pdfCell04.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell04.MinimumHeight = 10
                    pdfCell04.Colspan = 2
                    pdfCell04.PaddingLeft = 15.0F
                    pdfTable04.AddCell(pdfCell04)

                    pdfDoc.Add(pdfTable04)

                End If


                ' ------------------------------------------------------------------------------------------------
                Dim p002 As Paragraph = New Paragraph(Chr(13) & "Arrêter la présente à la somme de : " & Functions.NBLT(totalDesDesVentes - totalDesDesVentes2) & " " & societe.Rows(0)("CODE_MONNAIE") & Chr(13) & Chr(13), pRow)
                p002.Alignment = Element.ALIGN_LEFT

                pdfDoc.Add(p002)

                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Process.Start(sfd.FileName)

            Else

                MessageBox.Show("Aucun Document à imprimer", "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            End If

        End If

    End Sub


    Public Shared Function resumeDesVentesQuotidienne(ByVal DateDebut As Date, ByVal DateFin As Date, ByVal CODE_UTILISATEUR As String) As DataTable

        Dim getUserQuery = "SELECT * FROM resume_vente_journaliere WHERE DATE_VENTE >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_VENTE <= '" & DateFin.ToString("yyyy-MM-dd") & "' AND CODE_UTILISATEUR=@CODE_UTILISATEUR"

        Dim command As New MySqlCommand(getUserQuery, GlobalVariable.connect)

        command.Parameters.Add("@CODE_UTILISATEUR", MySqlDbType.VarChar).Value = CODE_UTILISATEUR

        Dim adapter As New MySqlDataAdapter(command)

        Dim listeDesResumeDesVentes As New DataTable()

        adapter.Fill(listeDesResumeDesVentes)

        Return listeDesResumeDesVentes

    End Function

    Public Shared Function resumeDesVentesGlobal(ByVal DateDebut As Date, ByVal DateFin As Date) As DataTable

        Dim getUserQuery = "SELECT * FROM resume_vente_journaliere WHERE DATE_VENTE >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_VENTE <= '" & DateFin.ToString("yyyy-MM-dd") & "'"

        Dim command As New MySqlCommand(getUserQuery, GlobalVariable.connect)

        Dim adapter As New MySqlDataAdapter(command)

        Dim listeDesResumeDesVentes As New DataTable()

        adapter.Fill(listeDesResumeDesVentes)

        Return listeDesResumeDesVentes

    End Function


    'PLANNING DE NETTOYAGE
    Public Shared Sub planningDeNettoyage(ByVal dt As DataTable, ByVal typeDerapport As Integer, ByVal DateDebut As Date, ByVal DateFin As Date)

        Dim writer As PdfWriter
        Dim Document As Document

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalCommande As Double = 0

        Dim tireDocument As String = ""

        If typeDerapport = 0 Then
            tireDocument = "PLANNING DE NETTOYAGE DU " & Date.Now().ToString("ddMMyyHHmmss") & " "
        ElseIf typeDerapport = 1 Then
            tireDocument = "RAPPORT DE PRODUCTIVITE DU " & Date.Now().ToString("ddMMyyHHmmss") & " "
        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc

            'If typeDerapport = 0 Then
            'pdfDoc = New Document(PageSize.A4, 20, 20, 20, 20)
            'ElseIf typeDerapport = 1 Then
            'pdfDoc = New Document(PageSize.A4.Rotate, 20, 20, 20, 20)
            'End If

            pdfDoc = New Document(PageSize.A4.Rotate, 20, 20, 20, 20)

            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            pdfDoc.Open()

            '--------------------------- HEADER --------------------------

            Dim HeaderFont As New Font(Font.FontFamily.COURIER, 18, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            'Dim font1 As New Font(Font.FontFamily.COURIER, 13, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim font2 As New Font(Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim pdfCell As PdfPCell = Nothing

            Dim img() As Byte
            img = societe.Rows(0)("LOGO")

            Dim mStream As New MemoryStream(img)

            Dim logo As Image
            logo = Image.GetInstance(img)
            logo.ScalePercent(24.0F)

            Dim pHeaderLogo As New PdfPTable(1)
            'pHeaderLogo.TotalWidth = Document.PageSize.Width
            pHeaderLogo.DefaultCell.Border = 0

            pdfCell = New PdfPCell(logo)
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.PaddingLeft = 5.0F
            pdfCell.Border = 0 'used to remove borders on the cells
            pHeaderLogo.AddCell(pdfCell)
            'pHeaderLogo.WriteSelectedRows(0, -1, 0, Document.GetTop(Document.TopMargin) + 125, writer.DirectContent)
            pdfDoc.Add(pHeaderLogo)

            Dim pHeader As New PdfPTable(1)
            'pHeader.TotalWidth = Document.PageSize.Width
            pHeader.DefaultCell.Border = 0

            pdfCell = New PdfPCell(New Paragraph(societe.Rows(0)("RAISON_SOCIALE"), HeaderFont))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.PaddingLeft = 5.0F
            pdfCell.Border = 0 'used to remove borders on the cells
            pHeader.AddCell(pdfCell)
            pdfDoc.Add(pHeader)

            'pHeader.WriteSelectedRows(0, -1, document.LeftMargin, document.GetTop(document.TopMargin) + 110, writer.DirectContent)
            'pHeader.WriteSelectedRows(0, -1, 0, Document.GetTop(Document.TopMargin) + 150, writer.DirectContent)

            Dim pHeaderSubTitle As New PdfPTable(1)
            ' pHeaderSubTitle.TotalWidth = Document.PageSize.Width
            pHeaderSubTitle.DefaultCell.Border = 0

            pdfCell = New PdfPCell(New Paragraph(societe.Rows(0)("PAYS") & " - " & societe.Rows(0)("VILLE") & Chr(13) & "TELEPHONE: " & societe.Rows(0)("TELEPHONE") & Chr(13) & "EMAIL: " & societe.Rows(0)("EMAIL"), font1))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.PaddingLeft = 15.0F
            pdfCell.Border = 0
            'pHeaderSubTitle.AddCell(pdfCell)
            'pHeaderSubTitle.WriteSelectedRows(0, -1, 0, Document.GetTop(Document.TopMargin) + 120, writer.DirectContent)

            pdfDoc.Add(pHeaderSubTitle)

            Dim pHeaderSubTitle1 As New PdfPTable(1)
            'pHeaderSubTitle1.TotalWidth = Document.PageSize.Width
            pHeaderSubTitle1.DefaultCell.Border = 0

            pdfCell = New PdfPCell(New Paragraph("BOITE POSTALE: " & societe.Rows(0)("BOITE_POSTALE") & Chr(13) & societe.Rows(0)("NUM_CONTRIBUABLE") & Chr(13) & societe.Rows(0)("NUM_REGISTRE"), font1))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.PaddingLeft = 15.0F
            pdfCell.Border = 0
            pHeaderSubTitle1.AddCell(pdfCell)
            'pdfDoc.Add(pHeaderSubTitle1)

            ' ------------------------------------------------------------

            'pdfWrite.PageEvent = New HeaderFooter

            Dim p1 As Paragraph = New Paragraph("LA ROCHELLE HOTEL " & Chr(13) & "***" & Chr(13) & Chr(13), pColumn)
            p1.Alignment = Element.ALIGN_CENTER

            'pdfDoc.Add(p1)

            If dt.Rows.Count > 0 Then

                For i = 0 To dt.Rows.Count - 1
                    'TotalCommande += Functions.NonprelevementDeTaxeSurUnMontant(dt.Rows(i).Cells("MONTANT HT").Value)
                Next

            End If

            Dim p2 As Paragraph = New Paragraph(Chr(13) & "PLANNING DE NETTOYAGE DU " & Date.Now() & Chr(13) & Chr(13), fontTotal)
            p2.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p2)

            'UN PERSONNEL QUELCONQUE

            For i = 0 To dt.Rows.Count - 1

                Dim nombreDeChambre As Integer = 0
                Dim tempsTotal As Integer = 0
                Dim totauxDesTemps As Integer = 0

                Dim pdfTable

                If typeDerapport = 0 Then
                    pdfTable = New PdfPTable(7) 'Number of columns
                    pdfTable.TotalWidth = 790.0F
                ElseIf typeDerapport = 1 Then
                    pdfTable = New PdfPTable(11) 'Number of columns
                    pdfTable.TotalWidth = 800.0F
                End If

                pdfTable.LockedWidth = True
                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable.HeaderRows = 1

                Dim widths As Single()

                If typeDerapport = 0 Then
                    widths = New Single() {10.0F, 45.0F, 17.0F, 17.0F, 8.0F, 26.0F, 20.0F}
                ElseIf typeDerapport = 1 Then
                    widths = New Single() {15.0F, 65.0F, 25.0F, 25.0F, 10.0F, 35.0F, 30.0F, 18.0F, 18.0F, 18.0F, 22.0F}
                End If

                pdfTable.SetWidths(widths)

                Dim p3 As Paragraph = New Paragraph("NOM: " & dt.Rows(i)("NOM_COMPLET_PERSONNEL") & Chr(13) & Chr(13), fontTotal)
                p3.Alignment = Element.ALIGN_LEFT

                pdfDoc.Add(p3)

                If typeDerapport = 0 Then

                    pdfCell = New PdfPCell(New Paragraph("CH.", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("PAX", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("COMMENTAIRE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("NETTOYAGE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                ElseIf typeDerapport = 1 Then

                    pdfCell = New PdfPCell(New Paragraph("CH.", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("PAX", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("COMMENTAIRE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("NETTOYAGE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY

                    pdfCell = New PdfPCell(New Paragraph("DEBUT", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("FIN", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("TEMPS PASSE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("CONTROLE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                End If

                Dim Query1 As String

                If typeDerapport = 0 Then
                    Query1 = "SELECT * FROM `nettoyage` WHERE DATE_CREATION <= '" & DateFin.ToString("yyyy-MM-dd") & "' AND DATE_CREATION >='" & DateDebut.ToString("yyyy-MM-dd") & "' ORDER BY NOM_COMPLET_PERSONNEL ASC, CODE_CHAMBRE ASC"
                ElseIf typeDerapport = 1 Then
                    Query1 = "SELECT * FROM `nettoyage` WHERE DATE_CREATION <= '" & DateFin.ToString("yyyy-MM-dd") & "' AND DATE_CREATION >='" & DateDebut.ToString("yyyy-MM-dd") & "' ORDER BY NOM_COMPLET_PERSONNEL ASC, CODE_CHAMBRE ASC"
                End If

                Dim command1 = New MySqlCommand(Query1, GlobalVariable.connect)
                command1.Parameters.Add("@STATUTS", MySqlDbType.Int64).Value = 0
                command1.Parameters.Add("@STATUTS_1", MySqlDbType.Int64).Value = 1
                command1.Parameters.Add("@STATUTS_2", MySqlDbType.Int64).Value = 2
                command1.Parameters.Add("@STATUTS_3", MySqlDbType.Int64).Value = 3

                Dim adapter1 As New MySqlDataAdapter(command1)
                Dim dt2 As New DataTable()

                adapter1.Fill(dt2)

                'LISTE DES CHAMBRES LIEES A UN PERSONNEL
                If dt2.Rows.Count > 0 Then

                    For j = 0 To dt2.Rows.Count - 1

                        If typeDerapport = 0 And dt2.Rows(j)("COD_PERSONNEL") = dt.Rows(i)("COD_PERSONNEL") Then

                            nombreDeChambre += 1

                            pdfCell = New PdfPCell(New Paragraph(dt2.Rows(j)("CODE_CHAMBRE"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            '--------------------------------------------------------------------------------------
                            'DETERMINONS SI LA CHAMBRE EST OCCUPEE OU PAS
                            Dim CHAMBRE_ID As String = dt2.Rows(j)("CODE_CHAMBRE")
                            Dim resa As DataTable = Functions.GetAllElementsOnTwoConditions(CHAMBRE_ID, "reserve_conf", "CHAMBRE_ID", 1, "ETAT_RESERVATION")

                            If resa.Rows.Count > 0 Then
                                pdfCell = New PdfPCell(New Paragraph(resa.Rows(0)("NOM_CLIENT"), font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("-", font1))
                            End If

                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfTable.AddCell(pdfCell)

                            If resa.Rows.Count > 0 Then
                                pdfCell = New PdfPCell(New Paragraph(resa.Rows(0)("DATE_ENTTRE"), font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("-", font1))
                            End If

                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            '--------------------------------------------------------------------------------------

                            If resa.Rows.Count > 0 Then
                                pdfCell = New PdfPCell(New Paragraph(resa.Rows(0)("DATE_SORTIE"), font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("-", font1))
                            End If
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                            pdfTable.AddCell(pdfCell)

                            If resa.Rows.Count > 0 Then
                                pdfCell = New PdfPCell(New Paragraph(resa.Rows(0)("NB_PERSONNES"), font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("-", font1))
                            End If
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(dt2.Rows(j)("COMMENTAIRE"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.AddCell(pdfCell)

                            If resa.Rows.Count > 0 Then
                                pdfCell = New PdfPCell(New Paragraph("EN RECOUCHE", font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("A BLANC", font1))
                            End If
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                        ElseIf typeDerapport = 1 And dt2.Rows(j)("COD_PERSONNEL") = dt.Rows(i)("COD_PERSONNEL") Then

                            nombreDeChambre += 1

                            pdfCell = New PdfPCell(New Paragraph(dt2.Rows(j)("CODE_CHAMBRE"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            'DETERMINONS SI LA CHAMBRE EST OCCUPEE OU PAS
                            Dim CHAMBRE_ID As String = dt2.Rows(j)("CODE_CHAMBRE")
                            Dim resa As DataTable = Functions.GetAllElementsOnTwoConditions(CHAMBRE_ID, "reserve_conf", "CHAMBRE_ID", 1, "ETAT_RESERVATION")

                            If resa.Rows.Count > 0 Then
                                pdfCell = New PdfPCell(New Paragraph(resa.Rows(0)("NOM_CLIENT"), font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("-", font1))
                            End If
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            If resa.Rows.Count > 0 Then
                                pdfCell = New PdfPCell(New Paragraph(resa.Rows(0)("DATE_ENTTRE"), font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("-", font1))
                            End If

                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            '--------------------------------------------------------------------------------------

                            If resa.Rows.Count > 0 Then
                                pdfCell = New PdfPCell(New Paragraph(resa.Rows(0)("DATE_SORTIE"), font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("-", font1))
                            End If
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                            pdfTable.AddCell(pdfCell)

                            If resa.Rows.Count > 0 Then
                                pdfCell = New PdfPCell(New Paragraph(resa.Rows(0)("NB_PERSONNES"), font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("-", font1))
                            End If
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(dt2.Rows(j)("COMMENTAIRE"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.AddCell(pdfCell)

                            If resa.Rows.Count > 0 Then
                                pdfCell = New PdfPCell(New Paragraph("EN RECOUCHE", font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("A BLANC", font1))
                            End If
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)


                            pdfCell = New PdfPCell(New Paragraph(CDate(dt2.Rows(j)("HEURE_DEBUT")).ToShortTimeString, font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(CDate(dt2.Rows(j)("HEURE_FIN")).ToShortTimeString, font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.AddCell(pdfCell)

                            Dim TimeSpend As TimeSpan = (dt2.Rows(j)("HEURE_FIN") - dt2.Rows(j)("HEURE_DEBUT"))

                            tempsTotal = TimeSpend.TotalMinutes

                            totauxDesTemps += tempsTotal

                            pdfCell = New PdfPCell(New Paragraph(Format(tempsTotal, "#,##0.0"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(CDate(dt2.Rows(j)("HEURE_CONTROL")).ToShortTimeString, font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                        End If


                    Next

                    pdfDoc.Add(pdfTable)

                    Dim p4 As Paragraph = New Paragraph("NOMBRE DE CHAMBRE : " & nombreDeChambre & "           TEMPS TOTAL : " & Format(totauxDesTemps, "#,##0.0"), font1)
                    p4.Alignment = Element.ALIGN_RIGHT

                    pdfDoc.Add(p4)

                    ' ------------------------------------------------------------------------------------------------
                Else

                    MessageBox.Show("Aucune Ligne à imprimer!")

                End If

            Next

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub planningDeNettoyageShort(ByVal dt As DataTable, ByVal typeDerapport As Integer, ByVal DateDebut As Date, ByVal DateFin As Date)

        Dim writer As PdfWriter
        Dim Document As Document

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalCommande As Double = 0

        Dim tireDocument As String = ""
        Dim title As String = ""

        If GlobalVariable.actualLanguageValue = 1 Then

            If typeDerapport = 0 Then
                tireDocument = "PLANNING DE NETTOYAGE DU " & DateDebut.Now().ToString("ddMMyyHHmmss") & " "
                title = "PLANNING DE NETTOYAGE DU "
            ElseIf typeDerapport = 1 Then
                tireDocument = "RAPPORT DE PRODUCTIVITE DU " & Date.Now().ToString("ddMMyyHHmmss") & " "

            End If

        Else

            If typeDerapport = 0 Then
                tireDocument = "CLEANING OF THE " & Date.Now().ToString("ddMMyyHHmmss") & " "
                title = "CLEANING OF THE "
            ElseIf typeDerapport = 1 Then
                tireDocument = "PRODUCTIVITY REPORT OF THE " & Date.Now().ToString("ddMMyyHHmmss") & " "
            End If

        End If



        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc

            'If typeDerapport = 0 Then
            'pdfDoc = New Document(PageSize.A4, 20, 20, 20, 20)
            'ElseIf typeDerapport = 1 Then
            'pdfDoc = New Document(PageSize.A4.Rotate, 20, 20, 20, 20)
            'End If

            pdfDoc = New Document(PageSize.A4.Rotate, 20, 20, 20, 20)

            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            pdfDoc.Open()

            '--------------------------- HEADER --------------------------

            Dim HeaderFont As New Font(Font.FontFamily.COURIER, 18, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            'Dim font1 As New Font(Font.FontFamily.COURIER, 13, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim font2 As New Font(Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim pdfCell As PdfPCell = Nothing

            Dim img() As Byte
            img = societe.Rows(0)("LOGO")

            Dim mStream As New MemoryStream(img)

            Dim logo As Image
            logo = Image.GetInstance(img)
            logo.ScalePercent(24.0F)

            Dim pHeaderLogo As New PdfPTable(1)
            'pHeaderLogo.TotalWidth = Document.PageSize.Width
            pHeaderLogo.DefaultCell.Border = 0

            pdfCell = New PdfPCell(logo)
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.PaddingLeft = 5.0F
            pdfCell.Border = 0 'used to remove borders on the cells
            pHeaderLogo.AddCell(pdfCell)
            'pHeaderLogo.WriteSelectedRows(0, -1, 0, Document.GetTop(Document.TopMargin) + 125, writer.DirectContent)
            pdfDoc.Add(pHeaderLogo)

            Dim pHeader As New PdfPTable(1)
            'pHeader.TotalWidth = Document.PageSize.Width
            pHeader.DefaultCell.Border = 0

            pdfCell = New PdfPCell(New Paragraph(societe.Rows(0)("RAISON_SOCIALE"), HeaderFont))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.PaddingLeft = 5.0F
            pdfCell.Border = 0 'used to remove borders on the cells
            pHeader.AddCell(pdfCell)
            pdfDoc.Add(pHeader)

            'pHeader.WriteSelectedRows(0, -1, document.LeftMargin, document.GetTop(document.TopMargin) + 110, writer.DirectContent)
            'pHeader.WriteSelectedRows(0, -1, 0, Document.GetTop(Document.TopMargin) + 150, writer.DirectContent)

            Dim pHeaderSubTitle As New PdfPTable(1)
            ' pHeaderSubTitle.TotalWidth = Document.PageSize.Width
            pHeaderSubTitle.DefaultCell.Border = 0

            pdfCell = New PdfPCell(New Paragraph(societe.Rows(0)("PAYS") & " - " & societe.Rows(0)("VILLE") & Chr(13) & "TELEPHONE: " & societe.Rows(0)("TELEPHONE") & Chr(13) & "EMAIL: " & societe.Rows(0)("EMAIL"), font1))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.PaddingLeft = 15.0F
            pdfCell.Border = 0
            'pHeaderSubTitle.AddCell(pdfCell)
            'pHeaderSubTitle.WriteSelectedRows(0, -1, 0, Document.GetTop(Document.TopMargin) + 120, writer.DirectContent)

            pdfDoc.Add(pHeaderSubTitle)

            Dim pHeaderSubTitle1 As New PdfPTable(1)
            'pHeaderSubTitle1.TotalWidth = Document.PageSize.Width
            pHeaderSubTitle1.DefaultCell.Border = 0

            pdfCell = New PdfPCell(New Paragraph("BOITE POSTALE: " & societe.Rows(0)("BOITE_POSTALE") & Chr(13) & societe.Rows(0)("NUM_CONTRIBUABLE") & Chr(13) & societe.Rows(0)("NUM_REGISTRE"), font1))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.PaddingLeft = 15.0F
            pdfCell.Border = 0
            pHeaderSubTitle1.AddCell(pdfCell)
            'pdfDoc.Add(pHeaderSubTitle1)

            ' ------------------------------------------------------------

            'pdfWrite.PageEvent = New HeaderFooter

            If dt.Rows.Count > 0 Then

                For i = 0 To dt.Rows.Count - 1
                    'TotalCommande += Functions.NonprelevementDeTaxeSurUnMontant(dt.Rows(i).Cells("MONTANT HT").Value)
                Next

            End If

            Dim p2 As Paragraph = New Paragraph(Chr(13) & title & DateDebut.ToShortDateString & Chr(13) & Chr(13), fontTotal)
            p2.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p2)

            'UN PERSONNEL QUELCONQUE

            For i = 0 To dt.Rows.Count - 1

                Dim nombreDeChambre As Integer = 0
                Dim tempsTotal As Integer = 0
                Dim totauxDesTemps As Integer = 0

                Dim pdfTable

                If typeDerapport = 0 Then
                    pdfTable = New PdfPTable(7) 'Number of columns
                    pdfTable.TotalWidth = 790.0F
                ElseIf typeDerapport = 1 Then
                    pdfTable = New PdfPTable(11) 'Number of columns
                    pdfTable.TotalWidth = 800.0F
                End If

                pdfTable.LockedWidth = True
                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable.HeaderRows = 1

                Dim widths As Single()

                If typeDerapport = 0 Then
                    widths = New Single() {10.0F, 45.0F, 17.0F, 17.0F, 8.0F, 26.0F, 20.0F}
                ElseIf typeDerapport = 1 Then
                    widths = New Single() {15.0F, 65.0F, 25.0F, 25.0F, 10.0F, 35.0F, 30.0F, 18.0F, 18.0F, 18.0F, 22.0F}
                End If

                pdfTable.SetWidths(widths)

                If typeDerapport = 0 Then

                    pdfCell = New PdfPCell(New Paragraph("CH.", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("PAX", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("COMMENTAIRE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("NETTOYAGE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                ElseIf typeDerapport = 1 Then

                    pdfCell = New PdfPCell(New Paragraph("CH.", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("PAX", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("COMMENTAIRE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("NETTOYAGE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY

                    pdfCell = New PdfPCell(New Paragraph("DEBUT", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("FIN", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("TEMPS PASSE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("CONTROLE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                End If

                Dim Query1 As String

                If typeDerapport = 0 Then
                    Query1 = "SELECT * FROM `nettoyage` WHERE DATE_CREATION <= '" & DateFin.ToString("yyyy-MM-dd") & "' AND DATE_CREATION >='" & DateDebut.ToString("yyyy-MM-dd") & "' ORDER BY NOM_COMPLET_PERSONNEL ASC, CODE_CHAMBRE ASC"
                ElseIf typeDerapport = 1 Then
                    Query1 = "SELECT * FROM `nettoyage` WHERE DATE_CREATION <= '" & DateFin.ToString("yyyy-MM-dd") & "' AND DATE_CREATION >='" & DateDebut.ToString("yyyy-MM-dd") & "' ORDER BY NOM_COMPLET_PERSONNEL ASC, CODE_CHAMBRE ASC"
                End If

                Dim command1 = New MySqlCommand(Query1, GlobalVariable.connect)
                command1.Parameters.Add("@STATUTS", MySqlDbType.Int64).Value = 0
                command1.Parameters.Add("@STATUTS_1", MySqlDbType.Int64).Value = 1
                command1.Parameters.Add("@STATUTS_2", MySqlDbType.Int64).Value = 2
                command1.Parameters.Add("@STATUTS_3", MySqlDbType.Int64).Value = 3

                Dim adapter1 As New MySqlDataAdapter(command1)
                Dim dt2 As New DataTable()

                adapter1.Fill(dt2)

                'LISTE DES CHAMBRES LIEES A UN PERSONNEL
                If dt2.Rows.Count > 0 Then

                    Dim chambreLibre As String = ""

                    For j = 0 To dt2.Rows.Count - 1

                        If typeDerapport = 0 And dt2.Rows(j)("COD_PERSONNEL") = dt.Rows(i)("COD_PERSONNEL") Then

                            pdfCell = New PdfPCell(New Paragraph(dt2.Rows(j)("CODE_CHAMBRE"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            '--------------------------------------------------------------------------------------
                            'DETERMINONS SI LA CHAMBRE EST OCCUPEE OU PAS
                            Dim CHAMBRE_ID As String = dt2.Rows(j)("CODE_CHAMBRE")
                            'Dim resa As DataTable = Functions.GetAllElementsOnTwoConditions(CHAMBRE_ID, "reserve_conf", "CHAMBRE_ID", 1, "ETAT_RESERVATION")
                            Dim resa As DataTable = Functions.InfoDUnEnChambre(CHAMBRE_ID, DateDebut)

                            If resa.Rows.Count > 0 Then
                                'On insere le code de chambre si la chambre est logé
                                pdfCell = New PdfPCell(New Paragraph(resa.Rows(0)("NOM_CLIENT"), font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("-", font1))
                            End If

                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                            'If Not Trim(chambreLibre).Equals("-") Then
                            pdfTable.AddCell(pdfCell)
                            nombreDeChambre += 1
                            'End If

                            If resa.Rows.Count > 0 Then
                                pdfCell = New PdfPCell(New Paragraph(resa.Rows(0)("DATE_ENTTRE"), font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("-", font1))
                            End If

                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                            'If Not Trim(chambreLibre).Equals("-") Then
                            pdfTable.AddCell(pdfCell)
                            'End If

                            '--------------------------------------------------------------------------------------

                            If resa.Rows.Count > 0 Then
                                pdfCell = New PdfPCell(New Paragraph(resa.Rows(0)("DATE_SORTIE"), font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("-", font1))
                            End If
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                            'If Not Trim(chambreLibre).Equals("-") Then
                            pdfTable.AddCell(pdfCell)
                            'End If

                            If resa.Rows.Count > 0 Then
                                pdfCell = New PdfPCell(New Paragraph(resa.Rows(0)("NB_PERSONNES"), font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("-", font1))
                            End If
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                            'If Not Trim(chambreLibre).Equals("-") Then
                            pdfTable.AddCell(pdfCell)
                            'End If

                            pdfCell = New PdfPCell(New Paragraph(dt2.Rows(j)("COMMENTAIRE"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                            'If Not Trim(chambreLibre).Equals("-") Then
                            pdfTable.AddCell(pdfCell)
                            'End If

                            If resa.Rows.Count > 0 Then
                                pdfCell = New PdfPCell(New Paragraph("EN RECOUCHE", font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("A BLANC", font1))
                            End If
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                            'If Not Trim(chambreLibre).Equals("-") Then
                            pdfTable.AddCell(pdfCell)
                            'End If

                        ElseIf typeDerapport = 1 And dt2.Rows(j)("COD_PERSONNEL") = dt.Rows(i)("COD_PERSONNEL") Then

                            nombreDeChambre += 1

                            pdfCell = New PdfPCell(New Paragraph(dt2.Rows(j)("CODE_CHAMBRE"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            'DETERMINONS SI LA CHAMBRE EST OCCUPEE OU PAS
                            Dim CHAMBRE_ID As String = dt2.Rows(j)("CODE_CHAMBRE")
                            Dim resa As DataTable = Functions.GetAllElementsOnTwoConditions(CHAMBRE_ID, "reserve_conf", "CHAMBRE_ID", 1, "ETAT_RESERVATION")

                            If resa.Rows.Count > 0 Then
                                pdfCell = New PdfPCell(New Paragraph(resa.Rows(0)("NOM_CLIENT"), font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("-", font1))
                            End If
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            If resa.Rows.Count > 0 Then
                                pdfCell = New PdfPCell(New Paragraph(resa.Rows(0)("DATE_ENTTRE"), font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("-", font1))
                            End If

                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            '--------------------------------------------------------------------------------------

                            If resa.Rows.Count > 0 Then
                                pdfCell = New PdfPCell(New Paragraph(resa.Rows(0)("DATE_SORTIE"), font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("-", font1))
                            End If
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                            pdfTable.AddCell(pdfCell)

                            If resa.Rows.Count > 0 Then
                                pdfCell = New PdfPCell(New Paragraph(resa.Rows(0)("NB_PERSONNES"), font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("-", font1))
                            End If
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(dt2.Rows(j)("COMMENTAIRE"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.AddCell(pdfCell)

                            If resa.Rows.Count > 0 Then
                                pdfCell = New PdfPCell(New Paragraph("EN RECOUCHE", font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph("A BLANC", font1))
                            End If
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)


                            pdfCell = New PdfPCell(New Paragraph(CDate(dt2.Rows(j)("HEURE_DEBUT")).ToShortTimeString, font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(CDate(dt2.Rows(j)("HEURE_FIN")).ToShortTimeString, font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.AddCell(pdfCell)

                            Dim TimeSpend As TimeSpan = (dt2.Rows(j)("HEURE_FIN") - dt2.Rows(j)("HEURE_DEBUT"))

                            tempsTotal = TimeSpend.TotalMinutes

                            totauxDesTemps += tempsTotal

                            pdfCell = New PdfPCell(New Paragraph(Format(tempsTotal, "#,##0.0"), font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(CDate(dt2.Rows(j)("HEURE_CONTROL")).ToShortTimeString, font1))
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfTable.AddCell(pdfCell)

                        End If

                        chambreLibre = ""

                    Next

                    pdfDoc.Add(pdfTable)

                    Dim p4 As Paragraph = New Paragraph("NOMBRE DE CHAMBRE : " & nombreDeChambre & "           TEMPS TOTAL : " & Format(totauxDesTemps, "#,##0.0"), font1)
                    p4.Alignment = Element.ALIGN_RIGHT

                    pdfDoc.Add(p4)

                    ' ------------------------------------------------------------------------------------------------
                Else

                    MessageBox.Show("Aucune Ligne à imprimer!")

                End If

            Next

            pdfDoc.Close()

            'MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub productionDelaCuisine(ByVal dt As DataTable, ByVal dateDebut As Date, ByVal dateFin As Date, ByVal tableName As String, ByVal title As String, Optional ByVal cumul As String = "")

        ' COMMANDES DE LA CUISINE

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalCommande As Double = 0

        Dim sousTitre As String = ""
        Dim titre As String = ""

        sousTitre = title

        Dim dateAAfficher As String = ""

        If dateDebut.ToShortDateString = dateFin.ToShortDateString Then
            dateAAfficher = dateDebut.ToShortDateString
        Else
            dateAAfficher = dateDebut.ToShortDateString & " - " & dateFin.ToShortDateString
        End If

        titre = sousTitre + " DU " & dateAAfficher

        Dim tireDocument As String = ""
        tireDocument = sousTitre & " " & Date.Now().ToString("ddMMyyHHmmss") & " "

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 20, 40)
            'Dim pdfDoc As New Document(PageSize.B7, 5, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pHotelName As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 16, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            Dim pdfTable As New PdfPTable(7) 'Number of columns
            pdfTable.TotalWidth = 520.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single() = New Single() {10.0F, 35.0F, 16.0F, 16.0F, 16.0F, 16.0F, 16.0F}

            pdfTable.SetWidths(widths)

            Dim pdfCell As PdfPCell = Nothing

            'pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & "***", pHotelName)
            p1.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p1)

            Dim p2 As Paragraph = New Paragraph(Chr(13) & titre.ToUpper() & Chr(13) & Chr(13), pRow)
            p2.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p2)

            Dim p04 As Paragraph = New Paragraph("A- LISTE DES PLATS CUISINES " & Chr(13) & Chr(13), pRow)
            p04.Alignment = Element.ALIGN_RIGHT

            pdfDoc.Add(p04)

            pdfCell = New PdfPCell(New Paragraph("ORDRE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("PLATS CUISINES", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("QUANTITE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("COUT DE PRODUCTION", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("PRIX DE VENTE/PLAT", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            'pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("MARGE BRUTE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("DATE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            If Trim(cumul).Equals("") Then

                If dt.Rows.Count > 0 Then

                    Dim QUANTITE As Double = 0
                    Dim nombreDePlatPrepare As Integer = 0
                    Dim CODE_ARTICLE As String = ""
                    Dim CODE_FICHE_TECHNIQUE As String = ""

                    Dim totalDesVenteDesPlatsPrepares As Double = 0
                    Dim coutDeProductionDesPlatsPrepares As Double = 0

                    Dim ficheTechniqueElements As New Article()

                    For i = 0 To dt.Rows.Count - 1

                        '--------------------------CALCUL DU PRIX DE MARGE, COUT DE PRODUCTION & PRIX DE VENTE----------------------------------------------
                        Dim totalDeProduction As Double = 0

                        Dim totalDesVentes As Double = 0

                        QUANTITE = dt.Rows(i)("QUANTITE")
                        CODE_ARTICLE = dt.Rows(i)("CODE_ARTICLE")
                        CODE_FICHE_TECHNIQUE = dt.Rows(i)("CODE_FICHE_TECHNIQUE")

                        'ON DETERMINE LES QUANTITES
                        nombreDePlatPrepare += Double.Parse(QUANTITE)

                        Dim infoSupArticle As DataTable = Functions.getElementByCode(CODE_ARTICLE, "article", "CODE_ARTICLE")

                        '------------------------------------ SELECTION DE TOUS LES PRIX D-------------------------

                        'ON DETERMINE LE PRIX DE VENTE DE L'ARTICLE
                        If infoSupArticle.Rows.Count > 0 Then

                            'totalDesVenteDesPlatsPrepares += Double.Parse(infoSupArticle.Rows(0)("PRIX_VENTE_HT")) * QUANTITE
                            'totalDesVentes = Double.Parse(infoSupArticle.Rows(0)("PRIX_VENTE_HT")) * QUANTITE

                            totalDesVenteDesPlatsPrepares += Double.Parse(dt.Rows(i)("PRIX_VENTE")) * QUANTITE

                            totalDesVentes = Double.Parse(dt.Rows(i)("PRIX_VENTE")) * QUANTITE

                            Dim ficheTechElement As DataTable = ficheTechniqueElements.elementsDuneFicheTechniquePourPreparation(CODE_FICHE_TECHNIQUE)

                            '-----------------------------------------------------------------------------------------------------------------------------
                            Dim infoSupFTDivers As DataTable = Functions.getElementByCode(CODE_FICHE_TECHNIQUE, "fiche_technique", "CODE_FICHE_TECHNIQUE")

                            Dim DIVERS_MONTANT As Double = 0

                            If infoSupFTDivers.Rows.Count > 0 Then
                                DIVERS_MONTANT = Double.Parse(infoSupFTDivers.Rows(0)("DIVERS_MONTANT"))
                            End If

                            '------------------------------------------------------------------------------------------------------------------------------
                            'ON DETERMINE LE PRIX DE PRODUCTION DE L'ARTICLE A PARTIR DE SA FICHE TECHNIQUE
                            If ficheTechElement.Rows.Count > 0 Then

                                totalDeProduction = 0

                                For j = 0 To ficheTechElement.Rows.Count - 1
                                    totalDeProduction += (ficheTechElement(j)("COUT DE REVIENT")) * QUANTITE
                                Next

                                totalDeProduction += DIVERS_MONTANT * QUANTITE
                                coutDeProductionDesPlatsPrepares += totalDeProduction

                            End If

                        End If
                        '------------------------------------------------------------------------

                        pdfCell = New PdfPCell(New Paragraph(i + 1, font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(i)("ARTICLE"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(i)("QUANTITE"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalDeProduction, "#,##0"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalDesVentes, "#,##0"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalDesVentes - totalDeProduction, "#,##0"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(i)("DATE_PREPARATION"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                        pdfTable.AddCell(pdfCell)

                    Next

                    pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(nombreDePlatPrepare, "#,##0"), fontTotal))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(coutDeProductionDesPlatsPrepares, "#,##0"), fontTotal))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(totalDesVenteDesPlatsPrepares, "#,##0"), fontTotal))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(totalDesVenteDesPlatsPrepares - coutDeProductionDesPlatsPrepares, "#,##0"), fontTotal))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", fontTotal))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                    pdfTable.AddCell(pdfCell)

                    pdfDoc.Add(pdfTable)

                    '----------------------------- POUR NE PAS AFFICHER LES FICHES TECHNIQUES EN DOUBLE-------------------------------------------

                    'Dim ftQuery = "SELECT `CODE_ARTICLE`, `NOM_ARTICLE` AS ARTICLE, `CODE_FICHE_TECHNIQUE`, `QUANTITE_PREPARE` AS QUANTITE, `DATE_PREPARATION`, `ETAT`, `RANDOM_CODE` FROM `commande_cuisine` WHERE ETAT=@ETAT AND DATE_PREPARATION=@DATE_PREPARATION"
                    Dim ftQuery = "SELECT DISTINCT `CODE_FICHE_TECHNIQUE` FROM  " & tableName & " WHERE ETAT=@ETAT AND DATE_PREPARATION <= '" & dateFin.ToString("yyyy-MM-dd") & "' AND DATE_PREPARATION >= '" & dateDebut.ToString("yyyy-MM-dd") & "' "

                    Dim commandFt As New MySqlCommand(ftQuery, GlobalVariable.connect)
                    commandFt.Parameters.Add("@ETAT", MySqlDbType.Int64).Value = 1

                    Dim adapterFt As New MySqlDataAdapter(commandFt)
                    Dim tableFt As New DataTable()

                    adapterFt.Fill(tableFt)

                    Dim grandTotalCoutAchat As Double = 0

                    If tableFt.Rows.Count > 0 Then

                        Dim p004 As Paragraph = New Paragraph(Chr(13) & Chr(13) & Chr(13) & "B- LISTE DES FICHES TECHNIQUES " & Chr(13), pRow)
                        p004.Alignment = Element.ALIGN_RIGHT

                        pdfDoc.Add(p004)

                        Dim infoSupFt As DataTable

                        Dim NOMBRE_FT As Integer = 0

                        Dim DIVERS_MONTANT As Double = 0
                        Dim DIVERS_POURCENTAGE As Double = 0

                        For i = 0 To tableFt.Rows.Count - 1

                            Dim NOM_FT As String = ""

                            CODE_FICHE_TECHNIQUE = tableFt.Rows(i)("CODE_FICHE_TECHNIQUE")

                            '---------------------------- DETERMINONS LE NOMBRE D'OCCURENCE DE LA FICHE TECHNIQUE EN COURS DANS LA TABLE CUISINE -----------------------

                            Dim ftQueryCount = "SELECT SUM(QUANTITE_PREPARE) as NOMBRE FROM " & tableName & " WHERE ETAT=@ETAT AND DATE_PREPARATION <= '" & dateFin.ToString("yyyy-MM-dd") & "' AND DATE_PREPARATION >= '" & dateDebut.ToString("yyyy-MM-dd") & "'  AND CODE_FICHE_TECHNIQUE=@CODE_FICHE_TECHNIQUE"

                            Dim commandFtCount As New MySqlCommand(ftQueryCount, GlobalVariable.connect)
                            commandFtCount.Parameters.Add("@ETAT", MySqlDbType.Int64).Value = 1
                            commandFtCount.Parameters.Add("@CODE_FICHE_TECHNIQUE", MySqlDbType.VarChar).Value = CODE_FICHE_TECHNIQUE

                            Dim adapterFtCount As New MySqlDataAdapter(commandFtCount)
                            Dim tableFtCount As New DataTable()

                            adapterFtCount.Fill(tableFtCount)

                            If tableFtCount.Rows.Count > 0 Then
                                NOMBRE_FT = tableFtCount.Rows(0)("NOMBRE")
                            End If

                            '------------------------------------------------------------------------------------------------------------
                            infoSupFt = Functions.getElementByCode(CODE_FICHE_TECHNIQUE, "fiche_technique", "CODE_FICHE_TECHNIQUE")

                            If infoSupFt.Rows.Count > 0 Then
                                NOM_FT = infoSupFt.Rows(0)("LIBELLE_FICHE")
                                DIVERS_MONTANT = infoSupFt.Rows(0)("DIVERS_MONTANT")
                                DIVERS_POURCENTAGE = infoSupFt.Rows(0)("DIVERS_POURCENTAGE")
                            End If

                            Dim p5 As Paragraph = New Paragraph(Chr(13) & i + 1 & "- " & NOM_FT & " ( " & NOMBRE_FT & " ) " & Chr(13) & Chr(13), pRow)
                            p5.Alignment = Element.ALIGN_LEFT

                            pdfDoc.Add(p5)

                            'MATIERES DESTOCKAGE
                            Dim pdfTable1 As New PdfPTable(7) 'Number of columns
                            pdfTable1.TotalWidth = 520.0F
                            pdfTable1.LockedWidth = True
                            pdfTable1.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable1.HeaderRows = 1

                            Dim widths1 As Single() = New Single() {10.0F, 35.0F, 16.0F, 16.0F, 16.0F, 16.0F, 16.0F}

                            pdfTable1.SetWidths(widths1)

                            pdfCell = Nothing

                            pdfCell = New PdfPCell(New Paragraph("ORDRE", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable1.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("MATIERE PREMIERE", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable1.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("UNITE", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable1.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("QTE UTILISE", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            pdfTable1.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("QTE / PORTION", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable1.AddCell(pdfCell)

                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            'pdfTable1.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("COUT / PORTION", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable1.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("COUT ACHAT", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable1.AddCell(pdfCell)

                            'Dim ficheTechniqueElements As New Article()

                            Dim dtFicheMatiere As DataTable = ficheTechniqueElements.elementsDuneFicheTechnique(CODE_FICHE_TECHNIQUE)

                            Dim CoutTotalAchat As Double = 0

                            If dtFicheMatiere.Rows.Count > 0 Then

                                For j = 0 To dtFicheMatiere.Rows.Count - 1

                                    '--------------------------------MATIERE DES COMMANDES ---------------------------------------------

                                    pdfCell = New PdfPCell(New Paragraph(j + 1, font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfTable1.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(dtFicheMatiere.Rows(j)("DESIGNATION"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfTable1.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(dtFicheMatiere.Rows(j)("UNITE COMPTAGE"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfTable1.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(dtFicheMatiere.Rows(j)("QUANTITE UTILISE") * NOMBRE_FT, "#,##0"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfTable1.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(dtFicheMatiere.Rows(j)("QTE / PORTION"), "#,##0"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfTable1.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(dtFicheMatiere.Rows(j)("COUT ACHAT"), "#,##0.0"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                    pdfTable1.AddCell(pdfCell)

                                    CoutTotalAchat += (dtFicheMatiere.Rows(j)("COUT DE REVIENT")) * NOMBRE_FT

                                    pdfCell = New PdfPCell(New Paragraph(Format((dtFicheMatiere.Rows(j)("COUT DE REVIENT")) * NOMBRE_FT, "#,##0"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                    pdfTable1.AddCell(pdfCell)

                                Next

                                '------------------------- INSERTION DE LA LIGNE DES DIVERS ---------------------------------------

                                pdfCell = New PdfPCell(New Paragraph(dtFicheMatiere.Rows.Count + 1, font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfTable1.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph("DIVERS", font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfTable1.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(" % ", font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfTable1.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(DIVERS_POURCENTAGE, "#,##0"), font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfTable1.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(DIVERS_MONTANT, "#,##0"), font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfTable1.AddCell(pdfCell)

                                CoutTotalAchat += DIVERS_MONTANT * NOMBRE_FT

                                pdfCell = New PdfPCell(New Paragraph(Format(DIVERS_MONTANT, "#,##0"), font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfTable1.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(DIVERS_MONTANT * NOMBRE_FT, "#,##0"), font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfTable1.AddCell(pdfCell)

                                '--------------------------------------------------------------------------------------------------

                                pdfCell = New PdfPCell(New Paragraph("TOTAL : ", fontTotal))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.Colspan = 6
                                pdfCell.Border = 0
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfTable1.AddCell(pdfCell)

                                grandTotalCoutAchat += CoutTotalAchat

                                pdfCell = New PdfPCell(New Paragraph(Format(CoutTotalAchat, "#,##0"), fontTotal))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfTable1.AddCell(pdfCell)

                                pdfDoc.Add(pdfTable1)

                            End If

                        Next

                        Dim p005 As Paragraph = New Paragraph(Chr(13), pColumn)
                        p005.Alignment = Element.ALIGN_RIGHT

                        pdfDoc.Add(p005)

                        Dim pdfTable2 As New PdfPTable(7) 'Number of columns

                        pdfTable2.TotalWidth = 520.0F
                        pdfTable2.LockedWidth = True
                        pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                        'pdfTable2.HeaderRows = 1

                        Dim widths2 As Single() = New Single() {10.0F, 35.0F, 16.0F, 16.0F, 16.0F, 16.0F, 16.0F}
                        pdfTable2.SetWidths(widths2)

                        Dim pdfCell2 As PdfPCell = Nothing

                        pdfCell2 = New PdfPCell(New Paragraph("COUT TOTAL DE PRODUCTION : ", fontTotal))

                        pdfCell2.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell2.MinimumHeight = 5
                        pdfCell2.PaddingLeft = 15.0F
                        pdfCell2.Border = 0
                        pdfCell2.Colspan = 6
                        pdfTable2.AddCell(pdfCell2)

                        pdfCell2 = New PdfPCell(New Paragraph(Format(grandTotalCoutAchat, "#,##0"), fontTotal))
                        pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell2.MinimumHeight = 5
                        pdfCell2.PaddingLeft = 15.0F
                        pdfCell2.Border = 0
                        pdfTable2.AddCell(pdfCell2)

                        pdfDoc.Add(pdfTable2)

                    End If

                    pdfDoc.Close()

                    MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                    Process.Start(sfd.FileName)

                    '------------------------------------------------------------------------
                Else
                    MessageBox.Show("Aucune Ligne à imprimer!")
                End If

            Else

                'TRAITEMENT DU CUMUL DE LA PRODUCTION DE LA CUISINE

                If dt.Rows.Count > 0 Then

                    Dim QUANTITE As Double = 0
                    Dim nombreDePlatPrepare As Integer = 0
                    Dim CODE_ARTICLE As String = ""
                    Dim CODE_FICHE_TECHNIQUE As String = ""

                    Dim totalDesVenteDesPlatsPrepares As Double = 0
                    Dim coutDeProductionDesPlatsPrepares As Double = 0

                    Dim ficheTechniqueElements As New Article()

                    'POUR CHAQUE ARTICLE 

                    For i = 0 To dt.Rows.Count - 1

                        Dim totalDeProduction As Double = 0
                        Dim totalDesVentes As Double = 0

                        ' ON DETERMINE LA QTE TOTALE PRODUITE

                        '-----------------------------------------------------------------------------------------------------------------------------------
                        CODE_ARTICLE = dt.Rows(i)("CODE_ARTICLE")

                        Dim FillingListquery002 = "SELECT Sum(QUANTITE_PREPARE) AS QUANTITE_PREPARE FROM `production_cuisine` WHERE CODE_ARTICLE=@CODE_ARTICLE AND DATE_PREPARATION <= '" & dateFin.ToString("yyyy-MM-dd") & "' AND DATE_PREPARATION >= '" & dateDebut.ToString("yyyy-MM-dd") & "' "

                        Dim commandList002 As New MySqlCommand(FillingListquery002, GlobalVariable.connect)
                        commandList002.Parameters.Add("@ETAT", MySqlDbType.Int64).Value = 1
                        commandList002.Parameters.Add("@CODE_ARTICLE", MySqlDbType.VarChar).Value = CODE_ARTICLE

                        Dim adapterList002 As New MySqlDataAdapter(commandList002)
                        Dim table002 As New DataTable
                        adapterList002.Fill(table002)

                        Dim PRIX_VENTE_TOTAL As Double = 0

                        If table002.Rows.Count > 0 Then
                            QUANTITE = table002.Rows(0)("QUANTITE_PREPARE")
                        End If

                        '-----------------------------------------------------------------------------------------------------------------------------------

                        '--------------------------CALCUL DU PRIX DE MARGE, COUT DE PRODUCTION & PRIX DE VENTE----------------------------------------------


                        'ON DETERMINER LE COUT DE PRODUTION PARTANT DE CHAQUE LIGNE DE FICHE TECHNIQUE ASSOCIE A L'ARTICLE ------------------------------------------------------

                        Dim FillingListquery02 = "SELECT * FROM `production_cuisine` WHERE DATE_PREPARATION <= '" & dateFin.ToString("yyyy-MM-dd") & "' AND DATE_PREPARATION >= '" & dateDebut.ToString("yyyy-MM-dd") & "' AND CODE_ARTICLE=@CODE_ARTICLE"

                        Dim commandList02 As New MySqlCommand(FillingListquery02, GlobalVariable.connect)
                        commandList02.Parameters.Add("@CODE_ARTICLE", MySqlDbType.VarChar).Value = CODE_ARTICLE

                        Dim adapterList02 As New MySqlDataAdapter(commandList02)

                        Dim table02 As New DataTable

                        adapterList02.Fill(table02)

                        If table02.Rows.Count > 0 Then

                            Dim ficheTechElement As DataTable
                            Dim infoSupFTDivers As DataTable
                            Dim QTE_ARTICLE_FT As Double = 0

                            For j = 0 To table02.Rows.Count - 1

                                CODE_FICHE_TECHNIQUE = table02.Rows(j)("CODE_FICHE_TECHNIQUE")
                                QTE_ARTICLE_FT = table02.Rows(j)("QUANTITE_PREPARE")

                                ficheTechElement = ficheTechniqueElements.elementsDuneFicheTechniquePourPreparation(CODE_FICHE_TECHNIQUE)

                                '-----------------------------------------------------------------------------------------------------------------------------
                                infoSupFTDivers = Functions.getElementByCode(CODE_FICHE_TECHNIQUE, "fiche_technique", "CODE_FICHE_TECHNIQUE")

                                Dim DIVERS_MONTANT As Double = 0

                                If infoSupFTDivers.Rows.Count > 0 Then
                                    DIVERS_MONTANT = Double.Parse(infoSupFTDivers.Rows(0)("DIVERS_MONTANT")) * QTE_ARTICLE_FT
                                End If

                                '------------------------------------------------------------------------------------------------------------------------------
                                'ON DETERMINE LE PRIX DE PRODUCTION DE L'ARTICLE A PARTIR DE SA FICHE TECHNIQUE
                                If ficheTechElement.Rows.Count > 0 Then

                                    For k = 0 To ficheTechElement.Rows.Count - 1
                                        totalDeProduction += ficheTechElement(k)("COUT DE REVIENT") * QTE_ARTICLE_FT
                                        coutDeProductionDesPlatsPrepares += ficheTechElement(k)("COUT DE REVIENT") * QTE_ARTICLE_FT
                                    Next

                                    totalDeProduction += DIVERS_MONTANT

                                    coutDeProductionDesPlatsPrepares += DIVERS_MONTANT

                                End If

                            Next

                        End If

                        '-----------------------------------------------------------------------------------------------------------------------------------

                        'ON DETERMINE LES QUANTITES
                        nombreDePlatPrepare += Double.Parse(QUANTITE)

                        Dim infoSupArticle As DataTable = Functions.getElementByCode(CODE_ARTICLE, "article", "CODE_ARTICLE")

                        'ON DETERMINE LE PRIX DE VENTE DE L'ARTICLE

                        Dim ARTICLE As String = ""

                        If infoSupArticle.Rows.Count > 0 Then

                            ARTICLE = infoSupArticle.Rows(0)("DESIGNATION_FR")

                            'totalDesVenteDesPlatsPrepares += Double.Parse(infoSupArticle.Rows(0)("PRIX_VENTE_HT")) * QUANTITE
                            'totalDesVentes = Double.Parse(infoSupArticle.Rows(0)("PRIX_VENTE_HT")) * QUANTITE

                        End If

                        Dim infoProductionCuisinePourCalCulTotalDesVentes As DataTable = Functions.getElementByCode(CODE_ARTICLE, "production_cuisine", "CODE_ARTICLE")

                        If infoProductionCuisinePourCalCulTotalDesVentes.Rows.Count > 0 Then

                            totalDesVentes = 0

                            For l = 0 To infoProductionCuisinePourCalCulTotalDesVentes.Rows.Count - 1

                                PRIX_VENTE_TOTAL = infoProductionCuisinePourCalCulTotalDesVentes.Rows(l)("PRIX_VENTE") * infoProductionCuisinePourCalCulTotalDesVentes.Rows(l)("QUANTITE_PREPARE")

                                totalDesVenteDesPlatsPrepares += Double.Parse(PRIX_VENTE_TOTAL)
                                totalDesVentes += Double.Parse(PRIX_VENTE_TOTAL)

                            Next

                        End If

                        '------------------------------------------------------------------------

                        pdfCell = New PdfPCell(New Paragraph(i + 1, font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(ARTICLE, font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(QUANTITE, font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalDeProduction, "#,##0"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalDesVentes, "#,##0"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(totalDesVentes - totalDeProduction, "#,##0"), font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph("/", font1))
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                        pdfTable.AddCell(pdfCell)

                    Next

                    pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(nombreDePlatPrepare, "#,##0"), fontTotal))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(coutDeProductionDesPlatsPrepares, "#,##0"), fontTotal))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(totalDesVenteDesPlatsPrepares, "#,##0"), fontTotal))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(totalDesVenteDesPlatsPrepares - coutDeProductionDesPlatsPrepares, "#,##0"), fontTotal))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", fontTotal))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT

                    pdfTable.AddCell(pdfCell)

                    pdfDoc.Add(pdfTable)

                    '----------------------------- POUR NE PAS AFFICHER LES FICHES TECHNIQUES EN DOUBLE-------------------------------------------

                    'Dim ftQuery = "SELECT `CODE_ARTICLE`, `NOM_ARTICLE` AS ARTICLE, `CODE_FICHE_TECHNIQUE`, `QUANTITE_PREPARE` AS QUANTITE, `DATE_PREPARATION`, `ETAT`, `RANDOM_CODE` FROM `commande_cuisine` WHERE ETAT=@ETAT AND DATE_PREPARATION=@DATE_PREPARATION"
                    Dim ftQuery = "SELECT DISTINCT `CODE_FICHE_TECHNIQUE` FROM  " & tableName & " WHERE DATE_PREPARATION <= '" & dateFin.ToString("yyyy-MM-dd") & "' AND DATE_PREPARATION >= '" & dateDebut.ToString("yyyy-MM-dd") & "' "

                    Dim commandFt As New MySqlCommand(ftQuery, GlobalVariable.connect)

                    Dim adapterFt As New MySqlDataAdapter(commandFt)
                    Dim tableFt As New DataTable()

                    adapterFt.Fill(tableFt)

                    Dim grandTotalCoutAchat As Double = 0

                    If tableFt.Rows.Count > 0 Then

                        Dim p004 As Paragraph = New Paragraph(Chr(13) & Chr(13) & Chr(13) & "B- LISTE DES FICHES TECHNIQUES " & Chr(13), pRow)
                        p004.Alignment = Element.ALIGN_RIGHT

                        pdfDoc.Add(p004)

                        Dim infoSupFt As DataTable

                        Dim NOMBRE_FT As Integer = 0

                        Dim DIVERS_MONTANT As Double = 0
                        Dim DIVERS_POURCENTAGE As Double = 0

                        For i = 0 To tableFt.Rows.Count - 1

                            Dim NOM_FT As String = ""

                            CODE_FICHE_TECHNIQUE = tableFt.Rows(i)("CODE_FICHE_TECHNIQUE")

                            '---------------------------- DETERMINONS LE NOMBRE D'OCCURENCE DE LA FICHE TECHNIQUE EN COURS DANS LA TABLE CUISINE -----------------------

                            Dim ftQueryCount = "SELECT SUM(QUANTITE_PREPARE) as NOMBRE FROM " & tableName & " WHERE DATE_PREPARATION <= '" & dateFin.ToString("yyyy-MM-dd") & "' AND DATE_PREPARATION >= '" & dateDebut.ToString("yyyy-MM-dd") & "'  AND CODE_FICHE_TECHNIQUE=@CODE_FICHE_TECHNIQUE"

                            Dim commandFtCount As New MySqlCommand(ftQueryCount, GlobalVariable.connect)
                            commandFtCount.Parameters.Add("@CODE_FICHE_TECHNIQUE", MySqlDbType.VarChar).Value = CODE_FICHE_TECHNIQUE

                            Dim adapterFtCount As New MySqlDataAdapter(commandFtCount)
                            Dim tableFtCount As New DataTable()

                            adapterFtCount.Fill(tableFtCount)

                            If tableFtCount.Rows.Count > 0 Then
                                NOMBRE_FT = tableFtCount.Rows(0)("NOMBRE")
                            End If

                            '------------------------------------------------------------------------------------------------------------
                            infoSupFt = Functions.getElementByCode(CODE_FICHE_TECHNIQUE, "fiche_technique", "CODE_FICHE_TECHNIQUE")

                            If infoSupFt.Rows.Count > 0 Then
                                NOM_FT = infoSupFt.Rows(0)("LIBELLE_FICHE")
                                DIVERS_MONTANT = infoSupFt.Rows(0)("DIVERS_MONTANT")
                                DIVERS_POURCENTAGE = infoSupFt.Rows(0)("DIVERS_POURCENTAGE")
                            End If

                            Dim p5 As Paragraph = New Paragraph(Chr(13) & i + 1 & "- " & NOM_FT & " ( " & NOMBRE_FT & " ) " & Chr(13) & Chr(13), pRow)
                            p5.Alignment = Element.ALIGN_LEFT

                            pdfDoc.Add(p5)

                            'MATIERES DESTOCKAGE
                            Dim pdfTable1 As New PdfPTable(7) 'Number of columns
                            pdfTable1.TotalWidth = 520.0F
                            pdfTable1.LockedWidth = True
                            pdfTable1.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable1.HeaderRows = 1

                            Dim widths1 As Single() = New Single() {10.0F, 35.0F, 16.0F, 16.0F, 16.0F, 16.0F, 16.0F}

                            pdfTable1.SetWidths(widths1)

                            pdfCell = Nothing

                            pdfCell = New PdfPCell(New Paragraph("ORDRE", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable1.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("MATIERE PREMIERE", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable1.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("UNITE", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable1.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("QTE UTILISE", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            pdfTable1.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("QTE / PORTION", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable1.AddCell(pdfCell)

                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            'pdfTable1.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("COUT / PORTION", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable1.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("COUT ACHAT", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                            pdfTable1.AddCell(pdfCell)

                            'Dim ficheTechniqueElements As New Article()

                            Dim dtFicheMatiere As DataTable = ficheTechniqueElements.elementsDuneFicheTechnique(CODE_FICHE_TECHNIQUE)

                            Dim CoutTotalAchat As Double = 0

                            If dtFicheMatiere.Rows.Count > 0 Then

                                For j = 0 To dtFicheMatiere.Rows.Count - 1

                                    '--------------------------------MATIERE DES COMMANDES ---------------------------------------------

                                    pdfCell = New PdfPCell(New Paragraph(j + 1, font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfTable1.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(dtFicheMatiere.Rows(j)("DESIGNATION"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfTable1.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(dtFicheMatiere.Rows(j)("UNITE COMPTAGE"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfTable1.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(dtFicheMatiere.Rows(j)("QUANTITE UTILISE") * NOMBRE_FT, "#,##0"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfTable1.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(dtFicheMatiere.Rows(j)("QTE / PORTION"), "#,##0"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfTable1.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(dtFicheMatiere.Rows(j)("COUT ACHAT"), "#,##0.0"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                    pdfTable1.AddCell(pdfCell)

                                    CoutTotalAchat += (dtFicheMatiere.Rows(j)("COUT DE REVIENT")) * NOMBRE_FT

                                    pdfCell = New PdfPCell(New Paragraph(Format((dtFicheMatiere.Rows(j)("COUT DE REVIENT")) * NOMBRE_FT, "#,##0"), font1))
                                    pdfCell.MinimumHeight = 15
                                    pdfCell.PaddingLeft = 5.0F
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                    pdfTable1.AddCell(pdfCell)

                                Next

                                '------------------------- INSERTION DE LA LIGNE DES DIVERS ---------------------------------------

                                pdfCell = New PdfPCell(New Paragraph(dtFicheMatiere.Rows.Count + 1, font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfTable1.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph("DIVERS", font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfTable1.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(" % ", font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfTable1.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(DIVERS_POURCENTAGE, "#,##0"), font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfTable1.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(DIVERS_MONTANT, "#,##0"), font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfTable1.AddCell(pdfCell)

                                CoutTotalAchat += DIVERS_MONTANT * NOMBRE_FT

                                pdfCell = New PdfPCell(New Paragraph(Format(DIVERS_MONTANT, "#,##0"), font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfTable1.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(DIVERS_MONTANT * NOMBRE_FT, "#,##0"), font1))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfTable1.AddCell(pdfCell)

                                '--------------------------------------------------------------------------------------------------

                                pdfCell = New PdfPCell(New Paragraph("TOTAL : ", fontTotal))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.Colspan = 6
                                pdfCell.Border = 0
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfTable1.AddCell(pdfCell)

                                grandTotalCoutAchat += CoutTotalAchat

                                pdfCell = New PdfPCell(New Paragraph(Format(CoutTotalAchat, "#,##0"), fontTotal))
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfTable1.AddCell(pdfCell)

                                pdfDoc.Add(pdfTable1)

                            End If

                        Next

                        Dim p005 As Paragraph = New Paragraph(Chr(13), pColumn)
                        p005.Alignment = Element.ALIGN_RIGHT

                        pdfDoc.Add(p005)

                        Dim pdfTable2 As New PdfPTable(7) 'Number of columns

                        pdfTable2.TotalWidth = 520.0F
                        pdfTable2.LockedWidth = True
                        pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                        'pdfTable2.HeaderRows = 1

                        Dim widths2 As Single() = New Single() {10.0F, 35.0F, 16.0F, 16.0F, 16.0F, 16.0F, 16.0F}
                        pdfTable2.SetWidths(widths2)

                        Dim pdfCell2 As PdfPCell = Nothing

                        pdfCell2 = New PdfPCell(New Paragraph("COUT TOTAL DE PRODUCTION : ", fontTotal))

                        pdfCell2.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell2.MinimumHeight = 5
                        pdfCell2.PaddingLeft = 15.0F
                        pdfCell2.Border = 0
                        pdfCell2.Colspan = 6
                        pdfTable2.AddCell(pdfCell2)

                        pdfCell2 = New PdfPCell(New Paragraph(Format(grandTotalCoutAchat, "#,##0"), fontTotal))
                        pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell2.MinimumHeight = 5
                        pdfCell2.PaddingLeft = 15.0F
                        pdfCell2.Border = 0
                        pdfTable2.AddCell(pdfCell2)

                        pdfDoc.Add(pdfTable2)

                    End If

                    pdfDoc.Close()

                    MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                    Process.Start(sfd.FileName)

                    '------------------------------------------------------------------------
                Else
                    MessageBox.Show("Aucune Ligne à imprimer!")
                End If


            End If

            ' ------------------------------------------------------------------------------------------------


        End If

    End Sub

    'COMMANDE A PARTIR DU BAR RESTAURANT POUR LA CUISINE

    Public Shared Sub commandeGestionDesBlocNotes(ByVal dt As DataTable, ByVal nomClient As String, Optional ByVal NOM_SERVEUR As String = "", Optional Bloc_note As String = "")

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalCommande As Double = 0

        Dim tireDocument As String = ""
        tireDocument = "Commande " & GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR") & Date.Now().ToString("ddMMyyHHmmss") & " "

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (* .pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then
            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.B7, 5, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.TIMES_ROMAN, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pColumn1 As New Font(iTextSharp.text.Font.FontFamily.TIMES_ROMAN, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pColumn2 As New Font(iTextSharp.text.Font.FontFamily.TIMES_ROMAN, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim title As New Font(iTextSharp.text.Font.FontFamily.TIMES_ROMAN, 13, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.TIMES_ROMAN, 11, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow1 As New Font(iTextSharp.text.Font.FontFamily.TIMES_ROMAN, 5, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.TIMES_ROMAN, 11, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.TIMES_ROMAN, 11, iTextSharp.text.Font.BOLD, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            Dim pdfTable As New PdfPTable(4) 'Number of columns
            pdfTable.TotalWidth = 240.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single() = New Single() {35.0F, 16.0F, 10.0F, 16.0F}

            pdfTable.SetWidths(widths)

            Dim pdfCell As PdfPCell = Nothing

            'pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            '------------------------------- LOGO SUR LE BON DE COMMANDE --------------------------------------
            'klg
            Dim img() As Byte
            img = societe.Rows(0)("LOGO")

            Dim mStream As New MemoryStream(img)

            Dim logo As Image
            logo = Image.GetInstance(img)
            logo.ScalePercent(40.0F)

            Dim pHeaderLogo As New PdfPTable(1)
            pHeaderLogo.TotalWidth = pdfDoc.PageSize.Width
            pHeaderLogo.DefaultCell.Border = 0

            pdfCell = New PdfPCell(logo)
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.PaddingLeft = 5.0F
            pdfCell.Border = 0 'used to remove borders on the cells
            pHeaderLogo.AddCell(pdfCell)
            pHeaderLogo.WriteSelectedRows(0, -1, 0, pdfDoc.GetTop(pdfDoc.TopMargin) + 125, pdfWrite.DirectContent)

            pdfDoc.Add(pHeaderLogo)

            Dim pHeader As New PdfPTable(1)
            pHeader.TotalWidth = pdfDoc.PageSize.Width
            pHeader.DefaultCell.Border = 0

            Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE"), title)
            p1.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p1)

            Dim p001_ As Paragraph = New Paragraph("Num Reg. : " & societe.Rows(0)("NUM_REGISTRE") & " / Num Cont. : " & societe.Rows(0)("NUM_CONTRIBUABLE") & Chr(13) & societe.Rows(0)("TELEPHONE") & " - " & societe.Rows(0)("RUE") & Chr(13), pColumn2)
            p001_.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p001_)

            Dim p3 As Paragraph = New Paragraph(Date.Now() & Chr(13), pColumn2)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            If Not Trim(Bloc_note) = "" Then

                Dim infSupBlocNote As DataTable = Functions.getElementByCode(Bloc_note, "ligne_facture_bloc_note", "NUMERO_BLOC_NOTE")

                If infSupBlocNote.Rows.Count > 0 Then

                    Dim p001 As Paragraph = New Paragraph(Chr(13) & "FACTURE N° : " & infSupBlocNote.Rows(0)("CODE_FACTURE") & Chr(13), pColumn)
                    If GlobalVariable.actualLanguageValue = 0 Then
                        p001 = New Paragraph(Chr(13) & "INVOICE N° : " & infSupBlocNote.Rows(0)("CODE_FACTURE") & Chr(13), pColumn)
                    End If
                    p001.Alignment = Element.ALIGN_CENTER
                    pdfDoc.Add(p001)

                End If

                Dim p01 As Paragraph = New Paragraph(Chr(13) & "BON NUMERO : " & Bloc_note & Chr(13), pColumn)
                p01.Alignment = Element.ALIGN_LEFT

                pdfDoc.Add(p01)

            End If

            Dim p0 As Paragraph = New Paragraph("CLIENT : " & nomClient, pColumn)
            p0.Alignment = Element.ALIGN_LEFT

            pdfDoc.Add(p0)

            Dim TVA As Double = 0

            If dt.Rows.Count > 0 Then

                For i = 0 To dt.Rows.Count - 1

                    If GlobalVariable.societe.Rows(0)("TAUX_TVA") > 0 Then
                        'PRISE EN COMPTE DE LA TVA

                        If GlobalVariable.actualLanguageValue = 0 Then

                            TotalCommande += Functions.NonprelevementDeTaxeSurUnMontant(dt.Rows(i)("TOTAL AMOUNT"))
                            TVA += Functions.prelevementDeTaxeSurUnMontantPOurCalcul(dt.Rows(i)("TOTAL AMOUNT"))
                        Else

                            TotalCommande += Functions.NonprelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT TOTAL"))
                            TVA += Functions.prelevementDeTaxeSurUnMontantPOurCalcul(dt.Rows(i)("MONTANT TOTAL"))
                        End If

                    Else

                        If GlobalVariable.actualLanguageValue = 0 Then
                            TotalCommande += Functions.NonprelevementDeTaxeSurUnMontant(dt.Rows(i)("TOTAL AMOUNT"))
                        Else
                            TotalCommande += Functions.NonprelevementDeTaxeSurUnMontant(dt.Rows(i)("MONTANT TOTAL"))
                        End If

                    End If

                Next

            End If

            Dim p2 As Paragraph = New Paragraph("SERVICE : " & NOM_SERVEUR & Chr(13) & Chr(13), pColumn)

            p2.Alignment = Element.ALIGN_LEFT

            pdfDoc.Add(p2)

            If GlobalVariable.actualLanguageValue = 0 Then
                pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
            Else
                pdfCell = New PdfPCell(New Paragraph("WORDING", pColumn))
            End If

            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            If GlobalVariable.actualLanguageValue = 0 Then
                pdfCell = New PdfPCell(New Paragraph("UP", pColumn))
            Else
                pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
            End If

            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfCell.PaddingLeft = 5.0F
            pdfTable.AddCell(pdfCell)

            If GlobalVariable.actualLanguageValue = 0 Then
                pdfCell = New PdfPCell(New Paragraph("QTY", pColumn))
            Else
                pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
            End If

            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            'pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            If dt.Rows.Count > 0 Then

                For i = 0 To dt.Rows.Count - 1

                    If GlobalVariable.actualLanguageValue = 0 Then
                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(i)("ITEM"), font1))
                    Else
                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(i)("LIBELLE ARTICLE"), font1))
                    End If

                    pdfCell.MinimumHeight = 5
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfTable.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 0 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i)("TOTAL AMOUNT") / dt.Rows(i)("QUANTITY"), "#,##0"), font1))
                    Else
                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i)("MONTANT TOTAL") / dt.Rows(i)("QUANTITE"), "#,##0"), font1))
                    End If


                    pdfCell.MinimumHeight = 5
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 0 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i)("QUANTITY"), "#,##0"), font1))
                    Else
                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i)("QUANTITE"), "#,##0"), font1))
                    End If

                    pdfCell.MinimumHeight = 5
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfTable.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 0 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i)("TOTAL AMOUNT"), "#,##0"), font1))
                    Else
                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i)("MONTANT TOTAL"), "#,##0"), font1))
                    End If

                    pdfCell.MinimumHeight = 5
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                    pdfTable.AddCell(pdfCell)


                    'TotalCommande += dt.Rows(i).Cells("MONTANT HT").Value

                Next

                pdfDoc.Add(pdfTable)

                '------------------------------------------------------------------------
                '------------------------------------------------------------------------

                Dim pdfTable2 As New PdfPTable(2) 'Number of columns

                pdfTable2.TotalWidth = 230.0F
                pdfTable2.LockedWidth = True
                pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfTable2.HeaderRows = 1

                Dim widths2 As Single() = New Single() {30.0F, 20.0F}
                pdfTable2.SetWidths(widths2)

                Dim pdfCell2 As PdfPCell = Nothing

                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell2 = New PdfPCell(New Paragraph("TOTAL ET : ", fontTotal))
                Else
                    pdfCell2 = New PdfPCell(New Paragraph("TOTAL HT : ", fontTotal))
                End If

                pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell2.MinimumHeight = 5
                pdfCell2.PaddingLeft = 15.0F
                pdfCell2.Border = 0
                pdfTable2.AddCell(pdfCell2)

                pdfCell2 = New PdfPCell(New Paragraph(Format(TotalCommande - TVA, "#,##0"), fontTotal))
                pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell2.MinimumHeight = 5
                pdfCell2.PaddingLeft = 5.0F
                pdfCell2.Border = 0
                pdfTable2.AddCell(pdfCell2)

                If GlobalVariable.societe.Rows(0)("TAUX_TVA") > 0 Then

                    If GlobalVariable.actualLanguageValue = 0 Then
                        pdfCell2 = New PdfPCell(New Paragraph("VAT : ", fontTotal))
                    Else
                        pdfCell2 = New PdfPCell(New Paragraph("TVA : ", fontTotal))
                    End If

                    pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell2.MinimumHeight = 5
                    pdfCell2.PaddingLeft = 15.0F
                    pdfCell2.Border = 0
                    pdfTable2.AddCell(pdfCell2)

                    pdfCell2 = New PdfPCell(New Paragraph(Format(TVA, "#,##0"), fontTotal))
                    pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell2.MinimumHeight = 5
                    pdfCell2.PaddingLeft = 5.0F
                    pdfCell2.Border = 0
                    pdfTable2.AddCell(pdfCell2)

                    pdfCell2 = New PdfPCell(New Paragraph("", fontTotal))
                    pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell2.MinimumHeight = 5
                    pdfCell2.PaddingLeft = 5.0F
                    pdfCell2.Border = 0
                    pdfTable2.AddCell(pdfCell2)

                    pdfCell2 = New PdfPCell(New Paragraph("--------------", fontTotal))
                    pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell2.MinimumHeight = 5
                    pdfCell2.PaddingLeft = 5.0F
                    pdfCell2.Border = 0
                    pdfTable2.AddCell(pdfCell2)

                    If GlobalVariable.actualLanguageValue = 0 Then
                        pdfCell2 = New PdfPCell(New Paragraph("TOTAL IT : ", fontTotal))

                    Else
                        pdfCell2 = New PdfPCell(New Paragraph("TOTAL TTC : ", fontTotal))

                    End If

                    pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell2.MinimumHeight = 5
                    pdfCell2.PaddingLeft = 15.0F
                    pdfCell2.Border = 0
                    pdfTable2.AddCell(pdfCell2)

                    pdfCell2 = New PdfPCell(New Paragraph(Format(TotalCommande, "#,##0"), fontTotal))
                    pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell2.MinimumHeight = 5
                    pdfCell2.PaddingLeft = 5.0F
                    pdfCell2.Border = 0
                    pdfTable2.AddCell(pdfCell2)

                End If

                pdfDoc.Add(pdfTable2)

                '----------------------------------

                If GlobalVariable.actualLanguageValue = 0 Then
                    Dim p02 As Paragraph = New Paragraph("Closing at an amount of : " & Functions.NBLT(TotalCommande) & societe.Rows(0)("CODE_MONNAIE") & Chr(13) & Chr(13), pColumn)
                    p02.Alignment = Element.ALIGN_LEFT

                    pdfDoc.Add(p02)

                Else
                    Dim p02 As Paragraph = New Paragraph("Arrêter à la somme de : " & Functions.NBLT(TotalCommande) & societe.Rows(0)("CODE_MONNAIE") & Chr(13) & Chr(13), pColumn)
                    p02.Alignment = Element.ALIGN_LEFT

                    pdfDoc.Add(p02)

                End If

                '-----------------------------------

                Dim pdfTable4 As New PdfPTable(1) 'Number of columns

                pdfTable4.TotalWidth = 230.0F
                pdfTable4.LockedWidth = True
                pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfTable4.HeaderRows = 1

                Dim widths4 As Single() = New Single() {30.0F}
                pdfTable4.SetWidths(widths4)

                Dim pdfCell4 As PdfPCell = Nothing

                pdfCell4 = New PdfPCell(New Paragraph(Chr(13) & "Signature ", pRow))
                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell4.MinimumHeight = 5
                pdfCell4.PaddingLeft = 15.0F
                pdfCell4.Border = 0
                pdfTable4.AddCell(pdfCell4)

                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell4 = New PdfPCell(New Paragraph(Chr(13) & Chr(13) & "Thank you for your stay ", font1))
                Else
                    pdfCell4 = New PdfPCell(New Paragraph(Chr(13) & Chr(13) & "Merci pour votre séjour ", font1))
                End If

                pdfCell4.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell4.MinimumHeight = 5
                pdfCell4.PaddingLeft = 15.0F
                pdfCell4.Border = 0
                pdfTable4.AddCell(pdfCell4)


                pdfCell4 = New PdfPCell(New Paragraph(Chr(13) & Chr(13) & "TECHFLECTION LYTE " & Date.Now(), pRow1))
                pdfCell4.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell4.MinimumHeight = 5
                pdfCell4.PaddingLeft = 15.0F
                pdfCell4.Border = 0
                pdfTable4.AddCell(pdfCell4)

                pdfDoc.Add(pdfTable4)

            Else

                If GlobalVariable.actualLanguageValue = 0 Then
                    MessageBox.Show("Nothing to print !")

                Else
                    MessageBox.Show("Aucune Ligne de Fatcure à imprimer !")

                End If

            End If


            ' ------------------------------------------------------------------------------------------------

            pdfDoc.Close()

            If GlobalVariable.actualLanguageValue = 0 Then
                MessageBox.Show("PDF exported " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Else
                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            End If
            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub commande(ByVal dt As DataGridView, ByVal nomClient As String, ByVal NUM_FACTURE As String, Optional ByVal Chambre As String = "", Optional Bloc_note As String = "")

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalCommande As Double = 0

        Dim tireDocument As String = ""
        tireDocument = "Commande " & GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR") & Date.Now().ToString("ddMMyyHHmmss") & " "

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (* .pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        Dim TVA As Double = 0

        If sfd.ShowDialog = 1 Then

            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.B7, 5, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pColumn1 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pColumn2 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim title As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 13, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 11, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow1 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 11, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 11, iTextSharp.text.Font.BOLD, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            Dim pdfTable As New PdfPTable(4) 'Number of columns
            pdfTable.TotalWidth = 240.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single() = New Single() {35.0F, 16.0F, 10.0F, 16.0F}

            pdfTable.SetWidths(widths)

            Dim pdfCell As PdfPCell = Nothing

            'Remove
            'pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            '------------------------------- LOGO SUR LE BON DE COMMANDE --------------------------------------
            'klg
            Dim img() As Byte
            img = societe.Rows(0)("LOGO")

            Dim mStream As New MemoryStream(img)

            Dim logo As Image
            logo = Image.GetInstance(img)
            logo.ScalePercent(40.0F)

            Dim pHeaderLogo As New PdfPTable(1)
            pHeaderLogo.TotalWidth = pdfDoc.PageSize.Width
            pHeaderLogo.DefaultCell.Border = 0

            pdfCell = New PdfPCell(logo)
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.PaddingLeft = 5.0F
            pdfCell.Border = 0 'used to remove borders on the cells
            pHeaderLogo.AddCell(pdfCell)
            pHeaderLogo.WriteSelectedRows(0, -1, 0, pdfDoc.GetTop(pdfDoc.TopMargin) + 125, pdfWrite.DirectContent)

            pdfDoc.Add(pHeaderLogo)

            Dim pHeader As New PdfPTable(1)
            pHeader.TotalWidth = pdfDoc.PageSize.Width
            pHeader.DefaultCell.Border = 0

            Dim p10 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE"), title)
            p10.Alignment = Element.ALIGN_CENTER
            ' pdfDoc.Add(p10)

            '--------------------------------------------------------------------------------------------------

            Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE"), title)
            p1.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p1)

            Dim p001 As Paragraph = New Paragraph("Num Reg. : " & societe.Rows(0)("NUM_REGISTRE") & " / Num Cont. : " & societe.Rows(0)("NUM_CONTRIBUABLE") & Chr(13) & societe.Rows(0)("TELEPHONE") & " - " & societe.Rows(0)("RUE") & Chr(13), pColumn2)
            p001.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p001)

            Dim p3 As Paragraph = New Paragraph(Date.Now() & Chr(13), pColumn2)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            If Not Trim(NUM_FACTURE).Equals("") Then
                Dim p01 As Paragraph = New Paragraph(Chr(13) & "N° FACTURE : " & NUM_FACTURE, pColumn)
                If GlobalVariable.actualLanguageValue = 0 Then
                    p01 = New Paragraph(Chr(13) & "INVOICE N° : " & NUM_FACTURE, pColumn)
                End If
                p01.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p01)
            End If

            If Not Trim(Bloc_note) = "" Then

                Dim p01 As Paragraph = New Paragraph(Chr(13) & "BON NUMERO : " & Bloc_note & Chr(13), pColumn)
                p01.Alignment = Element.ALIGN_LEFT

                pdfDoc.Add(p01)

            End If

            If GlobalVariable.typeDeClientAFacturer = "en chambre" Or GlobalVariable.typeDeClientAFacturer = "evenement" Then
                Dim p0 As Paragraph

                If GlobalVariable.typeDeClientAFacturer = "en chambre" Then

                    If GlobalVariable.actualLanguageValue = 1 Then
                        p0 = New Paragraph("CLIENT : " & nomClient & Chr(13) & "CHAMBRE : " & Chambre & Chr(13), pRow)
                    Else
                        p0 = New Paragraph("CLIENT : " & nomClient & Chr(13) & "ROOM : " & Chambre & Chr(13), pRow)
                    End If
                End If

                If GlobalVariable.typeDeClientAFacturer = "evenement" Then

                    If GlobalVariable.actualLanguageValue = 1 Then
                        p0 = New Paragraph("CLIENT : " & nomClient & Chr(13) & " SALLE : " & Chambre & Chr(13), pRow)
                    Else
                        p0 = New Paragraph("CLIENT : " & nomClient & Chr(13) & " HALL : " & Chambre & Chr(13), pRow)
                    End If
                End If

                p0.Alignment = Element.ALIGN_LEFT

                pdfDoc.Add(p0)

            Else

                If GlobalVariable.typeDeClientAFacturer = "comptoir" Then

                    Dim p0 As Paragraph = New Paragraph("CLIENT : " & nomClient, pColumn)
                    p0.Alignment = Element.ALIGN_LEFT

                    pdfDoc.Add(p0)

                End If

            End If

            Dim CODE_CLIENT As String = ""
            Dim CODE_ENTREPRISE As String = ""
            Dim exonore As Boolean = False 'PAS EXONERE DE LA TVA DONC ELLE S'APPLIQUE

            'ON DOIT DETERMINER SI LA TVA DOIT S'APPLIQUER AU CLIENT
            If GlobalVariable.typeDeClientAFacturer = "en chambre" Or GlobalVariable.typeDeClientAFacturer = "evenement" Then

                Dim ETAT_RESERVATION As Integer = 1
                Dim infoSupResa As DataTable = Functions.GetAllElementsOnTwoConditions(Chambre, "reserve_conf", "CHAMBRE_ID", ETAT_RESERVATION, "ETAT_RESERVATION")

                If infoSupResa.Rows.Count > 0 Then
                    '1- ON CHERCHE A SAVOIR SI LA RESERVATION EST ASSOCIE A UNE ENTREPRISE 
                    CODE_ENTREPRISE = infoSupResa.Rows(0)("CODE_ENTREPRISE")
                    CODE_CLIENT = infoSupResa.Rows(0)("CLIENT_ID")

                    'SI NON ON UTILISERA LE CODE DE L'INDIVIDU POUR SAVOIR SI EXONERA OU PAS
                    If Trim(CODE_ENTREPRISE).Equals("") Then
                        exonore = Functions.exonereDelaTVA(CODE_CLIENT)
                    Else
                        'SI OUI ON UTILISERA LE CODE DE L'ENTREPRISE POUR SAVOIR DETERMINE SI EXONERA OU PAS
                        exonore = Functions.exonereDelaTVA(CODE_ENTREPRISE)
                    End If

                Else

                End If

            Else

                Dim infoSupClient As DataTable = Functions.getElementByCode(nomClient, "client", "NOM_PRENOM")

                If Not infoSupClient.Rows.Count > 0 Then
                    infoSupClient = Functions.getElementByCode(nomClient, "client", "NOM_CLIENT")
                End If

                If infoSupClient.Rows.Count > 0 Then

                    CODE_CLIENT = infoSupClient.Rows(0)("CODE_CLIENT")

                    exonore = Functions.exonereDelaTVA(CODE_CLIENT)

                End If

            End If

            'CALCUL DU MONTANT DE LA TH, TVA, TTC
            If dt.Rows.Count > 0 Then

                For i = 0 To dt.Rows.Count - 1

                    If Not exonore Then
                        'LE CLIENT N'EST PAS EXONORE ALORS ON CALCUL SA TVA SI ACTIVE

                        If GlobalVariable.societe.Rows(0)("TAUX_TVA") > 0 Then

                            'TVA ACTIVE
                            If GlobalVariable.actualLanguageValue = 0 Then

                                TotalCommande += Functions.NonprelevementDeTaxeSurUnMontant(dt.Rows(i).Cells("AMOUNT IT").Value)
                                TVA += Functions.prelevementDeTaxeSurUnMontantPOurCalcul(dt.Rows(i).Cells("AMOUNT IT").Value)

                            ElseIf GlobalVariable.actualLanguageValue = 1 Then

                                TotalCommande += Functions.NonprelevementDeTaxeSurUnMontant(dt.Rows(i).Cells("MONTANT TTC").Value)
                                TVA += Functions.prelevementDeTaxeSurUnMontantPOurCalcul(dt.Rows(i).Cells("MONTANT TTC").Value)

                            End If

                        Else

                            'TVA NON ACTIVE
                            If GlobalVariable.actualLanguageValue = 0 Then
                                TotalCommande += Functions.NonprelevementDeTaxeSurUnMontant(dt.Rows(i).Cells("AMOUNT IT").Value)
                            ElseIf GlobalVariable.actualLanguageValue = 1 Then
                                TotalCommande += Functions.NonprelevementDeTaxeSurUnMontant(dt.Rows(i).Cells("MONTANT TTC").Value)
                            End If

                        End If

                    Else

                        'LE CLIENT EST EXONORE ALORS ON CALCUL SON TOTAL HT 

                        If GlobalVariable.actualLanguageValue = 0 Then
                            TotalCommande += Functions.NonprelevementDeTaxeSurUnMontant(dt.Rows(i).Cells("AMOUNT IT").Value)
                        ElseIf GlobalVariable.actualLanguageValue = 1 Then
                            TotalCommande += Functions.NonprelevementDeTaxeSurUnMontant(dt.Rows(i).Cells("MONTANT TTC").Value)
                        End If

                    End If

                Next

            End If

            If GlobalVariable.AgenceActuelle.Rows(0)("SESSION_UNIQUE") = 0 Then

                Dim SERVEUR As String = "-"

                Dim infoSupBon As DataTable = Functions.getElementByCode(Bloc_note, "ligne_facture_bloc_note", "NUMERO_BLOC_NOTE")

                If infoSupBon.Rows.Count > 0 Then
                    Dim infoSupCaissier As DataTable = Functions.getElementByCode(infoSupBon.Rows(0)("CODE_CAISSIER"), "utilisateurs", "CODE_UTILISATEUR")
                    SERVEUR = infoSupCaissier.Rows(0)("NOM_UTILISATEUR")
                End If

                Dim p2_ As Paragraph = New Paragraph("SERVEUR : " & SERVEUR & Chr(13), pColumn)
                If GlobalVariable.actualLanguageValue = 0 Then
                    p2_ = New Paragraph("SERVER : " & SERVEUR & Chr(13), pColumn)
                End If
                p2_.Alignment = Element.ALIGN_LEFT

                pdfDoc.Add(p2_)

            End If

            Dim p2 As Paragraph = New Paragraph("CAISSIER : " & GlobalVariable.ConnectedUser(0)("NOM_UTILISATEUR") & Chr(13) & Chr(13), pColumn)
            If GlobalVariable.actualLanguageValue = 0 Then
                p2 = New Paragraph("CAISHIER : " & GlobalVariable.ConnectedUser(0)("NOM_UTILISATEUR") & Chr(13) & Chr(13), pColumn)
            End If
            p2.Alignment = Element.ALIGN_LEFT

            pdfDoc.Add(p2)

            If GlobalVariable.actualLanguageValue = 0 Then
                pdfCell = New PdfPCell(New Paragraph("ITEM", pColumn))
            ElseIf GlobalVariable.actualLanguageValue = 1 Then
                pdfCell = New PdfPCell(New Paragraph("DESIGNATION", pColumn))
            End If

            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            If GlobalVariable.actualLanguageValue = 0 Then
                pdfCell = New PdfPCell(New Paragraph("UP", pColumn))
            ElseIf GlobalVariable.actualLanguageValue = 1 Then
                pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
            End If

            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfCell.PaddingLeft = 5.0F
            pdfTable.AddCell(pdfCell)

            If GlobalVariable.actualLanguageValue = 0 Then
                pdfCell = New PdfPCell(New Paragraph("QTY", pColumn))
            ElseIf GlobalVariable.actualLanguageValue = 1 Then
                pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
            End If

            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            'pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 5
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            If dt.Rows.Count > 0 Then

                For i = 0 To dt.Rows.Count - 1

                    If GlobalVariable.actualLanguageValue = 0 Then
                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells("ITEM").Value.ToString, font1))
                    ElseIf GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells("DESIGNATION").Value.ToString, font1))
                    End If

                    pdfCell.MinimumHeight = 5
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfTable.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 0 Then
                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells("ITEM").Value.ToString, font1))
                    ElseIf GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells("DESIGNATION").Value.ToString, font1))
                    End If

                    If GlobalVariable.actualLanguageValue = 0 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells("UNIT PRICE").Value, "#,##0"), font1))
                    ElseIf GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells("PU TTC").Value, "#,##0"), font1))
                    End If

                    pdfCell.MinimumHeight = 5
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 0 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells("QUANTITY").Value, "#,##0"), font1))
                    ElseIf GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells("QUANTITE").Value, "#,##0"), font1))
                    End If

                    pdfCell.MinimumHeight = 5
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfTable.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 0 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells("AMOUNT IT").Value, "#,##0"), font1))
                    ElseIf GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells("MONTANT TTC").Value, "#,##0"), font1))
                    End If

                    pdfCell.MinimumHeight = 5
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                    pdfTable.AddCell(pdfCell)

                    'TotalCommande += dt.Rows(i).Cells("MONTANT HT").Value

                Next

                pdfDoc.Add(pdfTable)

                '------------------------------------------------------------------------

                Dim pdfTable2 As New PdfPTable(2) 'Number of columns

                pdfTable2.TotalWidth = 230.0F
                pdfTable2.LockedWidth = True
                pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfTable2.HeaderRows = 1

                Dim widths2 As Single() = New Single() {30.0F, 20.0F}
                pdfTable2.SetWidths(widths2)

                Dim pdfCell2 As PdfPCell = Nothing

                If GlobalVariable.actualLanguageValue = 0 Then
                    pdfCell2 = New PdfPCell(New Paragraph("TOTAL ET : ", fontTotal))
                ElseIf GlobalVariable.actualLanguageValue = 1 Then
                    pdfCell2 = New PdfPCell(New Paragraph("TOTAL HT : ", fontTotal))
                End If

                pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell2.MinimumHeight = 5
                pdfCell2.PaddingLeft = 15.0F
                pdfCell2.Border = 0
                pdfTable2.AddCell(pdfCell2)

                pdfCell2 = New PdfPCell(New Paragraph(Format(TotalCommande - TVA, "#,##0"), fontTotal))
                pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell2.MinimumHeight = 5
                pdfCell2.PaddingLeft = 5.0F
                pdfCell2.Border = 0
                pdfTable2.AddCell(pdfCell2)

                'SI LE CLIENT N'EST PAS EXONORE ALORS ON CALCUL SA TVA SI ACTIVE
                If Not exonore Then

                    If GlobalVariable.societe.Rows(0)("TAUX_TVA") > 0 Then

                        If GlobalVariable.actualLanguageValue = 0 Then
                            pdfCell2 = New PdfPCell(New Paragraph("VAT : ", fontTotal))
                        ElseIf GlobalVariable.actualLanguageValue = 1 Then
                            pdfCell2 = New PdfPCell(New Paragraph("TVA : ", fontTotal))
                        End If

                        pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell2.MinimumHeight = 5
                        pdfCell2.PaddingLeft = 15.0F
                        pdfCell2.Border = 0
                        pdfTable2.AddCell(pdfCell2)

                        pdfCell2 = New PdfPCell(New Paragraph(Format(TVA, "#,##0"), fontTotal))
                        pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell2.MinimumHeight = 5
                        pdfCell2.PaddingLeft = 5.0F
                        pdfCell2.Border = 0
                        pdfTable2.AddCell(pdfCell2)


                        pdfCell2 = New PdfPCell(New Paragraph("", fontTotal))
                        pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell2.MinimumHeight = 5
                        pdfCell2.PaddingLeft = 5.0F
                        pdfCell2.Border = 0
                        pdfTable2.AddCell(pdfCell2)

                        pdfCell2 = New PdfPCell(New Paragraph("--------------", fontTotal))
                        pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell2.MinimumHeight = 5
                        pdfCell2.PaddingLeft = 5.0F
                        pdfCell2.Border = 0
                        pdfTable2.AddCell(pdfCell2)

                        If GlobalVariable.actualLanguageValue = 0 Then
                            pdfCell2 = New PdfPCell(New Paragraph("TOTAL IT : ", fontTotal))
                        ElseIf GlobalVariable.actualLanguageValue = 1 Then
                            pdfCell2 = New PdfPCell(New Paragraph("TOTAL TTC : ", fontTotal))
                        End If

                        pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell2.MinimumHeight = 5
                        pdfCell2.PaddingLeft = 15.0F
                        pdfCell2.Border = 0
                        pdfTable2.AddCell(pdfCell2)

                        pdfCell2 = New PdfPCell(New Paragraph(Format(TotalCommande, "#,##0"), fontTotal))
                        pdfCell2.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell2.MinimumHeight = 5
                        pdfCell2.PaddingLeft = 5.0F
                        pdfCell2.Border = 0
                        pdfTable2.AddCell(pdfCell2)

                    End If

                End If


                pdfDoc.Add(pdfTable2)

                '----------------------------------

                If GlobalVariable.actualLanguageValue = 0 Then

                    Dim p02 As Paragraph = New Paragraph("Closing the present at an amount of : " & Functions.NBLT(TotalCommande) & societe.Rows(0)("CODE_MONNAIE") & Chr(13) & Chr(13), pColumn)
                    p02.Alignment = Element.ALIGN_LEFT

                    pdfDoc.Add(p02)

                ElseIf GlobalVariable.actualLanguageValue = 1 Then

                    Dim p02 As Paragraph = New Paragraph("Arrêter à la somme de : " & Functions.NBLT(TotalCommande) & societe.Rows(0)("CODE_MONNAIE") & Chr(13) & Chr(13), pColumn)
                    p02.Alignment = Element.ALIGN_LEFT

                    pdfDoc.Add(p02)

                End If

                '-----------------------------------

                Dim pdfTable4 As New PdfPTable(1) 'Number of columns

                pdfTable4.TotalWidth = 230.0F
                pdfTable4.LockedWidth = True
                pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfTable4.HeaderRows = 1

                Dim widths4 As Single() = New Single() {30.0F}
                pdfTable4.SetWidths(widths4)

                Dim pdfCell4 As PdfPCell = Nothing

                pdfCell4 = New PdfPCell(New Paragraph(Chr(13) & "Signature ", pRow))
                pdfCell4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell4.MinimumHeight = 5
                pdfCell4.PaddingLeft = 15.0F
                pdfCell4.Border = 0
                pdfTable4.AddCell(pdfCell4)

                If GlobalVariable.actualLanguageValue = 0 Then

                    pdfCell4 = New PdfPCell(New Paragraph(Chr(13) & "Thank you for your stay ", font1))
                Else

                    pdfCell4 = New PdfPCell(New Paragraph(Chr(13) & "Merci pour votre séjour ", font1))
                End If

                pdfCell4.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell4.MinimumHeight = 5
                pdfCell4.PaddingLeft = 15.0F
                pdfCell4.Border = 0
                pdfTable4.AddCell(pdfCell4)


                pdfCell4 = New PdfPCell(New Paragraph(Chr(13) & "TECHFLECTION LYTE " & Date.Now(), pRow1))
                pdfCell4.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell4.MinimumHeight = 5
                pdfCell4.PaddingLeft = 15.0F
                pdfCell4.Border = 0
                pdfTable4.AddCell(pdfCell4)

                'Remove
                pdfDoc.Add(pdfTable4)

            Else

                If GlobalVariable.actualLanguageValue = 0 Then
                    MessageBox.Show("Nothing to print !")
                Else
                    MessageBox.Show("Aucune Ligne de Fatcure à imprimer !")
                End If

            End If

            ' ------------------------------------------------------------------------------------------------

            pdfDoc.Close()

            If GlobalVariable.actualLanguageValue = 0 Then
                'MessageBox.Show("PDF exported successfully " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Else
                'MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generation de PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            End If

            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub ficheTechnique(ByVal dt As DataGridView, ByVal NOM_FICHE As String, ByVal CODE_FICHE As String, ByVal nombreDePortion As Integer, ByVal PrixVente As Double, ByVal CTR As Double, ByVal PV As Double, ByVal CRPPP As Double, ByVal PMI As Double, ByVal CM As Double, ByVal CRPPV As Double, ByVal MB As Double, ByVal TM As Double)

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalCommande As Double = 0

        Dim sousTitre As String = ""
        Dim titre As String = ""

        If GlobalVariable.typeRapportEconmat = "PC" Then
            sousTitre = "PRODUCTION DE LA CUISINE "
        ElseIf GlobalVariable.typeRapportEconmat = "FPT" Then
            sousTitre = "FICHE TECHNIQUE DE PLAT "
            titre = "NOM DE LA FICHE  " + NOM_FICHE
        End If

        Dim tireDocument As String = ""
        tireDocument = sousTitre & GlobalVariable.ConnectedUser.Rows(0)("NOM_UTILISATEUR") & Date.Now().ToString("ddMMyyHHmmss") & " "

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 20, 40)
            'Dim pdfDoc As New Document(PageSize.B7, 5, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            Dim pdfTable As New PdfPTable(7) 'Number of columns
            pdfTable.TotalWidth = 520.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single() = New Single() {10.0F, 35.0F, 16.0F, 16.0F, 16.0F, 16.0F, 16.0F}

            pdfTable.SetWidths(widths)

            Dim pdfCell As PdfPCell = Nothing

            'pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p1 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & "***", pColumn)
            p1.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p1)

            Dim p2 As Paragraph = New Paragraph(sousTitre.ToUpper() & Chr(13) & Chr(13), pRow)
            p2.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p2)

            Dim p3 As Paragraph = New Paragraph(Date.Now() & Chr(13), pColumn)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            Dim p4 As Paragraph = New Paragraph(titre & Chr(13) & Chr(13), pRow)
            p4.Alignment = Element.ALIGN_LEFT

            pdfDoc.Add(p4)

            pdfCell = New PdfPCell(New Paragraph("ORDRE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("ARTICLE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("UNITE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("QTE UTILISE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("QTE / PORTION", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            'pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("COUT DE REVIENT", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("COUT ACHAT", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            'pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable.AddCell(pdfCell)

            If dt.Rows.Count > 0 Then

                For i = 0 To dt.Rows.Count - 1

                    '-------------------------------- GESTION DES REGLEMENTS DE LA FACTURE ---------------
                    pdfCell = New PdfPCell(New Paragraph(i + 1, font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells("DESIGNATION").Value.ToString, font1))
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfTable.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells("UNITE COMPTAGE").Value.ToString, font1))
                    Else
                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells("UNIT").Value.ToString, font1))
                    End If
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfTable.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells("QUANTITE UTILISE").Value, "#,##0"), font1))
                    Else
                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells("USED QTY").Value, "#,##0"), font1))
                    End If
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfTable.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells("QTE / PORTION").Value, "#,##0"), font1))
                    Else
                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells("QTY / PORTION").Value, "#,##0"), font1))
                    End If
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfTable.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells("COUT ACHAT").Value, "#,##0"), font1))
                    Else
                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells("COST PRICE").Value, "#,##0"), font1))
                    End If
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells("COUT DE REVIENT").Value, "#,##0"), font1))
                    Else
                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells("PRODUCTION COST").Value, "#,##0"), font1))
                    End If
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                    pdfTable.AddCell(pdfCell)

                Next

                pdfDoc.Add(pdfTable)

                '------------------------------------------------------------------------

                Dim pdfTable2 As New PdfPTable(2) 'Number of columns

                pdfTable2.TotalWidth = 520.0F
                pdfTable2.LockedWidth = True
                pdfTable2.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfTable2.HeaderRows = 1

                Dim widths2 As Single() = New Single() {50.0F, 70.0F}
                pdfTable2.SetWidths(widths2)

                Dim pdfCell2 As PdfPCell = Nothing

                If GlobalVariable.actualLanguageValue = 1 Then
                    pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & "Coût de Revient  " & Chr(13) & Chr(13) & "Coût de Revient par portion produite : " & Chr(13) & Chr(13) & "Prix de vente : " & Chr(13) & Chr(13) & "Prix de revient par portion vendue : " & Chr(13) & Chr(13) & "Pourcentage Moyen d'indendus : " & Chr(13) & Chr(13) & "Marge brute :" & Chr(13) & Chr(13) & "Coefficient de Marge : " & Chr(13) & Chr(13) & "Taux de marge :", fontTotal))
                Else
                    pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & "Production Cost  " & Chr(13) & Chr(13) & "Cost Price per portion produced : " & Chr(13) & Chr(13) & "Selling Price : " & Chr(13) & Chr(13) & "Cost Price per portion sold : " & Chr(13) & Chr(13) & "Average percentage of unsold : " & Chr(13) & Chr(13) & "Grosse profit :" & Chr(13) & Chr(13) & "Percentage Coefficient : " & Chr(13) & Chr(13) & "Profit Rate :", fontTotal))
                End If

                pdfCell2.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell2.MinimumHeight = 18
                pdfCell2.PaddingLeft = 15.0F
                pdfCell2.Border = 0
                pdfTable2.AddCell(pdfCell2)

                pdfCell2 = New PdfPCell(New Paragraph(Chr(13) & Format(CTR, "#,##0") & Chr(13) & Chr(13) & Format(CRPPP, "#,##0") & Chr(13) & Chr(13) & Format(PV, "#,##0") & Chr(13) & Chr(13) & Format(CRPPV, "#,##0") & Chr(13) & Chr(13) & Format(PMI, "#,##0") & Chr(13) & Chr(13) & Format(MB, "#,##0") & Chr(13) & Chr(13) & Format(CM, "#,##0") & Chr(13) & Chr(13) & Format(TM, "#,##0"), fontTotal))
                pdfCell2.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell2.MinimumHeight = 18
                pdfCell2.PaddingLeft = 5.0F
                pdfCell2.Border = 0
                pdfTable2.AddCell(pdfCell2)

                pdfDoc.Add(pdfTable2)

            Else

                MessageBox.Show("Aucune Ligne de Fatcure à imprimer!")

            End If


            ' ------------------------------------------------------------------------------------------------

            pdfDoc.Close()

            'MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub listeDesNoShow(ByVal dt As DataGridView, ByVal titre As String, ByVal DateDebut As Date, ByVal DateFin As Date)

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        Dim datestringFormat As String = ""

        If DateDebut.ToShortDateString = DateFin.ToShortDateString Then
            datestringFormat = DateDebut.ToShortDateString
        Else
            datestringFormat = DateDebut.ToShortDateString & " au " & DateFin.ToShortDateString
        End If

        If titre = "NO SHOW" Then
            tireDocument = "LISTE DES NO SHOW ET ANNULATION " & " DU " & datestringFormat & " " & Now().ToLongTimeString
            titreFichier = "LISTE DES NO SHOW  ET ANNULATION "
        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then
            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4.Rotate, 60, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 13, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            Dim pdfTable4 As New PdfPTable(9) 'Number of columns
            pdfTable4.TotalWidth = 780.0F
            pdfTable4.LockedWidth = True
            pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable4.HeaderRows = 1

            Dim widths4 As Single() = New Single() {25.0F, 6.0F, 8.0F, 8.0F, 8.0F, 5.0F, 10.0F, 9.0F, 15.0F}
            pdfTable4.SetWidths(widths4)

            pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("CHAM.", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("TYPE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)


            pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)


            pdfCell = New PdfPCell(New Paragraph("PAX", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("PRIX/NUITEE ", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("STATUT", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("SOURCE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            If dt.Rows.Count > 0 Then

                For i = 0 To dt.Rows.Count - 1

                    For j = 0 To dt.Columns.Count - 1

                        'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        If j = 6 Then
                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells(j).Value, "#,##0"), pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        ElseIf j = 3 Or j = 4 Then
                            pdfCell = New PdfPCell(New Paragraph(CDate(dt.Rows(i).Cells(j).Value.ToString).ToShortDateString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        Else
                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value.ToString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        End If

                        If j = 0 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        End If

                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable4.AddCell(pdfCell)
                    Next

                Next

                pdfDoc.Add(pdfTable4)

            End If

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub debiteurs(ByVal dt As DataGridView, ByVal DateDebut As Date, ByVal DateFin As Date)

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        Dim dateString = ""

        If DateDebut = DateFin Then
            dateString = DateDebut.ToShortDateString
        Else
            dateString = DateDebut.ToShortDateString & " AU " & DateFin.ToShortDateString
        End If

        If GlobalVariable.actualLanguageValue = 0 Then
            tireDocument = "LIST OF DEBTORS " & " OF " & dateString
            titreFichier = "LIST DEBTORS "
        Else
            tireDocument = "LISTE DES DEBITEURS " & " DU " & dateString
            titreFichier = "LISTE DES DEBITEURS  "
        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then
            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 13, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            Dim pdfTable4 As New PdfPTable(4) 'Number of columns
            pdfTable4.TotalWidth = 520.0F
            pdfTable4.LockedWidth = True
            pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable4.HeaderRows = 1

            Dim widths4 As Single() = New Single() {40.0F, 15.0F, 15.0F, 15.0F}
            pdfTable4.SetWidths(widths4)

            pdfCell = New PdfPCell(New Paragraph("CLIENT", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("DEBIT", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("CREDIT", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("SOLDE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            If dt.Rows.Count > 0 Then

                Dim total As Double = 0
                Dim totalCredit As Double = 0
                Dim totalDebit As Double = 0
                Dim totalSolde As Double = 0

                For i = 0 To dt.Rows.Count - 1

                    For j = 0 To dt.Columns.Count - 1

                        'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        If j = 1 Or j = 2 Or j = 3 Then
                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value, pRow))
                            total += dt.Rows(i).Cells(j).Value
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        ElseIf j = 1 Then
                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value.ToString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        ElseIf j = 0 Then
                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value.ToString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        End If

                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable4.AddCell(pdfCell)


                        If j = 2 Then
                            totalCredit += dt.Rows(i).Cells(j).Value
                        ElseIf j = 1 Then
                            totalDebit += dt.Rows(i).Cells(j).Value
                        End If
                    Next

                Next

                pdfCell = New PdfPCell(New Paragraph("TOTAL : ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(totalDebit, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(totalCredit, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(totalCredit - totalDebit, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfTable4.AddCell(pdfCell)

                pdfDoc.Add(pdfTable4)

            End If

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub navette(ByVal dt As DataGridView, ByVal DateDebut As Date, ByVal DateFin As Date, ByVal typeDeTrajet As Integer)

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        Dim dateString = ""

        If DateDebut = DateFin Then
            dateString = DateDebut.ToShortDateString
        Else
            dateString = DateDebut.ToShortDateString & " AU " & DateFin.ToShortDateString
        End If

        If GlobalVariable.actualLanguageValue = 0 Then
            tireDocument = "LIST OF TOP PRODUCERS " & " OF " & dateString
            titreFichier = "LIST OF TOP PRODUCERS "
        Else
            tireDocument = "NAVETTE " & " DU " & dateString
            titreFichier = "NAVETTE  "
        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then
            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 13, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            Dim pdfTable4 As New PdfPTable(13) 'Number of columns
            pdfTable4.TotalWidth = 760.0F
            pdfTable4.LockedWidth = True
            pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable4.HeaderRows = 1

            Dim widths4 As Single() = New Single() {25.0F, 18.0F, 12.0F, 12.0F, 6.0F, 12.0F, 12.0F, 12.0F, 12.0F, 12.0F, 12.0F, 11.0F, 10.0F}
            pdfTable4.SetWidths(widths4)

            For k = 0 To dt.Columns.Count - 1

                pdfCell = New PdfPCell(New Paragraph(dt.Columns(k).HeaderText, pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfTable4.AddCell(pdfCell)

            Next

            If dt.Rows.Count > 0 Then

                Dim total As Double = 0

                For i = 0 To dt.Rows.Count - 1

                    For j = 0 To dt.Columns.Count - 1

                        'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        If j = 3 Then
                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value.ToString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j = 7 Or j = 11 Then

                            If j = 7 Then

                                pdfCell = New PdfPCell(New Paragraph(CDate(dt.Rows(i).Cells(j).Value.ToString).ToShortDateString, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                            Else

                                If typeDeTrajet = 2 Or typeDeTrajet = 3 Or typeDeTrajet = 4 Then

                                    If dt.Rows(i).Cells(3).Value.ToString.Equals("Pick Up / Drop Off") Or dt.Rows(i).Cells(3).Value.ToString.Equals("Course") Then
                                        pdfCell = New PdfPCell(New Paragraph(CDate(dt.Rows(i).Cells(j).Value.ToString).ToShortDateString, pRow))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    Else
                                        pdfCell = New PdfPCell(New Paragraph("", pRow))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    End If

                                Else
                                    pdfCell = New PdfPCell(New Paragraph("", pRow))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                End If

                            End If

                        ElseIf j = 12 Then

                            If typeDeTrajet = 2 Or typeDeTrajet = 3 Or typeDeTrajet = 4 Then
                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value.ToString, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            Else
                                pdfCell = New PdfPCell(New Paragraph("", pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            End If

                        Else
                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value.ToString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        End If

                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable4.AddCell(pdfCell)
                    Next

                Next

                pdfDoc.Add(pdfTable4)

            End If

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub topProducers(ByVal dt As DataGridView, ByVal DateDebut As Date, ByVal DateFin As Date)

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        Dim dateString = ""

        If DateDebut = DateFin Then
            dateString = DateDebut.ToShortDateString
        Else
            dateString = DateDebut.ToShortDateString & " AU " & DateFin.ToShortDateString
        End If

        If GlobalVariable.actualLanguageValue = 0 Then
            tireDocument = "LIST OF TOP PRODUCERS " & " OF " & dateString
            titreFichier = "LIST OF TOP PRODUCERS "
        Else
            tireDocument = "LISTE DES TOP PRODUCERS " & " DU " & dateString
            titreFichier = "LISTE DES TOP PRODUCERS  "
        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then
            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 13, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            Dim pdfTable4 As New PdfPTable(3) 'Number of columns
            pdfTable4.TotalWidth = 520.0F
            pdfTable4.LockedWidth = True
            pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable4.HeaderRows = 1

            Dim widths4 As Single() = New Single() {9.0F, 40.0F, 15.0F}
            pdfTable4.SetWidths(widths4)

            pdfCell = New PdfPCell(New Paragraph("RANG", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("ENTREPRISE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("CHIFFRES D'AFFAIRES", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            If dt.Rows.Count > 0 Then

                Dim total As Double = 0

                For i = 0 To dt.Rows.Count - 1

                    For j = 0 To dt.Columns.Count - 1

                        'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        If j = 2 Then
                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells(j).Value, "#,##0"), pRow))
                            total += dt.Rows(i).Cells(j).Value
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        ElseIf j = 1 Then
                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value.ToString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        ElseIf j = 0 Then
                            pdfCell = New PdfPCell(New Paragraph(i + 1, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        End If

                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable4.AddCell(pdfCell)
                    Next

                Next

                pdfCell = New PdfPCell(New Paragraph("TOTAL : ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfCell.Colspan = 2
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(total, "#,##0"), pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F

                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfDoc.Add(pdfTable4)

            End If

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub rapportDesReservationDuDashBoard(ByVal titre As String)

        Dim DateDebut As Date = GlobalVariable.DateDeTravail.ToString("yyyy-MM-dd")
        Dim DateFin As Date = GlobalVariable.DateDeTravail.ToString("yyyy-MM-dd")

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        If titre = "ATTENDUES" Or titre = "EXPECTED" Then
            tireDocument = "LISTE DES ARRIVEES " & " du " & GlobalVariable.DateDeTravail & " " & Now().ToLongTimeString
            titreFichier = "LISTE DES ARRIVEES "
        ElseIf titre = "DEPARTS" Or titre = "DUE OUT" Then
            tireDocument = "LISTE DES DEAPRTS " & " du " & GlobalVariable.DateDeTravail & " " & Now().ToLongTimeString
            titreFichier = "LISTE DES NO SHOW  "
        ElseIf titre = "SEJOURS" Or titre = "STAY" Then
            tireDocument = "LISTE DES SEJOURS " & " du " & GlobalVariable.DateDeTravail & " " & Now().ToLongTimeString
            titreFichier = "LISTE DES SEJOURS "

        ElseIf titre = "NO SHOW" Then
            tireDocument = "LISTE DES NO SHOW " & " du " & GlobalVariable.DateDeTravail & " " & Now().ToLongTimeString
            titreFichier = "LISTE DES NO SHOW  "
        ElseIf titre = "RESERVATIONS" Or titre = "BOOKINGS" Then
            tireDocument = "LISTE DES RESERVATIONS " & " du " & GlobalVariable.DateDeTravail & " " & Now().ToLongTimeString
            titreFichier = "LISTE DES RESERVATIONS  "
        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then
            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 13, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            Dim pdfTable4 As New PdfPTable(8) 'Number of columns
            pdfTable4.TotalWidth = 750.0F
            pdfTable4.LockedWidth = True
            pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable4.HeaderRows = 1

            Dim widths4 As Single() = New Single() {20.0F, 9.0F, 9.0F, 9.0F, 9.0F, 9.0F, 9.0F, 9.0F}
            pdfTable4.SetWidths(widths4)

            pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("CHAMBRE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("SOLDE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("PRIX/NUITEE ", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("RESERVATION", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("PERSONNE(S)", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)


            Dim query4 As String = ""

            If titre = "ATTENDUES" Or titre = "EXPECTED" Then
                query4 = "Select NOM_CLIENT As 'NOM CLIENT', CHAMBRE_ID AS 'CHAMBRE',DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION', NB_PERSONNES As 'PERSONNE(S)' FROM reservation WHERE DATE_ENTTRE >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_ENTTRE <='" & DateFin.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND ETAT_RESERVATION = 0 ORDER BY ID_RESERVATION DESC"
            ElseIf titre = "DEPARTS" Or titre = "DUE OUT" Then
                query4 = "Select NOM_CLIENT As 'NOM CLIENT', CHAMBRE_ID AS 'CHAMBRE',DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_SORTIE >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE <='" & DateFin.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 1 AND TYPE=@TYPE ORDER BY ID_RESERVATION DESC"
            ElseIf titre = "SEJOURS" Or titre = "STAY" Then
                query4 = "Select  NOM_CLIENT As 'NOM CLIENT', CHAMBRE_ID As 'CHAMBRE', DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_ENTTRE <= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & DateDebut.ToString("yyyy-MM-dd") & "' AND ETAT_RESERVATION = 1 AND TYPE=@TYPE ORDER BY ID_RESERVATION DESC"
            ElseIf titre = "NO SHOW" Then
                query4 = "SELECT NOM_CLIENT As 'NOM CLIENT', CHAMBRE_ID AS 'CHAMBRE',DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_temp WHERE TYPE=@TYPE ORDER BY ID_RESERVATION DESC"
            ElseIf titre = "RESERVATIONS" Or titre = "BOOKINGS" Then
                query4 = "SELECT NOM_CLIENT As 'NOM CLIENT', CHAMBRE_ID AS 'CHAMBRE',DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_temp WHERE TYPE=@TYPE ORDER BY ID_RESERVATION DESC"
            End If

            Dim command4 As New MySqlCommand(query4, GlobalVariable.connect)
            command4.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle

            Dim adapter4 As New MySqlDataAdapter(command4)
            Dim tableArrivee As New DataTable()
            adapter4.Fill(tableArrivee)

            If tableArrivee.Rows.Count > 0 Then

                For i = 0 To tableArrivee.Rows.Count - 1

                    For j = 0 To tableArrivee.Columns.Count - 1

                        'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        If j = 4 Or j = 5 Then
                            pdfCell = New PdfPCell(New Paragraph(Format(tableArrivee.Rows(i)(j), "#,##0"), pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        ElseIf j = 2 Or j = 3 Then
                            pdfCell = New PdfPCell(New Paragraph(CDate(tableArrivee.Rows(i)(j).ToString).ToShortDateString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        Else
                            pdfCell = New PdfPCell(New Paragraph(tableArrivee.Rows(i)(j), pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        End If

                        If j = 0 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        End If

                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable4.AddCell(pdfCell)
                    Next

                Next

                pdfDoc.Add(pdfTable4)

            End If

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub resaParSourceOuTypeSpecifique(ByVal bonDeRapport As String, ByVal dateDu As Date, ByVal dateAu As Date, ByVal CODE_SOURCE_TYPE As String)

        Dim tireDocument As String
        Dim titreFichier As String

        If GlobalVariable.DocumentToGenerate = "source" Then
            tireDocument = "RESERVATIONS PAR SOURCE " & " du " & dateDu.ToShortDateString & " au " & dateAu.ToShortDateString
            titreFichier = "LISTE DES RESERVATIONS PAR TYPE "
        ElseIf GlobalVariable.DocumentToGenerate = "type" Then
            tireDocument = "RESERVATIONS PAR TYPE " & " du " & dateDu.ToShortDateString & " au " & dateAu.ToShortDateString
            titreFichier = "LISTE DES RESERVATIONS PAR TYPE "
        End If

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then
            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font2 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font3 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim HeaderFont As New Font(Font.FontFamily.COURIER, 18, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontInfoSup As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 11, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter()

            pdfDoc.Open()

            '------------------------------------------------------------------------
            Dim pdfCell As PdfPCell = Nothing

            Dim img() As Byte
            img = societe.Rows(0)("LOGO")

            Dim mStream As New MemoryStream(img)

            Dim logo As Image
            logo = Image.GetInstance(img)
            logo.ScalePercent(40.0F)

            Dim pHeaderLogo As New PdfPTable(1)
            pHeaderLogo.TotalWidth = pdfDoc.PageSize.Width
            pHeaderLogo.DefaultCell.Border = 0

            pdfCell = New PdfPCell(logo)
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.PaddingLeft = 5.0F
            pdfCell.Border = 0 'used to remove borders on the cells
            pHeaderLogo.AddCell(pdfCell)
            pHeaderLogo.WriteSelectedRows(0, -1, 0, pdfDoc.GetTop(pdfDoc.TopMargin) + 125, pdfWrite.DirectContent)

            Dim pHeader As New PdfPTable(1)
            pHeader.TotalWidth = pdfDoc.PageSize.Width
            pHeader.DefaultCell.Border = 0

            Dim p10 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE"), HeaderFont)
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            'pHeader.WriteSelectedRows(0, -1, Document.LeftMargin, Document.GetTop(Document.TopMargin) + 110, writer.DirectContent)
            'pHeader.WriteSelectedRows(0, -1, 0, pdfDoc.GetTop(pdfDoc.TopMargin) + 150, pdfWrite.DirectContent)

            'Dim pHeaderSubTitle As New PdfPTable(1)
            'pHeaderSubTitle.TotalWidth = pdfDoc.PageSize.Width
            'pHeaderSubTitle.DefaultCell.Border = 0

            'pdfCell = New PdfPCell(New Paragraph(societe.Rows(0)("PAYS") & " - " & societe.Rows(0)("VILLE") & Chr(13) & "TELEPHONE: " & societe.Rows(0)("TELEPHONE") & Chr(13) & "EMAIL: " & societe.Rows(0)("EMAIL"), fontInfoSup))
            'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            'pdfCell.PaddingLeft = 15.0F
            'pdfCell.Border = 0
            'pHeaderSubTitle.AddCell(pdfCell)
            'pHeaderSubTitle.WriteSelectedRows(0, -1, 0, pdfDoc.GetTop(pdfDoc.TopMargin) + 120, pdfWrite.DirectContent)

            Dim pHeaderSubTitle1 As New PdfPTable(1)
            pHeaderSubTitle1.TotalWidth = pdfDoc.PageSize.Width
            pHeaderSubTitle1.DefaultCell.Border = 0

            'pdfCell = New PdfPCell(New Paragraph("BOITE POSTALE: " & societe.Rows(0)("BOITE_POSTALE") & Chr(13) & societe.Rows(0)("NUM_CONTRIBUABLE") & Chr(13) & societe.Rows(0)("NUM_REGISTRE"), fontInfoSup))
            'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            'pdfCell.PaddingLeft = 15.0F
            'pdfCell.Border = 0
            'pHeaderSubTitle1.AddCell(pdfCell)
            pHeaderSubTitle1.WriteSelectedRows(0, -1, 0, pdfDoc.GetTop(pdfDoc.TopMargin) + 80, pdfWrite.DirectContent)

            '-------------------------------------------------------------------------------------------------------------------------------

            Dim p100 As Paragraph = New Paragraph(Chr(13) & tireDocument & Chr(13) & Chr(13))
            p100.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p100)

            Dim query4 As String = ""
            Dim query5 As String = ""

            Dim resa As New DataTable()

            Dim resa_conf As New DataTable()

            If GlobalVariable.DocumentToGenerate = "source" Then

                query5 = "SELECT SOURCE_RESERVATION FROM reserve_conf WHERE DATE_ENTTRE >= '" & dateDu.ToString("yyyy-MM-dd") & "' AND DATE_ENTTRE <='" & dateAu.ToString("yyyy-MM-dd") & "' AND SOURCE_RESERVATION=@CODE_SOURCE_TYPE AND TYPE=@TYPE ORDER BY DATE_ENTTRE ASC"

                Dim command5 As New MySqlCommand(query5, GlobalVariable.connect)
                command5.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = "chambre"
                command5.Parameters.Add("@CODE_SOURCE_TYPE", MySqlDbType.VarChar).Value = CODE_SOURCE_TYPE

                Dim adapter5 As New MySqlDataAdapter(command5)

                adapter5.Fill(resa_conf)

            ElseIf GlobalVariable.DocumentToGenerate = "type" Then

                query5 = "SELECT DISTINCT RAISON FROM reserve_conf WHERE DATE_CREATION >= '" & dateDu.ToString("yyyy-MM-dd") & "' AND DATE_CREATION <='" & dateAu.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE ORDER BY RAISON ASC"

                Dim command5 As New MySqlCommand(query5, GlobalVariable.connect)
                command5.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = "chambre"

                Dim adapter5 As New MySqlDataAdapter(command5)

                adapter5.Fill(resa_conf)

                'resa_conf.Merge(resa)

            End If

            Dim CODE_SOURCE_RESERVATION As String = ""

            For k = 0 To 0

                Dim titre As String = ""
                Dim typeResa As String = ""

                Dim RAISON As String = ""

                If GlobalVariable.DocumentToGenerate = "source" Then

                    CODE_SOURCE_RESERVATION = resa_conf.Rows(k)("SOURCE_RESERVATION")

                    Dim infoSupSourceResa As DataTable = Functions.getElementByCode(CODE_SOURCE_RESERVATION, "source_reservation", "CODE_SOURCE_RESERVATION")

                    If infoSupSourceResa.Rows.Count > 0 Then
                        titre = infoSupSourceResa.Rows(0)("SOURCE_RESERVATION")
                    End If

                    'query4 = "SELECT  NOM_CLIENT As 'NOM CLIENT', CHAMBRE_ID As 'CHAMBRE', DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_ENTTRE <= '" & dateDu.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & dateAu.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND SOURCE_RESERVATION = @FILTRE ORDER BY DATE_CREATION ASC"
                    query4 = "SELECT  NOM_CLIENT As 'NOM CLIENT', CHAMBRE_ID As 'CHAMBRE', DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_ENTTRE >= '" & dateDu.ToString("yyyy-MM-dd") & "' AND DATE_ENTTRE <='" & dateAu.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND SOURCE_RESERVATION = @FILTRE ORDER BY DATE_ENTTRE ASC"

                ElseIf GlobalVariable.DocumentToGenerate = "type" Then

                    RAISON = resa_conf.Rows(k)("RAISON")

                    titre = resa_conf.Rows(k)("RAISON")
                    typeResa = "RAISON"
                    'query4 = "SELECT  NOM_CLIENT As 'NOM CLIENT', CHAMBRE_ID As 'CHAMBRE', DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_ENTTRE <= '" & dateDu.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & dateAu.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND RAISON = @FILTRE ORDER BY DATE_CREATION ASC"
                    query4 = "SELECT  NOM_CLIENT As 'NOM CLIENT', CHAMBRE_ID As 'CHAMBRE', DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_CREATION >= '" & dateDu.ToString("yyyy-MM-dd") & "' AND DATE_CREATION <='" & dateAu.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND RAISON = @RAISON ORDER BY DATE_CREATION ASC"

                End If

                Dim command4 As New MySqlCommand(query4, GlobalVariable.connect)
                command4.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle
                command4.Parameters.Add("@FILTRE", MySqlDbType.VarChar).Value = CODE_SOURCE_RESERVATION
                command4.Parameters.Add("@RAISON", MySqlDbType.VarChar).Value = RAISON

                Dim adapter4 As New MySqlDataAdapter(command4)

                Dim tableArrivee As New DataTable()

                adapter4.Fill(tableArrivee)

                Dim p11 As Paragraph = New Paragraph(k + 1 & " - " & titre & Chr(13) & Chr(13))
                p11.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p11)

                Dim pdfTable4 As New PdfPTable(8) 'Number of columns
                pdfTable4.TotalWidth = 750.0F
                pdfTable4.LockedWidth = True
                pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable4.HeaderRows = 1

                Dim widths4 As Single() = New Single() {20.0F, 9.0F, 9.0F, 9.0F, 9.0F, 9.0F, 12.0F, 6.0F}
                pdfTable4.SetWidths(widths4)

                pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CHAMBRE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("SOLDE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PRIX/NUITEE ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("RESERVATION", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAX", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                Dim TotalDelaSource As Double = 0

                If tableArrivee.Rows.Count > 0 Then

                    For i = 0 To tableArrivee.Rows.Count - 1

                        For j = 0 To tableArrivee.Columns.Count - 1

                            'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            If j = 4 Or j = 5 Then
                                pdfCell = New PdfPCell(New Paragraph(Format(tableArrivee.Rows(i)(j), "#,##0"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                If j = 5 Then
                                    TotalDelaSource += tableArrivee.Rows(i)(j)
                                End If

                            ElseIf j = 2 Or j = 3 Then
                                pdfCell = New PdfPCell(New Paragraph(CDate(tableArrivee.Rows(i)(j).ToString).ToShortDateString, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            Else
                                pdfCell = New PdfPCell(New Paragraph(tableArrivee.Rows(i)(j), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            End If

                            If j = 0 Then
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            End If

                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F

                            pdfTable4.AddCell(pdfCell)
                        Next

                    Next

                    pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 5
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable4.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(TotalDelaSource, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable4.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfTable4.AddCell(pdfCell)

                    pdfDoc.Add(pdfTable4)

                End If
            Next

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

            Process.Start(sfd.FileName)

        End If

    End Sub


    Public Shared Sub resaParSourceOuType(ByVal bonDeRapport As String, ByVal dateDu As Date, ByVal dateAu As Date)

        Dim tireDocument As String
        Dim titreFichier As String

        If GlobalVariable.DocumentToGenerate = "source" Then
            tireDocument = "RESERVATIONS PAR SOURCE " & " du " & dateDu.ToShortDateString & " au " & dateAu.ToShortDateString
            titreFichier = "LISTE DES RESERVATIONS PAR TYPE "
        ElseIf GlobalVariable.DocumentToGenerate = "type" Then
            tireDocument = "RESERVATIONS PAR TYPE " & " du " & dateDu.ToShortDateString & " au " & dateAu.ToShortDateString
            titreFichier = "LISTE DES RESERVATIONS PAR TYPE "
        End If

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then
            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font2 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font3 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim HeaderFont As New Font(Font.FontFamily.COURIER, 18, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontInfoSup As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 11, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter()

            pdfDoc.Open()

            '------------------------------------------------------------------------
            Dim pdfCell As PdfPCell = Nothing

            Dim img() As Byte
            img = societe.Rows(0)("LOGO")

            Dim mStream As New MemoryStream(img)

            Dim logo As Image
            logo = Image.GetInstance(img)
            logo.ScalePercent(40.0F)

            Dim pHeaderLogo As New PdfPTable(1)
            pHeaderLogo.TotalWidth = pdfDoc.PageSize.Width
            pHeaderLogo.DefaultCell.Border = 0

            pdfCell = New PdfPCell(logo)
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.PaddingLeft = 5.0F
            pdfCell.Border = 0 'used to remove borders on the cells
            pHeaderLogo.AddCell(pdfCell)
            pHeaderLogo.WriteSelectedRows(0, -1, 0, pdfDoc.GetTop(pdfDoc.TopMargin) + 125, pdfWrite.DirectContent)

            Dim pHeader As New PdfPTable(1)
            pHeader.TotalWidth = pdfDoc.PageSize.Width
            pHeader.DefaultCell.Border = 0

            Dim p10 As Paragraph = New Paragraph(societe.Rows(0)("RAISON_SOCIALE"), HeaderFont)
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            'pHeader.WriteSelectedRows(0, -1, Document.LeftMargin, Document.GetTop(Document.TopMargin) + 110, writer.DirectContent)
            'pHeader.WriteSelectedRows(0, -1, 0, pdfDoc.GetTop(pdfDoc.TopMargin) + 150, pdfWrite.DirectContent)

            'Dim pHeaderSubTitle As New PdfPTable(1)
            'pHeaderSubTitle.TotalWidth = pdfDoc.PageSize.Width
            'pHeaderSubTitle.DefaultCell.Border = 0

            'pdfCell = New PdfPCell(New Paragraph(societe.Rows(0)("PAYS") & " - " & societe.Rows(0)("VILLE") & Chr(13) & "TELEPHONE: " & societe.Rows(0)("TELEPHONE") & Chr(13) & "EMAIL: " & societe.Rows(0)("EMAIL"), fontInfoSup))
            'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            'pdfCell.PaddingLeft = 15.0F
            'pdfCell.Border = 0
            'pHeaderSubTitle.AddCell(pdfCell)
            'pHeaderSubTitle.WriteSelectedRows(0, -1, 0, pdfDoc.GetTop(pdfDoc.TopMargin) + 120, pdfWrite.DirectContent)

            Dim pHeaderSubTitle1 As New PdfPTable(1)
            pHeaderSubTitle1.TotalWidth = pdfDoc.PageSize.Width
            pHeaderSubTitle1.DefaultCell.Border = 0

            'pdfCell = New PdfPCell(New Paragraph("BOITE POSTALE: " & societe.Rows(0)("BOITE_POSTALE") & Chr(13) & societe.Rows(0)("NUM_CONTRIBUABLE") & Chr(13) & societe.Rows(0)("NUM_REGISTRE"), fontInfoSup))
            'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
            'pdfCell.PaddingLeft = 15.0F
            'pdfCell.Border = 0
            'pHeaderSubTitle1.AddCell(pdfCell)
            pHeaderSubTitle1.WriteSelectedRows(0, -1, 0, pdfDoc.GetTop(pdfDoc.TopMargin) + 80, pdfWrite.DirectContent)

            '-------------------------------------------------------------------------------------------------------------------------------

            Dim p100 As Paragraph = New Paragraph(Chr(13) & tireDocument & Chr(13) & Chr(13))
            p100.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p100)

            Dim query4 As String = ""
            Dim query5 As String = ""

            Dim resa As New DataTable()

            Dim resa_conf As New DataTable()

            If GlobalVariable.DocumentToGenerate = "source" Then

                'query4 = "Select DISTINCT SOURCE_RESERVATION FROM reservation WHERE DATE_ENTTRE >= '" & dateDu.ToString("yyyy-MM-dd") & "' AND DATE_ENTTRE <='" & dateAu.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND ETAT_RESERVATION = 0 ORDER BY DATE_CREATION ASC"

                'Dim command4 As New MySqlCommand(query4, GlobalVariable.connect)
                'command4.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle

                ' Dim adapter4 As New MySqlDataAdapter(command4)

                'adapter4.Fill(resa)

                query5 = "SELECT DISTINCT SOURCE_RESERVATION FROM reserve_conf WHERE DATE_CREATION >= '" & dateDu.ToString("yyyy-MM-dd") & "' AND DATE_CREATION <='" & dateAu.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE ORDER BY SOURCE_RESERVATION ASC"

                Dim command5 As New MySqlCommand(query5, GlobalVariable.connect)
                command5.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle

                Dim adapter5 As New MySqlDataAdapter(command5)

                adapter5.Fill(resa_conf)

                'resa_conf.Merge(resa)

            ElseIf GlobalVariable.DocumentToGenerate = "type" Then

                'query4 = "Select DISTINCT RAISON FROM reservation WHERE DATE_ENTTRE >= '" & dateDu.ToString("yyyy-MM-dd") & "' AND DATE_ENTTRE <='" & dateAu.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND ETAT_RESERVATION = 0 ORDER BY DATE_CREATION ASC"

                'Dim command4 As New MySqlCommand(query4, GlobalVariable.connect)
                'command4.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle

                'Dim adapter4 As New MySqlDataAdapter(command4)

                ' adapter4.Fill(resa)

                query5 = "SELECT DISTINCT RAISON FROM reserve_conf WHERE DATE_CREATION >= '" & dateDu.ToString("yyyy-MM-dd") & "' AND DATE_CREATION <='" & dateAu.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE ORDER BY RAISON ASC"

                Dim command5 As New MySqlCommand(query5, GlobalVariable.connect)
                command5.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = "chambre"

                Dim adapter5 As New MySqlDataAdapter(command5)

                adapter5.Fill(resa_conf)

                'resa_conf.Merge(resa)

            End If


            Dim CODE_SOURCE_RESERVATION As String = ""

            For k = 0 To resa_conf.Rows.Count - 1

                Dim titre As String = ""
                Dim typeResa As String = ""

                Dim RAISON As String = ""

                If GlobalVariable.DocumentToGenerate = "source" Then

                    CODE_SOURCE_RESERVATION = resa_conf.Rows(k)("SOURCE_RESERVATION")

                    Dim infoSupSourceResa As DataTable = Functions.getElementByCode(CODE_SOURCE_RESERVATION, "source_reservation", "CODE_SOURCE_RESERVATION")

                    If infoSupSourceResa.Rows.Count > 0 Then
                        titre = infoSupSourceResa.Rows(0)("SOURCE_RESERVATION")
                    End If

                    'query4 = "SELECT  NOM_CLIENT As 'NOM CLIENT', CHAMBRE_ID As 'CHAMBRE', DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_ENTTRE <= '" & dateDu.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & dateAu.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND SOURCE_RESERVATION = @FILTRE ORDER BY DATE_CREATION ASC"
                    query4 = "SELECT  NOM_CLIENT As 'NOM CLIENT', CHAMBRE_ID As 'CHAMBRE', DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_CREATION >= '" & dateDu.ToString("yyyy-MM-dd") & "' AND DATE_CREATION <='" & dateAu.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND SOURCE_RESERVATION = @FILTRE ORDER BY DATE_CREATION ASC"

                ElseIf GlobalVariable.DocumentToGenerate = "type" Then

                    RAISON = resa_conf.Rows(k)("RAISON")

                    titre = resa_conf.Rows(k)("RAISON")
                    typeResa = "RAISON"
                    'query4 = "SELECT  NOM_CLIENT As 'NOM CLIENT', CHAMBRE_ID As 'CHAMBRE', DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_ENTTRE <= '" & dateDu.ToString("yyyy-MM-dd") & "' AND DATE_SORTIE >='" & dateAu.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND RAISON = @FILTRE ORDER BY DATE_CREATION ASC"
                    query4 = "SELECT  NOM_CLIENT As 'NOM CLIENT', CHAMBRE_ID As 'CHAMBRE', DATE_ENTTRE As 'DATE ENTREE', DATE_SORTIE As 'DATE SORTIE', SOLDE_RESERVATION AS 'SOLDE', MONTANT_ACCORDE AS 'PRIX/NUITEE', CODE_RESERVATION AS 'RESERVATION',NB_PERSONNES As 'PERSONNE(S)' FROM reserve_conf WHERE DATE_CREATION >= '" & dateDu.ToString("yyyy-MM-dd") & "' AND DATE_CREATION <='" & dateAu.ToString("yyyy-MM-dd") & "' AND TYPE=@TYPE AND RAISON = @RAISON ORDER BY DATE_CREATION ASC"

                End If

                Dim command4 As New MySqlCommand(query4, GlobalVariable.connect)
                command4.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = GlobalVariable.typeChambreOuSalle
                command4.Parameters.Add("@FILTRE", MySqlDbType.VarChar).Value = CODE_SOURCE_RESERVATION
                command4.Parameters.Add("@RAISON", MySqlDbType.VarChar).Value = RAISON

                Dim adapter4 As New MySqlDataAdapter(command4)

                Dim tableArrivee As New DataTable()

                adapter4.Fill(tableArrivee)

                Dim p11 As Paragraph = New Paragraph(k + 1 & " - " & titre & Chr(13) & Chr(13))
                p11.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p11)

                Dim pdfTable4 As New PdfPTable(8) 'Number of columns
                pdfTable4.TotalWidth = 750.0F
                pdfTable4.LockedWidth = True
                pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable4.HeaderRows = 1

                Dim widths4 As Single() = New Single() {20.0F, 9.0F, 9.0F, 9.0F, 9.0F, 9.0F, 12.0F, 6.0F}
                pdfTable4.SetWidths(widths4)

                pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CHAMBRE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("SOLDE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PRIX/NUITEE ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("RESERVATION", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAX", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                If tableArrivee.Rows.Count > 0 Then

                    For i = 0 To tableArrivee.Rows.Count - 1

                        For j = 0 To tableArrivee.Columns.Count - 1

                            'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            If j = 4 Or j = 5 Then
                                pdfCell = New PdfPCell(New Paragraph(Format(tableArrivee.Rows(i)(j), "#,##0"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            ElseIf j = 2 Or j = 3 Then
                                pdfCell = New PdfPCell(New Paragraph(CDate(tableArrivee.Rows(i)(j).ToString).ToShortDateString, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            Else
                                pdfCell = New PdfPCell(New Paragraph(tableArrivee.Rows(i)(j), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            End If

                            If j = 0 Then
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            End If

                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F

                            pdfTable4.AddCell(pdfCell)
                        Next

                    Next

                    pdfDoc.Add(pdfTable4)

                End If
            Next

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub impressionEconomat(ByVal dt As DataGridView, ByVal title As String, ByVal totalAchat As Double, ByVal totalVente As Double,
                                         ByVal numeroBon As String, Optional ByVal nomTiers As String = "", Optional ByVal libelle As String = "", Optional ByVal reference As String = "",
                                         Optional ByVal observations As String = "", Optional CODE_MAGASIN_ As String = "")

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0

        Dim tireDocument As String = title.ToUpper() & " DU " & (Date.Now().ToString("ddMMyyHHmmss"))

        Dim sousTitreDocument As String = ""

        sousTitreDocument = tireDocument

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 20, 80, 40)
            'Dim pdfDoc As New Document(PageSize.A4, 40, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 20, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p3 As Paragraph = New Paragraph(Chr(13) & title.ToUpper() & " DU " & " " & GlobalVariable.DateDeTravail & Chr(13) & Chr(13), pRow)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            If title.Contains("INVENTAIRE") Then

                Dim CODE_MAGASIN As String = ""

                If Trim(CODE_MAGASIN_).Equals("") Then
                    CODE_MAGASIN = MainWindowEconomat.GunaComboBoxMagasin_1.SelectedValue.ToString
                Else
                    CODE_MAGASIN = CODE_MAGASIN_
                End If


                Dim LIBELLE_MAGASIN As String = ""
                Dim infoSupMagasin As DataTable = Functions.getElementByCode(CODE_MAGASIN, "magasin", "CODE_MAGASIN")

                If infoSupMagasin.Rows.Count > 0 Then
                    LIBELLE_MAGASIN = infoSupMagasin.Rows(0)("LIBELLE_MAGASIN")
                End If

                Dim p03 As Paragraph = New Paragraph("MAGASIN : " & LIBELLE_MAGASIN & Chr(13) & Chr(13), pRow)
                p03.Alignment = Element.ALIGN_LEFT

                pdfDoc.Add(p03)

                Dim pdfTable As New PdfPTable(5) 'Number of columns
                pdfTable.TotalWidth = 555.0F
                pdfTable.LockedWidth = True
                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable.HeaderRows = 1

                'Dim widths As Single() = New Single() {25.0F, 25.0F, 25.0F, 25.0F, 25.0F, 25.0F, 25.0F, 25.0F}
                Dim widths As Single() = New Single() {15.0F, 60.0F, 15.0F, 15.0F, 15.0F}

                pdfTable.SetWidths(widths)

                Dim pdfCell As PdfPCell = Nothing

                pdfCell = New PdfPCell(New Paragraph("REF.", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DESIGNATION", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("QTE EN STOCK", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("QTE PHYSIQUE", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("COUT DU STOCK", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                For j = 0 To dt.Rows.Count - 1

                    For k = 0 To dt.Columns.Count - 1

                        If dt.Rows(j).Cells(2).Value > 0 Then

                            If k = 2 Or k = 4 Then

                                Dim COTE_ARTICLE As String = dt.Rows(j).Cells(0).Value.ToString
                                Dim QTE_CONVERTI As Double = Functions.affichageQteDansUnFormatCorrect(COTE_ARTICLE, dt.Rows(j).Cells(k).Value)

                                pdfCell = New PdfPCell(New Paragraph(Format(QTE_CONVERTI, "#,##0.00"), font1))
                            ElseIf k = 3 Then
                                pdfCell = New PdfPCell(New Paragraph("", font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells(k).Value.ToString, font1))
                            End If

                            If k = 0 Then
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            ElseIf k = 1 Then
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            ElseIf k = 2 Then
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            ElseIf k = 3 Then
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            ElseIf k = 4 Then
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                totalAchat += dt.Rows(j).Cells(k).Value

                            End If

                            pdfCell.MinimumHeight = 5

                            pdfTable.AddCell(pdfCell)

                        End If

                    Next

                Next

                pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0
                pdfCell.Colspan = 4

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(totalAchat, "#,##0"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                Process.Start(sfd.FileName)

            Else

                If Not Trim(numeroBon).Equals("") Then

                    Dim infoSupBon As DataTable = Functions.getElementByCode(numeroBon, "bordereaux", "CODE_BORDEREAUX")

                    If infoSupBon.Rows.Count > 0 Then

                        Dim p0 As Paragraph = New Paragraph(Chr(13) & title & " NUMERO :  " & infoSupBon.Rows(0)("CODE_BORDEREAUX") & Chr(13) & "LIBELLE: " & infoSupBon.Rows(0)("LIBELLE_BORDEREAUX") & Chr(13) & "REFERENCE: " & infoSupBon.Rows(0)("REF_BORDEREAUX") & Chr(13) & "TIERS: " & infoSupBon.Rows(0)("NON_TIERS") & Chr(13) & Chr(13), pRow)
                        p0.Alignment = Element.ALIGN_LEFT

                        pdfDoc.Add(p0)

                    Else

                        Dim p0 As Paragraph = New Paragraph(Chr(13) & title & " NUMERO :  " & numeroBon & Chr(13) & "LIBELLE: " & libelle & Chr(13) & "REFERENCE: " & reference & Chr(13) & "TIERS: " & nomTiers & Chr(13) & Chr(13), pRow)
                        p0.Alignment = Element.ALIGN_LEFT

                        pdfDoc.Add(p0)

                    End If

                End If

                'Dim pdfTable As New PdfPTable(8) 'Number of columns
                Dim pdfTable As New PdfPTable(5) 'Number of columns
                pdfTable.TotalWidth = 555.0F
                pdfTable.LockedWidth = True
                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable.HeaderRows = 1

                'Dim widths As Single() = New Single() {25.0F, 25.0F, 25.0F, 25.0F, 25.0F, 25.0F, 25.0F, 25.0F}
                Dim widths As Single() = New Single() {15.0F, 60.0F, 15.0F, 15.0F, 15.0F}

                pdfTable.SetWidths(widths)

                Dim pdfCell As PdfPCell = Nothing

                pdfCell = New PdfPCell(New Paragraph("REF.", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("LIBELLE", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("QTE", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PU", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                For j = 0 To dt.Rows.Count - 1

                    Dim CODE_ARTICLE As String = dt.Rows(j).Cells(1).Value.ToString

                    For k = 0 To dt.Columns.Count - 1

                        If k = 6 Or k = 3 Or k = 1 Or k = 2 Or k = 5 Then

                            If Not Trim(dt.Rows(j).Cells(k).Value.ToString).Equals("") Then

                                If k = 5 Or k = 6 Then

                                    pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j).Cells(k).Value, "#,##0"), font1))

                                Else

                                    If k = 3 Then
                                        Dim QTE_CONVERTI As Double = Functions.affichageQteDansUnFormatCorrect(CODE_ARTICLE, dt.Rows(j).Cells(k).Value)
                                        pdfCell = New PdfPCell(New Paragraph(QTE_CONVERTI, font1))
                                    Else
                                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells(k).Value, font1))
                                    End If

                                End If

                            End If

                            If k = 1 Then
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            ElseIf k = 2 Then
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            ElseIf k = 3 Then
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            ElseIf k = 5 Or k = 6 Then
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            End If

                            pdfCell.MinimumHeight = 5

                            pdfTable.AddCell(pdfCell)

                        End If

                    Next

                Next

                pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0
                pdfCell.Colspan = 4

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(totalAchat, "#,##0"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

                Dim p03 As Paragraph = New Paragraph(Chr(13) & "OBSERVATIONS : " & observations & Chr(13), pRow)
                p03.Alignment = Element.ALIGN_CENTER

                pdfDoc.Add(p03)

                '------------------------------------------------------------------------

                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                Process.Start(sfd.FileName)

            End If

        End If

    End Sub

    Public Shared Sub exportationDuCardexVersExcel(ByVal dt As DataGridView, ByVal title As String)


        If dt.Rows.Count > 0 Then

            Dim sfd As FolderBrowserDialog = New FolderBrowserDialog

            'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))

            If sfd.ShowDialog() = DialogResult.OK Then

                Dim xlApp As Excel.Application
                Dim xlWorkBook As Excel.Workbook
                Dim xlWorkSheet As Excel.Worksheet
                Dim misValue As Object = System.Reflection.Missing.Value
                Dim i As Integer
                Dim j As Integer

                xlApp = New Excel.Application
                xlWorkBook = xlApp.Workbooks.Add(Type.Missing)
                xlWorkSheet = xlWorkBook.Sheets(1)

                Dim k As Integer = 0

                For Each column As DataGridViewColumn In dt.Columns
                    xlWorkSheet.Cells(1, k + 1) = column.HeaderText
                    k += 1
                Next

                Dim n As Integer = 2
                Dim m As Integer = 1

                For i = 2 To dt.RowCount + 1

                    For j = 1 To dt.ColumnCount

                        If False Then
                            'xlWorkSheet.Cells(i, j) = CDate(dt.Rows(i - n).Cells(j - m).Value).ToLongDateString()
                            'xlWorkSheet.Cells(i, j) = CDate(dt.Rows(i - n).Cells(j - m).Value).ToLongDateString()
                        Else
                            xlWorkSheet.Cells(i, j) = dt.Rows(i - n).Cells(j - m).Value.ToString()
                        End If

                    Next
                Next

                Dim fileName As String = "\" & title & ".xlsx"
                Dim finalPath = sfd.SelectedPath + fileName

                xlWorkSheet.Columns.AutoFit()

                xlWorkSheet.SaveAs(finalPath)
                xlWorkBook.Close()
                xlApp.Quit()

                releaseObject(xlApp)
                releaseObject(xlWorkBook)
                releaseObject(xlWorkSheet)

                MessageBox.Show(title & " a été exporté au format Excel", "Exportation Excel", MessageBoxButtons.OK, MessageBoxIcon.Information)

                'Process.Start(sfd.FileName)

            End If

        End If

    End Sub

    Public Shared Sub exportationversExcel(ByVal dt As DataGridView, ByVal title As String)


        If dt.Rows.Count > 0 Then

            Dim sfd As FolderBrowserDialog = New FolderBrowserDialog

            'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))

            If sfd.ShowDialog() = DialogResult.OK Then

                Dim xlApp As Excel.Application
                Dim xlWorkBook As Excel.Workbook
                Dim xlWorkSheet As Excel.Worksheet
                Dim misValue As Object = System.Reflection.Missing.Value
                Dim i As Integer
                Dim j As Integer

                xlApp = New Excel.Application
                xlWorkBook = xlApp.Workbooks.Add(Type.Missing)
                xlWorkSheet = xlWorkBook.Sheets(1)

                Dim k As Integer = 0

                For Each column As DataGridViewColumn In dt.Columns
                    xlWorkSheet.Cells(1, k + 1) = column.HeaderText
                    k += 1
                Next

                Dim n As Integer = 2
                Dim m As Integer = 1

                For i = 2 To dt.RowCount + 1

                    For j = 1 To dt.ColumnCount

                        If j = 2 Then
                            xlWorkSheet.Cells(i, j) = CDate(dt.Rows(i - n).Cells(j - m).Value).ToLongDateString()
                        Else
                            xlWorkSheet.Cells(i, j) = dt.Rows(i - n).Cells(j - m).Value.ToString()
                        End If

                    Next
                Next

                Dim fileName As String = "\" & title & ".xlsx"
                Dim finalPath = sfd.SelectedPath + fileName

                xlWorkSheet.Columns.AutoFit()

                xlWorkSheet.SaveAs(finalPath)
                xlWorkBook.Close()
                xlApp.Quit()

                releaseObject(xlApp)
                releaseObject(xlWorkBook)
                releaseObject(xlWorkSheet)

                MessageBox.Show(title & " a été exporté au format Excel", "Exportation Excel", MessageBoxButtons.OK, MessageBoxIcon.Information)

                'Process.Start(sfd.FileName)

            End If
        End If

    End Sub

    Private Shared Sub releaseObject(ByVal obj As Object)

        Try
            System.Runtime.InteropServices.Marshal.ReleaseComObject(obj)
            obj = Nothing
        Catch ex As Exception
            obj = Nothing
        Finally
            GC.Collect()
        End Try

    End Sub

    Public Shared Sub affichageDesEntreesSortiePeriodiqueImpression(ByVal DateDebut As Date, DateFin As Date, ByVal entreeSortie As Integer, ByVal globalIndividuel As Integer, ByVal title As String, ByVal entreeSortieOuAchatPeriodique As Integer)

        Dim TYPE_BORDEREAUX_1 As String = ""
        Dim TYPE_BORDEREAUX_2 As String = ""

        Dim FillingListquery As String = ""
        Dim FillingListquery01 As String = ""
        Dim FillingListquery02 As String = ""

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0

        Dim tireDocument As String = title.ToUpper() & " DU " & (Date.Now().ToString("ddMMyyHHmmss"))

        Dim sousTitreDocument As String = ""

        sousTitreDocument = tireDocument

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        Dim totalAchat As Double = 0
        Dim GrandTotalAchat As Double = 0

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 20, 20, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRowFirst As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 18, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal1 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p0003 As Paragraph = New Paragraph(GlobalVariable.societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & Chr(13), pRowFirst)
            p0003.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p0003)

            Dim p3 As Paragraph = New Paragraph(title.ToUpper() & " DU " & " " & DateDebut & " AU " & DateFin & Chr(13), pRow)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            If entreeSortieOuAchatPeriodique = 1 Then

                TYPE_BORDEREAUX_1 = "Bon de Réception"
                TYPE_BORDEREAUX_2 = "Entrée exceptionnelle"

                'TRAITEMENT DES ACHATS PERIODIQUE

                '1- SELECTION DES DIVERS MAGASINS

                FillingListquery01 = "SELECT DISTINCT CODE_MAGASIN FROM `bordereaux` WHERE TYPE_BORDEREAUX=@TYPE_BORDEREAUX_1 AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <= '" & DateFin.ToString("yyyy-MM-dd") & "' OR TYPE_BORDEREAUX=@TYPE_BORDEREAUX_2 AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' ORDER BY DATE_BORDEREAU DESC"

                Dim commandList01 As New MySqlCommand(FillingListquery01, GlobalVariable.connect)
                commandList01.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                commandList01.Parameters.Add("@TYPE_BORDEREAUX_2", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_2

                Dim adapterList01 As New MySqlDataAdapter(commandList01)
                Dim tableListMagasin As New DataTable()

                adapterList01.Fill(tableListMagasin)

                If tableListMagasin.Rows.Count > 0 Then

                    For i = 0 To tableListMagasin.Rows.Count - 1

                        Dim infoSupMagaSin As DataTable = Functions.getElementByCode(tableListMagasin.Rows(i)("CODE_MAGASIN"), "magasin", "CODE_MAGASIN")

                        If infoSupMagaSin.Rows.Count > 0 Then

                            Dim p03 As Paragraph = New Paragraph(Chr(13) & " MAGASIN : " & infoSupMagaSin.Rows(0)("LIBELLE_MAGASIN") & Chr(13), pRow)
                            p03.Alignment = Element.ALIGN_LEFT

                            pdfDoc.Add(p03)

                        End If

                        '2. FAMILLES D'ARTICLES / MATIERES

                        FillingListquery02 = "SELECT DISTINCT CODE_SOUS_FAMILLE FROM article, bordereaux, ligne_bordereaux  WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "','" & TYPE_BORDEREAUX_2 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND ligne_bordereaux.CODE_MAGASIN = @CODE_MAGASIN ORDER BY DATE_BORDEREAU DESC"

                        Dim commandList02 As New MySqlCommand(FillingListquery02, GlobalVariable.connect)
                        commandList02.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                        commandList02.Parameters.Add("@TYPE_BORDEREAUX_2", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_2
                        commandList02.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")

                        Dim adapterList02 As New MySqlDataAdapter(commandList02)
                        Dim tableListFamille As New DataTable()

                        adapterList02.Fill(tableListFamille)

                        If tableListFamille.Rows.Count > 0 Then

                            '3- LISTES DES ARTICLES  (PAR MAGASIN ET PAR FAMILLE)

                            For t = 0 To tableListFamille.Rows.Count - 1

                                If globalIndividuel = 0 Then

                                    totalAchat = 0

                                    'FAMILLE HERE

                                    FillingListquery = "SELECT `DATE_BORDEREAU` AS 'DATE',  DESIGNATION_FR AS 'DESIGNATION', NUM_SERIE_DEBUT AS 'UNITE', ligne_bordereaux.QUANTITE As 'QTE AVANT MOVT', QUANTITE_ENTREE_STOCK AS 'QTE EN MOVT', PRIX_UNITAIRE_HT AS 'PRIX UNITAIRE', PRIX_TOTAL_HT AS 'TOTAL' FROM `bordereaux`, ligne_bordereaux, article, magasin WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "','" & TYPE_BORDEREAUX_2 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND magasin.CODE_MAGASIN = ligne_bordereaux.CODE_MAGASIN AND article.CODE_SOUS_FAMILLE = @CODE_SOUS_FAMILLE AND ligne_bordereaux.CODE_MAGASIN = @CODE_MAGASIN ORDER BY ID_LIGNE_BORDEREAU DESC"

                                    Dim commandList As New MySqlCommand(FillingListquery, GlobalVariable.connect)
                                    commandList.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                                    commandList.Parameters.Add("@TYPE_BORDEREAUX_2", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_2
                                    commandList.Parameters.Add("@CODE_SOUS_FAMILLE", MySqlDbType.VarChar).Value = tableListFamille.Rows(t)("CODE_SOUS_FAMILLE")
                                    commandList.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")

                                    Dim adapterList As New MySqlDataAdapter(commandList)
                                    Dim dt As New DataTable()

                                    adapterList.Fill(dt)

                                    If dt.Rows.Count > 0 Then

                                        Dim p003 As Paragraph = New Paragraph(Chr(13) & "FAMILLE : " & tableListFamille.Rows(t)("CODE_SOUS_FAMILLE") & Chr(13) & Chr(13), pRow)
                                        p003.Alignment = Element.ALIGN_RIGHT

                                        pdfDoc.Add(p003)

                                        Dim pdfTable As New PdfPTable(7) 'Number of columns
                                        pdfTable.TotalWidth = 555.0F
                                        pdfTable.LockedWidth = True
                                        pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfTable.HeaderRows = 1

                                        Dim widths As Single() = New Single() {20.0F, 45.0F, 25.0F, 15.0F, 15.0F, 15.0F, 15.0F}

                                        pdfTable.SetWidths(widths)

                                        Dim pdfCell As PdfPCell = Nothing

                                        pdfCell = New PdfPCell(New Paragraph("DATE", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("DESIGNATION", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("UNITE", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("QTE AV. MVT", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("QTE EN MVT", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("PU", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        For j = 0 To dt.Rows.Count - 1

                                            For k = 0 To dt.Columns.Count - 1

                                                If k = 6 Or k = 5 Then
                                                    pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j)(k), "#,##0"), font1))
                                                Else
                                                    pdfCell = New PdfPCell(New Paragraph(dt.Rows(j)(k), font1))
                                                End If

                                                If k = 6 Or k = 5 Then
                                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                                ElseIf k = 3 Or k = 4 Then
                                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                                Else
                                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                                End If

                                                If k = 6 Then
                                                    totalAchat += dt.Rows(j)(k)
                                                    GrandTotalAchat += dt.Rows(j)(k)
                                                End If
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                            Next

                                        Next

                                        pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        pdfCell.Border = 0
                                        pdfCell.Colspan = 6

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(Format(totalAchat, "#,##0"), fontTotal))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfDoc.Add(pdfTable)

                                    End If

                                Else

                                    totalAchat = 0

                                    FillingListquery = "SELECT DISTINCT ligne_bordereaux.CODE_ARTICLE FROM `bordereaux`, ligne_bordereaux, article, magasin WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "','" & TYPE_BORDEREAUX_2 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND magasin.CODE_MAGASIN = ligne_bordereaux.CODE_MAGASIN AND article.CODE_SOUS_FAMILLE = @CODE_SOUS_FAMILLE AND ligne_bordereaux.CODE_MAGASIN = @CODE_MAGASIN ORDER BY ID_LIGNE_BORDEREAU DESC"

                                    'article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE
                                    ',  DESIGNATION_FR AS DESIGNATION

                                    Dim commandList As New MySqlCommand(FillingListquery, GlobalVariable.connect)
                                    commandList.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                                    commandList.Parameters.Add("@TYPE_BORDEREAUX_2", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_2
                                    commandList.Parameters.Add("@CODE_SOUS_FAMILLE", MySqlDbType.VarChar).Value = tableListFamille.Rows(t)("CODE_SOUS_FAMILLE")
                                    commandList.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")

                                    Dim adapterList As New MySqlDataAdapter(commandList)
                                    Dim articleList As New DataTable()

                                    adapterList.Fill(articleList)

                                    If articleList.Rows.Count > 0 Then


                                        Dim p003 As Paragraph = New Paragraph(Chr(13) & "FAMILLE : " & tableListFamille.Rows(t)("CODE_SOUS_FAMILLE") & Chr(13) & Chr(13), pRow)
                                        p003.Alignment = Element.ALIGN_RIGHT

                                        pdfDoc.Add(p003)

                                        Dim pdfTable As New PdfPTable(5) 'Number of columns
                                        pdfTable.TotalWidth = 555.0F
                                        pdfTable.LockedWidth = True
                                        pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfTable.HeaderRows = 1

                                        Dim widths As Single() = New Single() {45.0F, 30.0F, 15.0F, 15.0F, 15.0F}

                                        pdfTable.SetWidths(widths)

                                        Dim pdfCell As PdfPCell = Nothing

                                        pdfCell = New PdfPCell(New Paragraph("DESIGNATION", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("UNITE", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("QTE", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("PU Moy.", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        For l = 0 To articleList.Rows.Count - 1

                                            '----------------------------------------------

                                            Dim FillingListquery03 As String = "SELECT `DATE_BORDEREAU` AS 'DATE',  DESIGNATION_FR AS 'DESIGNATION', NUM_SERIE_DEBUT AS 'UNITE', ligne_bordereaux.QUANTITE As 'QTE AVANT MOVT', QUANTITE_ENTREE_STOCK AS 'QTE EN MOVT', PRIX_UNITAIRE_HT AS 'PRIX UNITAIRE', PRIX_TOTAL_HT AS 'TOTAL' FROM `bordereaux`, ligne_bordereaux, article, magasin WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "','" & TYPE_BORDEREAUX_2 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND magasin.CODE_MAGASIN = ligne_bordereaux.CODE_MAGASIN AND article.CODE_SOUS_FAMILLE = @CODE_SOUS_FAMILLE AND ligne_bordereaux.CODE_MAGASIN = @CODE_MAGASIN AND ligne_bordereaux.CODE_ARTICLE =@CODE_ARTICLE ORDER BY ID_LIGNE_BORDEREAU DESC"

                                            Dim commandList03 As New MySqlCommand(FillingListquery03, GlobalVariable.connect)
                                            commandList03.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                                            commandList03.Parameters.Add("@TYPE_BORDEREAUX_2", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_2
                                            commandList03.Parameters.Add("@CODE_SOUS_FAMILLE", MySqlDbType.VarChar).Value = tableListFamille.Rows(t)("CODE_SOUS_FAMILLE")
                                            commandList03.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")
                                            commandList03.Parameters.Add("@CODE_ARTICLE", MySqlDbType.VarChar).Value = articleList.Rows(l)("CODE_ARTICLE")

                                            Dim adapterList03 As New MySqlDataAdapter(commandList03)
                                            Dim dt As New DataTable()

                                            adapterList03.Fill(dt)

                                            If dt.Rows.Count > 0 Then

                                                Dim qteTotal As Double = 0
                                                Dim montantTotal As Double = 0

                                                For m = 0 To dt.Rows.Count - 1
                                                    qteTotal += dt.Rows(m)("QTE EN MOVT")
                                                    montantTotal += dt.Rows(m)("TOTAL")
                                                    totalAchat += dt.Rows(m)("TOTAL")
                                                    GrandTotalAchat += dt.Rows(m)("TOTAL")
                                                Next

                                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(0)("DESIGNATION"), font1))
                                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(0)("UNITE"), font1))
                                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                                pdfCell = New PdfPCell(New Paragraph(Format(qteTotal, "#,##0.0"), font1))
                                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                                If qteTotal > 0 Then
                                                    pdfCell = New PdfPCell(New Paragraph(Format(montantTotal / qteTotal, "#,##0"), font1))
                                                Else
                                                    pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(0)("PRIX UNITAIRE"), "#,##0"), font1))
                                                End If

                                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                                pdfCell = New PdfPCell(New Paragraph(Format(montantTotal, "#,##0"), font1))
                                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                            End If
                                            '----------------------------------------------

                                        Next

                                        pdfCell = New PdfPCell(New Paragraph("TOTAL : ", fontTotal))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        pdfCell.Border = 0
                                        pdfCell.Colspan = 4

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(Format(totalAchat, "#,##0"), fontTotal))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfDoc.Add(pdfTable)

                                    End If


                                End If

                            Next

                        End If

                    Next

                    Dim p0030 As Paragraph = New Paragraph(Chr(13) & "COUT TOTAL : " & Format(Math.Floor(GrandTotalAchat), "#,##0") & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE") & Chr(13), pRow)
                    p0030.Alignment = Element.ALIGN_RIGHT

                    pdfDoc.Add(p0030)

                End If


            Else


                'TRAITEMENT DES ENTREES / SORTIES

                Dim TYPE_BORDEREAUX_3 As String = ""
                Dim TYPE_BORDEREAUX_4 As String = ""
                Dim TYPE_BORDEREAUX_5 As String = ""
                Dim TYPE_BORDEREAUX_6 As String = ""

                Dim tableListMagasin As New DataTable()
                Dim tableListMagasin001 As New DataTable()

                '1- SELECTION DES DIVERS MAGASINS


                If entreeSortie = 0 Then

                    'ENTREE

                    TYPE_BORDEREAUX_1 = "Bon de Réception"
                    TYPE_BORDEREAUX_2 = "Entrée exceptionnelle"
                    TYPE_BORDEREAUX_3 = "Sortie"
                    TYPE_BORDEREAUX_4 = "Sortie Exceptionnelle"
                    TYPE_BORDEREAUX_5 = "" 'GRAND MAGASIN
                    TYPE_BORDEREAUX_6 = "Transfert Inter Magasin" 'PETIT MAGASIN

                Else

                    'SORTIE
                    TYPE_BORDEREAUX_1 = "Sortie"
                    TYPE_BORDEREAUX_2 = "Sortie Exceptionnelle"
                    TYPE_BORDEREAUX_3 = "Sortie"
                    TYPE_BORDEREAUX_4 = "Sortie Exceptionnelle"
                    TYPE_BORDEREAUX_5 = "Transfert Inter Magasin"
                    TYPE_BORDEREAUX_6 = ""

                End If

                If True Then

                    'GRANDE MAGASIN 

                    FillingListquery01 = "SELECT DISTINCT CODE_MAGASIN FROM `bordereaux` WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "','" & TYPE_BORDEREAUX_2 & "','" & TYPE_BORDEREAUX_5 & "') AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' ORDER BY DATE_BORDEREAU DESC"

                    Dim commandList01 As New MySqlCommand(FillingListquery01, GlobalVariable.connect)
                    commandList01.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                    commandList01.Parameters.Add("@TYPE_BORDEREAUX_2", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_2

                    Dim adapterList01 As New MySqlDataAdapter(commandList01)

                    adapterList01.Fill(tableListMagasin)

                    'SOUS MAGASIN 

                    Dim FillingListquery001 As String = "SELECT DISTINCT CODE_SOUS_MAGASIN As 'CODE_MAGASIN' FROM `bordereaux` WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_3 & "','" & TYPE_BORDEREAUX_4 & "','" & TYPE_BORDEREAUX_6 & "' ) AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' ORDER BY DATE_BORDEREAU DESC"

                    Dim commandList001 As New MySqlCommand(FillingListquery001, GlobalVariable.connect)
                    commandList001.Parameters.Add("@TYPE_BORDEREAUX_3", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_3
                    commandList001.Parameters.Add("@TYPE_BORDEREAUX_4", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_4

                    Dim adapterList001 As New MySqlDataAdapter(commandList001)

                    adapterList001.Fill(tableListMagasin001)

                    tableListMagasin.Merge(tableListMagasin001)

                End If

                If tableListMagasin.Rows.Count > 0 Then

                    For i = 0 To tableListMagasin.Rows.Count - 1

                        Dim infoSupMagaSin As DataTable = Functions.getElementByCode(tableListMagasin.Rows(i)("CODE_MAGASIN"), "magasin", "CODE_MAGASIN")

                        If infoSupMagaSin.Rows.Count > 0 Then

                            Dim p03 As Paragraph = New Paragraph(Chr(13) & " MAGASIN : " & infoSupMagaSin.Rows(0)("LIBELLE_MAGASIN") & Chr(13), pRow)
                            p03.Alignment = Element.ALIGN_LEFT

                            pdfDoc.Add(p03)

                        End If

                        '2. FAMILLES D'ARTICLES / MATIERES

                        Dim tableListFamille As New DataTable()
                        Dim tableListFamille002 As New DataTable()

                        If True Then ' ENTREE / SORTIE

                            'GRAND MAGASIN

                            FillingListquery02 = "SELECT DISTINCT CODE_SOUS_FAMILLE FROM article, bordereaux, ligne_bordereaux  WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "','" & TYPE_BORDEREAUX_2 & "','" & TYPE_BORDEREAUX_5 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND ligne_bordereaux.CODE_MAGASIN = @CODE_MAGASIN ORDER BY DATE_BORDEREAU DESC"

                            Dim commandList02 As New MySqlCommand(FillingListquery02, GlobalVariable.connect)
                            commandList02.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                            commandList02.Parameters.Add("@TYPE_BORDEREAUX_2", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_2
                            commandList02.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")

                            Dim adapterList02 As New MySqlDataAdapter(commandList02)

                            adapterList02.Fill(tableListFamille)

                            'SOUS MAGASINS

                            Dim FillingListquery002 As String = "SELECT DISTINCT CODE_SOUS_FAMILLE FROM article, bordereaux, ligne_bordereaux  WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_3 & "','" & TYPE_BORDEREAUX_4 & "','" & TYPE_BORDEREAUX_6 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND ligne_bordereaux.CODE_SOUS_MAGASIN = @CODE_MAGASIN ORDER BY DATE_BORDEREAU DESC"

                            Dim commandList002 As New MySqlCommand(FillingListquery002, GlobalVariable.connect)
                            commandList002.Parameters.Add("@TYPE_BORDEREAUX_3", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_3
                            commandList002.Parameters.Add("@TYPE_BORDEREAUX_4", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_4
                            commandList002.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")

                            Dim adapterList002 As New MySqlDataAdapter(commandList002)

                            adapterList002.Fill(tableListFamille002)

                            tableListFamille.Merge(tableListFamille002)

                        End If

                        If tableListFamille.Rows.Count > 0 Then

                            '3- LISTES DES ARTICLES  (PAR MAGASIN ET PAR FAMILLE)

                            For t = 0 To tableListFamille.Rows.Count - 1

                                If globalIndividuel = 0 Then

                                    'AFFICHAGE DES LIGNES INDIVIDUELEMENTS

                                    totalAchat = 0


                                    Dim dt As New DataTable()
                                    Dim dt1 As New DataTable()

                                    If True Then

                                        FillingListquery = "SELECT `DATE_BORDEREAU` AS 'DATE',  DESIGNATION_FR AS 'DESIGNATION', NUM_SERIE_DEBUT AS 'UNITE', ligne_bordereaux.QUANTITE As 'QTE AVANT MOVT', QUANTITE_ENTREE_STOCK AS 'QTE EN MOVT', PRIX_UNITAIRE_HT AS 'PRIX UNITAIRE', PRIX_TOTAL_HT AS 'TOTAL' FROM `bordereaux`, ligne_bordereaux, article, magasin WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "','" & TYPE_BORDEREAUX_2 & "','" & TYPE_BORDEREAUX_5 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND magasin.CODE_MAGASIN = ligne_bordereaux.CODE_MAGASIN AND article.CODE_SOUS_FAMILLE = @CODE_SOUS_FAMILLE AND ligne_bordereaux.CODE_MAGASIN = @CODE_MAGASIN ORDER BY ID_LIGNE_BORDEREAU DESC"

                                        'article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE
                                        ',  DESIGNATION_FR AS DESIGNATION

                                        Dim commandList As New MySqlCommand(FillingListquery, GlobalVariable.connect)
                                        commandList.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                                        commandList.Parameters.Add("@TYPE_BORDEREAUX_2", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_2
                                        commandList.Parameters.Add("@CODE_SOUS_FAMILLE", MySqlDbType.VarChar).Value = tableListFamille.Rows(t)("CODE_SOUS_FAMILLE")
                                        commandList.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")

                                        Dim adapterList As New MySqlDataAdapter(commandList)

                                        adapterList.Fill(dt)

                                        Dim FillingListquery003 As String = "SELECT `DATE_BORDEREAU` AS 'DATE',  DESIGNATION_FR AS 'DESIGNATION', NUM_SERIE_DEBUT AS 'UNITE', ligne_bordereaux.QUANTITE As 'QTE AVANT MOVT', QUANTITE_ENTREE_STOCK AS 'QTE EN MOVT', PRIX_UNITAIRE_HT AS 'PRIX UNITAIRE', PRIX_TOTAL_HT AS 'TOTAL' FROM `bordereaux`, ligne_bordereaux, article, magasin WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_3 & "','" & TYPE_BORDEREAUX_4 & "','" & TYPE_BORDEREAUX_6 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND magasin.CODE_MAGASIN = ligne_bordereaux.CODE_SOUS_MAGASIN AND article.CODE_SOUS_FAMILLE = @CODE_SOUS_FAMILLE AND ligne_bordereaux.CODE_SOUS_MAGASIN = @CODE_MAGASIN ORDER BY ID_LIGNE_BORDEREAU DESC"

                                        'article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE
                                        ',  DESIGNATION_FR AS DESIGNATION

                                        Dim commandList003 As New MySqlCommand(FillingListquery003, GlobalVariable.connect)
                                        commandList003.Parameters.Add("@TYPE_BORDEREAUX_3", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_3
                                        commandList003.Parameters.Add("@TYPE_BORDEREAUX_4", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_4
                                        commandList003.Parameters.Add("@CODE_SOUS_FAMILLE", MySqlDbType.VarChar).Value = tableListFamille.Rows(t)("CODE_SOUS_FAMILLE")
                                        commandList003.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")

                                        Dim adapterList003 As New MySqlDataAdapter(commandList003)

                                        adapterList003.Fill(dt1)

                                        dt.Merge(dt1)

                                    End If

                                    If dt.Rows.Count > 0 Then

                                        Dim p003 As Paragraph = New Paragraph(Chr(13) & "FAMILLE : " & tableListFamille.Rows(t)("CODE_SOUS_FAMILLE") & Chr(13) & Chr(13), pRow)
                                        p003.Alignment = Element.ALIGN_RIGHT

                                        pdfDoc.Add(p003)

                                        Dim pdfTable As New PdfPTable(7) 'Number of columns
                                        pdfTable.TotalWidth = 555.0F
                                        pdfTable.LockedWidth = True
                                        pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfTable.HeaderRows = 1

                                        Dim widths As Single() = New Single() {20.0F, 45.0F, 25.0F, 15.0F, 15.0F, 15.0F, 15.0F}

                                        pdfTable.SetWidths(widths)

                                        Dim pdfCell As PdfPCell = Nothing

                                        pdfCell = New PdfPCell(New Paragraph("DATE", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("DESIGNATION", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("UNITE", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("QTE AV. MVT", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("QTE EN MVT", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("PU", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        For j = 0 To dt.Rows.Count - 1

                                            For k = 0 To dt.Columns.Count - 1

                                                If k = 6 Or k = 5 Then
                                                    pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j)(k), "#,##0"), font1))
                                                Else
                                                    pdfCell = New PdfPCell(New Paragraph(dt.Rows(j)(k), font1))
                                                End If

                                                If k = 6 Or k = 5 Then
                                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                                ElseIf k = 3 Or k = 4 Then
                                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                                Else
                                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                                End If

                                                If k = 6 Then
                                                    totalAchat += dt.Rows(j)(k)
                                                    GrandTotalAchat += dt.Rows(j)(k)
                                                End If
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                            Next

                                        Next

                                        pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        pdfCell.Border = 0
                                        pdfCell.Colspan = 6

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(Format(totalAchat, "#,##0"), fontTotal))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfDoc.Add(pdfTable)

                                    End If

                                Else

                                    'AFFICHAGE DES LIGNES EN LES REGROUPANTS

                                    totalAchat = 0

                                    Dim articleList As New DataTable()
                                    Dim articleList004 As New DataTable()

                                    If True Then

                                        FillingListquery = "SELECT DISTINCT ligne_bordereaux.CODE_ARTICLE FROM `bordereaux`, ligne_bordereaux, article, magasin WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "','" & TYPE_BORDEREAUX_2 & "','" & TYPE_BORDEREAUX_5 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND magasin.CODE_MAGASIN = ligne_bordereaux.CODE_MAGASIN AND article.CODE_SOUS_FAMILLE = @CODE_SOUS_FAMILLE AND ligne_bordereaux.CODE_MAGASIN = @CODE_MAGASIN ORDER BY ID_LIGNE_BORDEREAU DESC"

                                        'article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE
                                        ',  DESIGNATION_FR AS DESIGNATION

                                        Dim commandList As New MySqlCommand(FillingListquery, GlobalVariable.connect)
                                        commandList.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                                        commandList.Parameters.Add("@TYPE_BORDEREAUX_2", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_2
                                        commandList.Parameters.Add("@CODE_SOUS_FAMILLE", MySqlDbType.VarChar).Value = tableListFamille.Rows(t)("CODE_SOUS_FAMILLE")
                                        commandList.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")

                                        Dim adapterList As New MySqlDataAdapter(commandList)

                                        adapterList.Fill(articleList)

                                        Dim FillingListquery004 As String = "SELECT DISTINCT ligne_bordereaux.CODE_ARTICLE FROM `bordereaux`, ligne_bordereaux, article, magasin WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_3 & "','" & TYPE_BORDEREAUX_4 & "','" & TYPE_BORDEREAUX_6 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND magasin.CODE_MAGASIN = ligne_bordereaux.CODE_SOUS_MAGASIN AND article.CODE_SOUS_FAMILLE = @CODE_SOUS_FAMILLE AND ligne_bordereaux.CODE_SOUS_MAGASIN = @CODE_MAGASIN ORDER BY ID_LIGNE_BORDEREAU DESC"

                                        Dim commandList004 As New MySqlCommand(FillingListquery004, GlobalVariable.connect)
                                        commandList004.Parameters.Add("@TYPE_BORDEREAUX_3", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_3
                                        commandList004.Parameters.Add("@TYPE_BORDEREAUX_4", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_4
                                        commandList004.Parameters.Add("@CODE_SOUS_FAMILLE", MySqlDbType.VarChar).Value = tableListFamille.Rows(t)("CODE_SOUS_FAMILLE")
                                        commandList004.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")

                                        Dim adapterList004 As New MySqlDataAdapter(commandList004)

                                        adapterList004.Fill(articleList004)

                                        articleList.Merge(articleList004)

                                    End If

                                    If articleList.Rows.Count > 0 Then

                                        Dim p003 As Paragraph = New Paragraph(Chr(13) & "FAMILLE : " & tableListFamille.Rows(t)("CODE_SOUS_FAMILLE") & Chr(13) & Chr(13), pRow)
                                        p003.Alignment = Element.ALIGN_RIGHT

                                        pdfDoc.Add(p003)

                                        Dim pdfTable As New PdfPTable(5) 'Number of columns
                                        pdfTable.TotalWidth = 555.0F
                                        pdfTable.LockedWidth = True
                                        pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfTable.HeaderRows = 1

                                        Dim widths As Single() = New Single() {45.0F, 30.0F, 15.0F, 15.0F, 15.0F}

                                        pdfTable.SetWidths(widths)

                                        Dim pdfCell As PdfPCell = Nothing

                                        pdfCell = New PdfPCell(New Paragraph("DESIGNATION", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("UNITE", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("QTE", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("PU Moy.", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        For l = 0 To articleList.Rows.Count - 1

                                            '----------------------------------------------
                                            Dim dt As New DataTable()
                                            Dim dt01 As New DataTable()

                                            If True Then

                                                Dim FillingListquery03 As String = "SELECT `DATE_BORDEREAU` AS 'DATE',  DESIGNATION_FR AS 'DESIGNATION', NUM_SERIE_DEBUT AS 'UNITE', ligne_bordereaux.QUANTITE As 'QTE AVANT MOVT', QUANTITE_ENTREE_STOCK AS 'QTE EN MOVT', PRIX_UNITAIRE_HT AS 'PRIX UNITAIRE', PRIX_TOTAL_HT AS 'TOTAL' FROM `bordereaux`, ligne_bordereaux, article, magasin WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "','" & TYPE_BORDEREAUX_2 & "','" & TYPE_BORDEREAUX_5 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND magasin.CODE_MAGASIN = ligne_bordereaux.CODE_MAGASIN AND article.CODE_SOUS_FAMILLE = @CODE_SOUS_FAMILLE AND ligne_bordereaux.CODE_MAGASIN = @CODE_MAGASIN AND ligne_bordereaux.CODE_ARTICLE =@CODE_ARTICLE ORDER BY ID_LIGNE_BORDEREAU DESC"

                                                Dim commandList03 As New MySqlCommand(FillingListquery03, GlobalVariable.connect)
                                                commandList03.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                                                commandList03.Parameters.Add("@TYPE_BORDEREAUX_2", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_2
                                                commandList03.Parameters.Add("@CODE_SOUS_FAMILLE", MySqlDbType.VarChar).Value = tableListFamille.Rows(t)("CODE_SOUS_FAMILLE")
                                                commandList03.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")
                                                commandList03.Parameters.Add("@CODE_ARTICLE", MySqlDbType.VarChar).Value = articleList.Rows(l)("CODE_ARTICLE")

                                                Dim adapterList03 As New MySqlDataAdapter(commandList03)

                                                adapterList03.Fill(dt)


                                                Dim FillingListquery003 As String = "SELECT `DATE_BORDEREAU` AS 'DATE',  DESIGNATION_FR AS 'DESIGNATION', NUM_SERIE_DEBUT AS 'UNITE', ligne_bordereaux.QUANTITE As 'QTE AVANT MOVT', QUANTITE_ENTREE_STOCK AS 'QTE EN MOVT', PRIX_UNITAIRE_HT AS 'PRIX UNITAIRE', PRIX_TOTAL_HT AS 'TOTAL' FROM `bordereaux`, ligne_bordereaux, article, magasin WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_3 & "','" & TYPE_BORDEREAUX_4 & "','" & TYPE_BORDEREAUX_6 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND magasin.CODE_MAGASIN = ligne_bordereaux.CODE_SOUS_MAGASIN AND article.CODE_SOUS_FAMILLE = @CODE_SOUS_FAMILLE AND ligne_bordereaux.CODE_SOUS_MAGASIN = @CODE_MAGASIN AND ligne_bordereaux.CODE_ARTICLE =@CODE_ARTICLE ORDER BY ID_LIGNE_BORDEREAU DESC"

                                                Dim commandList003 As New MySqlCommand(FillingListquery003, GlobalVariable.connect)
                                                commandList003.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                                                commandList003.Parameters.Add("@TYPE_BORDEREAUX_2", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_2
                                                commandList003.Parameters.Add("@CODE_SOUS_FAMILLE", MySqlDbType.VarChar).Value = tableListFamille.Rows(t)("CODE_SOUS_FAMILLE")
                                                commandList003.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")
                                                commandList003.Parameters.Add("@CODE_ARTICLE", MySqlDbType.VarChar).Value = articleList.Rows(l)("CODE_ARTICLE")

                                                Dim adapterList003 As New MySqlDataAdapter(commandList003)

                                                adapterList003.Fill(dt01)

                                                dt.Merge(dt01)

                                            Else

                                            End If

                                            If dt.Rows.Count > 0 Then

                                                Dim qteTotal As Double = 0
                                                Dim montantTotal As Double = 0

                                                For m = 0 To dt.Rows.Count - 1
                                                    qteTotal += dt.Rows(m)("QTE EN MOVT")
                                                    montantTotal += dt.Rows(m)("TOTAL")
                                                    totalAchat += dt.Rows(m)("TOTAL")
                                                    GrandTotalAchat += dt.Rows(m)("TOTAL")
                                                Next

                                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(0)("DESIGNATION"), font1))
                                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(0)("UNITE"), font1))
                                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                                pdfCell = New PdfPCell(New Paragraph(Format(qteTotal, "#,##0.0"), font1))
                                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                                If qteTotal > 0 Then
                                                    pdfCell = New PdfPCell(New Paragraph(Format(montantTotal / qteTotal, "#,##0"), font1))
                                                Else
                                                    pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(0)("PRIX UNITAIRE"), "#,##0"), font1))
                                                End If

                                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                                pdfCell = New PdfPCell(New Paragraph(Format(montantTotal, "#,##0"), font1))
                                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                            End If
                                            '----------------------------------------------

                                        Next

                                        pdfCell = New PdfPCell(New Paragraph("TOTAL : ", fontTotal))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        pdfCell.Border = 0
                                        pdfCell.Colspan = 4

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(Format(totalAchat, "#,##0"), fontTotal))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfDoc.Add(pdfTable)

                                    End If


                                End If

                            Next

                        End If

                        Dim p0030 As Paragraph = New Paragraph(Chr(13) & "COUT TOTAL : " & Format(Math.Floor(GrandTotalAchat), "#,##0") & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE") & Chr(13), pRow)
                        p0030.Alignment = Element.ALIGN_RIGHT

                        pdfDoc.Add(p0030)

                    Next

                End If

            End If

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

            Process.Start(sfd.FileName)

        End If

    End Sub


    Public Shared Sub affichageDesEntreesSortiePeriodiqueImpressionSpecifique(ByVal DateDebut As Date, DateFin As Date, ByVal entreeSortie As Integer, ByVal globalIndividuel As Integer, ByVal title As String, ByVal entreeSortieOuAchatPeriodique As Integer, ByVal CODE_MAGASIN As String)

        Dim TYPE_BORDEREAUX_1 As String = ""
        Dim TYPE_BORDEREAUX_2 As String = ""

        Dim FillingListquery As String = ""
        Dim FillingListquery01 As String = ""
        Dim FillingListquery02 As String = ""

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0

        Dim tireDocument As String = title.ToUpper() & " DU " & (Date.Now().ToString("ddMMyyHHmmss"))

        Dim sousTitreDocument As String = ""

        sousTitreDocument = tireDocument

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        Dim totalAchat As Double = 0
        Dim GrandTotalAchat As Double = 0

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 20, 20, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRowFirst As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 18, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal1 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            'pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p0003 As Paragraph = New Paragraph(GlobalVariable.societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & Chr(13), pRowFirst)
            p0003.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p0003)

            Dim p3 As Paragraph = New Paragraph(title.ToUpper() & " DU " & " " & DateDebut & " AU " & DateFin & Chr(13), pRow)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            If entreeSortieOuAchatPeriodique = 1 Then 'ACHAT PERIODIQUE

                TYPE_BORDEREAUX_1 = "Bon de Réception"
                TYPE_BORDEREAUX_2 = "Entrée exceptionnelle"

                'TRAITEMENT DES ACHATS PERIODIQUE

                '1- SELECTION DES DIVERS MAGASINS

                FillingListquery01 = "SELECT DISTINCT CODE_MAGASIN FROM `bordereaux` WHERE TYPE_BORDEREAUX=@TYPE_BORDEREAUX_1 AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <= '" & DateFin.ToString("yyyy-MM-dd") & "' OR TYPE_BORDEREAUX=@TYPE_BORDEREAUX_2 AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND CODE_MAGASIN=@CODE_MAGASIN ORDER BY DATE_BORDEREAU DESC"

                Dim commandList01 As New MySqlCommand(FillingListquery01, GlobalVariable.connect)
                commandList01.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                commandList01.Parameters.Add("@TYPE_BORDEREAUX_2", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_2
                commandList01.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = CODE_MAGASIN

                Dim adapterList01 As New MySqlDataAdapter(commandList01)
                Dim tableListMagasin As New DataTable()

                adapterList01.Fill(tableListMagasin)

                If tableListMagasin.Rows.Count > 0 Then

                    For i = 0 To tableListMagasin.Rows.Count - 1

                        Dim infoSupMagaSin As DataTable = Functions.getElementByCode(tableListMagasin.Rows(i)("CODE_MAGASIN"), "magasin", "CODE_MAGASIN")

                        If infoSupMagaSin.Rows.Count > 0 Then

                            Dim p03 As Paragraph = New Paragraph(Chr(13) & " MAGASIN : " & infoSupMagaSin.Rows(0)("LIBELLE_MAGASIN") & Chr(13), pRow)
                            p03.Alignment = Element.ALIGN_LEFT

                            pdfDoc.Add(p03)

                        End If

                        '2. FAMILLES D'ARTICLES / MATIERES

                        FillingListquery02 = "SELECT DISTINCT CODE_SOUS_FAMILLE FROM article, bordereaux, ligne_bordereaux  WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "','" & TYPE_BORDEREAUX_2 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND ligne_bordereaux.CODE_MAGASIN = @CODE_MAGASIN ORDER BY DATE_BORDEREAU DESC"

                        Dim commandList02 As New MySqlCommand(FillingListquery02, GlobalVariable.connect)
                        commandList02.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                        commandList02.Parameters.Add("@TYPE_BORDEREAUX_2", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_2
                        commandList02.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")

                        Dim adapterList02 As New MySqlDataAdapter(commandList02)
                        Dim tableListFamille As New DataTable()

                        adapterList02.Fill(tableListFamille)

                        If tableListFamille.Rows.Count > 0 Then

                            '3- LISTES DES ARTICLES  (PAR MAGASIN ET PAR FAMILLE)

                            For t = 0 To tableListFamille.Rows.Count - 1

                                If globalIndividuel = 0 Then

                                    totalAchat = 0

                                    'FAMILLE HERE

                                    FillingListquery = "SELECT `DATE_BORDEREAU` AS 'DATE',  DESIGNATION_FR AS 'DESIGNATION', NUM_SERIE_DEBUT AS 'UNITE', ligne_bordereaux.QUANTITE As 'QTE AVANT MOVT', QUANTITE_ENTREE_STOCK AS 'QTE EN MOVT', PRIX_UNITAIRE_HT AS 'PRIX UNITAIRE', PRIX_TOTAL_HT AS 'TOTAL' FROM `bordereaux`, ligne_bordereaux, article, magasin WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "','" & TYPE_BORDEREAUX_2 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND magasin.CODE_MAGASIN = ligne_bordereaux.CODE_MAGASIN AND article.CODE_SOUS_FAMILLE = @CODE_SOUS_FAMILLE AND ligne_bordereaux.CODE_MAGASIN = @CODE_MAGASIN ORDER BY ID_LIGNE_BORDEREAU DESC"

                                    Dim commandList As New MySqlCommand(FillingListquery, GlobalVariable.connect)
                                    commandList.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                                    commandList.Parameters.Add("@TYPE_BORDEREAUX_2", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_2
                                    commandList.Parameters.Add("@CODE_SOUS_FAMILLE", MySqlDbType.VarChar).Value = tableListFamille.Rows(t)("CODE_SOUS_FAMILLE")
                                    commandList.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")

                                    Dim adapterList As New MySqlDataAdapter(commandList)
                                    Dim dt As New DataTable()

                                    adapterList.Fill(dt)

                                    If dt.Rows.Count > 0 Then

                                        Dim p003 As Paragraph = New Paragraph(Chr(13) & "FAMILLE : " & tableListFamille.Rows(t)("CODE_SOUS_FAMILLE") & Chr(13) & Chr(13), pRow)
                                        p003.Alignment = Element.ALIGN_RIGHT

                                        pdfDoc.Add(p003)

                                        Dim pdfTable As New PdfPTable(7) 'Number of columns
                                        pdfTable.TotalWidth = 555.0F
                                        pdfTable.LockedWidth = True
                                        pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfTable.HeaderRows = 1

                                        Dim widths As Single() = New Single() {20.0F, 45.0F, 25.0F, 15.0F, 15.0F, 15.0F, 15.0F}

                                        pdfTable.SetWidths(widths)

                                        Dim pdfCell As PdfPCell = Nothing

                                        pdfCell = New PdfPCell(New Paragraph("DATE", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("DESIGNATION", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("UNITE", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("QTE AV. MVT", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("QTE EN MVT", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("PU", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        For j = 0 To dt.Rows.Count - 1

                                            For k = 0 To dt.Columns.Count - 1

                                                If k = 6 Or k = 5 Then
                                                    pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j)(k), "#,##0"), font1))
                                                Else
                                                    pdfCell = New PdfPCell(New Paragraph(dt.Rows(j)(k), font1))
                                                End If

                                                If k = 6 Or k = 5 Then
                                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                                ElseIf k = 3 Or k = 4 Then
                                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                                Else
                                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                                End If

                                                If k = 6 Then
                                                    totalAchat += dt.Rows(j)(k)
                                                    GrandTotalAchat += dt.Rows(j)(k)
                                                End If
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                            Next

                                        Next

                                        pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        pdfCell.Border = 0
                                        pdfCell.Colspan = 6

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(Format(totalAchat, "#,##0"), fontTotal))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfDoc.Add(pdfTable)

                                    End If

                                Else

                                    totalAchat = 0

                                    FillingListquery = "SELECT DISTINCT ligne_bordereaux.CODE_ARTICLE FROM `bordereaux`, ligne_bordereaux, article, magasin WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "','" & TYPE_BORDEREAUX_2 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND magasin.CODE_MAGASIN = ligne_bordereaux.CODE_MAGASIN AND article.CODE_SOUS_FAMILLE = @CODE_SOUS_FAMILLE AND ligne_bordereaux.CODE_MAGASIN = @CODE_MAGASIN ORDER BY ID_LIGNE_BORDEREAU DESC"

                                    'article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE
                                    ',  DESIGNATION_FR AS DESIGNATION

                                    Dim commandList As New MySqlCommand(FillingListquery, GlobalVariable.connect)
                                    commandList.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                                    commandList.Parameters.Add("@TYPE_BORDEREAUX_2", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_2
                                    commandList.Parameters.Add("@CODE_SOUS_FAMILLE", MySqlDbType.VarChar).Value = tableListFamille.Rows(t)("CODE_SOUS_FAMILLE")
                                    commandList.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")

                                    Dim adapterList As New MySqlDataAdapter(commandList)
                                    Dim articleList As New DataTable()

                                    adapterList.Fill(articleList)

                                    If articleList.Rows.Count > 0 Then


                                        Dim p003 As Paragraph = New Paragraph(Chr(13) & "FAMILLE : " & tableListFamille.Rows(t)("CODE_SOUS_FAMILLE") & Chr(13) & Chr(13), pRow)
                                        p003.Alignment = Element.ALIGN_RIGHT

                                        pdfDoc.Add(p003)

                                        Dim pdfTable As New PdfPTable(5) 'Number of columns
                                        pdfTable.TotalWidth = 555.0F
                                        pdfTable.LockedWidth = True
                                        pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfTable.HeaderRows = 1

                                        Dim widths As Single() = New Single() {45.0F, 30.0F, 15.0F, 15.0F, 15.0F}

                                        pdfTable.SetWidths(widths)

                                        Dim pdfCell As PdfPCell = Nothing

                                        pdfCell = New PdfPCell(New Paragraph("DESIGNATION", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("UNITE", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("QTE", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("PU Moy.", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        For l = 0 To articleList.Rows.Count - 1

                                            '----------------------------------------------

                                            Dim FillingListquery03 As String = "SELECT `DATE_BORDEREAU` AS 'DATE',  DESIGNATION_FR AS 'DESIGNATION', NUM_SERIE_DEBUT AS 'UNITE', ligne_bordereaux.QUANTITE As 'QTE AVANT MOVT', QUANTITE_ENTREE_STOCK AS 'QTE EN MOVT', PRIX_UNITAIRE_HT AS 'PRIX UNITAIRE', PRIX_TOTAL_HT AS 'TOTAL' FROM `bordereaux`, ligne_bordereaux, article, magasin WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "','" & TYPE_BORDEREAUX_2 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND magasin.CODE_MAGASIN = ligne_bordereaux.CODE_MAGASIN AND article.CODE_SOUS_FAMILLE = @CODE_SOUS_FAMILLE AND ligne_bordereaux.CODE_MAGASIN = @CODE_MAGASIN AND ligne_bordereaux.CODE_ARTICLE =@CODE_ARTICLE ORDER BY ID_LIGNE_BORDEREAU DESC"

                                            Dim commandList03 As New MySqlCommand(FillingListquery03, GlobalVariable.connect)
                                            commandList03.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                                            commandList03.Parameters.Add("@TYPE_BORDEREAUX_2", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_2
                                            commandList03.Parameters.Add("@CODE_SOUS_FAMILLE", MySqlDbType.VarChar).Value = tableListFamille.Rows(t)("CODE_SOUS_FAMILLE")
                                            commandList03.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")
                                            commandList03.Parameters.Add("@CODE_ARTICLE", MySqlDbType.VarChar).Value = articleList.Rows(l)("CODE_ARTICLE")

                                            Dim adapterList03 As New MySqlDataAdapter(commandList03)
                                            Dim dt As New DataTable()

                                            adapterList03.Fill(dt)

                                            If dt.Rows.Count > 0 Then

                                                Dim qteTotal As Double = 0
                                                Dim montantTotal As Double = 0

                                                For m = 0 To dt.Rows.Count - 1
                                                    qteTotal += dt.Rows(m)("QTE EN MOVT")
                                                    montantTotal += dt.Rows(m)("TOTAL")
                                                    totalAchat += dt.Rows(m)("TOTAL")
                                                    GrandTotalAchat += dt.Rows(m)("TOTAL")
                                                Next

                                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(0)("DESIGNATION"), font1))
                                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(0)("UNITE"), font1))
                                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                                pdfCell = New PdfPCell(New Paragraph(Format(qteTotal, "#,##0.0"), font1))
                                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                                If qteTotal > 0 Then
                                                    pdfCell = New PdfPCell(New Paragraph(Format(montantTotal / qteTotal, "#,##0"), font1))
                                                Else
                                                    pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(0)("PRIX UNITAIRE"), "#,##0"), font1))
                                                End If

                                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                                pdfCell = New PdfPCell(New Paragraph(Format(montantTotal, "#,##0"), font1))
                                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                            End If
                                            '----------------------------------------------

                                        Next

                                        pdfCell = New PdfPCell(New Paragraph("TOTAL : ", fontTotal))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        pdfCell.Border = 0
                                        pdfCell.Colspan = 4

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(Format(totalAchat, "#,##0"), fontTotal))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfDoc.Add(pdfTable)

                                    End If


                                End If

                            Next

                        End If

                    Next

                End If


            Else


                'TRAITEMENT DES ENTREES / SORTIES

                Dim TYPE_BORDEREAUX_3 As String = ""
                Dim TYPE_BORDEREAUX_4 As String = ""
                Dim TYPE_BORDEREAUX_5 As String = ""
                Dim TYPE_BORDEREAUX_6 As String = ""

                Dim tableListMagasin As New DataTable()
                Dim tableListMagasin001 As New DataTable()

                '1- SELECTION DES DIVERS MAGASINS


                If entreeSortie = 0 Then

                    'ENTREE

                    TYPE_BORDEREAUX_1 = "Bon de Réception"
                    TYPE_BORDEREAUX_2 = "Entrée exceptionnelle"
                    TYPE_BORDEREAUX_3 = "Sortie"
                    TYPE_BORDEREAUX_4 = "Sortie Exceptionnelle"
                    TYPE_BORDEREAUX_5 = "" 'GRAND MAGASIN
                    TYPE_BORDEREAUX_6 = "Transfert Inter Magasin" 'PETIT MAGASIN

                Else

                    'SORTIE
                    TYPE_BORDEREAUX_1 = "Sortie"
                    TYPE_BORDEREAUX_2 = "Sortie Exceptionnelle"
                    TYPE_BORDEREAUX_3 = "Sortie"
                    TYPE_BORDEREAUX_4 = "Sortie Exceptionnelle"
                    TYPE_BORDEREAUX_5 = "Transfert Inter Magasin"
                    TYPE_BORDEREAUX_6 = ""

                End If

                If True Then

                    'GRANDE MAGASIN 

                    FillingListquery01 = "SELECT DISTINCT CODE_MAGASIN FROM `bordereaux` WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "','" & TYPE_BORDEREAUX_2 & "','" & TYPE_BORDEREAUX_5 & "') AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND CODE_MAGASIN=@CODE_MAGASIN ORDER BY DATE_BORDEREAU DESC"

                    Dim commandList01 As New MySqlCommand(FillingListquery01, GlobalVariable.connect)
                    commandList01.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                    commandList01.Parameters.Add("@TYPE_BORDEREAUX_2", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_2
                    commandList01.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = CODE_MAGASIN

                    Dim adapterList01 As New MySqlDataAdapter(commandList01)

                    adapterList01.Fill(tableListMagasin)

                    'SOUS MAGASIN 

                    Dim FillingListquery001 As String = "SELECT DISTINCT CODE_SOUS_MAGASIN As 'CODE_MAGASIN' FROM `bordereaux` WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_3 & "','" & TYPE_BORDEREAUX_4 & "','" & TYPE_BORDEREAUX_6 & "' ) AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND CODE_MAGASIN=@CODE_MAGASIN ORDER BY DATE_BORDEREAU DESC"

                    Dim commandList001 As New MySqlCommand(FillingListquery001, GlobalVariable.connect)
                    commandList001.Parameters.Add("@TYPE_BORDEREAUX_3", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_3
                    commandList001.Parameters.Add("@TYPE_BORDEREAUX_4", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_4
                    commandList001.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = CODE_MAGASIN

                    Dim adapterList001 As New MySqlDataAdapter(commandList001)

                    adapterList001.Fill(tableListMagasin001)

                    tableListMagasin.Merge(tableListMagasin001)

                End If

                If tableListMagasin.Rows.Count > 0 Then

                    For i = 0 To tableListMagasin.Rows.Count - 1

                        Dim infoSupMagaSin As DataTable = Functions.getElementByCode(tableListMagasin.Rows(i)("CODE_MAGASIN"), "magasin", "CODE_MAGASIN")

                        If infoSupMagaSin.Rows.Count > 0 Then

                            Dim p03 As Paragraph = New Paragraph(Chr(13) & " MAGASIN : " & infoSupMagaSin.Rows(0)("LIBELLE_MAGASIN") & Chr(13), pRow)
                            p03.Alignment = Element.ALIGN_LEFT

                            pdfDoc.Add(p03)

                        End If

                        '2. FAMILLES D'ARTICLES / MATIERES

                        Dim tableListFamille As New DataTable()
                        Dim tableListFamille002 As New DataTable()

                        If True Then ' ENTREE / SORTIE

                            'GRAND MAGASIN

                            FillingListquery02 = "SELECT DISTINCT CODE_SOUS_FAMILLE FROM article, bordereaux, ligne_bordereaux  WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "','" & TYPE_BORDEREAUX_2 & "','" & TYPE_BORDEREAUX_5 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND ligne_bordereaux.CODE_MAGASIN = @CODE_MAGASIN ORDER BY DATE_BORDEREAU DESC"

                            Dim commandList02 As New MySqlCommand(FillingListquery02, GlobalVariable.connect)
                            commandList02.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                            commandList02.Parameters.Add("@TYPE_BORDEREAUX_2", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_2
                            commandList02.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")

                            Dim adapterList02 As New MySqlDataAdapter(commandList02)

                            adapterList02.Fill(tableListFamille)

                            'SOUS MAGASINS

                            Dim FillingListquery002 As String = "SELECT DISTINCT CODE_SOUS_FAMILLE FROM article, bordereaux, ligne_bordereaux  WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_3 & "','" & TYPE_BORDEREAUX_4 & "','" & TYPE_BORDEREAUX_6 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND ligne_bordereaux.CODE_SOUS_MAGASIN = @CODE_MAGASIN ORDER BY DATE_BORDEREAU DESC"

                            Dim commandList002 As New MySqlCommand(FillingListquery002, GlobalVariable.connect)
                            commandList002.Parameters.Add("@TYPE_BORDEREAUX_3", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_3
                            commandList002.Parameters.Add("@TYPE_BORDEREAUX_4", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_4
                            commandList002.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")

                            Dim adapterList002 As New MySqlDataAdapter(commandList002)

                            adapterList002.Fill(tableListFamille002)

                            tableListFamille.Merge(tableListFamille002)

                        End If

                        If tableListFamille.Rows.Count > 0 Then

                            '3- LISTES DES ARTICLES  (PAR MAGASIN ET PAR FAMILLE)

                            For t = 0 To tableListFamille.Rows.Count - 1

                                If globalIndividuel = 0 Then

                                    'AFFICHAGE DES LIGNES INDIVIDUELEMENTS

                                    totalAchat = 0


                                    Dim dt As New DataTable()
                                    Dim dt1 As New DataTable()

                                    If True Then

                                        FillingListquery = "SELECT `DATE_BORDEREAU` AS 'DATE',  DESIGNATION_FR AS 'DESIGNATION', NUM_SERIE_DEBUT AS 'UNITE', ligne_bordereaux.QUANTITE As 'QTE AVANT MOVT', QUANTITE_ENTREE_STOCK AS 'QTE EN MOVT', PRIX_UNITAIRE_HT AS 'PRIX UNITAIRE', PRIX_TOTAL_HT AS 'TOTAL' FROM `bordereaux`, ligne_bordereaux, article, magasin WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "','" & TYPE_BORDEREAUX_2 & "','" & TYPE_BORDEREAUX_5 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND magasin.CODE_MAGASIN = ligne_bordereaux.CODE_MAGASIN AND article.CODE_SOUS_FAMILLE = @CODE_SOUS_FAMILLE AND ligne_bordereaux.CODE_MAGASIN = @CODE_MAGASIN ORDER BY ID_LIGNE_BORDEREAU DESC"

                                        'article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE
                                        ',  DESIGNATION_FR AS DESIGNATION

                                        Dim commandList As New MySqlCommand(FillingListquery, GlobalVariable.connect)
                                        commandList.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                                        commandList.Parameters.Add("@TYPE_BORDEREAUX_2", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_2
                                        commandList.Parameters.Add("@CODE_SOUS_FAMILLE", MySqlDbType.VarChar).Value = tableListFamille.Rows(t)("CODE_SOUS_FAMILLE")
                                        commandList.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")

                                        Dim adapterList As New MySqlDataAdapter(commandList)

                                        adapterList.Fill(dt)

                                        Dim FillingListquery003 As String = "SELECT `DATE_BORDEREAU` AS 'DATE',  DESIGNATION_FR AS 'DESIGNATION', NUM_SERIE_DEBUT AS 'UNITE', ligne_bordereaux.QUANTITE As 'QTE AVANT MOVT', QUANTITE_ENTREE_STOCK AS 'QTE EN MOVT', PRIX_UNITAIRE_HT AS 'PRIX UNITAIRE', PRIX_TOTAL_HT AS 'TOTAL' FROM `bordereaux`, ligne_bordereaux, article, magasin WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_3 & "','" & TYPE_BORDEREAUX_4 & "','" & TYPE_BORDEREAUX_6 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND magasin.CODE_MAGASIN = ligne_bordereaux.CODE_SOUS_MAGASIN AND article.CODE_SOUS_FAMILLE = @CODE_SOUS_FAMILLE AND ligne_bordereaux.CODE_SOUS_MAGASIN = @CODE_MAGASIN ORDER BY ID_LIGNE_BORDEREAU DESC"

                                        'article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE
                                        ',  DESIGNATION_FR AS DESIGNATION

                                        Dim commandList003 As New MySqlCommand(FillingListquery003, GlobalVariable.connect)
                                        commandList003.Parameters.Add("@TYPE_BORDEREAUX_3", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_3
                                        commandList003.Parameters.Add("@TYPE_BORDEREAUX_4", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_4
                                        commandList003.Parameters.Add("@CODE_SOUS_FAMILLE", MySqlDbType.VarChar).Value = tableListFamille.Rows(t)("CODE_SOUS_FAMILLE")
                                        commandList003.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")

                                        Dim adapterList003 As New MySqlDataAdapter(commandList003)

                                        adapterList003.Fill(dt1)

                                        dt.Merge(dt1)

                                    End If

                                    If dt.Rows.Count > 0 Then

                                        Dim p003 As Paragraph = New Paragraph(Chr(13) & "FAMILLE : " & tableListFamille.Rows(t)("CODE_SOUS_FAMILLE") & Chr(13) & Chr(13), pRow)
                                        p003.Alignment = Element.ALIGN_RIGHT

                                        pdfDoc.Add(p003)

                                        Dim pdfTable As New PdfPTable(7) 'Number of columns
                                        pdfTable.TotalWidth = 555.0F
                                        pdfTable.LockedWidth = True
                                        pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfTable.HeaderRows = 1

                                        Dim widths As Single() = New Single() {20.0F, 45.0F, 25.0F, 15.0F, 15.0F, 15.0F, 15.0F}

                                        pdfTable.SetWidths(widths)

                                        Dim pdfCell As PdfPCell = Nothing

                                        pdfCell = New PdfPCell(New Paragraph("DATE", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("DESIGNATION", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("UNITE", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("QTE AV. MVT", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("QTE EN MVT", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("PU", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        For j = 0 To dt.Rows.Count - 1

                                            For k = 0 To dt.Columns.Count - 1

                                                If k = 6 Or k = 5 Then
                                                    pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j)(k), "#,##0"), font1))
                                                Else
                                                    pdfCell = New PdfPCell(New Paragraph(dt.Rows(j)(k), font1))
                                                End If

                                                If k = 6 Or k = 5 Then
                                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                                ElseIf k = 3 Or k = 4 Then
                                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                                Else
                                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                                End If

                                                If k = 6 Then
                                                    totalAchat += dt.Rows(j)(k)
                                                    GrandTotalAchat += dt.Rows(j)(k)
                                                End If
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                            Next

                                        Next

                                        pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        pdfCell.Border = 0
                                        pdfCell.Colspan = 6

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(Format(totalAchat, "#,##0"), fontTotal))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfDoc.Add(pdfTable)

                                    End If

                                Else

                                    'AFFICHAGE DES LIGNES EN LES REGROUPANTS

                                    totalAchat = 0

                                    Dim articleList As New DataTable()
                                    Dim articleList004 As New DataTable()

                                    If True Then

                                        FillingListquery = "SELECT DISTINCT ligne_bordereaux.CODE_ARTICLE FROM `bordereaux`, ligne_bordereaux, article, magasin WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "','" & TYPE_BORDEREAUX_2 & "','" & TYPE_BORDEREAUX_5 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND magasin.CODE_MAGASIN = ligne_bordereaux.CODE_MAGASIN AND article.CODE_SOUS_FAMILLE = @CODE_SOUS_FAMILLE AND ligne_bordereaux.CODE_MAGASIN = @CODE_MAGASIN ORDER BY ID_LIGNE_BORDEREAU DESC"

                                        'article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE
                                        ',  DESIGNATION_FR AS DESIGNATION

                                        Dim commandList As New MySqlCommand(FillingListquery, GlobalVariable.connect)
                                        commandList.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                                        commandList.Parameters.Add("@TYPE_BORDEREAUX_2", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_2
                                        commandList.Parameters.Add("@CODE_SOUS_FAMILLE", MySqlDbType.VarChar).Value = tableListFamille.Rows(t)("CODE_SOUS_FAMILLE")
                                        commandList.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")

                                        Dim adapterList As New MySqlDataAdapter(commandList)

                                        adapterList.Fill(articleList)

                                        Dim FillingListquery004 As String = "SELECT DISTINCT ligne_bordereaux.CODE_ARTICLE FROM `bordereaux`, ligne_bordereaux, article, magasin WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_3 & "','" & TYPE_BORDEREAUX_4 & "','" & TYPE_BORDEREAUX_6 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND magasin.CODE_MAGASIN = ligne_bordereaux.CODE_SOUS_MAGASIN AND article.CODE_SOUS_FAMILLE = @CODE_SOUS_FAMILLE AND ligne_bordereaux.CODE_SOUS_MAGASIN = @CODE_MAGASIN ORDER BY ID_LIGNE_BORDEREAU DESC"

                                        Dim commandList004 As New MySqlCommand(FillingListquery004, GlobalVariable.connect)
                                        commandList004.Parameters.Add("@TYPE_BORDEREAUX_3", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_3
                                        commandList004.Parameters.Add("@TYPE_BORDEREAUX_4", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_4
                                        commandList004.Parameters.Add("@CODE_SOUS_FAMILLE", MySqlDbType.VarChar).Value = tableListFamille.Rows(t)("CODE_SOUS_FAMILLE")
                                        commandList004.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")

                                        Dim adapterList004 As New MySqlDataAdapter(commandList004)

                                        adapterList004.Fill(articleList004)

                                        articleList.Merge(articleList004)

                                    End If

                                    If articleList.Rows.Count > 0 Then

                                        Dim p003 As Paragraph = New Paragraph(Chr(13) & "FAMILLE : " & tableListFamille.Rows(t)("CODE_SOUS_FAMILLE") & Chr(13) & Chr(13), pRow)
                                        p003.Alignment = Element.ALIGN_RIGHT

                                        pdfDoc.Add(p003)

                                        Dim pdfTable As New PdfPTable(5) 'Number of columns
                                        pdfTable.TotalWidth = 555.0F
                                        pdfTable.LockedWidth = True
                                        pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfTable.HeaderRows = 1

                                        Dim widths As Single() = New Single() {45.0F, 30.0F, 15.0F, 15.0F, 15.0F}

                                        pdfTable.SetWidths(widths)

                                        Dim pdfCell As PdfPCell = Nothing

                                        pdfCell = New PdfPCell(New Paragraph("DESIGNATION", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("UNITE", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("QTE", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("PU Moy.", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal1))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        'pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        For l = 0 To articleList.Rows.Count - 1

                                            '----------------------------------------------
                                            Dim dt As New DataTable()
                                            Dim dt01 As New DataTable()

                                            If True Then

                                                Dim FillingListquery03 As String = "SELECT `DATE_BORDEREAU` AS 'DATE',  DESIGNATION_FR AS 'DESIGNATION', NUM_SERIE_DEBUT AS 'UNITE', ligne_bordereaux.QUANTITE As 'QTE AVANT MOVT', QUANTITE_ENTREE_STOCK AS 'QTE EN MOVT', PRIX_UNITAIRE_HT AS 'PRIX UNITAIRE', PRIX_TOTAL_HT AS 'TOTAL' FROM `bordereaux`, ligne_bordereaux, article, magasin WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "','" & TYPE_BORDEREAUX_2 & "','" & TYPE_BORDEREAUX_5 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND magasin.CODE_MAGASIN = ligne_bordereaux.CODE_MAGASIN AND article.CODE_SOUS_FAMILLE = @CODE_SOUS_FAMILLE AND ligne_bordereaux.CODE_MAGASIN = @CODE_MAGASIN AND ligne_bordereaux.CODE_ARTICLE =@CODE_ARTICLE ORDER BY ID_LIGNE_BORDEREAU DESC"

                                                Dim commandList03 As New MySqlCommand(FillingListquery03, GlobalVariable.connect)
                                                commandList03.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                                                commandList03.Parameters.Add("@TYPE_BORDEREAUX_2", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_2
                                                commandList03.Parameters.Add("@CODE_SOUS_FAMILLE", MySqlDbType.VarChar).Value = tableListFamille.Rows(t)("CODE_SOUS_FAMILLE")
                                                commandList03.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")
                                                commandList03.Parameters.Add("@CODE_ARTICLE", MySqlDbType.VarChar).Value = articleList.Rows(l)("CODE_ARTICLE")

                                                Dim adapterList03 As New MySqlDataAdapter(commandList03)

                                                adapterList03.Fill(dt)


                                                Dim FillingListquery003 As String = "SELECT `DATE_BORDEREAU` AS 'DATE',  DESIGNATION_FR AS 'DESIGNATION', NUM_SERIE_DEBUT AS 'UNITE', ligne_bordereaux.QUANTITE As 'QTE AVANT MOVT', QUANTITE_ENTREE_STOCK AS 'QTE EN MOVT', PRIX_UNITAIRE_HT AS 'PRIX UNITAIRE', PRIX_TOTAL_HT AS 'TOTAL' FROM `bordereaux`, ligne_bordereaux, article, magasin WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_3 & "','" & TYPE_BORDEREAUX_4 & "','" & TYPE_BORDEREAUX_6 & "') AND DATE_BORDEREAU >= '" & DateDebut.ToString("yyyy-MM-dd") & "' AND DATE_BORDEREAU <='" & DateFin.ToString("yyyy-MM-dd") & "' AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND magasin.CODE_MAGASIN = ligne_bordereaux.CODE_SOUS_MAGASIN AND article.CODE_SOUS_FAMILLE = @CODE_SOUS_FAMILLE AND ligne_bordereaux.CODE_SOUS_MAGASIN = @CODE_MAGASIN AND ligne_bordereaux.CODE_ARTICLE =@CODE_ARTICLE ORDER BY ID_LIGNE_BORDEREAU DESC"

                                                Dim commandList003 As New MySqlCommand(FillingListquery003, GlobalVariable.connect)
                                                commandList003.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                                                commandList003.Parameters.Add("@TYPE_BORDEREAUX_2", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_2
                                                commandList003.Parameters.Add("@CODE_SOUS_FAMILLE", MySqlDbType.VarChar).Value = tableListFamille.Rows(t)("CODE_SOUS_FAMILLE")
                                                commandList003.Parameters.Add("@CODE_MAGASIN", MySqlDbType.VarChar).Value = tableListMagasin.Rows(i)("CODE_MAGASIN")
                                                commandList003.Parameters.Add("@CODE_ARTICLE", MySqlDbType.VarChar).Value = articleList.Rows(l)("CODE_ARTICLE")

                                                Dim adapterList003 As New MySqlDataAdapter(commandList003)

                                                adapterList003.Fill(dt01)

                                                dt.Merge(dt01)

                                            Else

                                            End If

                                            If dt.Rows.Count > 0 Then

                                                Dim qteTotal As Double = 0
                                                Dim montantTotal As Double = 0

                                                For m = 0 To dt.Rows.Count - 1
                                                    qteTotal += dt.Rows(m)("QTE EN MOVT")
                                                    montantTotal += dt.Rows(m)("TOTAL")
                                                    totalAchat += dt.Rows(m)("TOTAL")
                                                    GrandTotalAchat += dt.Rows(m)("TOTAL")
                                                Next

                                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(0)("DESIGNATION"), font1))
                                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(0)("UNITE"), font1))
                                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                                pdfCell = New PdfPCell(New Paragraph(Format(qteTotal, "#,##0.0"), font1))
                                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                                If qteTotal > 0 Then
                                                    pdfCell = New PdfPCell(New Paragraph(Format(montantTotal / qteTotal, "#,##0"), font1))
                                                Else
                                                    pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(0)("PRIX UNITAIRE"), "#,##0"), font1))
                                                End If

                                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                                pdfCell = New PdfPCell(New Paragraph(Format(montantTotal, "#,##0"), font1))
                                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                                pdfCell.MinimumHeight = 5

                                                pdfTable.AddCell(pdfCell)

                                            End If
                                            '----------------------------------------------

                                        Next

                                        pdfCell = New PdfPCell(New Paragraph("TOTAL : ", fontTotal))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        pdfCell.Border = 0
                                        pdfCell.Colspan = 4

                                        pdfTable.AddCell(pdfCell)

                                        pdfCell = New PdfPCell(New Paragraph(Format(totalAchat, "#,##0"), fontTotal))
                                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                        pdfCell.MinimumHeight = 5
                                        'pdfCell.PaddingLeft = 5.0F
                                        pdfCell.Border = 0

                                        pdfTable.AddCell(pdfCell)

                                        pdfDoc.Add(pdfTable)

                                    End If

                                End If

                            Next

                        End If

                    Next

                End If

            End If

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub impressionEconomaListeMarche(ByVal title As String, ByVal totalAchat As Double, ByVal totalVente As Double, ByVal numeroBon As String, ByVal nomTiers As String, ByVal libelle As String, ByVal reference As String, ByVal observation As String)

        Dim TYPE_BORDEREAUX_1 As String = "Liste du Marché"

        Dim FillingListquery As String = ""
        Dim FillingListquery01 As String = ""
        Dim FillingListquery02 As String = ""

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0

        Dim tireDocument As String = title.ToUpper() & " DU " & (Date.Now().ToString("ddMMyyHHmmss"))

        Dim sousTitreDocument As String = ""

        sousTitreDocument = tireDocument

        Dim CODE_BORDEREAUX As String = ""

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = tireDocument

        Dim GrandTotalAchat As Double = 0

        Dim totaux As Double = 0

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 20, 80, 60)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRowFirst As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 18, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal1 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p0003 As Paragraph = New Paragraph(GlobalVariable.societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & Chr(13), pRowFirst)
            p0003.Alignment = Element.ALIGN_CENTER

            'pdfDoc.Add(p0003)

            Dim infoSupBon As DataTable = Functions.getElementByCode(numeroBon, "bordereaux", "CODE_BORDEREAUX")

            Dim dateDebut As Date
            Dim dateDu As Date
            Dim dateAu As Date
            Dim passant As Integer = 0

            '1- INSERTION DES EN TETE DES 

            If infoSupBon.Rows.Count > 0 Then

                CODE_BORDEREAUX = numeroBon

                dateDebut = infoSupBon.Rows(0)("DATE_BORDEREAU")
                dateDu = infoSupBon.Rows(0)("DATE_DU")
                dateAu = infoSupBon.Rows(0)("DATE_AU")
                passant = infoSupBon.Rows(0)("PASSANT")

                Dim p0 As Paragraph = New Paragraph(Chr(13) & Chr(13) & title & " NUMERO :  " & infoSupBon.Rows(0)("CODE_BORDEREAUX") & Chr(13) & "LIBELLE: " & infoSupBon.Rows(0)("LIBELLE_BORDEREAUX") & Chr(13) & "REFERENCE: " & infoSupBon.Rows(0)("REF_BORDEREAUX") & Chr(13) & "DEMANDEUR: " & infoSupBon.Rows(0)("NON_TIERS") & Chr(13) & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p0)

                Dim p3 As Paragraph = New Paragraph(title.ToUpper() & " DU " & " " & dateDebut & Chr(13) & "POUR LA PERIODE DU " & CDate(infoSupBon.Rows(0)("DATE_DU")).ToShortDateString & " AU " & CDate(infoSupBon.Rows(0)("DATE_AU")).ToShortDateString, pRow)
                p3.Alignment = Element.ALIGN_LEFT

                pdfDoc.Add(p3)

            Else

                dateDebut = GlobalVariable.DateDeTravail
                dateDu = MainWindowEconomat.GunaDateTimePickerP1LM.Value.ToShortDateString
                dateAu = MainWindowEconomat.GunaDateTimePickerP2LM.Value.ToShortDateString

                CODE_BORDEREAUX = MainWindowEconomat.GunaTextBoxCodeBordereau.Text

                '1- INSERTION DES EN TETE DES 
                Dim p0 As Paragraph = New Paragraph(Chr(13) & Chr(13) & title & " NUMERO :  " & CODE_BORDEREAUX & Chr(13) & "LIBELLE: " & libelle & Chr(13) & "REFERENCE: " & reference & Chr(13) & "DEMANDEUR: " & nomTiers & Chr(13) & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p0)

                Dim p3 As Paragraph = New Paragraph(title.ToUpper() & " DU " & " " & dateDebut & Chr(13) & "POUR LA PERIODE DU " & MainWindowEconomat.GunaDateTimePickerP1LM.Value.ToShortDateString & " AU " & MainWindowEconomat.GunaDateTimePickerP2LM.Value.ToShortDateString, pRow)
                p3.Alignment = Element.ALIGN_LEFT

                pdfDoc.Add(p3)


            End If

            '----------------------------------------------------------------------------------------------------------------------------------
            Dim p001 As Paragraph = New Paragraph(Chr(13) & "NOMBRE DE CLIENT LOGES", pRow)
            p001.Alignment = Element.ALIGN_LEFT
            pdfDoc.Add(p001)

            Dim pdfTable001 As New PdfPTable(8) 'Number of columns
            pdfTable001.TotalWidth = 555.0F
            pdfTable001.LockedWidth = True
            pdfTable001.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable001.HeaderRows = 1

            Dim widths001 As Single() = New Single() {25.0F, 25.0F, 25.0F, 25.0F, 25.0F, 25.0F, 25.0F, 25.0F}

            pdfTable001.SetWidths(widths001)

            Dim pdfCell001 As PdfPCell = Nothing

            pdfCell001 = New PdfPCell(New Paragraph("", fontTotal1))
            pdfCell001.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell001.MinimumHeight = 5
            pdfCell001.Colspan = 8
            pdfCell001.Border = 0
            pdfTable001.AddCell(pdfCell001)

            For i = 0 To 7

                pdfCell001 = New PdfPCell(New Paragraph(dateDu.AddDays(i), fontTotal1))
                pdfCell001.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell001.MinimumHeight = 5
                pdfCell001.Border = 0
                pdfTable001.AddCell(pdfCell001)

            Next

            Dim nombreDeClient As Integer = 0
            Dim nombreClientLoges As Integer = 0

            For i = 0 To 7

                nombreDeClient = Functions.nombreDeClientEnChambre(dateDu.AddDays(i), "chambre")
                nombreClientLoges += Functions.nombreDeClientEnChambre(dateDu.AddDays(i), "chambre")

                pdfCell001 = New PdfPCell(New Paragraph(nombreDeClient, fontTotal1))
                pdfCell001.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell001.MinimumHeight = 5
                pdfCell001.Border = 0
                pdfTable001.AddCell(pdfCell001)

            Next

            pdfDoc.Add(pdfTable001)

            '----------------------------------------------------------------------------------------------------------------------------------

            Dim p02 As Paragraph = New Paragraph(Chr(13) & "PREVISION (NOMBRE DE PERSONNE)" & Chr(13) & Chr(13), pRow)
            p02.Alignment = Element.ALIGN_LEFT
            pdfDoc.Add(p02)

            Dim pdfTable002 As New PdfPTable(4) 'Number of columns
            pdfTable002.TotalWidth = 555.0F
            pdfTable002.LockedWidth = True
            pdfTable002.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable002.HeaderRows = 1
            pdfTable002.PaddingTop = 50

            Dim widths002 As Single() = New Single() {25.0F, 25.0F, 25.0F, 25.0F}

            pdfTable002.SetWidths(widths002)

            Dim pdfCell002 As PdfPCell = Nothing

            pdfCell002 = New PdfPCell(New Paragraph("CLIENTS LOGES", fontTotal1))
            pdfCell002.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell002.MinimumHeight = 5
            pdfCell002.Border = 0

            pdfTable002.AddCell(pdfCell002)

            pdfCell002 = New PdfPCell(New Paragraph("PASSANT", fontTotal1))
            pdfCell002.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell002.MinimumHeight = 5
            pdfCell002.Border = 0

            pdfTable002.AddCell(pdfCell002)

            pdfCell002 = New PdfPCell(New Paragraph("TRAITEURS", fontTotal1))
            pdfCell002.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell002.MinimumHeight = 5
            pdfCell002.Border = 0

            pdfTable002.AddCell(pdfCell002)

            pdfCell002 = New PdfPCell(New Paragraph("EVENEMENTIEL", fontTotal1))
            pdfCell002.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell002.MinimumHeight = 5
            pdfCell002.Border = 0

            pdfTable002.AddCell(pdfCell002)

            Dim nombre As Integer = 0

            pdfCell002 = New PdfPCell(New Paragraph(nombreClientLoges, fontTotal1))
            pdfCell002.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell002.MinimumHeight = 5
            pdfCell002.Border = 0
            pdfTable002.AddCell(pdfCell002)

            For i = 0 To 2

                Dim table As DataTable = Functions.nombreDeTraiteur(dateDu.AddDays(0).ToShortDateString(), dateDu.AddDays(6).ToShortDateString(), "salle")
                nombre = 0

                If Not table Is Nothing Then

                    If i = 0 Then

                    ElseIf i = 1 Then
                        For j = 0 To table.Rows.Count - 1
                            nombre += table.Rows(j)("NB_PERSONNES")
                        Next
                    Else
                        nombre = table.Rows.Count
                    End If

                End If

                If i = 0 Then
                    nombre += passant
                End If

                pdfCell002 = New PdfPCell(New Paragraph(nombre, fontTotal1))
                pdfCell002.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell002.MinimumHeight = 5
                pdfCell002.Border = 0
                pdfTable002.AddCell(pdfCell002)

            Next

            pdfDoc.Add(pdfTable002)

            Dim p0030_ As Paragraph = New Paragraph(Chr(13), pRow)
            p0030_.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p0030_)

            totalAchat = 0

            FillingListquery = "SELECT DISTINCT ligne_bordereaux.CODE_ARTICLE FROM `bordereaux`, ligne_bordereaux, article, magasin WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "') AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND bordereaux.CODE_BORDEREAUX=@CODE_BORDEREAUX ORDER BY ID_LIGNE_BORDEREAU DESC"

            'article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE
            ',  DESIGNATION_FR AS DESIGNATION

            Dim commandList As New MySqlCommand(FillingListquery, GlobalVariable.connect)
            commandList.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
            commandList.Parameters.Add("@CODE_BORDEREAUX", MySqlDbType.VarChar).Value = CODE_BORDEREAUX

            Dim adapterList As New MySqlDataAdapter(commandList)
            Dim articleList As New DataTable()

            adapterList.Fill(articleList)

            If articleList.Rows.Count > 0 Then

                Dim pdfTable As New PdfPTable(6) 'Number of columns
                pdfTable.TotalWidth = 555.0F
                pdfTable.LockedWidth = True
                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable.HeaderRows = 1

                Dim widths As Single() = New Single() {10.0F, 65.0F, 25.0F, 20.0F, 25.0F, 25.0F}

                pdfTable.SetWidths(widths)

                Dim pdfCell As PdfPCell = Nothing

                pdfCell = New PdfPCell(New Paragraph("No", fontTotal1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DESIGNATION", fontTotal1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("UNITE", fontTotal1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("QTE", fontTotal1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PU", fontTotal1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                For l = 0 To articleList.Rows.Count - 1

                    '----------------------------------------------

                    Dim FillingListquery03 As String = "SELECT `DATE_BORDEREAU` AS 'DATE',  DESIGNATION_FR AS 'DESIGNATION', NUM_SERIE_DEBUT AS 'UNITE', ligne_bordereaux.QUANTITE As 'QTE AVANT MOVT', QUANTITE_ENTREE_STOCK AS 'QTE EN MOVT', PRIX_UNITAIRE_HT AS 'PRIX UNITAIRE', PRIX_TOTAL_HT AS 'TOTAL' FROM `bordereaux`, ligne_bordereaux, article WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "') AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND ligne_bordereaux.CODE_ARTICLE =@CODE_ARTICLE AND bordereaux.CODE_BORDEREAUX = @CODE_BORDEREAUX ORDER BY ID_LIGNE_BORDEREAU DESC"

                    Dim commandList03 As New MySqlCommand(FillingListquery03, GlobalVariable.connect)
                    commandList03.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                    commandList03.Parameters.Add("@CODE_ARTICLE", MySqlDbType.VarChar).Value = articleList.Rows(l)("CODE_ARTICLE")
                    commandList03.Parameters.Add("@CODE_BORDEREAUX", MySqlDbType.VarChar).Value = CODE_BORDEREAUX

                    Dim adapterList03 As New MySqlDataAdapter(commandList03)
                    Dim dt As New DataTable()

                    adapterList03.Fill(dt)

                    If dt.Rows.Count > 0 Then

                        Dim qteTotal As Double = 0
                        Dim montantTotal As Double = 0

                        For m = 0 To dt.Rows.Count - 1
                            qteTotal += dt.Rows(m)("QTE EN MOVT")
                            montantTotal += dt.Rows(m)("TOTAL")
                            totalAchat += dt.Rows(m)("TOTAL")
                            GrandTotalAchat += dt.Rows(m)("TOTAL")
                            totaux += dt.Rows(m)("TOTAL")
                        Next

                        pdfCell = New PdfPCell(New Paragraph(l + 1, font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 5

                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(0)("DESIGNATION"), font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 5

                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(dt.Rows(0)("UNITE"), font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell.MinimumHeight = 5

                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(qteTotal, "#,##0.0"), font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 5

                        pdfTable.AddCell(pdfCell)

                        If qteTotal > 0 Then
                            pdfCell = New PdfPCell(New Paragraph(Format(montantTotal / qteTotal, "#,##0"), font1))
                        Else
                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(0)("PRIX UNITAIRE"), "#,##0"), font1))
                        End If

                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 5

                        pdfTable.AddCell(pdfCell)

                        pdfCell = New PdfPCell(New Paragraph(Format(montantTotal, "#,##0"), font1))
                        pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell.MinimumHeight = 5

                        pdfTable.AddCell(pdfCell)

                    End If
                    '----------------------------------------------

                Next

                pdfCell = New PdfPCell(New Paragraph("TOTAL : ", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0
                pdfCell.Colspan = 4

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(GrandTotalAchat, "#,##0") & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 5
                pdfCell.Colspan = 2
                pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

            End If

            Dim p0030 As Paragraph = New Paragraph(Chr(13) & "TOTAUX : " & Format(totaux, "#,##0") & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE"), pRow)
            p0030.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p0030)

            '--------------------------------

            '------------------------------------------------------- HISTORIQUES DES LISTES PASSES --------------------------------------------------------

            Dim GrandTotalAchat_ As Double = 0
            Dim totalAchat_ As Double = 0

            Dim date_1 As Date = dateDebut.AddDays(-7).ToShortDateString
            Dim date_2 As Date = dateDebut.AddDays(-1).ToShortDateString

            Dim p030 As Paragraph = New Paragraph(Chr(13) & "HISTORIQUES DU MARCHE " & date_1 & " AU " & date_2 & Chr(13 & Chr(13)), pRow)
            p030.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p030)

            Dim p030_ As Paragraph = New Paragraph(Chr(13), pRow)
            p030_.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p030_)

            If True Then

                totalAchat_ = 0

                '1- SELECTION DES DIFFERENTES LIGNE DU BORDEREAUX. 

                Dim FillingListquery_ As String = "SELECT DISTINCT ligne_bordereaux.CODE_ARTICLE FROM `bordereaux`, ligne_bordereaux, article WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "') AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND bordereaux.CODE_BORDEREAUX=@CODE_BORDEREAUX ORDER BY ID_LIGNE_BORDEREAU DESC"

                Dim commandList_ As New MySqlCommand(FillingListquery_, GlobalVariable.connect)
                commandList_.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                commandList_.Parameters.Add("@CODE_BORDEREAUX", MySqlDbType.VarChar).Value = CODE_BORDEREAUX

                Dim adapterList_ As New MySqlDataAdapter(commandList_)
                Dim articleList_ As New DataTable()

                adapterList_.Fill(articleList_)

                If articleList_.Rows.Count > 0 Then

                    Dim pdfTable As New PdfPTable(8) 'Number of columns
                    pdfTable.TotalWidth = 555.0F
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.HeaderRows = 1

                    Dim widths As Single() = New Single() {65.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F}

                    pdfTable.SetWidths(widths)

                    Dim pdfCell As PdfPCell = Nothing

                    pdfCell = New PdfPCell(New Paragraph("DESIGNATION", fontTotal1))
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfCell.MinimumHeight = 5

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(date_1.ToShortDateString, fontTotal1))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 5

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(date_1.AddDays(1).ToShortDateString, fontTotal1))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 5

                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(date_1.AddDays(2).ToShortDateString, fontTotal1))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 5
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(date_1.AddDays(3).ToShortDateString, fontTotal1))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 5
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(date_1.AddDays(4).ToShortDateString, fontTotal1))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 5
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(date_1.AddDays(5).ToShortDateString, fontTotal1))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 5
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(date_1.AddDays(6).ToShortDateString, fontTotal1))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 5

                    pdfTable.AddCell(pdfCell)

                    For l = 0 To articleList_.Rows.Count - 1

                        '----------------------------------------------

                        '2- SELECTION DES DIFFERENTS 

                        Dim FillingListquery03_ As String = "SELECT `DATE_BORDEREAU` AS 'DATE',  DESIGNATION_FR AS 'DESIGNATION', NUM_SERIE_DEBUT AS 'UNITE', ligne_bordereaux.QUANTITE As 'QTE AVANT MOVT', QUANTITE_ENTREE_STOCK AS 'QTE EN MOVT', PRIX_UNITAIRE_HT AS 'PRIX UNITAIRE', PRIX_TOTAL_HT AS 'TOTAL' FROM `bordereaux`, ligne_bordereaux, article WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "') AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND ligne_bordereaux.CODE_ARTICLE =@CODE_ARTICLE AND bordereaux.CODE_BORDEREAUX = @CODE_BORDEREAUX ORDER BY ID_LIGNE_BORDEREAU DESC"

                        Dim commandList03_ As New MySqlCommand(FillingListquery03_, GlobalVariable.connect)
                        commandList03_.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                        commandList03_.Parameters.Add("@CODE_ARTICLE", MySqlDbType.VarChar).Value = articleList_.Rows(l)("CODE_ARTICLE")
                        commandList03_.Parameters.Add("@CODE_BORDEREAUX", MySqlDbType.VarChar).Value = CODE_BORDEREAUX

                        Dim adapterList03_ As New MySqlDataAdapter(commandList03_)
                        Dim dt_ As New DataTable()

                        adapterList03_.Fill(dt_)

                        If dt_.Rows.Count > 0 Then

                            Dim qteTotal_ As Double = 0
                            Dim montantTotal_ As Double = 0

                            For m = 0 To dt_.Rows.Count - 1
                                qteTotal_ += dt_.Rows(m)("QTE EN MOVT")
                                montantTotal_ += dt_.Rows(m)("TOTAL")
                                totalAchat_ += dt_.Rows(m)("TOTAL")
                                GrandTotalAchat_ += dt_.Rows(m)("TOTAL")
                            Next

                            pdfCell = New PdfPCell(New Paragraph(dt_.Rows(0)("DESIGNATION"), font1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfCell.MinimumHeight = 5

                            pdfTable.AddCell(pdfCell)

                            Dim CODE_ARTICLE As String = articleList_.Rows(l)("CODE_ARTICLE")

                            Dim montant As Double = Functions.historiquesDuMarche(CODE_ARTICLE, date_1.ToShortDateString)

                            If montant = 0 Then
                                pdfCell = New PdfPCell(New Paragraph("", font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph(Format(montant, "#,##0"), font1))
                            End If

                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfCell.MinimumHeight = 5

                            pdfTable.AddCell(pdfCell)

                            montant = Functions.historiquesDuMarche(CODE_ARTICLE, date_1.AddDays(1).ToShortDateString)

                            If montant = 0 Then
                                pdfCell = New PdfPCell(New Paragraph("", font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph(Format(montant, "#,##0"), font1))
                            End If

                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 5

                            pdfTable.AddCell(pdfCell)

                            montant = Functions.historiquesDuMarche(CODE_ARTICLE, date_1.AddDays(2).ToShortDateString)

                            If montant = 0 Then
                                pdfCell = New PdfPCell(New Paragraph("", font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph(Format(montant, "#,##0"), font1))
                            End If

                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 5

                            pdfTable.AddCell(pdfCell)

                            montant = Functions.historiquesDuMarche(CODE_ARTICLE, date_1.AddDays(3).ToShortDateString)

                            If montant = 0 Then
                                pdfCell = New PdfPCell(New Paragraph("", font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph(Format(montant, "#,##0"), font1))
                            End If

                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 5

                            pdfTable.AddCell(pdfCell)

                            montant = Functions.historiquesDuMarche(CODE_ARTICLE, date_1.AddDays(4).ToShortDateString)

                            If montant = 0 Then
                                pdfCell = New PdfPCell(New Paragraph("", font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph(Format(montant, "#,##0"), font1))
                            End If
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 5

                            pdfTable.AddCell(pdfCell)

                            montant = Functions.historiquesDuMarche(CODE_ARTICLE, date_1.AddDays(5).ToShortDateString)

                            If montant = 0 Then
                                pdfCell = New PdfPCell(New Paragraph("", font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph(Format(montant, "#,##0"), font1))
                            End If
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 5

                            pdfTable.AddCell(pdfCell)

                            montant = Functions.historiquesDuMarche(CODE_ARTICLE, date_1.AddDays(6).ToShortDateString)

                            If montant = 0 Then
                                pdfCell = New PdfPCell(New Paragraph("", font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph(Format(montant, "#,##0"), font1))
                            End If
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 5

                            pdfTable.AddCell(pdfCell)

                        End If
                        '----------------------------------------------

                    Next

                    pdfCell = New PdfPCell(New Paragraph("TOTAL : ", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 7
                    'pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0
                    pdfCell.Colspan = 4

                    'pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(totalAchat_, "#,##0"), fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 5
                    'pdfCell.PaddingLeft = 5.0F
                    pdfCell.Border = 0

                    'pdfTable.AddCell(pdfCell)

                    pdfDoc.Add(pdfTable)

                End If

            End If
            '----------------------------------------------------------------------------------------------------------------------------------------------

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

            Process.Start(sfd.FileName)

        End If

    End Sub


    Public Shared Sub impressionEconomaListeMarcheOld(ByVal title As String, ByVal totalAchat As Double, ByVal totalVente As Double, ByVal numeroBon As String, ByVal nomTiers As String, ByVal libelle As String, ByVal reference As String, ByVal observation As String)

        Dim TYPE_BORDEREAUX_1 As String = "Liste du Marché"

        Dim FillingListquery As String = ""
        Dim FillingListquery01 As String = ""
        Dim FillingListquery02 As String = ""

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0

        Dim tireDocument As String = title.ToUpper() & " DU " & (Date.Now().ToString("ddMMyyHHmmss"))

        Dim sousTitreDocument As String = ""

        sousTitreDocument = tireDocument

        Dim CODE_BORDEREAUX As String = ""

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = tireDocument

        Dim GrandTotalAchat As Double = 0

        Dim totaux As Double = 0

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 20, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRowFirst As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 18, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal1 As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p0003 As Paragraph = New Paragraph(GlobalVariable.societe.Rows(0)("RAISON_SOCIALE") & Chr(13) & Chr(13), pRowFirst)
            p0003.Alignment = Element.ALIGN_CENTER

            'pdfDoc.Add(p0003)

            Dim infoSupBon As DataTable = Functions.getElementByCode(numeroBon, "bordereaux", "CODE_BORDEREAUX")

            Dim dateDebut As Date
            Dim dateDu As Date
            Dim dateAu As Date
            Dim passant As Integer = 0

            '1- INSERTION DES EN TETE DES 

            If infoSupBon.Rows.Count > 0 Then

                CODE_BORDEREAUX = numeroBon

                dateDebut = infoSupBon.Rows(0)("DATE_BORDEREAU")
                dateDu = infoSupBon.Rows(0)("DATE_DU")
                dateAu = infoSupBon.Rows(0)("DATE_AU")
                passant = infoSupBon.Rows(0)("PASSANT")

                Dim p0 As Paragraph = New Paragraph(Chr(13) & title & " NUMERO :  " & infoSupBon.Rows(0)("CODE_BORDEREAUX") & Chr(13) & "LIBELLE: " & infoSupBon.Rows(0)("LIBELLE_BORDEREAUX") & Chr(13) & "REFERENCE: " & infoSupBon.Rows(0)("REF_BORDEREAUX") & Chr(13) & "DEMANDEUR: " & infoSupBon.Rows(0)("NON_TIERS") & Chr(13) & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p0)

                Dim p3 As Paragraph = New Paragraph(title.ToUpper() & " DU " & " " & dateDebut & Chr(13) & "POUR LA PERIODE DU " & CDate(infoSupBon.Rows(0)("DATE_DU")).ToShortDateString & " AU " & CDate(infoSupBon.Rows(0)("DATE_AU")).ToShortDateString, pRow)
                p3.Alignment = Element.ALIGN_LEFT

                pdfDoc.Add(p3)

            Else

                dateDebut = GlobalVariable.DateDeTravail
                dateDu = MainWindowEconomat.GunaDateTimePickerP1LM.Value.ToShortDateString
                dateAu = MainWindowEconomat.GunaDateTimePickerP2LM.Value.ToShortDateString

                CODE_BORDEREAUX = MainWindowEconomat.GunaTextBoxCodeBordereau.Text

                '1- INSERTION DES EN TETE DES 
                Dim p0 As Paragraph = New Paragraph(Chr(13) & title & " NUMERO :  " & CODE_BORDEREAUX & Chr(13) & "LIBELLE: " & libelle & Chr(13) & "REFERENCE: " & reference & Chr(13) & "DEMANDEUR: " & nomTiers & Chr(13) & Chr(13), pRow)
                p0.Alignment = Element.ALIGN_LEFT
                pdfDoc.Add(p0)

                Dim p3 As Paragraph = New Paragraph(title.ToUpper() & " DU " & " " & dateDebut & Chr(13) & "POUR LA PERIODE DU " & MainWindowEconomat.GunaDateTimePickerP1LM.Value.ToShortDateString & " AU " & MainWindowEconomat.GunaDateTimePickerP2LM.Value.ToShortDateString, pRow)
                p3.Alignment = Element.ALIGN_LEFT

                pdfDoc.Add(p3)


            End If

            '----------------------------------------------------------------------------------------------------------------------------------
            Dim p001 As Paragraph = New Paragraph(Chr(13) & "NOMBRE DE CLIENT LOGES", pRow)
            p001.Alignment = Element.ALIGN_LEFT
            pdfDoc.Add(p001)

            Dim pdfTable001 As New PdfPTable(8) 'Number of columns
            pdfTable001.TotalWidth = 555.0F
            pdfTable001.LockedWidth = True
            pdfTable001.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable001.HeaderRows = 1

            Dim widths001 As Single() = New Single() {25.0F, 25.0F, 25.0F, 25.0F, 25.0F, 25.0F, 25.0F, 25.0F}

            pdfTable001.SetWidths(widths001)

            Dim pdfCell001 As PdfPCell = Nothing

            pdfCell001 = New PdfPCell(New Paragraph("", fontTotal1))
            pdfCell001.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell001.MinimumHeight = 5
            pdfCell001.Colspan = 8
            pdfCell001.Border = 0
            pdfTable001.AddCell(pdfCell001)

            For i = 0 To 7

                pdfCell001 = New PdfPCell(New Paragraph(dateDu.AddDays(i), fontTotal1))
                pdfCell001.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell001.MinimumHeight = 5
                pdfCell001.Border = 0
                pdfTable001.AddCell(pdfCell001)

            Next

            Dim nombreDeClient As Integer = 0

            For i = 0 To 7

                nombreDeClient = Functions.nombreDeClientEnChambre(dateDu.AddDays(i), "chambre")

                pdfCell001 = New PdfPCell(New Paragraph(nombreDeClient, fontTotal1))
                pdfCell001.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell001.MinimumHeight = 5
                pdfCell001.Border = 0
                pdfTable001.AddCell(pdfCell001)

            Next

            pdfDoc.Add(pdfTable001)

            '----------------------------------------------------------------------------------------------------------------------------------

            Dim p02 As Paragraph = New Paragraph(Chr(13) & "PREVISION (NOMBRE DE PERSONNE)" & Chr(13) & Chr(13), pRow)
            p02.Alignment = Element.ALIGN_LEFT
            pdfDoc.Add(p02)

            Dim pdfTable002 As New PdfPTable(3) 'Number of columns
            pdfTable002.TotalWidth = 555.0F
            pdfTable002.LockedWidth = True
            pdfTable002.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable002.HeaderRows = 1
            pdfTable002.PaddingTop = 50

            Dim widths002 As Single() = New Single() {25.0F, 25.0F, 25.0F}

            pdfTable002.SetWidths(widths002)

            Dim pdfCell002 As PdfPCell = Nothing

            pdfCell002 = New PdfPCell(New Paragraph("PASSANT", fontTotal1))
            pdfCell002.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell002.MinimumHeight = 5
            pdfCell002.Border = 0

            pdfTable002.AddCell(pdfCell002)

            pdfCell002 = New PdfPCell(New Paragraph("TRAITEURS", fontTotal1))
            pdfCell002.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell002.MinimumHeight = 5
            pdfCell002.Border = 0

            pdfTable002.AddCell(pdfCell002)

            pdfCell002 = New PdfPCell(New Paragraph("EVENEMENTIEL", fontTotal1))
            pdfCell002.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell002.MinimumHeight = 5
            pdfCell002.Border = 0

            pdfTable002.AddCell(pdfCell002)

            Dim nombre As Integer = 0

            For i = 0 To 2

                Dim table As DataTable = Functions.nombreDeTraiteur(dateDu.AddDays(0).ToShortDateString(), dateDu.AddDays(6).ToShortDateString(), "salle")
                nombre = 0

                If Not table Is Nothing Then

                    If i = 0 Then

                    ElseIf i = 1 Then
                        For j = 0 To table.Rows.Count - 1
                            nombre += table.Rows(j)("NB_PERSONNES")
                        Next
                    Else
                        nombre = table.Rows.Count
                    End If

                End If

                If i = 0 Then
                    nombre += passant
                End If

                pdfCell002 = New PdfPCell(New Paragraph(nombre, fontTotal1))
                pdfCell002.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell002.MinimumHeight = 5
                pdfCell002.Border = 0
                pdfTable002.AddCell(pdfCell002)

            Next

            pdfDoc.Add(pdfTable002)


            '2. FAMILLES D'ARTICLES / MATIERES

            FillingListquery02 = "SELECT DISTINCT CODE_SOUS_FAMILLE FROM article, bordereaux, ligne_bordereaux WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "') AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND bordereaux.CODE_BORDEREAUX = @CODE_BORDEREAUX ORDER BY DATE_BORDEREAU DESC"

            Dim commandList02 As New MySqlCommand(FillingListquery02, GlobalVariable.connect)
            commandList02.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
            commandList02.Parameters.Add("@CODE_BORDEREAUX", MySqlDbType.VarChar).Value = CODE_BORDEREAUX

            Dim adapterList02 As New MySqlDataAdapter(commandList02)
            Dim tableListFamille As New DataTable()

            adapterList02.Fill(tableListFamille)

            If tableListFamille.Rows.Count > 0 Then

                '3- LISTES DES ARTICLES  (PAR MAGASIN ET PAR FAMILLE)

                For t = 0 To tableListFamille.Rows.Count - 1

                    GrandTotalAchat = 0

                    If True Then

                        totalAchat = 0

                        FillingListquery = "SELECT DISTINCT ligne_bordereaux.CODE_ARTICLE FROM `bordereaux`, ligne_bordereaux, article, magasin WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "') AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND bordereaux.CODE_BORDEREAUX=@CODE_BORDEREAUX AND article.CODE_SOUS_FAMILLE = @CODE_SOUS_FAMILLE ORDER BY ID_LIGNE_BORDEREAU DESC"

                        'article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE
                        ',  DESIGNATION_FR AS DESIGNATION

                        Dim commandList As New MySqlCommand(FillingListquery, GlobalVariable.connect)
                        commandList.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                        commandList.Parameters.Add("@CODE_SOUS_FAMILLE", MySqlDbType.VarChar).Value = tableListFamille.Rows(t)("CODE_SOUS_FAMILLE")
                        commandList.Parameters.Add("@CODE_BORDEREAUX", MySqlDbType.VarChar).Value = CODE_BORDEREAUX

                        Dim adapterList As New MySqlDataAdapter(commandList)
                        Dim articleList As New DataTable()

                        adapterList.Fill(articleList)

                        If articleList.Rows.Count > 0 Then

                            Dim p003 As Paragraph = New Paragraph(Chr(13) & "FAMILLE : " & tableListFamille.Rows(t)("CODE_SOUS_FAMILLE") & Chr(13) & Chr(13), pRow)
                            p003.Alignment = Element.ALIGN_LEFT

                            pdfDoc.Add(p003)

                            Dim pdfTable As New PdfPTable(6) 'Number of columns
                            pdfTable.TotalWidth = 555.0F
                            pdfTable.LockedWidth = True
                            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.HeaderRows = 1

                            Dim widths As Single() = New Single() {10.0F, 65.0F, 25.0F, 20.0F, 25.0F, 25.0F}

                            pdfTable.SetWidths(widths)

                            Dim pdfCell As PdfPCell = Nothing

                            pdfCell = New PdfPCell(New Paragraph("No", fontTotal1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 5

                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("DESIGNATION", fontTotal1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 5

                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("UNITE", fontTotal1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 5
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.Border = 0

                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("QTE", fontTotal1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 5
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.Border = 0

                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("PU", fontTotal1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 5
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.Border = 0

                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 5
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.Border = 0

                            pdfTable.AddCell(pdfCell)

                            For l = 0 To articleList.Rows.Count - 1

                                '----------------------------------------------

                                Dim FillingListquery03 As String = "SELECT `DATE_BORDEREAU` AS 'DATE',  DESIGNATION_FR AS 'DESIGNATION', NUM_SERIE_DEBUT AS 'UNITE', ligne_bordereaux.QUANTITE As 'QTE AVANT MOVT', QUANTITE_ENTREE_STOCK AS 'QTE EN MOVT', PRIX_UNITAIRE_HT AS 'PRIX UNITAIRE', PRIX_TOTAL_HT AS 'TOTAL' FROM `bordereaux`, ligne_bordereaux, article WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "') AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND article.CODE_SOUS_FAMILLE = @CODE_SOUS_FAMILLE AND ligne_bordereaux.CODE_ARTICLE =@CODE_ARTICLE AND bordereaux.CODE_BORDEREAUX = @CODE_BORDEREAUX ORDER BY ID_LIGNE_BORDEREAU DESC"

                                Dim commandList03 As New MySqlCommand(FillingListquery03, GlobalVariable.connect)
                                commandList03.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                                commandList03.Parameters.Add("@CODE_SOUS_FAMILLE", MySqlDbType.VarChar).Value = tableListFamille.Rows(t)("CODE_SOUS_FAMILLE")
                                commandList03.Parameters.Add("@CODE_ARTICLE", MySqlDbType.VarChar).Value = articleList.Rows(l)("CODE_ARTICLE")
                                commandList03.Parameters.Add("@CODE_BORDEREAUX", MySqlDbType.VarChar).Value = CODE_BORDEREAUX

                                Dim adapterList03 As New MySqlDataAdapter(commandList03)
                                Dim dt As New DataTable()

                                adapterList03.Fill(dt)

                                If dt.Rows.Count > 0 Then

                                    Dim qteTotal As Double = 0
                                    Dim montantTotal As Double = 0

                                    For m = 0 To dt.Rows.Count - 1
                                        qteTotal += dt.Rows(m)("QTE EN MOVT")
                                        montantTotal += dt.Rows(m)("TOTAL")
                                        totalAchat += dt.Rows(m)("TOTAL")
                                        GrandTotalAchat += dt.Rows(m)("TOTAL")
                                        totaux += dt.Rows(m)("TOTAL")
                                    Next

                                    pdfCell = New PdfPCell(New Paragraph(l + 1, font1))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 5

                                    pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(dt.Rows(0)("DESIGNATION"), font1))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfCell.MinimumHeight = 5

                                    pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(dt.Rows(0)("UNITE"), font1))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfCell.MinimumHeight = 5

                                    pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(qteTotal, "#,##0.0"), font1))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                    pdfCell.MinimumHeight = 5

                                    pdfTable.AddCell(pdfCell)

                                    If qteTotal > 0 Then
                                        pdfCell = New PdfPCell(New Paragraph(Format(montantTotal / qteTotal, "#,##0"), font1))
                                    Else
                                        pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(0)("PRIX UNITAIRE"), "#,##0"), font1))
                                    End If

                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                    pdfCell.MinimumHeight = 5

                                    pdfTable.AddCell(pdfCell)

                                    pdfCell = New PdfPCell(New Paragraph(Format(montantTotal, "#,##0"), font1))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                    pdfCell.MinimumHeight = 5

                                    pdfTable.AddCell(pdfCell)

                                End If
                                '----------------------------------------------

                            Next

                            pdfCell = New PdfPCell(New Paragraph("TOTAL : ", fontTotal))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 5
                            'pdfCell.PaddingLeft = 5.0F
                            pdfCell.Border = 0
                            pdfCell.Colspan = 4

                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(GrandTotalAchat, "#,##0") & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE"), fontTotal))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell.MinimumHeight = 5
                            pdfCell.Colspan = 2
                            pdfCell.Border = 0

                            pdfTable.AddCell(pdfCell)

                            pdfDoc.Add(pdfTable)

                        End If

                    End If

                Next

                Dim p0030 As Paragraph = New Paragraph(Chr(13) & "TOTAUX : " & Format(totaux, "#,##0") & " " & GlobalVariable.societe.Rows(0)("CODE_MONNAIE"), pRow)
                p0030.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p0030)


            End If

            '------------------------------------------------------- HISTORIQUES DES LISTES PASSES --------------------------------------------------------

            Dim GrandTotalAchat_ As Double = 0
            Dim totalAchat_ As Double = 0

            Dim date_1 As Date = dateDebut.AddDays(-7).ToShortDateString
            Dim date_2 As Date = dateDebut.AddDays(-1).ToShortDateString

            Dim p030 As Paragraph = New Paragraph(Chr(13) & "HISTORIQUES DU MARCHE " & date_1 & " AU " & date_2, pRow)
            p030.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p030)

            Dim FillingListquery02_ As String = "SELECT DISTINCT CODE_SOUS_FAMILLE FROM article, bordereaux, ligne_bordereaux WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "') AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND bordereaux.CODE_BORDEREAUX = @CODE_BORDEREAUX ORDER BY DATE_BORDEREAU DESC"

            Dim commandList02_ As New MySqlCommand(FillingListquery02_, GlobalVariable.connect)
            commandList02_.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
            commandList02_.Parameters.Add("@CODE_BORDEREAUX", MySqlDbType.VarChar).Value = CODE_BORDEREAUX

            Dim adapterList02_ As New MySqlDataAdapter(commandList02)
            Dim tableListFamille_ As New DataTable()

            adapterList02_.Fill(tableListFamille_)

            If tableListFamille_.Rows.Count > 0 Then

                '3- LISTES DES ARTICLES  (PAR MAGASIN ET PAR FAMILLE)

                For t = 0 To tableListFamille_.Rows.Count - 1

                    If True Then

                        totalAchat_ = 0

                        Dim FillingListquery_ As String = "SELECT DISTINCT ligne_bordereaux.CODE_ARTICLE FROM `bordereaux`, ligne_bordereaux, article WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "') AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND bordereaux.CODE_BORDEREAUX=@CODE_BORDEREAUX AND article.CODE_SOUS_FAMILLE = @CODE_SOUS_FAMILLE ORDER BY ID_LIGNE_BORDEREAU DESC"

                        'article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE
                        ',  DESIGNATION_FR AS DESIGNATION

                        Dim commandList_ As New MySqlCommand(FillingListquery_, GlobalVariable.connect)
                        commandList_.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                        commandList_.Parameters.Add("@CODE_SOUS_FAMILLE", MySqlDbType.VarChar).Value = tableListFamille_.Rows(t)("CODE_SOUS_FAMILLE")
                        commandList_.Parameters.Add("@CODE_BORDEREAUX", MySqlDbType.VarChar).Value = CODE_BORDEREAUX

                        Dim adapterList_ As New MySqlDataAdapter(commandList_)
                        Dim articleList_ As New DataTable()

                        adapterList_.Fill(articleList_)

                        If articleList_.Rows.Count > 0 Then

                            Dim p003 As Paragraph = New Paragraph(Chr(13) & "FAMILLE : " & tableListFamille_.Rows(t)("CODE_SOUS_FAMILLE") & Chr(13) & Chr(13), pRow)
                            p003.Alignment = Element.ALIGN_LEFT

                            pdfDoc.Add(p003)

                            Dim pdfTable As New PdfPTable(8) 'Number of columns
                            pdfTable.TotalWidth = 555.0F
                            pdfTable.LockedWidth = True
                            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfTable.HeaderRows = 1

                            Dim widths As Single() = New Single() {65.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F}

                            pdfTable.SetWidths(widths)

                            Dim pdfCell As PdfPCell = Nothing

                            pdfCell = New PdfPCell(New Paragraph("DESIGNATION", fontTotal1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfCell.MinimumHeight = 5

                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(date_1.ToShortDateString, fontTotal1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 5

                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(date_1.AddDays(1).ToShortDateString, fontTotal1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 5

                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(date_1.AddDays(2).ToShortDateString, fontTotal1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 5
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.Border = 0

                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(date_1.AddDays(3).ToShortDateString, fontTotal1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 5
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.Border = 0

                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(date_1.AddDays(4).ToShortDateString, fontTotal1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 5
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.Border = 0

                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(date_1.AddDays(5).ToShortDateString, fontTotal1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 5
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.Border = 0

                            pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(date_1.AddDays(6).ToShortDateString, fontTotal1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 5
                            'pdfCell.PaddingLeft = 5.0F
                            'pdfCell.Border = 0

                            pdfTable.AddCell(pdfCell)

                            For l = 0 To articleList_.Rows.Count - 1

                                '----------------------------------------------

                                Dim FillingListquery03_ As String = "SELECT `DATE_BORDEREAU` AS 'DATE',  DESIGNATION_FR AS 'DESIGNATION', NUM_SERIE_DEBUT AS 'UNITE', ligne_bordereaux.QUANTITE As 'QTE AVANT MOVT', QUANTITE_ENTREE_STOCK AS 'QTE EN MOVT', PRIX_UNITAIRE_HT AS 'PRIX UNITAIRE', PRIX_TOTAL_HT AS 'TOTAL' FROM `bordereaux`, ligne_bordereaux, article WHERE TYPE_BORDEREAUX IN ('" & TYPE_BORDEREAUX_1 & "') AND bordereaux.CODE_BORDEREAUX = ligne_bordereaux.CODE_BORDEREAUX AND article.CODE_ARTICLE = ligne_bordereaux.CODE_ARTICLE AND article.CODE_SOUS_FAMILLE = @CODE_SOUS_FAMILLE AND ligne_bordereaux.CODE_ARTICLE =@CODE_ARTICLE AND bordereaux.CODE_BORDEREAUX = @CODE_BORDEREAUX ORDER BY ID_LIGNE_BORDEREAU DESC"

                                Dim commandList03_ As New MySqlCommand(FillingListquery03_, GlobalVariable.connect)
                                commandList03_.Parameters.Add("@TYPE_BORDEREAUX_1", MySqlDbType.VarChar).Value = TYPE_BORDEREAUX_1
                                commandList03_.Parameters.Add("@CODE_SOUS_FAMILLE", MySqlDbType.VarChar).Value = tableListFamille_.Rows(t)("CODE_SOUS_FAMILLE")
                                commandList03_.Parameters.Add("@CODE_ARTICLE", MySqlDbType.VarChar).Value = articleList_.Rows(l)("CODE_ARTICLE")
                                commandList03_.Parameters.Add("@CODE_BORDEREAUX", MySqlDbType.VarChar).Value = CODE_BORDEREAUX

                                Dim adapterList03_ As New MySqlDataAdapter(commandList03_)
                                Dim dt_ As New DataTable()

                                adapterList03_.Fill(dt_)

                                If dt_.Rows.Count > 0 Then

                                    Dim qteTotal_ As Double = 0
                                    Dim montantTotal_ As Double = 0

                                    For m = 0 To dt_.Rows.Count - 1
                                        qteTotal_ += dt_.Rows(m)("QTE EN MOVT")
                                        montantTotal_ += dt_.Rows(m)("TOTAL")
                                        totalAchat_ += dt_.Rows(m)("TOTAL")
                                        GrandTotalAchat_ += dt_.Rows(m)("TOTAL")
                                    Next

                                    pdfCell = New PdfPCell(New Paragraph(dt_.Rows(0)("DESIGNATION"), font1))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfCell.MinimumHeight = 5

                                    pdfTable.AddCell(pdfCell)

                                    Dim CODE_ARTICLE As String = articleList_.Rows(l)("CODE_ARTICLE")

                                    Dim montant As Double = Functions.historiquesDuMarche(CODE_ARTICLE, date_1.ToShortDateString)

                                    If montant = 0 Then
                                        pdfCell = New PdfPCell(New Paragraph("", font1))
                                    Else
                                        pdfCell = New PdfPCell(New Paragraph(Format(montant, "#,##0"), font1))
                                    End If

                                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                    pdfCell.MinimumHeight = 5

                                    pdfTable.AddCell(pdfCell)

                                    montant = Functions.historiquesDuMarche(CODE_ARTICLE, date_1.AddDays(1).ToShortDateString)

                                    If montant = 0 Then
                                        pdfCell = New PdfPCell(New Paragraph("", font1))
                                    Else
                                        pdfCell = New PdfPCell(New Paragraph(Format(montant, "#,##0"), font1))
                                    End If

                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 5

                                    pdfTable.AddCell(pdfCell)

                                    montant = Functions.historiquesDuMarche(CODE_ARTICLE, date_1.AddDays(2).ToShortDateString)

                                    If montant = 0 Then
                                        pdfCell = New PdfPCell(New Paragraph("", font1))
                                    Else
                                        pdfCell = New PdfPCell(New Paragraph(Format(montant, "#,##0"), font1))
                                    End If

                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 5

                                    pdfTable.AddCell(pdfCell)

                                    montant = Functions.historiquesDuMarche(CODE_ARTICLE, date_1.AddDays(3).ToShortDateString)

                                    If montant = 0 Then
                                        pdfCell = New PdfPCell(New Paragraph("", font1))
                                    Else
                                        pdfCell = New PdfPCell(New Paragraph(Format(montant, "#,##0"), font1))
                                    End If

                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 5

                                    pdfTable.AddCell(pdfCell)

                                    montant = Functions.historiquesDuMarche(CODE_ARTICLE, date_1.AddDays(4).ToShortDateString)

                                    If montant = 0 Then
                                        pdfCell = New PdfPCell(New Paragraph("", font1))
                                    Else
                                        pdfCell = New PdfPCell(New Paragraph(Format(montant, "#,##0"), font1))
                                    End If
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 5

                                    pdfTable.AddCell(pdfCell)

                                    montant = Functions.historiquesDuMarche(CODE_ARTICLE, date_1.AddDays(5).ToShortDateString)

                                    If montant = 0 Then
                                        pdfCell = New PdfPCell(New Paragraph("", font1))
                                    Else
                                        pdfCell = New PdfPCell(New Paragraph(Format(montant, "#,##0"), font1))
                                    End If
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 5

                                    pdfTable.AddCell(pdfCell)

                                    montant = Functions.historiquesDuMarche(CODE_ARTICLE, date_1.AddDays(6).ToShortDateString)

                                    If montant = 0 Then
                                        pdfCell = New PdfPCell(New Paragraph("", font1))
                                    Else
                                        pdfCell = New PdfPCell(New Paragraph(Format(montant, "#,##0"), font1))
                                    End If
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                    pdfCell.MinimumHeight = 5

                                    pdfTable.AddCell(pdfCell)

                                End If
                                '----------------------------------------------

                            Next

                            pdfCell = New PdfPCell(New Paragraph("TOTAL : ", fontTotal))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 7
                            'pdfCell.PaddingLeft = 5.0F
                            pdfCell.Border = 0
                            pdfCell.Colspan = 4

                            'pdfTable.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(totalAchat_, "#,##0"), fontTotal))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            pdfCell.MinimumHeight = 5
                            'pdfCell.PaddingLeft = 5.0F
                            pdfCell.Border = 0

                            'pdfTable.AddCell(pdfCell)

                            pdfDoc.Add(pdfTable)

                        End If

                    End If

                Next

            End If

            '----------------------------------------------------------------------------------------------------------------------------------------------

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub headerPreview(ByVal model As Integer)

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim papierEnTete As DataTable = Functions.getElementByCode(GlobalVariable.AgenceActuelle.Rows(0)("CODE_AGENCE"), "papier_entete", "CODE_AGENCE")

        Dim tireDocument As String = "MODEL D'EN TETE"

        If model = 1 Then
            tireDocument = "LOGO SUR LE COIN AVEC BORDURES"
        ElseIf model = 0 Then
            tireDocument = "LOGO AU CENTRE"
        End If

        Dim titreFichier As String = "MODEL EN TETE"

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier

        '-----------------------------------------------------------------------------------------
        Dim document As New Document(PageSize.A4, 40, 40, 80, 40)
        Dim writer As PdfWriter = PdfWriter.GetInstance(document, New FileStream(sfd.FileName, FileMode.Create))
        Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
        Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
        Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
        Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 13, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

        Dim HeaderFont As New Font(iTextSharp.text.Font.FontFamily.COURIER, 22, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
        Dim font2 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
        Dim font4 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
        Dim font3 As New Font(iTextSharp.text.Font.FontFamily.TIMES_ROMAN, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)

        Dim pdfCell As PdfPCell = Nothing

        document.Open()

        Dim img() As Byte
        img = societe.Rows(0)("LOGO")

        Dim img2() As Byte
        img2 = papierEnTete.Rows(0)("IMAGE_2")

        Dim img1() As Byte
        img1 = papierEnTete.Rows(0)("IMAGE_1")

        Dim mStream As New MemoryStream(img)
        Dim mStream2 As New MemoryStream(img2)
        Dim mStream1 As New MemoryStream(img1)

        Dim logo As Image
        logo = Image.GetInstance(img)
        logo.ScalePercent(65.0F)

        Dim IMAGE_2 As Image
        IMAGE_2 = Image.GetInstance(img2)
        IMAGE_2.ScalePercent(18.0F)

        Dim IMAGE_1 As Image
        IMAGE_1 = Image.GetInstance(img1)
        IMAGE_1.ScalePercent(18.0F)

        Dim pHeader As New PdfPTable(1)
        pHeader.TotalWidth = Document.PageSize.Width
        pHeader.DefaultCell.Border = 0

        Dim pHeaderSubTitle As New PdfPTable(1)
        pHeaderSubTitle.TotalWidth = Document.PageSize.Width
        pHeaderSubTitle.DefaultCell.Border = 0

        Dim pHeaderSubTitle1 As New PdfPTable(1)
        pHeaderSubTitle1.TotalWidth = Document.PageSize.Width
        pHeaderSubTitle1.DefaultCell.Border = 0

        '-----------------------------------------------------------------------------------------

        If sfd.ShowDialog = 1 Then

            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)


            '---------------------------------------------------------------------------------------------------------------------------
            If model = 1 Then 'LOGO SUR LE COIN GAUCHE

                Dim pdfTable As New PdfPTable(3) 'Number of columns

                pdfTable.TotalWidth = Document.PageSize.Width
                pdfTable.LockedWidth = True
                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfTable.HeaderRows = 1

                Dim widths As Single() = New Single() {2.4F, 10.0F, 2.4F}
                pdfTable.SetWidths(widths)

                pdfCell = New PdfPCell(logo)
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Border = 0
                pdfCell.PaddingLeft = 15.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                Dim EN_TETE_L1 = papierEnTete.Rows(0)("EN_TETE_L1")
                Dim EN_TETE_L2 = papierEnTete.Rows(0)("EN_TETE_L2")
                Dim EN_TETE_L3 = papierEnTete.Rows(0)("EN_TETE_L3")
                Dim EN_TETE_L4 = papierEnTete.Rows(0)("EN_TETE_L4")
                Dim PIEDS_L1 = papierEnTete.Rows(0)("PIEDS_L1")
                Dim PIEDS_L2 = papierEnTete.Rows(0)("PIEDS_L2")
                Dim PIEDS_L3 = papierEnTete.Rows(0)("PIEDS_L3")

                Dim mtable As PdfPTable = New PdfPTable(1)
                mtable.WidthPercentage = 100
                mtable.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER

                pdfCell = New PdfPCell(New Paragraph(societe.Rows(0)("RAISON_SOCIALE"), HeaderFont))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0 'used to remove borders on the cells

                mtable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(EN_TETE_L1 & Chr(13), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0 'used to remove borders on the cells

                mtable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(EN_TETE_L2, font3))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0 'used to remove borders on the cells

                mtable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(EN_TETE_L3, font3))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0 'used to remove borders on the cells

                mtable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(EN_TETE_L4, font3))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0 'used to remove borders on the cells

                mtable.DefaultCell.BorderWidth = 0
                pdfTable.DefaultCell.BorderWidth = 0

                mtable.AddCell(pdfCell)

                pdfTable.AddCell(mtable)

                pdfCell = New PdfPCell(IMAGE_2)
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Border = 0
                pdfCell.PaddingRight = 15.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                If Document.PageNumber = 1 Then
                    pdfTable.AddCell(pdfCell)
                    pdfTable.WriteSelectedRows(0, -1, 0, Document.GetTop(Document.TopMargin) + 155, writer.DirectContent)
                Else
                    pdfTable.AddCell(pdfCell)
                End If
                '----------------------------------------------------------------------------------------------------------------------------------------------------------------

                If GlobalVariable.DocumentToGenerate = "situation caisse" Then
                    pdfCell = New PdfPCell(New Paragraph("               SIGNATURE DU CAISSIER                                               SIGNATURE DU COMPTABLE"))
                ElseIf GlobalVariable.DocumentToGenerate = "DST" Then
                    pdfCell = New PdfPCell(New Paragraph(""))
                ElseIf GlobalVariable.DocumentToGenerate = "reglement" Or GlobalVariable.DocumentToGenerate = "facture" Then
                    pdfCell = New PdfPCell(New Paragraph("               SIGNATURE DU CLIENT                                                    SIGNATURE DE L'HOTEL"))
                End If

                'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                'pdfCell.PaddingLeft = 15.0F
                'pdfCell.Border = 0

                'pFooterSign.AddCell(pdfCell)
                'pFooterSign.WriteSelectedRows(0, -1, 0, document.GetBottom(document.BottomMargin) + 45, writer.DirectContent)

                Dim pFooter As New PdfPTable(1)
                pFooter.TotalWidth = Document.PageSize.Width
                pdfCell.PaddingLeft = 15.0F
                pFooter.DefaultCell.Border = 0

                pdfCell = New PdfPCell(New Paragraph(PIEDS_L1, font4))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.PaddingLeft = 15.0F
                pdfCell.Border = 0
                pFooter.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(PIEDS_L2 & Chr(13) & PIEDS_L3 & Chr(13) & " TECHFLECTION LYTE " & GlobalVariable.DateDeTravail & "-" & Now().ToLongTimeString, font2))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.PaddingLeft = 15.0F
                pdfCell.Border = 0
                pFooter.AddCell(pdfCell)

                pFooter.WriteSelectedRows(0, -1, 0, 55, writer.DirectContent)

                Dim pFooterLeft As New PdfPTable(1)
                pFooterLeft.TotalWidth = Document.PageSize.Width
                pdfCell.PaddingLeft = 15.0F
                pFooterLeft.DefaultCell.Border = 0

                pdfCell = New PdfPCell(IMAGE_1)
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.PaddingLeft = 15.0F
                pdfCell.Border = 0
                pFooterLeft.AddCell(pdfCell)
                pFooterLeft.WriteSelectedRows(0, -1, 0, 95, writer.DirectContent)

            ElseIf model = 0 Then 'LOGO AU MILIEU

                Dim pdfTable As New PdfPTable(1) 'Number of columns

                pdfTable.TotalWidth = Document.PageSize.Width
                pdfTable.LockedWidth = True
                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                'pdfTable.HeaderRows = 1

                Dim widths As Single() = New Single() {10.0F}
                pdfTable.SetWidths(widths)

                pdfCell = New PdfPCell(logo)
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Border = 0
                pdfCell.PaddingLeft = 15.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                Dim EN_TETE_L1 = papierEnTete.Rows(0)("EN_TETE_L1")
                Dim EN_TETE_L2 = papierEnTete.Rows(0)("EN_TETE_L2")
                Dim EN_TETE_L3 = papierEnTete.Rows(0)("EN_TETE_L3")
                Dim EN_TETE_L4 = papierEnTete.Rows(0)("EN_TETE_L4")
                Dim PIEDS_L1 = papierEnTete.Rows(0)("PIEDS_L1")
                Dim PIEDS_L2 = papierEnTete.Rows(0)("PIEDS_L2")
                Dim PIEDS_L3 = papierEnTete.Rows(0)("PIEDS_L3")

                pdfCell = New PdfPCell(New Paragraph(societe.Rows(0)("RAISON_SOCIALE"), HeaderFont))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0 'used to remove borders on the cells
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(EN_TETE_L1 & Chr(13), font1))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0 'used to remove borders on the cells
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(EN_TETE_L2, font3))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0 'used to remove borders on the cells
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(EN_TETE_L3, font3))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0 'used to remove borders on the cells
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(EN_TETE_L4, font3))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0 'used to remove borders on the cells

                pdfTable.DefaultCell.BorderWidth = 0
                pdfTable.DefaultCell.BorderWidth = 0
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(IMAGE_2)
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.Border = 0
                pdfCell.PaddingRight = 15.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                If Document.PageNumber = 1 Then
                    pdfTable.AddCell(pdfCell)
                    pdfTable.WriteSelectedRows(0, -1, 0, Document.GetTop(Document.TopMargin) + 155, writer.DirectContent)
                Else
                    pdfTable.AddCell(pdfCell)
                End If
                '----------------------------------------------------------------------------------------------------------------------------------------------------------------

                Dim pFooterSign As New PdfPTable(1)
                pFooterSign.TotalWidth = Document.PageSize.Width
                'pdfCell.PaddingLeft = 15.0F
                pFooterSign.DefaultCell.Border = 0

                If GlobalVariable.DocumentToGenerate = "situation caisse" Then
                    pdfCell = New PdfPCell(New Paragraph("               SIGNATURE DU CAISSIER                                               SIGNATURE DU COMPTABLE"))
                ElseIf GlobalVariable.DocumentToGenerate = "DST" Then
                    pdfCell = New PdfPCell(New Paragraph(""))
                ElseIf GlobalVariable.DocumentToGenerate = "reglement" Or GlobalVariable.DocumentToGenerate = "facture" Then
                    pdfCell = New PdfPCell(New Paragraph("               SIGNATURE DU CLIENT                                                    SIGNATURE DE L'HOTEL"))
                End If

                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.PaddingLeft = 15.0F
                pdfCell.Border = 0

                pFooterSign.AddCell(pdfCell)
                pFooterSign.WriteSelectedRows(0, -1, 0, Document.GetBottom(Document.BottomMargin) + 45, writer.DirectContent)

                Dim pFooter As New PdfPTable(1)
                pFooter.TotalWidth = Document.PageSize.Width
                pdfCell.PaddingLeft = 15.0F
                pFooter.DefaultCell.Border = 0

                pdfCell = New PdfPCell(New Paragraph(PIEDS_L1, font4))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.PaddingLeft = 15.0F
                pdfCell.Border = 0
                pFooter.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(PIEDS_L2 & Chr(13) & PIEDS_L3 & Chr(13) & " TECHFLECTION LYTE " & GlobalVariable.DateDeTravail & "-" & Now().ToLongTimeString, font2))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.PaddingLeft = 15.0F
                pdfCell.Border = 0
                pFooter.AddCell(pdfCell)

                pFooter.WriteSelectedRows(0, -1, 0, 55, writer.DirectContent)

            End If
            '---------------------------------------------------------------------------------------------------------------------------

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            document.Add(p10)

            document.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub

    Structure ResumeProductiviteReceptionnistes
        Dim ordre As Integer
        Dim receptionnistes As String
        Dim nombreDeNuitee As Integer
        Dim prixMoyen As Double
        Dim CA As Double
    End Structure

    Public Shared Sub productiviteReceptionnistes(ByVal dateDebut As Date, ByVal dateFin As Date)

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        tireDocument = "PRODUCTIVITE DES RECEPTIONNISTES DU " & dateDebut.ToShortDateString & " AU " & dateFin.ToShortDateString
        titreFichier = "PRODUCTIVITE DES RECEPTIONNISTES "

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (dateDebut.ToString("ddMMyyHmss") & " " & dateFin.ToString("ddMMyyHmss"))

        If sfd.ShowDialog = 1 Then

            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 40, 80, 60)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 13, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            '---------------------------- SELECTION DES DIFFERENTS CAISSIER SUR LA PERIODE ------------------------------

            '1- SELECTION DES DIFFERENTES PERSONNES AYANT EFFECTUES DES CHECKINS
            ': COMPTOIR
            ': 
            Dim recepyion As String = "SELECT DISTINCT CHECKIN_PAR FROM suivi_des_reservations WHERE DATE_DE_CONTROLE BETWEEN '" & dateDebut.ToString("yyyy-MM-dd hh:mm:ss") & "' AND '" & dateFin.ToString("yyyy-MM-dd hh:mm:ss") & "' ORDER BY CHECKIN_PAR ASC"
            'Dim recepyion As String = "SELECT DISTINCT CHECKIN_PAR FROM suivi_des_reservations ORDER BY CHECKIN_PAR ASC"
            Dim command As New MySqlCommand(recepyion, GlobalVariable.connect)
            Dim adapter As New MySqlDataAdapter
            Dim table_ As New DataTable()

            adapter.SelectCommand = command
            adapter.Fill(table_)

            If table_.Rows.Count > 0 Then

                Dim resumeProductivte(table_.Rows.Count - 1) As ResumeProductiviteReceptionnistes

                Dim ordre As Integer = 0

                For k = 0 To table_.Rows.Count - 1

                    Dim pdfTable4 As New PdfPTable(9) 'Number of columns
                    pdfTable4.TotalWidth = 765.0F
                    pdfTable4.LockedWidth = True
                    pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable4.HeaderRows = 1

                    Dim widths4 As Single() = New Single() {4.0F, 10.0F, 25.0F, 8.0F, 8.0F, 7.0F, 12.0F, 12.0F, 12.0F}
                    pdfTable4.SetWidths(widths4)

                    Dim pdfCell As PdfPCell = Nothing

                    Dim CHECKIN_PAR As String = table_.Rows(k)("CHECKIN_PAR")

                    If Not CHECKIN_PAR.Equals("") Then

                        Dim totalAffiche As Double = 0
                        Dim totalAccorde As Double = 0
                        Dim totalNuitee As Integer = 0
                        'Dim totalNuitee As Integer = 0

                        '2- SELECTION DES RESERVATIONS DONT LA DATE EST ENTRE LES PLAGE DE DATE, CREE PAR UN RECEPTIONNISTE ET DONT LA SOURCE EST COMPTOIR OU WALKIN
                        '---------------------------------------------------------------------------------------------------------------------------------

                        Dim infoSupReceptionniste As DataTable = Functions.getElementByCode(CHECKIN_PAR, "utilisateurs", "CODE_UTILISATEUR")

                        Dim NOM_RECEPTIONNISTE As String = ""
                        If infoSupReceptionniste.Rows.Count > 0 Then
                            NOM_RECEPTIONNISTE = infoSupReceptionniste.Rows(0)("NOM_UTILISATEUR").ToString.ToUpper
                        End If

                        Dim query4 As String = "SELECT CHAMBRE_ID AS 'CHAMBRE', NOM_CLIENT As 'NOM & PRENOM', DATE_ENTTRE As 'DATE ARRIVEE', HEURE_ENTREE, HEURE_SORTIE, 
                        DATE_SORTIE As 'DATE DEPART', source_reservation.SOURCE_RESERVATION AS SOURCE, reserve_conf.CODE_RESERVATION, MONTANT_ACCORDE, TYPE_CHAMBRE 
                        FROM reserve_conf, source_reservation, suivi_des_reservations 
                        WHERE DATE_ENTTRE <= '" & dateFin.ToString("yyyy-MM-dd") & "' AND DATE_ENTTRE >='" & dateDebut.ToString("yyyy-MM-dd") & "' AND DAY_USE = 0 AND reserve_conf.TYPE=@TYPE AND 
                        reserve_conf.SOURCE_RESERVATION = source_reservation.CODE_SOURCE_RESERVATION AND reserve_conf.SOURCE_RESERVATION IN ('SR136310821141135','SR1363108211411350') 
                        AND CHECKIN_PAR =@CHECKIN_PAR AND reserve_conf.CODE_RESERVATION = suivi_des_reservations.CODE_RESERVATION ORDER BY DATE_ENTTRE ASC"

                        Dim command4 As New MySqlCommand(query4, GlobalVariable.connect)
                        command4.Parameters.Add("@TYPE", MySqlDbType.VarChar).Value = "chambre"
                        command4.Parameters.Add("@CHECKIN_PAR", MySqlDbType.VarChar).Value = CHECKIN_PAR

                        Dim adapter4 As New MySqlDataAdapter(command4)
                        Dim dt As New DataTable()
                        adapter4.Fill(dt)

                        If dt.Rows.Count > 0 Then

                            resumeProductivte(ordre).ordre = ordre + 1
                            resumeProductivte(ordre).receptionnistes = NOM_RECEPTIONNISTE

                            ordre += 1

                            Dim p14 As Paragraph = New Paragraph(Chr(13) & ordre & " *\ RESERVATIONS PRISES PAR " & NOM_RECEPTIONNISTE & Chr(13) & Chr(13))
                            p14.Alignment = Element.ALIGN_LEFT
                            pdfDoc.Add(p14)

                            pdfCell = New PdfPCell(New Paragraph("N°", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable4.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("N° CH.", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable4.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM ", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable4.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("ARRIVEE ", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable4.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("DEPART ", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable4.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("NUITEE", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable4.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("TARIF AFFICHE", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable4.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("TARIF ACCORDE", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable4.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("CA", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable4.AddCell(pdfCell)

                            Dim nombreDeLigne As Integer

                            For i = 0 To dt.Rows.Count - 1

                                Dim totalPrixAffiche As Double = 0
                                Dim totalMontantAccorde As Double = 0
                                Dim tarifAffiche As Double = 0

                                nombreDeLigne = dt.Rows.Count

                                pdfCell = New PdfPCell(New Paragraph(i + 1, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfTable4.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(i)("CHAMBRE"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfTable4.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(i)("NOM & PRENOM"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfTable4.AddCell(pdfCell)

                                Dim dateEntree As Date = dt.Rows(i)("DATE ARRIVEE")
                                Dim dateDepart As Date = dt.Rows(i)("DATE DEPART")

                                Dim nombreDeNuitee As Integer = DateDiff(DateInterval.Day, dateEntree, dateDepart)
                                totalNuitee += nombreDeNuitee

                                pdfCell = New PdfPCell(New Paragraph(CDate(dt.Rows(i)("DATE ARRIVEE")).ToShortDateString, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfTable4.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(CDate(dt.Rows(i)("DATE DEPART")).ToShortDateString, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfTable4.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(nombreDeNuitee, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfTable4.AddCell(pdfCell)

                                Dim TYPE_CHAMBRE As String = dt.Rows(i)("type_chambre")
                                Dim CODE_RESERVATION As String = dt.Rows(i)("CODE_RESERVATION")

                                Dim infoSupChambre As DataTable = Functions.GetAllElementsOnCondition(TYPE_CHAMBRE, "type_chambre", "CODE_TYPE_CHAMBRE")

                                If infoSupChambre.Rows.Count > 0 Then
                                    tarifAffiche = infoSupChambre.Rows(0)("PRIX")
                                End If

                                pdfCell = New PdfPCell(New Paragraph(Format(tarifAffiche, "#,##0"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfTable4.AddCell(pdfCell)

                                totalAffiche += tarifAffiche * nombreDeNuitee

                                pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i)("MONTANT_ACCORDE"), "#,##0"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfTable4.AddCell(pdfCell)

                                totalAccorde += dt.Rows(i)("MONTANT_ACCORDE") * nombreDeNuitee ' totalMontantAccorde

                                pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i)("MONTANT_ACCORDE") * nombreDeNuitee, "#,##0"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F
                                pdfTable4.AddCell(pdfCell)

                            Next

                            pdfCell = New PdfPCell(New Paragraph("", pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.Colspan = 5
                            pdfCell.Border = 0
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable4.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(totalNuitee, "#,##0"), pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable4.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph("", pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.Border = 0
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable4.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(totalAccorde / nombreDeLigne, "#,##0"), pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable4.AddCell(pdfCell)

                            pdfCell = New PdfPCell(New Paragraph(Format(totalAccorde, "#,##0"), pColumn))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F
                            pdfTable4.AddCell(pdfCell)

                            resumeProductivte(ordre - 1).nombreDeNuitee = totalNuitee
                            resumeProductivte(ordre - 1).prixMoyen = totalAccorde / nombreDeLigne
                            resumeProductivte(ordre - 1).CA = totalAccorde

                        End If

                        pdfDoc.Add(pdfTable4)

                    End If

                Next

                Dim p1401 As Paragraph = New Paragraph(Chr(13) & Chr(13) & " RECAPITULATIF " & Chr(13) & Chr(13))
                p1401.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p1401)

                Dim pdfTable4_ As New PdfPTable(5) 'Number of columns
                pdfTable4_.TotalWidth = 765.0F
                pdfTable4_.LockedWidth = True
                pdfTable4_.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable4_.HeaderRows = 1

                Dim widths4_ As Single() = New Single() {10.0F, 30, 15.0F, 25.0F, 25.0F}
                pdfTable4_.SetWidths(widths4_)

                Dim pdfCell_ As PdfPCell = Nothing

                pdfCell_ = New PdfPCell(New Paragraph("No", pColumn))
                pdfCell_.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell_.MinimumHeight = 15
                pdfCell_.PaddingLeft = 5.0F
                pdfTable4_.AddCell(pdfCell_)

                pdfCell_ = New PdfPCell(New Paragraph("RECEPTIONNISTE", pColumn))
                pdfCell_.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell_.MinimumHeight = 15
                pdfCell_.PaddingLeft = 5.0F
                pdfTable4_.AddCell(pdfCell_)

                pdfCell_ = New PdfPCell(New Paragraph("NUITEES", pColumn))
                pdfCell_.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell_.MinimumHeight = 15
                pdfCell_.PaddingLeft = 5.0F
                pdfTable4_.AddCell(pdfCell_)

                pdfCell_ = New PdfPCell(New Paragraph("PRIX MOYEN", pColumn))
                pdfCell_.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell_.MinimumHeight = 15
                pdfCell_.PaddingLeft = 5.0F
                pdfTable4_.AddCell(pdfCell_)

                pdfCell_ = New PdfPCell(New Paragraph("CHIFFRES D'AFFAIRES", pColumn))
                pdfCell_.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell_.MinimumHeight = 15
                pdfCell_.PaddingLeft = 5.0F
                pdfTable4_.AddCell(pdfCell_)

                Dim totalNuiteeResume As Integer = 0
                Dim totalCAResume As Double = 0

                For k = 0 To resumeProductivte.Count - 1

                    If Not Trim(resumeProductivte(k).receptionnistes).Equals("") Then

                        pdfCell_ = New PdfPCell(New Paragraph(resumeProductivte(k).ordre, pColumn))
                        pdfCell_.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell_.MinimumHeight = 15
                        pdfCell_.PaddingLeft = 5.0F
                        pdfTable4_.AddCell(pdfCell_)

                        pdfCell_ = New PdfPCell(New Paragraph(resumeProductivte(k).receptionnistes, pColumn))
                        pdfCell_.HorizontalAlignment = Element.ALIGN_LEFT
                        pdfCell_.MinimumHeight = 15
                        pdfCell_.PaddingLeft = 5.0F
                        pdfTable4_.AddCell(pdfCell_)

                        totalNuiteeResume += resumeProductivte(k).nombreDeNuitee

                        pdfCell_ = New PdfPCell(New Paragraph(Format(resumeProductivte(k).nombreDeNuitee, "#,##0"), pColumn))
                        pdfCell_.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell_.MinimumHeight = 15
                        pdfCell_.PaddingLeft = 5.0F
                        pdfTable4_.AddCell(pdfCell_)

                        pdfCell_ = New PdfPCell(New Paragraph(Format(resumeProductivte(k).prixMoyen, "#,##0"), pColumn))
                        pdfCell_.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell_.MinimumHeight = 15
                        pdfCell_.PaddingLeft = 5.0F
                        pdfTable4_.AddCell(pdfCell_)

                        totalCAResume += resumeProductivte(k).CA

                        pdfCell_ = New PdfPCell(New Paragraph(Format(resumeProductivte(k).CA, "#,##0"), pColumn))
                        pdfCell_.HorizontalAlignment = Element.ALIGN_RIGHT
                        pdfCell_.MinimumHeight = 15
                        pdfCell_.PaddingLeft = 5.0F
                        pdfTable4_.AddCell(pdfCell_)

                    End If

                Next

                pdfCell_ = New PdfPCell(New Paragraph("", pColumn))
                pdfCell_.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell_.MinimumHeight = 15
                pdfCell_.Colspan = 2
                pdfCell_.PaddingLeft = 5.0F
                pdfTable4_.AddCell(pdfCell_)

                pdfCell_ = New PdfPCell(New Paragraph(Format(totalNuiteeResume, "#,##0"), pColumn))
                pdfCell_.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell_.MinimumHeight = 15
                pdfCell_.PaddingLeft = 5.0F
                pdfTable4_.AddCell(pdfCell_)

                pdfCell_ = New PdfPCell(New Paragraph("", pColumn))
                pdfCell_.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell_.MinimumHeight = 15
                pdfCell_.PaddingLeft = 5.0F
                pdfTable4_.AddCell(pdfCell_)

                pdfCell_ = New PdfPCell(New Paragraph(Format(totalCAResume, "#,##0"), pColumn))
                pdfCell_.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell_.MinimumHeight = 15
                pdfCell_.PaddingLeft = 5.0F
                pdfTable4_.AddCell(pdfCell_)

                pdfDoc.Add(pdfTable4_)

                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Process.Start(sfd.FileName)

            End If

        End If

    End Sub

    Public Shared Sub verificationDesSoldes(ByVal dt As DataGridView, ByVal dateDebut As Date)

        'Dim DateDebut As Date = GlobalVariable.DateDeTravail.ToString("yyyy-MM-dd")

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        If GlobalVariable.actualLanguageValue = 1 Then
            tireDocument = "VERIFICATION DES SOLDES " & " DU " & dateDebut.ToShortDateString & " " & Now().ToLongTimeString
            titreFichier = "VERIFICATION DES SOLDES "
        Else
            tireDocument = "BALANCE VERIFICATION " & " OF THE " & dateDebut.ToShortDateString & " " & Now().ToLongTimeString
            titreFichier = "BALANCE VERIFICATION "
        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then
            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 13, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            Dim pdfTable4 As New PdfPTable(10) 'Number of columns
            pdfTable4.TotalWidth = 765.0F
            pdfTable4.LockedWidth = True
            pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable4.HeaderRows = 1

            Dim widths4 As Single() = New Single() {6.0F, 30.0F, 8.0F, 8.0F, 7.0F, 9.0F, 8.0F, 8.0F, 10.0F, 16.0F}
            pdfTable4.SetWidths(widths4)

            pdfCell = New PdfPCell(New Paragraph("N°", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            If GlobalVariable.actualLanguageValue = 1 Then

                pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ARRIVEE ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEPART ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NUITEE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TARIF ACCORDE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEBIT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CREDIT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("SOLDE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("SOURCE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

            Else

                pdfCell = New PdfPCell(New Paragraph("NAMES ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ARRIVAL ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEPART ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NIGHTS", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("GRANTED AMOUNT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEBIT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CREDIT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BALANCE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("SOURCE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

            End If


            If dt.Rows.Count > 0 Then

                For i = 0 To dt.Rows.Count - 1

                    For j = 0 To dt.Columns.Count - 1

                        'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        If j = 4 Then
                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j = 5 Or j = 6 Or j = 7 Or j = 8 Then
                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j = 0 Then
                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value.ToString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        Else
                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value.ToString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        End If



                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable4.AddCell(pdfCell)
                    Next

                Next

                pdfDoc.Add(pdfTable4)

            End If

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub ecartDesPrix(ByVal dt As DataGridView, ByVal dateDebut As Date)

        'Dim DateDebut As Date = GlobalVariable.DateDeTravail.ToString("yyyy-MM-dd")

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        tireDocument = "ECARTS TARIFAIRES " & " DU " & dateDebut.ToShortDateString & " " & Now().ToLongTimeString
        titreFichier = "ECARTS TARIFAIRES "

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then
            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 13, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            Dim pdfTable4 As New PdfPTable(11) 'Number of columns
            pdfTable4.TotalWidth = 780.0F
            pdfTable4.LockedWidth = True
            pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable4.HeaderRows = 1

            Dim widths4 As Single() = New Single() {8.0F, 8.0F, 30.0F, 8.0F, 8.0F, 7.0F, 9.0F, 8.0F, 8.0F, 8.0F, 16.0F}
            pdfTable4.SetWidths(widths4)

            pdfCell = New PdfPCell(New Paragraph("N° CH.", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("TYPE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM ", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("ARRIVEE ", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("DEPART ", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("NUITEE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("TARIF DE BASE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("TARIF ACCORDE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("ECART", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph(" % ", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            pdfCell = New PdfPCell(New Paragraph("SOURCE", pColumn))
            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
            pdfCell.MinimumHeight = 15
            pdfCell.PaddingLeft = 5.0F
            'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
            pdfTable4.AddCell(pdfCell)

            If dt.Rows.Count > 0 Then

                For i = 0 To dt.Rows.Count - 1

                    For j = 0 To dt.Columns.Count - 1

                        If j = 4 Then
                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j = 5 Or j = 8 Or j = 7 Then
                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells(j).Value, "#,##0"), pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                        ElseIf j = 6 Then
                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells(j).Value, "#,##0"), pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j = 9 Then
                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value.ToString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j = 0 Then
                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value.ToString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        Else
                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value.ToString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        End If

                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable4.AddCell(pdfCell)

                    Next

                Next

                pdfDoc.Add(pdfTable4)

            End If

            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)

        End If

    End Sub

    Public Shared Sub DocumentToPrintDSTResa(ByVal dt As DataGridView, ByVal DateDebut As Date, ByVal DateFin As Date, ByVal filtre As Integer)

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        Dim DateDST As String = ""

        If DateDebut = DateFin Then
            DateDST = DateDebut.ToShortDateString
        Else
            DateDST = DateDebut.ToShortDateString & " AU " & DateFin.ToShortDateString
        End If

        Dim filtreTExt As String = ""

        If GlobalVariable.actualLanguageValue = 1 Then
            If filtre = 0 Then
                filtreTExt = "LISTE DES RESERVATIONS"
            ElseIf filtre = 1 Then
                filtreTExt = "LISTE DES CHECK IN"
            ElseIf filtre = 2 Then
                filtreTExt = "LISTE DES CHECK OUT"
            ElseIf filtre = 3 Then
                filtreTExt = "LISTE DES SEJOURS"
            ElseIf filtre = 4 Then
                filtreTExt = "LISTE DES NO SHOW"
            End If
        Else
            If filtre = 0 Then
                filtreTExt = "RESERVATIONS LIST"
            ElseIf filtre = 1 Then
                filtreTExt = "CHECKED IN"
            ElseIf filtre = 2 Then
                filtreTExt = "CHECKED OUT"
            ElseIf filtre = 3 Then
                filtreTExt = "IN HOUSE"
            ElseIf filtre = 4 Then
                filtreTExt = "NO SHOW"
            End If
        End If

        If GlobalVariable.DocumentToGenerate = "evenements" Then

            If GlobalVariable.actualLanguageValue = 1 Then
                tireDocument = "LISTE DES EVENEMENTS " & Chr(13) & " DU " & DateDST & " " & Now().ToLongTimeString
                titreFichier = "EVENEMENTS "
            Else
                tireDocument = "LISTE DES EVENEMENTS " & Chr(13) & " OF " & DateDST & " " & Now().ToLongTimeString
                titreFichier = "EVENTS "
            End If

        Else

            If GlobalVariable.actualLanguageValue = 1 Then
                tireDocument = filtreTExt & Chr(13) & " DU " & DateDST & " " & Now().ToLongTimeString
                titreFichier = filtreTExt & "RESERVATIONS "
            Else
                tireDocument = filtreTExt & Chr(13) & " OF " & DateDST & " " & Now().ToLongTimeString
                titreFichier = filtreTExt & "RESERVATIONS "
            End If

        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then
            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 13, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            If GlobalVariable.DocumentToGenerate = "reservations" Then

                Dim pdfCell As PdfPCell = Nothing

                pdfWrite.PageEvent = New HeaderFooter

                pdfDoc.Open()

                Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13))
                p10.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p10)

                Dim pdfTable4 As New PdfPTable(11) 'Number of columns
                pdfTable4.TotalWidth = 780.0F
                pdfTable4.LockedWidth = True
                pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable4.HeaderRows = 1

                Dim widths4 As Single() = New Single() {5.0F, 6.0F, 18.0F, 7.0F, 7.0F, 8.0F, 8.0F, 11.0F, 12.0F, 4.0F, 12.0F}
                pdfTable4.SetWidths(widths4)

                pdfCell = New PdfPCell(New Paragraph("N° CH.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("TYPE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("NOM & PRENOM ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ARRIVEE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DEPART", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)


                pdfCell = New PdfPCell(New Paragraph("MONTANT ACCORDE ", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("SOLDE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("RESA", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("STATUT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAX", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("SOURCE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                If dt.Rows.Count > 0 Then

                    For i = 0 To dt.Rows.Count - 1

                        For j = 0 To dt.Columns.Count - 1

                            'pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            If j = 5 Or j = 6 Then
                                pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells(j).Value, "#,##0"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            ElseIf j = 3 Or j = 4 Then
                                pdfCell = New PdfPCell(New Paragraph(CDate(dt.Rows(i).Cells(j).Value).ToShortDateString, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            ElseIf j = 7 Then
                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value.ToString, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            Else
                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value.ToString, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            End If

                            If j = 1 Or j = 2 Then
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            End If

                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F

                            pdfTable4.AddCell(pdfCell)
                        Next

                    Next

                    pdfDoc.Add(pdfTable4)

                End If

                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Process.Start(sfd.FileName)


            End If

        End If

    End Sub

    Public Shared Sub DocumentToPrintDSTBlocNOte(ByVal dt As DataGridView, ByVal DateDebut As Date, ByVal DateFin As Date, ByVal filtre As Integer)

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        Dim DateDST As String = ""

        If DateDebut = DateFin Then
            DateDST = DateDebut.ToShortDateString
        Else
            DateDST = DateDebut.ToShortDateString & " AU " & DateFin.ToShortDateString
        End If

        Dim filtreTExt As String = ""

        If GlobalVariable.actualLanguageValue = 1 Then
            If filtre = 0 Then
                filtreTExt = "LISTE DES VENTES COMPTOIR"
            ElseIf filtre = 1 Then
                filtreTExt = "LISTE DES TRANSFERTS EN CHAMBRE"
            ElseIf filtre = 2 Then
                filtreTExt = "LISTE DES OFFRES"
            ElseIf filtre = 3 Then
                filtreTExt = "LISTE DES TRANSFERT VERS COMPTES"
            ElseIf filtre = 4 Then
                filtreTExt = "LISTE DES BLOC NOTES"
            ElseIf filtre = 5 Then
                filtreTExt = "LISTE VENTES EN SALLE"
            End If

            tireDocument = filtreTExt & Chr(13) & " DU " & DateDST & " " & Now().ToLongTimeString

        Else
            If filtre = 0 Then
                filtreTExt = "SALES OF WALK IN"
            ElseIf filtre = 1 Then
                filtreTExt = "SALES TRANSFERED TO ROOMS"
            ElseIf filtre = 2 Then
                filtreTExt = "SALES OFFERED"
            ElseIf filtre = 3 Then
                filtreTExt = "SALES TRANSFERED TO DEBTOR ACCOUNT"
            ElseIf filtre = 5 Then
                filtreTExt = "SALES OF EVENTS"
            ElseIf filtre = 4 Then
                filtreTExt = "LIST OF RECEIPTS"
            End If

            tireDocument = filtreTExt & Chr(13) & " OF THE " & DateDST & " " & Now().ToLongTimeString

        End If


        titreFichier = filtreTExt

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then

            Dim MONTANT_TOTAL As Double = 0

            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4, 45, 40, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 9, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 13, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            If filtre = 4 Then

                Dim pdfTable4 As New PdfPTable(5) 'Number of columns
                pdfTable4.TotalWidth = 540.0F
                pdfTable4.LockedWidth = True
                pdfTable4.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable4.HeaderRows = 1

                Dim widths4 As Single() = New Single() {6.0F, 10.0F, 10.0F, 10.0F, 25.0F}
                pdfTable4.SetWidths(widths4)

                pdfCell = New PdfPCell(New Paragraph("No", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BLOC NOTE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("MONTANT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("STATUT", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CAISSIER", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable4.AddCell(pdfCell)

                If dt.Rows.Count > 0 Then

                    For i = 0 To dt.Rows.Count - 1

                        pdfCell = Nothing

                        pdfCell = New PdfPCell(New Paragraph(i + 1, pRow))
                        pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        pdfCell.MinimumHeight = 15
                        pdfCell.PaddingLeft = 5.0F

                        pdfTable4.AddCell(pdfCell)

                        For j = 0 To dt.Columns.Count - 1

                            If j = 0 Then

                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value.ToString, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            ElseIf j = 1 Then
                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT

                                MONTANT_TOTAL += dt.Rows(i).Cells(j).Value

                            ElseIf j = 2 Then
                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value.ToString, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            ElseIf j = 3 Then
                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value.ToString, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            Else
                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value.ToString, pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            End If

                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F

                            pdfTable4.AddCell(pdfCell)

                        Next

                    Next

                    pdfCell = New PdfPCell(New Paragraph("TOTAL : ", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F

                    pdfTable4.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(MONTANT_TOTAL, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.Border = 0
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable4.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pRow))
                    pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                    pdfCell.Colspan = 2
                    pdfCell.Border = 0
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F

                    pdfTable4.AddCell(pdfCell)

                    pdfDoc.Add(pdfTable4)

                End If

            Else


                For l = 0 To dt.Rows.Count - 1

                    Dim NUMERO_BLOC_NOTE As String = ""

                    If GlobalVariable.actualLanguageValue = 0 Then
                        NUMERO_BLOC_NOTE = dt.Rows(l).Cells("RECEIPT NUMBER").Value.ToString
                    Else
                        NUMERO_BLOC_NOTE = dt.Rows(l).Cells("NUMERO BLOC NOTE").Value.ToString
                    End If

                    Dim caissier As New Caisse()
                    Dim MOTNANT As Double = 0
                    Dim UTILISATEUR As String = ""
                    Dim dt_ As DataTable
                    Dim CODE_RESERVATION As String = ""
                    Dim CODE_CAISSIER As String = ""

                    Dim infoSupBlocNOte As New DataTable
                    infoSupBlocNOte = Functions.getElementByCode(NUMERO_BLOC_NOTE, "ligne_facture_bloc_note", "NUMERO_BLOC_NOTE")

                    If infoSupBlocNOte.Rows.Count > 0 Then

                        CODE_RESERVATION = infoSupBlocNOte.Rows(0)("CODE_RESERVATION")
                        MOTNANT = infoSupBlocNOte.Rows(0)("MONTANT_BLOC_NOTE")
                        CODE_CAISSIER = infoSupBlocNOte.Rows(0)("CODE_CAISSIER")

                    End If

                    Dim infoSupCaissier As DataTable

                    If filtre = 1 Then
                        dt_ = caissier.LigneDunBlocNoteQuelconquePartantDuNumResa(CODE_RESERVATION, NUMERO_BLOC_NOTE)
                    Else
                        dt_ = caissier.LigneDunBlocNoteQuelconque(NUMERO_BLOC_NOTE)
                    End If

                    infoSupCaissier = Functions.getElementByCode(CODE_CAISSIER, "utilisateurs", "CODE_UTILISATEUR")

                    Dim NOM_UTILISATEUR As String = ""

                    If infoSupCaissier.Rows.Count > 0 Then
                        NOM_UTILISATEUR = infoSupCaissier.Rows(0)("NOM_UTILISATEUR")
                    End If

                    Dim p10_ As Paragraph = New Paragraph(Chr(13) & l + 1 & "-/ " & NUMERO_BLOC_NOTE & " ( " & Format(MOTNANT, "#,##0") & " ) " & " [" & NOM_UTILISATEUR & "]" & Chr(13) & Chr(13))
                    p10_.Alignment = Element.ALIGN_LEFT
                    pdfDoc.Add(p10_)

                    Dim pdfTable04 As New PdfPTable(5) 'Number of columns
                    pdfTable04.TotalWidth = 540.0F
                    pdfTable04.LockedWidth = True
                    pdfTable04.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable04.HeaderRows = 1

                    Dim widths04 As Single() = New Single() {5.0F, 50.0F, 8.0F, 9.0F, 9.0F}
                    pdfTable04.SetWidths(widths04)

                    pdfCell = New PdfPCell(New Paragraph("No", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable04.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("ARTICLE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable04.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("QTE", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable04.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("PU", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable04.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable04.AddCell(pdfCell)

                    If dt_.Rows.Count > 0 Then

                        For i = 0 To dt_.Rows.Count - 1

                            pdfCell = New PdfPCell(New Paragraph(i + 1, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfCell.PaddingLeft = 5.0F

                            pdfTable04.AddCell(pdfCell)

                            If GlobalVariable.actualLanguageValue = 0 Then

                                pdfCell = New PdfPCell(New Paragraph(dt_.Rows(i)("ITEM"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F

                                pdfTable04.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(dt_.Rows(i)("QUANTITY"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F

                                pdfTable04.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(dt_.Rows(i)("UNIT PRICE"), "#,##0"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F

                                pdfTable04.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(dt_.Rows(i)("TOTAL AMOUNT"), "#,##0"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                MONTANT_TOTAL += dt_.Rows(i)("TOTAL AMOUNT")
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F

                            ElseIf GlobalVariable.actualLanguageValue = 1 Then

                                pdfCell = New PdfPCell(New Paragraph(dt_.Rows(i)("LIBELLE ARTICLE"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F

                                pdfTable04.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(dt_.Rows(i)("QUANTITE"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F

                                pdfTable04.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(dt_.Rows(i)("PU"), "#,##0"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F

                                pdfTable04.AddCell(pdfCell)

                                pdfCell = New PdfPCell(New Paragraph(Format(dt_.Rows(i)("MONTANT TOTAL"), "#,##0"), pRow))
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                                MONTANT_TOTAL += dt_.Rows(i)("MONTANT TOTAL")
                                pdfCell.MinimumHeight = 15
                                pdfCell.PaddingLeft = 5.0F

                            End If

                            pdfTable04.AddCell(pdfCell)

                        Next

                        pdfDoc.Add(pdfTable04)

                    End If

                Next

                Dim p010_ As Paragraph = New Paragraph(Chr(13) & " TOTAL : " & Format(MONTANT_TOTAL, "#,##0") & Chr(13) & Chr(13))
                p010_.Alignment = Element.ALIGN_RIGHT
                pdfDoc.Add(p010_)

            End If


            pdfDoc.Close()

            MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Process.Start(sfd.FileName)


        End If

    End Sub

    Public Shared Sub impressionEconomatBarRestautant(ByVal dt As DataGridView, ByVal title As String)

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0

        Dim tireDocument As String = title.ToUpper() & " DU " & (Date.Now().ToString("ddMMyyHHmmss"))

        Dim sousTitreDocument As String = ""
        Dim totalVente As Double = 0
        sousTitreDocument = tireDocument

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4, 40, 20, 80, 40)
            'Dim pdfDoc As New Document(PageSize.A4, 40, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 20, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p3 As Paragraph = New Paragraph(Chr(13) & title.ToUpper() & " DU " & " " & GlobalVariable.DateDeTravail & Chr(13) & Chr(13), pRow)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            If title.Contains("INVENTAIRE") Then

                Dim CODE_MAGASIN As String = GlobalVariable.magasinActuel
                Dim LIBELLE_MAGASIN As String = ""
                Dim infoSupMagasin As DataTable = Functions.getElementByCode(CODE_MAGASIN, "magasin", "CODE_MAGASIN")

                If infoSupMagasin.Rows.Count > 0 Then
                    LIBELLE_MAGASIN = infoSupMagasin.Rows(0)("LIBELLE_MAGASIN")
                End If

                Dim p03 As Paragraph = New Paragraph("MAGASIN : " & LIBELLE_MAGASIN & Chr(13) & Chr(13), pRow)
                p03.Alignment = Element.ALIGN_LEFT

                pdfDoc.Add(p03)

                Dim pdfTable As New PdfPTable(5) 'Number of columns
                pdfTable.TotalWidth = 555.0F
                pdfTable.LockedWidth = True
                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable.HeaderRows = 1

                'Dim widths As Single() = New Single() {25.0F, 25.0F, 25.0F, 25.0F, 25.0F, 25.0F, 25.0F, 25.0F}
                Dim widths As Single() = New Single() {15.0F, 60.0F, 15.0F, 15.0F, 15.0F}

                pdfTable.SetWidths(widths)

                Dim pdfCell As PdfPCell = Nothing

                pdfCell = New PdfPCell(New Paragraph("REF.", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DESIGNATION", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("QTE EN STOCK", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("QTE PHYSIQUE", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("COUT DU STOCK", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                'pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                Dim qteAcorrigerAffichage As Double
                Dim QTE As Double =0
                Dim CODE_ARTICLE As String = ""

                For j = 0 To dt.Rows.Count - 1

                    For k = 0 To dt.Columns.Count - 1

                        CODE_ARTICLE = dt.Rows(j).Cells(0).Value.ToString 'DES RANGEES DIFFERENTES MAIS TOUJOURS LA MEME COLONNE

                        If k = 2 Or k = 4 Then

                            qteAcorrigerAffichage = Functions.affichageQteDansUnFormatCorrect(CODE_ARTICLE, dt.Rows(j).Cells(k).Value)

                            If k = 2 Then
                                pdfCell = New PdfPCell(New Paragraph(qteAcorrigerAffichage, font1))
                            Else
                                pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(j).Cells(k).Value, "#,##0"), font1))
                            End If

                        ElseIf k = 3 Then
                            pdfCell = New PdfPCell(New Paragraph("", font1))
                        Else
                            pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells(k).Value.ToString, font1))
                        End If

                        If k = 0 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        ElseIf k = 1 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                        ElseIf k = 2 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf k = 3 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf k = 4 Then
                            pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            totalVente += dt.Rows(j).Cells(k).Value
                        End If

                        pdfCell.MinimumHeight = 5

                        pdfTable.AddCell(pdfCell)

                    Next

                Next

                pdfCell = New PdfPCell(New Paragraph("TOTAL", fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0
                pdfCell.Colspan = 4

                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(totalVente, "#,##0"), fontTotal))
                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfCell.MinimumHeight = 5
                'pdfCell.PaddingLeft = 5.0F
                pdfCell.Border = 0

                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

                pdfDoc.Close()

                MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                Process.Start(sfd.FileName)

            End If

        End If

    End Sub

    Public Shared Sub TauxOccupationPeriodique(ByVal dt As DataGridView, ByVal dateMainCouranteDebut As Date, ByVal dateMainCouranteFin As Date)

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        If GlobalVariable.actualLanguageValue = 1 Then
            titreFichier = "TAUX D'OCCUPATION "
            tireDocument = titreFichier & Chr(13) & " DU " & dateMainCouranteDebut & " AU " & dateMainCouranteFin
        Else
            titreFichier = "PERIODIC OCCUPANCY RATE "
            tireDocument = titreFichier & Chr(13) & " OF " & dateMainCouranteDebut & " AU " & dateMainCouranteFin
        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then

            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4, 20, 20, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim nbreDeColonne As Integer = dt.Columns.Count

            Dim pdfTable As New PdfPTable(nbreDeColonne + 1) 'Number of columns
            pdfTable.TotalWidth = 560.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single()

            If nbreDeColonne = 2 Then
                widths = New Single() {10.0F, 120.0F, 120.0F}
            ElseIf nbreDeColonne = 3 Then
                widths = New Single() {50.0F, 110.0F, 110.0F, 110.0F}
            ElseIf nbreDeColonne = 4 Then
                widths = New Single() {50.0F, 100.0F, 100.0F, 100.0F, 100.0F}
            ElseIf nbreDeColonne = 5 Then
                widths = New Single() {50.0F, 90.0F, 90.0F, 90.0F, 90.0F, 90.0F}
            ElseIf nbreDeColonne = 6 Then
                widths = New Single() {65.0F, 80.0F, 80.0F, 80.0F, 80.0F, 80.0F, 80.0F}
            ElseIf nbreDeColonne = 7 Then
                widths = New Single() {60.0F, 70.0F, 70.0F, 70.0F, 70.0F, 70.0F, 70.0F, 70.0F}
            End If

            pdfTable.SetWidths(widths)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            Dim table_ As DataTable = Functions.GetAllElementsOnCondition("chambre", "type_chambre", "TYPE")

            Dim k = 0 'index de la colonne taxe de sejours

            Dim vertiTaxe As Double = 0

            If True Then

                pdfCell = New PdfPCell(New Paragraph("DATE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                Dim nomDeColonne As String = ""

                For i = 0 To table_.Rows.Count - 1

                    nomDeColonne = table_.Rows(i)("LIBELLE_TYPE_CHAMBRE")

                    pdfCell = New PdfPCell(New Paragraph(nomDeColonne, pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                Next

                If GlobalVariable.actualLanguageValue = 1 Then
                    pdfCell = New PdfPCell(New Paragraph("CUMUL", pColumn))
                Else
                    pdfCell = New PdfPCell(New Paragraph("AVER.", pColumn))
                End If

                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

            End If

            Dim totalTOJ_1 As Double = 0
            Dim totalTOJ_2 As Double = 0
            Dim totalTOJ_3 As Double = 0
            Dim totalTOJ_4 As Double = 0
            Dim totalTOJ_5 As Double = 0
            Dim totalTOJ_6 As Double = 0

            Dim nobreResa As Integer = 0

            Dim ChiffresAffaires As Double = 0

            Dim cumulTotal As Double = 0

            If dt.Rows.Count > 0 Then

                nobreResa = dt.Rows.Count

                Dim cumul As Double = 0

                For i = 0 To dt.Rows.Count - 1

                    cumul = 0

                    For j = 0 To dt.Columns.Count - 1

                        If j = 0 Then
                            pdfCell = New PdfPCell(New Paragraph(CDate(dt.Rows(i).Cells(j).Value.ToString).ToShortDateString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j > 0 Then
                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells(j).Value, "#,##0.00") & " %", pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        End If

                        pdfTable.AddCell(pdfCell)

                        If j = 1 Then
                            totalTOJ_1 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 2 Then
                            totalTOJ_2 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 3 Then
                            totalTOJ_3 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 4 Then
                            totalTOJ_4 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 5 Then
                            totalTOJ_5 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 6 Then
                            totalTOJ_6 += dt.Rows(i).Cells(j).Value
                        End If

                        If j > 0 Then
                            cumul += dt.Rows(i).Cells(j).Value
                        End If

                    Next

                    cumulTotal += cumul / (dt.Columns.Count - 1)

                    'CUMUL GLOBAL DERNIERE COLONNE DE DROITE

                    pdfCell = New PdfPCell(New Paragraph(Format(cumul / (dt.Columns.Count - 1), "#,##0.00") & " %", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                Next

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                Dim CumulGlobal As Double = 0

                For i = 0 To table_.Rows.Count - 1

                    If i = 0 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(totalTOJ_1 / dt.Rows.Count, "#,##0.00") & " %", pColumn))
                    ElseIf i = 1 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(totalTOJ_2 / dt.Rows.Count, "#,##0.00") & " %", pColumn))
                    ElseIf i = 2 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(totalTOJ_3 / dt.Rows.Count, "#,##0.00") & " %", pColumn))
                    ElseIf i = 3 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(totalTOJ_4 / dt.Rows.Count, "#,##0.00") & " %", pColumn))
                    ElseIf i = 4 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(totalTOJ_5 / dt.Rows.Count, "#,##0.00") & " %", pColumn))
                    ElseIf i = 5 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(totalTOJ_6 / dt.Rows.Count, "#,##0.00") & " %", pColumn))
                    End If

                    'CumulGlobal = (totalTOJ_1 + totalTOJ_2 + totalTOJ_3 + totalTOJ_4 + totalTOJ_5 + totalTOJ_6) / dt.Rows.Count

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                Next

                'CELLULE MENSUELLE DU MOIS
                pdfCell = New PdfPCell(New Paragraph(Format(cumulTotal / dt.Rows.Count, "#,##0.00") & " %", pColumn))

                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

                pdfDoc.Close()

                If GlobalVariable.actualLanguageValue = 1 Then
                    MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Else
                    MessageBox.Show("PDF successfully exported " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                End If

                Process.Start(sfd.FileName)

            Else

                MessageBox.Show("Aucune Ligne de Fatcure à imprimer!")

            End If

        End If

    End Sub

    Public Shared Sub PrixMoyenPeriodique(ByVal dt As DataGridView, ByVal dateMainCouranteDebut As Date, ByVal dateMainCouranteFin As Date)

        'CHAMBRE', NUM_RESERVATION As 'RESERVATION', MONTANT_ACCORDE AS 'MONTANT',BAR_RESTAURANT AS 'BAR/RESTAURANT', SERVICES,SALON_DE_BEAUTE AS 'SALON DE BEAUTE', BOUTIQE AS 'BOUTIQUE', CYBERCAFE, AUTRES

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        If GlobalVariable.actualLanguageValue = 1 Then

            titreFichier = "PRIX MOYENS "
            tireDocument = titreFichier & Chr(13) & " DU " & dateMainCouranteDebut & " AU " & dateMainCouranteFin

        Else
            titreFichier = "AVERAGE PRICES "
            tireDocument = titreFichier & Chr(13) & " OF " & dateMainCouranteDebut & " AU " & dateMainCouranteFin

        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then

            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4, 20, 20, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim nbreDeColonne As Integer = dt.Columns.Count

            Dim pdfTable As New PdfPTable(nbreDeColonne + 1) 'Number of columns
            pdfTable.TotalWidth = 560.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single()

            If nbreDeColonne = 2 Then
                widths = New Single() {10.0F, 120.0F, 120.0F}
            ElseIf nbreDeColonne = 3 Then
                widths = New Single() {50.0F, 110.0F, 110.0F, 110.0F}
            ElseIf nbreDeColonne = 4 Then
                widths = New Single() {50.0F, 100.0F, 100.0F, 100.0F, 100.0F}
            ElseIf nbreDeColonne = 5 Then
                widths = New Single() {50.0F, 90.0F, 90.0F, 90.0F, 90.0F, 90.0F}
            ElseIf nbreDeColonne = 6 Then
                widths = New Single() {65.0F, 80.0F, 80.0F, 80.0F, 80.0F, 80.0F, 80.0F}
            ElseIf nbreDeColonne = 7 Then
                widths = New Single() {60.0F, 70.0F, 70.0F, 70.0F, 70.0F, 70.0F, 70.0F, 70.0F}
            End If

            pdfTable.SetWidths(widths)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            Dim table_ As DataTable = Functions.GetAllElementsOnCondition("chambre", "type_chambre", "TYPE")

            Dim k = 0 'index de la colonne taxe de sejours

            Dim vertiTaxe As Double = 0

            If True Then

                pdfCell = New PdfPCell(New Paragraph("DATE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                Dim nomDeColonne As String = ""

                For i = 0 To table_.Rows.Count - 1

                    nomDeColonne = table_.Rows(i)("LIBELLE_TYPE_CHAMBRE")

                    pdfCell = New PdfPCell(New Paragraph(nomDeColonne, pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    'pdfCell.Rotation = 270
                    pdfCell.PaddingLeft = 5.0F
                    'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                    pdfTable.AddCell(pdfCell)

                Next

                If GlobalVariable.actualLanguageValue = 1 Then
                    pdfCell = New PdfPCell(New Paragraph("CUMUL", pColumn))
                Else
                    pdfCell = New PdfPCell(New Paragraph("AVER.", pColumn))
                End If

                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

            End If

            Dim totalPVM_1 As Double = 0
            Dim totalPVM_2 As Double = 0
            Dim totalPVM_3 As Double = 0
            Dim totalPVM_4 As Double = 0
            Dim totalPVM_5 As Double = 0
            Dim totalPVM_6 As Double = 0

            Dim nobreResa As Integer = 0

            Dim ChiffresAffaires As Double = 0

            Dim cumulTotal As Double = 0

            If dt.Rows.Count > 0 Then

                nobreResa = dt.Rows.Count

                Dim cumul As Double = 0

                For i = 0 To dt.Rows.Count - 1

                    cumul = 0

                    For j = 0 To dt.Columns.Count - 1

                        If j = 0 Then
                            pdfCell = New PdfPCell(New Paragraph(CDate(dt.Rows(i).Cells(j).Value.ToString).ToShortDateString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j > 0 Then
                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells(j).Value, "#,##0"), pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        End If

                        pdfTable.AddCell(pdfCell)

                        If j = 1 Then
                            totalPVM_1 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 2 Then
                            totalPVM_2 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 3 Then
                            totalPVM_3 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 4 Then
                            totalPVM_4 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 5 Then
                            totalPVM_5 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 6 Then
                            totalPVM_6 += dt.Rows(i).Cells(j).Value
                        End If

                        If j > 0 Then
                            cumul += dt.Rows(i).Cells(j).Value
                        End If

                    Next

                    cumulTotal += cumul / (dt.Columns.Count - 1)

                    pdfCell = New PdfPCell(New Paragraph(Format(cumul / (dt.Columns.Count - 1), "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                Next

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                Dim CumulGlobal As Double = 0

                For i = 0 To table_.Rows.Count - 1

                    If i = 0 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(totalPVM_1 / dt.Rows.Count, "#,##0"), pColumn))
                    ElseIf i = 1 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(totalPVM_2 / dt.Rows.Count, "#,##0"), pColumn))
                    ElseIf i = 2 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(totalPVM_3 / dt.Rows.Count, "#,##0"), pColumn))
                    ElseIf i = 3 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(totalPVM_4 / dt.Rows.Count, "#,##0"), pColumn))
                    ElseIf i = 4 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(totalPVM_5 / dt.Rows.Count, "#,##0"), pColumn))
                    ElseIf i = 5 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(totalPVM_6 / dt.Rows.Count, "#,##0"), pColumn))
                    End If

                    CumulGlobal = (totalPVM_1 + totalPVM_2 + totalPVM_3 + totalPVM_4 + totalPVM_5 + totalPVM_6) / dt.Rows.Count

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                Next

                pdfCell = New PdfPCell(New Paragraph(Format(cumulTotal / dt.Rows.Count, "#,##0"), pColumn))

                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

                pdfDoc.Close()

                If GlobalVariable.actualLanguageValue = 1 Then
                    MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Else
                    MessageBox.Show("PDF successfully exported " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                End If

                Process.Start(sfd.FileName)

            Else

                MessageBox.Show("Aucune Ligne de Fatcure à imprimer!")

            End If

        End If

    End Sub

    Public Shared Sub planningPersonnel(ByVal dt As DataTable, ByVal dt_ As DataTable)

        Dim societe As DataTable = Functions.allTableFields("societe")

        Dim TotalCommande As Double = 0

        Dim title As String = "PLANNING "
        Dim tireDocument As String = title.ToUpper() & " DU " & CDate(dt_.Rows(0)("DATE_DEBUT")).ToString("ddMMyy") & " AU " & CDate(dt_.Rows(0)("DATE_FIN")).ToString("ddMMyy")
        ' Dim tireDocument As String = title.ToUpper() & " DU " & Date.Now().ToString("ddMMyyHHmmss")

        Dim sousTitreDocument As String = ""

        sousTitreDocument = tireDocument

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        'sfd.FileName = titreFichier & nomClient & " " & (Date.Now().ToString("ddMMyyHHmmss"))
        sfd.FileName = tireDocument

        If sfd.ShowDialog = 1 Then

            Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 20, 80, 40)
            'Dim pdfDoc As New Document(PageSize.A4, 40, 5, 5, 5)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 20, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 10, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 10, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()


            Dim DateDebut As Date = dt_.Rows(0)("DATE_DEBUT")
            Dim DateFin As Date = dt_.Rows(0)("DATE_FIN")

            Dim p3 As Paragraph
            p3 = New Paragraph(Chr(13) & title.ToUpper() & " DU " & " " & DateDebut & " AU " & DateFin & Chr(13) & Chr(13), pRow)
            p3.Alignment = Element.ALIGN_CENTER

            pdfDoc.Add(p3)

            If dt.Rows.Count > 0 Then

                Dim query01 As String = "SELECT * FROM  type_personnel WHERE CODE_TYPE_PERSONNEL = @CODE_TYPE_PERSONNEL "

                Dim command01 As New MySqlCommand(query01, GlobalVariable.connect)
                command01.Parameters.Add("@CODE_TYPE_PERSONNEL", MySqlDbType.VarChar).Value = dt.Rows(0)("CODE_TYPE_PERSONNEL")

                Dim adapter01 As New MySqlDataAdapter(command01)
                Dim planningHebdomadaire01 As New DataTable()
                adapter01.Fill(planningHebdomadaire01)

                If planningHebdomadaire01.Rows.Count > 0 Then

                    Dim p3_ As Paragraph
                    p3_ = New Paragraph(Chr(13) & planningHebdomadaire01.Rows(0)("LIBELLE_TYPE_PERSONNEL").ToUpper() & Chr(13) & Chr(13), pColumn)
                    p3_.Alignment = Element.ALIGN_LEFT

                    pdfDoc.Add(p3_)

                End If

                Dim pdfTable As New PdfPTable(8) 'Number of columns
                    pdfTable.TotalWidth = 800.0F
                    pdfTable.LockedWidth = True
                    pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfTable.HeaderRows = 1

                    Dim widths As Single() = New Single() {50.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F}

                    pdfTable.SetWidths(widths)

                    Dim pdfCell As PdfPCell = Nothing

                    Dim debit As Double = 0
                    Dim credit As Double = 0
                    Dim solde As Double = 0

                    pdfCell = New PdfPCell(New Paragraph("NOMS & PRENOMS ", fontTotal))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfTable.AddCell(pdfCell)

                    Dim nombreDeJour As Integer = DateDiff(DateInterval.Day, DateDebut, DateFin)

                    'COLUMNS

                    For k = 0 To nombreDeJour

                        If k < 7 Then

                            pdfCell = New PdfPCell(New Paragraph(DateDebut.AddDays(k).ToString("ddd d MMM"), fontTotal))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            pdfCell.MinimumHeight = 15
                            pdfTable.AddCell(pdfCell)

                        End If

                    Next

                    Dim dateDuJour As Date

                    For j = 0 To dt.Rows.Count - 1

                        Dim infoSupPersonnel As DataTable = Functions.getElementByCode(dt.Rows(j)("CODE_PERSONNEL"), "personnel", "CODE_PERSONNEL")

                        If infoSupPersonnel.Rows.Count > 0 Then

                            pdfCell = New PdfPCell(New Paragraph(infoSupPersonnel.Rows(0)("NOM_PERSONNEL") & " " & infoSupPersonnel.Rows(0)("PRENOM_PERSONNEL"), font1))
                            pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            pdfCell.MinimumHeight = 15
                            pdfTable.AddCell(pdfCell)

                        End If

                        Dim HEURE_DEBUT_FIN As String = ""

                        For k = 0 To nombreDeJour

                            If k < 7 Then

                                HEURE_DEBUT_FIN = ""

                                dateDuJour = DateDebut.AddDays(k).ToShortDateString

                                'Dim query04 As String = "SELECT `HEURE_DEBUT`, `HEURE_FIN`, DATE_DEBUT, DATE_FIN, HEURE_DEBUT_FIN, planning_hebdomadaire_horaire.CODE_PLANNING
                                'FROM `planning_horaire`, `planning_hebdomadaire_horaire`, planning_horaire_personnel
                                'WHERE planning_horaire.CODE_PLANNING=@CODE_PLANNING AND planning_hebdomadaire_horaire.ID_HORAIRE =planning_horaire.ID_HORAIRE 
                                'AND planning_horaire.CODE_PLANNING = @CODE_PLANNING AND planning_horaire_personnel.CODE_TYPE_PERSONNEL = @CODE_TYPE_PERSONNEL"

                                Dim query04 As String = "SELECT `HEURE_DEBUT`, `HEURE_FIN`, DATE_DEBUT, DATE_FIN, HEURE_DEBUT_FIN, planning_hebdomadaire_horaire.CODE_PLANNING 
                            FROM `planning_horaire`, `planning_hebdomadaire_horaire` 
                                WHERE planning_horaire.CODE_PLANNING=@CODE_PLANNING AND planning_hebdomadaire_horaire.ID_HORAIRE =planning_horaire.ID_HORAIRE 
                                    AND DATE_DEBUT <= '" & dateDuJour.ToString("yyyy-MM-dd") & "' AND DATE_FIN >='" & dateDuJour.ToString("yyyy-MM-dd") & "'"

                                Dim command04 As New MySqlCommand(query04, GlobalVariable.connect)
                                'command04.Parameters.Add("@ETAT", MySqlDbType.Int64).Value = ETAT_HORAIRE_PLANNINg
                                command04.Parameters.Add("@CODE_PLANNING", MySqlDbType.VarChar).Value = dt.Rows(j)("CODE_PLANNING")
                                'command04.Parameters.Add("@CODE_TYPE_PERSONNEL", MySqlDbType.VarChar).Value = dt.Rows(j)("CODE_TYPE_PERSONNEL")

                                Dim adapter04 As New MySqlDataAdapter(command04)
                                Dim horraireAffectesAuxPlannings As New DataTable()
                                adapter04.Fill(horraireAffectesAuxPlannings)

                                If horraireAffectesAuxPlannings.Rows.Count > 0 Then

                                    For p = 0 To horraireAffectesAuxPlannings.Rows.Count - 1

                                        'SI LA DATE ACTUEL SE TROUVE DANS L'INTERVALE PERIODIQUE LE MONTANT A AFFICHER DOIT ETRE CELUI DE L'INTERVALE
                                        'disponibilite_tarif_specifique_periodique

                                        Dim DATE_DEBUT As Date = CDate(horraireAffectesAuxPlannings.Rows(p)("DATE_DEBUT")).ToShortDateString
                                        Dim DATE_FIN As Date = CDate(horraireAffectesAuxPlannings.Rows(p)("DATE_FIN")).ToShortDateString

                                        If DATE_DEBUT.ToString("yyyy-MM-dd") <= dateDuJour.ToString("yyyy-MM-dd") And DATE_FIN.ToString("yyyy-MM-dd") >= dateDuJour.ToString("yyyy-MM-dd") Then

                                            pdfCell = New PdfPCell(New Paragraph(horraireAffectesAuxPlannings.Rows(p)("HEURE_DEBUT_FIN"), font1))

                                            pdfCell.MinimumHeight = 15

                                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                                            pdfTable.AddCell(pdfCell)

                                        End If


                                    Next

                                Else

                                    pdfCell = New PdfPCell(New Paragraph("-", font1))
                                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER

                                    pdfTable.AddCell(pdfCell)

                                End If

                            End If

                        Next

                    Next

                    pdfDoc.Add(pdfTable)

                    '------------------------------------------------------------------------

                    pdfDoc.Close()

                    MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)

                    Process.Start(sfd.FileName)

                End If

            End If

    End Sub


    Public Shared Sub VenteNetHebermentNuits(ByVal dt As DataGridView, ByVal dateMainCouranteDebut As Date, ByVal dateMainCouranteFin As Date)

        'CHAMBRE', NUM_RESERVATION As 'RESERVATION', MONTANT_ACCORDE AS 'MONTANT',BAR_RESTAURANT AS 'BAR/RESTAURANT', SERVICES,SALON_DE_BEAUTE AS 'SALON DE BEAUTE', BOUTIQE AS 'BOUTIQUE', CYBERCAFE, AUTRES

        Dim societe As DataTable = Functions.allTableFields("societe")
        Dim TotalFacture As Double = 0

        Dim tireDocument As String = ""
        Dim titreFichier As String = ""

        If GlobalVariable.actualLanguageValue = 1 Then

            titreFichier = "RAPPORTS HEBERGEMENT "
            tireDocument = titreFichier & Chr(13) & " DU " & dateMainCouranteDebut & " AU " & dateMainCouranteFin

        Else
            titreFichier = "REPORT ON ACCOMMODATION "
            tireDocument = titreFichier & Chr(13) & " OF " & dateMainCouranteDebut & " AU " & dateMainCouranteFin

        End If

        Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

        sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

        If sfd.ShowDialog = 1 Then

            'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
            Dim pdfDoc As New Document(PageSize.A4, 20, 20, 80, 40)
            Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
            Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
            Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
            Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 7, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

            Dim nbreDeColonne As Integer = dt.Columns.Count

            Dim pdfTable As New PdfPTable(nbreDeColonne + 2) 'Number of columns
            pdfTable.TotalWidth = 560.0F
            pdfTable.LockedWidth = True
            pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
            pdfTable.HeaderRows = 1

            Dim widths As Single()

            If nbreDeColonne = 3 Then
                widths = New Single() {50.0F, 110.0F, 110.0F, 110.0F, 110.0F}
            ElseIf nbreDeColonne = 5 Then
                widths = New Single() {50.0F, 90.0F, 90.0F, 90.0F, 90.0F, 90.0F, 90.0F}
            ElseIf nbreDeColonne = 7 Then
                widths = New Single() {60.0F, 70.0F, 70.0F, 70.0F, 70.0F, 70.0F, 70.0F, 70.0F, 70.0F}
            ElseIf nbreDeColonne = 9 Then
                widths = New Single() {55.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F}
            ElseIf nbreDeColonne = 11 Then
                widths = New Single() {60.0F, 60.0F, 40.0F, 60.0F, 40.0F, 60.0F, 40.0F, 60.0F, 40.0F, 60.0F, 40.0F, 60.0F, 60.0F}
            ElseIf nbreDeColonne = 13 Then
                widths = New Single() {50.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F}
            ElseIf nbreDeColonne = 15 Then
                widths = New Single() {50.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F}
            ElseIf nbreDeColonne = 17 Then
                widths = New Single() {50.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F, 60.0F}
            End If

            pdfTable.SetWidths(widths)

            Dim pdfCell As PdfPCell = Nothing

            pdfWrite.PageEvent = New HeaderFooter

            pdfDoc.Open()

            Dim p10 As Paragraph = New Paragraph(Chr(13) & Chr(13) & tireDocument & Chr(13) & Chr(13))
            p10.Alignment = Element.ALIGN_CENTER
            pdfDoc.Add(p10)

            Dim table_ As DataTable = Functions.GetAllElementsOnCondition("chambre", "type_chambre", "TYPE")

            Dim k = 0 'index de la colonne taxe de sejours

            Dim vertiTaxe As Double = 0

            If True Then

                pdfCell = New PdfPCell(New Paragraph("DATE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                'pdfCell.Rotation = 270
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                Dim nomDeColonne As String = ""

                For i = 0 To table_.Rows.Count - 1

                    nomDeColonne = table_.Rows(i)("CODE_TYPE_CHAMBRE")

                    pdfCell = New PdfPCell(New Paragraph(nomDeColonne, pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    If GlobalVariable.actualLanguageValue = 1 Then
                        pdfCell = New PdfPCell(New Paragraph("No", pColumn))
                    Else
                        pdfCell = New PdfPCell(New Paragraph("No.", pColumn))
                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                Next

                If GlobalVariable.actualLanguageValue = 1 Then
                    pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                Else
                    pdfCell = New PdfPCell(New Paragraph("TOTAL.", pColumn))
                End If

                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                If GlobalVariable.actualLanguageValue = 1 Then
                    pdfCell = New PdfPCell(New Paragraph("# NUITS", pColumn))
                Else
                    pdfCell = New PdfPCell(New Paragraph("# NIGHTS", pColumn))
                End If

                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

            End If

            Dim montantService_1 As Double = 0
            Dim montantService_2 As Double = 0
            Dim montantService_3 As Double = 0
            Dim montantService_4 As Double = 0
            Dim montantService_5 As Double = 0
            Dim montantService_6 As Double = 0
            Dim montantService_7 As Double = 0
            Dim montantService_8 As Double = 0
            Dim montantService_9 As Double = 0
            Dim montantService_10 As Double = 0
            Dim montantService_11 As Double = 0
            Dim montantService_12 As Double = 0

            Dim nights_1 As Integer = 0
            Dim nights_2 As Integer = 0
            Dim nights_3 As Integer = 0
            Dim nights_4 As Integer = 0
            Dim nights_5 As Integer = 0
            Dim nights_6 As Integer = 0
            Dim nights_7 As Integer = 0
            Dim nights_8 As Integer = 0
            Dim nights_9 As Integer = 0
            Dim nights_10 As Integer = 0
            Dim nights_11 As Integer = 0
            Dim nights_12 As Integer = 0

            Dim nobreResa As Integer = 0

            Dim ChiffresAffaires As Double = 0

            Dim cumulTotal As Double = 0
            Dim cumulTotal_nights As Double = 0

            If dt.Rows.Count > 0 Then

                nobreResa = dt.Rows.Count

                Dim cumul As Double = 0
                Dim cumul_nights As Integer = 0

                For i = 0 To dt.Rows.Count - 1

                    cumul_nights = 0
                    cumul = 0

                    For j = 0 To dt.Columns.Count - 1

                        If j = 0 Then
                            pdfCell = New PdfPCell(New Paragraph(CDate(dt.Rows(i).Cells(j).Value.ToString).ToShortDateString, pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        ElseIf j > 0 Then
                            pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells(j).Value, "#,##0"), pRow))
                            pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                        End If

                        pdfTable.AddCell(pdfCell)

                        If j = 1 Then
                            montantService_1 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 2 Then
                            nights_1 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 3 Then
                            montantService_2 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 4 Then
                            nights_2 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 5 Then
                            montantService_3 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 6 Then
                            nights_3 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 7 Then
                            montantService_4 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 8 Then
                            nights_4 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 9 Then
                            montantService_5 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 10 Then
                            nights_5 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 11 Then
                            montantService_6 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 12 Then
                            nights_6 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 13 Then
                            montantService_7 += dt.Rows(i).Cells(j).Value
                        ElseIf j = 14 Then
                            nights_7 += dt.Rows(i).Cells(j).Value
                        End If

                        If j > 0 Then

                            If j Mod 2 = 0 Then
                                cumul_nights += dt.Rows(i).Cells(j).Value
                                cumulTotal_nights += dt.Rows(i).Cells(j).Value
                            Else
                                cumul += dt.Rows(i).Cells(j).Value
                                cumulTotal += dt.Rows(i).Cells(j).Value
                            End If

                        End If

                    Next

                    pdfCell = New PdfPCell(New Paragraph(Format(cumul, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(cumul_nights, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                Next

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                Dim CumulGlobal As Double = 0

                nbreDeColonne -= 1

                For i = 0 To nbreDeColonne - 1

                    If i = 0 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(montantService_1, "#,##0"), pColumn))
                    ElseIf i = 1 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(nights_1, "#,##0"), pColumn))
                    ElseIf i = 2 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(montantService_2, "#,##0"), pColumn))
                    ElseIf i = 3 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(nights_2, "#,##0"), pColumn))
                    ElseIf i = 4 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(montantService_3, "#,##0"), pColumn))
                    ElseIf i = 5 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(nights_3, "#,##0"), pColumn))
                    ElseIf i = 6 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(montantService_4, "#,##0"), pColumn))
                    ElseIf i = 7 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(nights_4, "#,##0"), pColumn))
                    ElseIf i = 8 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(montantService_5, "#,##0"), pColumn))
                    ElseIf i = 9 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(nights_5, "#,##0"), pColumn))
                    ElseIf i = 10 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(montantService_6, "#,##0"), pColumn))
                    ElseIf i = 11 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(nights_6, "#,##0"), pColumn))
                    ElseIf i = 12 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(montantService_7, "#,##0"), pColumn))
                    ElseIf i = 13 Then
                        pdfCell = New PdfPCell(New Paragraph(Format(nights_7, "#,##0"), pColumn))
                    End If

                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 15
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                Next

                pdfCell = New PdfPCell(New Paragraph(Format(cumulTotal, "#,##0"), pColumn))

                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph(Format(cumulTotal_nights, "#,##0"), pColumn))

                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 15
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfDoc.Add(pdfTable)

                pdfDoc.Close()

                If GlobalVariable.actualLanguageValue = 1 Then
                    MessageBox.Show("PDF a été exporté " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Else
                    MessageBox.Show("PDF successfully exported " & sfd.FileName, "Generate PDF", MessageBoxButtons.OK, MessageBoxIcon.Information)
                End If

                Process.Start(sfd.FileName)

            Else

                MessageBox.Show("Aucune Ligne de Fatcure à imprimer!")

            End If

        End If

    End Sub


    Public Shared Sub FicheVentilationBarRestaurant(ByVal dt As DataGridView, ByVal dateDebut As Date, ByVal dateFin As Date)

        Dim blocNoteDuCaissier As DataTable

        If dt.Rows.Count > 0 Then

            Dim societe As DataTable = Functions.allTableFields("societe")
            Dim TotalFacture As Double = 0

            Dim tireDocument As String = ""
            Dim titreFichier As String = ""

            If GlobalVariable.actualLanguageValue = 1 Then
                titreFichier = "FICHE DE VENTILATION "
                tireDocument = titreFichier & " DU " & dateDebut & " " & Now().ToLongTimeString & Chr(13)
            Else
                titreFichier = "SALES VENTILATION FORM "
                tireDocument = titreFichier & " OF " & dateDebut & " " & Now().ToLongTimeString & Chr(13)
            End If

            Dim sfd As New SaveFileDialog With {.Filter = "PDF Files (*.pdf) | *.pdf"}

            sfd.FileName = titreFichier & " " & (Date.Now().ToString("ddMMyyHms"))

            If sfd.ShowDialog = 1 Then
                'Dim pdfDoc As New Document(PageSize.A4, 40, 40, 80, 40)
                Dim pdfDoc As New Document(PageSize.A4.Rotate, 40, 40, 80, 40)
                Dim pdfWrite As PdfWriter = PdfWriter.GetInstance(pdfDoc, New FileStream(sfd.FileName, FileMode.Create))
                Dim pColumn As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim pRow As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)
                Dim fontTotal As New Font(iTextSharp.text.Font.FontFamily.HELVETICA, 8, iTextSharp.text.Font.BOLD, BaseColor.BLACK)
                Dim font1 As New Font(iTextSharp.text.Font.FontFamily.COURIER, 8, iTextSharp.text.Font.NORMAL, BaseColor.BLACK)

                pdfWrite.PageEvent = New HeaderFooter

                pdfDoc.Open()

                Dim pdfTable As New PdfPTable(18) 'Number of columns
                pdfTable.TotalWidth = 780.0F
                pdfTable.LockedWidth = True
                pdfTable.HorizontalAlignment = Element.ALIGN_RIGHT
                pdfTable.HeaderRows = 1

                pdfTable.WidthPercentage = 100
                Dim widths As Single() = New Single() {10.0F, 45.0F, 10.0F, 10.0F, 30.0F, 12.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 20.0F, 30.0F}
                pdfTable.SetWidths(widths)

                Dim pdfCell As PdfPCell = Nothing

                Dim p10 As Paragraph = New Paragraph(Chr(13) & tireDocument & Chr(13))
                p10.Alignment = Element.ALIGN_CENTER
                pdfDoc.Add(p10)

                '-------------------------------------------
                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                pdfCell.PaddingLeft = 5.0F
                pdfCell.Colspan = 6
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("FOOD", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                pdfCell.Colspan = 3
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                pdfCell.Colspan = 2
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAYMENT MODE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                pdfCell.Colspan = 6
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                '----------------------------------------  -----------------------------------------------------------
                pdfCell = New PdfPCell(New Paragraph("No", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                pdfCell.PaddingLeft = 5.0F
                'pdfCell.BackgroundColor = BaseColor.LIGHT_GRAY
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("Client", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                'pdfCell.Colspan = 2

                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("In", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("Out", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("Invoice No", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("PAX", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BKFAST", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                pdfCell.MinimumHeight = 14
                'pdfCell.Colspan = 2
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("LUNCH", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("DINER", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("BEVERAGE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("MISC.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("CASH", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("VISA", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("MOBIL", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("GUEST IN", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("ACCOU.", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("FREE", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                pdfCell = New PdfPCell(New Paragraph("OBS", pColumn))
                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                pdfCell.MinimumHeight = 14
                pdfCell.PaddingLeft = 5.0F
                pdfTable.AddCell(pdfCell)

                Dim pax As Integer = 0
                Dim breakfast As Double = 0
                Dim dejeuner As Double = 0
                Dim dinner As Double = 0
                Dim boisson As Double = 0
                Dim cash As Double = 0
                Dim visa As Double = 0
                Dim mobile_money As Double = 0
                Dim guest_in As Double = 0
                Dim observation As String = ""
                Dim compte As Double = 0
                Dim free As Double = 0
                Dim misc As Double = 0

                If dt.Rows.Count > 0 Then

                    For i = 0 To dt.Rows.Count - 1

                        For j = 0 To dt.Columns.Count - 1

                            If j > 5 And j < 17 Then
                                pdfCell = New PdfPCell(New Paragraph(Format(dt.Rows(i).Cells(j).Value, "#,##0"), pRow))
                            Else
                                pdfCell = New PdfPCell(New Paragraph(dt.Rows(i).Cells(j).Value, pRow))
                            End If

                            If j = 0 Or j = 1 Or j = 4 Then
                                pdfCell.HorizontalAlignment = Element.ALIGN_LEFT
                            ElseIf j = 2 Or j = 3 Or j = 5 Then
                                pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                            Else
                                pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                            End If

                            If j = 5 Then
                                pax += dt.Rows(i).Cells(j).Value
                            ElseIf j = 6 Then
                                breakfast += dt.Rows(i).Cells(j).Value
                            ElseIf j = 7 Then
                                dejeuner += dt.Rows(i).Cells(j).Value
                            ElseIf j = 8 Then
                                dinner += dt.Rows(i).Cells(j).Value
                            ElseIf j = 9 Then
                                boisson += dt.Rows(i).Cells(j).Value
                            ElseIf j = 10 Then
                                misc += dt.Rows(i).Cells(j).Value
                            ElseIf j = 11 Then
                                cash += dt.Rows(i).Cells(j).Value
                            ElseIf j = 12 Then
                                visa += dt.Rows(i).Cells(j).Value
                            ElseIf j = 13 Then
                                mobile_money += dt.Rows(i).Cells(j).Value
                            ElseIf j = 14 Then
                                guest_in += dt.Rows(i).Cells(j).Value
                            ElseIf j = 15 Then
                                compte += dt.Rows(i).Cells(j).Value
                            ElseIf j = 16 Then
                                free += dt.Rows(i).Cells(j).Value
                            End If

                            pdfCell.MinimumHeight = 14
                            pdfCell.PaddingLeft = 5.0F

                            pdfTable.AddCell(pdfCell)

                        Next

                    Next

                    Dim barRestaurant As Double = breakfast + dinner + dejeuner + boisson
                    Dim totalEncaissement As Double = visa + mobile_money + cash + guest_in + compte + free

                    pdfCell = New PdfPCell(New Paragraph("TOTAL", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    pdfCell.Colspan = 5
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(pax, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(breakfast, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 14
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(dejeuner, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 14
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(dinner, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 14
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(boisson, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 14
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)


                    pdfCell = New PdfPCell(New Paragraph(Format(misc, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 14
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(cash, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 14
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(visa, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 14
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(mobile_money, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 14
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(guest_in, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 14
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(compte, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 14
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(free, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 14
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 14
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)


                    '-----------------------------------------------------------------------------------

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 14
                    pdfCell.Colspan = 5
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(pax, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(barRestaurant, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    pdfCell.Colspan = 4
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(misc, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.MinimumHeight = 14
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph(Format(totalEncaissement, "#,##0"), pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_CENTER
                    pdfCell.Colspan = 6
                    pdfCell.MinimumHeight = 14
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                    pdfCell = New PdfPCell(New Paragraph("", pColumn))
                    pdfCell.HorizontalAlignment = Element.ALIGN_RIGHT
                    pdfCell.MinimumHeight = 14
                    pdfCell.PaddingLeft = 5.0F
                    pdfTable.AddCell(pdfCell)

                End If

                pdfDoc.Add(pdfTable)

                pdfDoc.Close()

                Process.Start(sfd.FileName)

            End If

        End If
        '-----------------------------------------------------------------------------------------------------------------------------------------------

    End Sub



    Public Shared Sub ficheSuivieDeStockExportExcelForm(ByVal dt As DataGridView, ByVal title As String)

        If dt.Rows.Count > 0 Then

            Dim sfd As FolderBrowserDialog = New FolderBrowserDialog

            If sfd.ShowDialog() = DialogResult.OK Then

                Dim xlApp As Excel.Application
                Dim xlWorkBook As Excel.Workbook
                Dim xlWorkSheet As Excel.Worksheet
                Dim misValue As Object = System.Reflection.Missing.Value
                Dim i As Integer
                Dim j As Integer

                xlApp = New Excel.Application
                xlWorkBook = xlApp.Workbooks.Add(Type.Missing)
                xlWorkSheet = xlWorkBook.Sheets(1)

                Dim k As Integer = 0

                For Each column As DataGridViewColumn In dt.Columns
                    xlWorkSheet.Cells(1, k + 1) = column.HeaderText
                    k += 1
                Next

                Dim n As Integer = 2
                Dim m As Integer = 1

                '------------------------------------------------------------------------------------

                'For j = 0 To dt.Rows.Count - 1

                'For k = 0 To dt.Columns.Count - 1

                'If dt.Rows(j).Cells(2).Value > 0 Then

                'If k = 2 Or k = 4 Then

                'Dim COTE_ARTICLE As String = dt.Rows(j).Cells(0).Value.ToString
                'Dim QTE_CONVERTI As Double = Functions.affichageQteDansUnFormatCorrect(COTE_ARTICLE, dt.Rows(j).Cells(k).Value)

                'pdfCell = New PdfPCell(New Paragraph(Format(QTE_CONVERTI, "#,##0.00"), font1))
                'ElseIf k = 3 Then
                'pdfCell = New PdfPCell(New Paragraph("", font1))
                'Else
                'pdfCell = New PdfPCell(New Paragraph(dt.Rows(j).Cells(k).Value.ToString, font1))
                '    'End If

                'End If

                'Next

                'Next

                '------------------------------------------------------------------------------------

                For i = 2 To dt.RowCount + 1

                    For j = 1 To dt.ColumnCount - 1

                        'dt.Rows(i - n).Cells(2).Value > 0 Then
                        xlWorkSheet.Cells(i, j) = dt.Rows(i - n).Cells(j - m).Value
                        'End If

                    Next
                Next

                Dim fileName As String = "\" & title & ".xlsx"
                Dim finalPath = sfd.SelectedPath + fileName

                xlWorkSheet.Columns.AutoFit()

                xlWorkSheet.SaveAs(finalPath)
                xlWorkBook.Close()
                xlApp.Quit()

                releaseObject(xlApp)
                releaseObject(xlWorkBook)
                releaseObject(xlWorkSheet)

                MessageBox.Show(title & " a été exporté au format Excel", "Exportation Excel", MessageBoxButtons.OK, MessageBoxIcon.Information)

            End If

        End If

    End Sub

End Class
